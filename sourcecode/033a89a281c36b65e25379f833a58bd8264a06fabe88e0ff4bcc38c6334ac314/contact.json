{
  "address": "0xeae9d154da7a1cd05076db1b83233f3213a95e4f",
  "chain": "ETH",
  "chainID": 1,
  "verifier": "etherscan.io",
  "commonName": "",
  "contractName": "GemERC721",
  "compilerVersion": "v0.4.23+commit.124ca40d",
  "optimization": true,
  "runs": "200",
  "evmVersion": "default",
  "sourceCode": "/**\n *Submitted for verification at Etherscan.io on 2018-08-31\n*/\n\npragma solidity 0.4.23;\n\n/**\n * Utility library of inline functions on addresses\n */\nlibrary AddressUtils {\n\n  /**\n   * @notice Checks if the target address is a contract\n   * @dev This function will return false if invoked during the constructor of a contract,\n   *      as the code is not actually created until after the constructor finishes.\n   * @param addr address to check\n   * @return whether the target address is a contract\n   */\n  function isContract(address addr) internal view returns (bool) {\n    // a variable to load `extcodesize` to\n    uint256 size = 0;\n\n    // XXX Currently there is no better way to check if there is a contract in an address\n    // than to check the size of the code at that address.\n    // See https://ethereum.stackexchange.com/a/14016/36603 for more details about how this works.\n    // TODO: Check this again before the Serenity release, because all addresses will be contracts.\n    // solium-disable-next-line security/no-inline-assembly\n    assembly {\n      // retrieve the size of the code at address `addr`\n      size := extcodesize(addr)\n    }\n\n    // positive size indicates a smart contract address\n    return size > 0;\n  }\n\n}\n\n\n/**\n * Library for working with strings, primarily converting\n * between strings and integer types\n */\nlibrary StringUtils {\n  /**\n   * @dev Converts a string to unsigned integer using the specified `base`\n   * @dev Throws on invalid input\n   *      (wrong characters for a given `base`)\n   * @dev Throws if given `base` is not supported\n   * @param a string to convert\n   * @param base number base, one of 2, 8, 10, 16\n   * @return a number representing given string\n   */\n  function atoi(string a, uint8 base) internal pure returns (uint256 i) {\n    // check if the base is valid\n    require(base == 2 || base == 8 || base == 10 || base == 16);\n\n    // convert string into bytes for convenient iteration\n    bytes memory buf = bytes(a);\n\n    // iterate over the string (bytes buffer)\n    for(uint256 p = 0; p < buf.length; p++) {\n      // extract the digit\n      uint8 digit = uint8(buf[p]) - 0x30;\n\n      // if digit is greater then 10 â€“ mind the gap\n      // see `itoa` function for more details\n      if(digit > 10) {\n        // remove the gap\n        digit -= 7;\n      }\n\n      // check if digit meets the base\n      require(digit < base);\n\n      // move to the next digit slot\n      i *= base;\n\n      // add digit to the result\n      i += digit;\n    }\n\n    // return the result\n    return i;\n  }\n\n  /**\n   * @dev Converts a integer to a string using the specified `base`\n   * @dev Throws if given `base` is not supported\n   * @param i integer to convert\n   * @param base number base, one of 2, 8, 10, 16\n   * @return a string representing given integer\n   */\n  function itoa(uint256 i, uint8 base) internal pure returns (string a) {\n    // check if the base is valid\n    require(base == 2 || base == 8 || base == 10 || base == 16);\n\n    // for zero input the result is \"0\" string for any base\n    if (i == 0) {\n      return \"0\";\n    }\n\n    // bytes buffer to put ASCII characters into\n    bytes memory buf = new bytes(256);\n\n    // position within a buffer to be used in cycle\n    uint256 p = 0;\n\n    // extract digits one by one in a cycle\n    while (i > 0) {\n      // extract current digit\n      uint8 digit = uint8(i % base);\n\n      // convert it to an ASCII code\n      // 0x20 is \" \"\n      // 0x30-0x39 is \"0\"-\"9\"\n      // 0x41-0x5A is \"A\"-\"Z\"\n      // 0x61-0x7A is \"a\"-\"z\" (\"A\"-\"Z\" XOR \" \")\n      uint8 ascii = digit + 0x30;\n\n      // if digit is greater then 10,\n      // fix the 0x3A-0x40 gap of punctuation marks\n      // (7 characters in ASCII table)\n      if(digit > 10) {\n        // jump through the gap\n        ascii += 7;\n      }\n\n      // write character into the buffer\n      buf[p++] = byte(ascii);\n\n      // move to the next digit\n      i /= base;\n    }\n\n    // `p` contains real length of the buffer now, save it\n    uint256 length = p;\n\n    // reverse the buffer\n    for(p = 0; p < length / 2; p++) {\n      // swap elements at position `p` from the beginning and end using XOR:\n      // https://en.wikipedia.org/wiki/XOR_swap_algorithm\n      buf[p] ^= buf[length - 1 - p];\n      buf[length - 1 - p] ^= buf[p];\n      buf[p] ^= buf[length - 1 - p];\n    }\n\n    // construct string and return\n    return string(buf);\n  }\n\n  /**\n   * @dev Concatenates two strings `s1` and `s2`, for example, if\n   *      `s1` == `foo` and `s2` == `bar`, the result `s` == `foobar`\n   * @param s1 first string\n   * @param s2 second string\n   * @return concatenation result s1 + s2\n   */\n  function concat(string s1, string s2) internal pure returns (string s) {\n    // convert s1 into buffer 1\n    bytes memory buf1 = bytes(s1);\n    // convert s2 into buffer 2\n    bytes memory buf2 = bytes(s2);\n    // create a buffer for concatenation result\n    bytes memory buf = new bytes(buf1.length + buf2.length);\n\n    // copy buffer 1 into buffer\n    for(uint256 i = 0; i < buf1.length; i++) {\n      buf[i] = buf1[i];\n    }\n\n    // copy buffer 2 into buffer\n    for(uint256 j = buf1.length; j < buf2.length; j++) {\n      buf[j] = buf2[j - buf1.length];\n    }\n\n    // construct string and return\n    return string(buf);\n  }\n}\n\n\n/**\n * @dev Access control module provides an API to check\n *      if specific operation is permitted globally and\n *      if particular user's has a permission to execute it\n */\ncontract AccessControl {\n  /// @notice Role manager is responsible for assigning the roles\n  /// @dev Role ROLE_ROLE_MANAGER allows executing addOperator/removeOperator\n  uint256 private constant ROLE_ROLE_MANAGER = 0x10000000;\n\n  /// @notice Feature manager is responsible for enabling/disabling\n  ///      global features of the smart contract\n  /// @dev Role ROLE_FEATURE_MANAGER allows enabling/disabling global features\n  uint256 private constant ROLE_FEATURE_MANAGER = 0x20000000;\n\n  /// @dev Bitmask representing all the possible permissions (super admin role)\n  uint256 private constant FULL_PRIVILEGES_MASK = 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF;\n\n  /// @dev A bitmask of globally enabled features\n  uint256 public features;\n\n  /// @notice Privileged addresses with defined roles/permissions\n  /// @notice In the context of ERC20/ERC721 tokens these can be permissions to\n  ///      allow minting tokens, transferring on behalf and so on\n  /// @dev Maps an address to the permissions bitmask (role), where each bit\n  ///      represents a permission\n  /// @dev Bitmask 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF\n  ///      represents all possible permissions\n  mapping(address => uint256) public userRoles;\n\n  /// @dev Fired in updateFeatures()\n  event FeaturesUpdated(address indexed _by, uint256 _requested, uint256 _actual);\n\n  /// @dev Fired in addOperator(), removeOperator(), addRole(), removeRole()\n  event RoleUpdated(address indexed _by, address indexed _to, uint256 _role);\n\n  /**\n   * @dev Creates an access controlled instance\n   */\n  constructor() public {\n    // contract creator has full privileges\n    userRoles[msg.sender] = FULL_PRIVILEGES_MASK;\n  }\n\n  /**\n   * @dev Updates set of the globally enabled features (`f`),\n   *      taking into account sender's permissions.\n   * @dev Requires sender to have `ROLE_FEATURE_MANAGER` permission.\n   * @param mask bitmask representing a set of features to enable/disable\n   */\n  function updateFeatures(uint256 mask) public {\n    // call sender nicely - caller\n    address caller = msg.sender;\n    // read caller's permissions\n    uint256 p = userRoles[caller];\n\n    // caller should have a permission to update global features\n    require(__hasRole(p, ROLE_FEATURE_MANAGER));\n\n    // taking into account caller's permissions,\n    // 1) enable features requested\n    features |= p & mask;\n    // 2) disable features requested\n    features &= FULL_PRIVILEGES_MASK ^ (p & (FULL_PRIVILEGES_MASK ^ mask));\n\n    // fire an event\n    emit FeaturesUpdated(caller, mask, features);\n  }\n\n  /**\n   * @dev Adds a new `operator` - an address which has\n   *      some extended privileges over the smart contract,\n   *      for example token minting, transferring on behalf, etc.\n   * @dev Newly added `operator` cannot have any permissions which\n   *      transaction sender doesn't have.\n   * @dev Requires transaction sender to have `ROLE_ROLE_MANAGER` permission.\n   * @dev Cannot update existing operator. Throws if `operator` already exists.\n   * @param operator address of the operator to add\n   * @param role bitmask representing a set of permissions which\n   *      newly created operator will have\n   */\n  function addOperator(address operator, uint256 role) public {\n    // call sender gracefully - `manager`\n    address manager = msg.sender;\n\n    // read manager's permissions (role)\n    uint256 permissions = userRoles[manager];\n\n    // check that `operator` doesn't exist\n    require(userRoles[operator] == 0);\n\n    // manager must have a ROLE_ROLE_MANAGER role\n    require(__hasRole(permissions, ROLE_ROLE_MANAGER));\n\n    // recalculate permissions (role) to set:\n    // we cannot create an operator more powerful then calling `manager`\n    uint256 r = role & permissions;\n\n    // check if we still have some permissions (role) to set\n    require(r != 0);\n\n    // create an operator by persisting his permissions (roles) to storage\n    userRoles[operator] = r;\n\n    // fire an event\n    emit RoleUpdated(manager, operator, userRoles[operator]);\n  }\n\n  /**\n   * @dev Deletes an existing `operator`.\n   * @dev Requires sender to have `ROLE_ROLE_MANAGER` permission.\n   * @param operator address of the operator to delete\n   */\n  function removeOperator(address operator) public {\n    // call sender gracefully - `manager`\n    address manager = msg.sender;\n\n    // check if an `operator` exists\n    require(userRoles[operator] != 0);\n\n    // do not allow transaction sender to remove himself\n    // protects from an accidental removal of all the operators\n    require(operator != manager);\n\n    // manager must have a ROLE_ROLE_MANAGER role\n    // and he must have all the permissions operator has\n    require(__hasRole(userRoles[manager], ROLE_ROLE_MANAGER | userRoles[operator]));\n\n    // perform operator deletion\n    delete userRoles[operator];\n\n    // fire an event\n    emit RoleUpdated(manager, operator, 0);\n  }\n\n  /**\n   * @dev Updates an existing `operator`, adding a specified role to it.\n   * @dev Note that `operator` cannot receive permission which\n   *      transaction sender doesn't have.\n   * @dev Requires transaction sender to have `ROLE_ROLE_MANAGER` permission.\n   * @dev Cannot create a new operator. Throws if `operator` doesn't exist.\n   * @dev Existing permissions of the `operator` are preserved\n   * @param operator address of the operator to update\n   * @param role bitmask representing a set of permissions which\n   *      `operator` will have\n   */\n  function addRole(address operator, uint256 role) public {\n    // call sender gracefully - `manager`\n    address manager = msg.sender;\n\n    // read manager's permissions (role)\n    uint256 permissions = userRoles[manager];\n\n    // check that `operator` exists\n    require(userRoles[operator] != 0);\n\n    // manager must have a ROLE_ROLE_MANAGER role\n    require(__hasRole(permissions, ROLE_ROLE_MANAGER));\n\n    // recalculate permissions (role) to add:\n    // we cannot make an operator more powerful then calling `manager`\n    uint256 r = role & permissions;\n\n    // check if we still have some permissions (role) to add\n    require(r != 0);\n\n    // update operator's permissions (roles) in the storage\n    userRoles[operator] |= r;\n\n    // fire an event\n    emit RoleUpdated(manager, operator, userRoles[operator]);\n  }\n\n  /**\n   * @dev Updates an existing `operator`, removing a specified role from it.\n   * @dev Note that  permissions which transaction sender doesn't have\n   *      cannot be removed.\n   * @dev Requires transaction sender to have `ROLE_ROLE_MANAGER` permission.\n   * @dev Cannot remove all permissions. Throws on such an attempt.\n   * @param operator address of the operator to update\n   * @param role bitmask representing a set of permissions which\n   *      will be removed from the `operator`\n   */\n  function removeRole(address operator, uint256 role) public {\n    // call sender gracefully - `manager`\n    address manager = msg.sender;\n\n    // read manager's permissions (role)\n    uint256 permissions = userRoles[manager];\n\n    // check that we're not removing all the `operator`s permissions\n    // this is not really required and just causes inconveniences is function use\n    //require(userRoles[operator] ^ role != 0);\n\n    // manager must have a ROLE_ROLE_MANAGER role\n    require(__hasRole(permissions, ROLE_ROLE_MANAGER));\n\n    // recalculate permissions (role) to remove:\n    // we cannot revoke permissions which calling `manager` doesn't have\n    uint256 r = role & permissions;\n\n    // check if we still have some permissions (role) to revoke\n    require(r != 0);\n\n    // update operator's permissions (roles) in the storage\n    userRoles[operator] &= FULL_PRIVILEGES_MASK ^ r;\n\n    // fire an event\n    emit RoleUpdated(manager, operator, userRoles[operator]);\n  }\n\n  /// @dev Checks if requested feature is enabled globally on the contract\n  function __isFeatureEnabled(uint256 featureRequired) internal constant returns(bool) {\n    // delegate call to `__hasRole`\n    return __hasRole(features, featureRequired);\n  }\n\n  /// @dev Checks if transaction sender `msg.sender` has all the required permissions `roleRequired`\n  function __isSenderInRole(uint256 roleRequired) internal constant returns(bool) {\n    // read sender's permissions (role)\n    uint256 userRole = userRoles[msg.sender];\n\n    // delegate call to `__hasRole`\n    return __hasRole(userRole, roleRequired);\n  }\n\n  /// @dev Checks if user role `userRole` contain all the permissions required `roleRequired`\n  function __hasRole(uint256 userRole, uint256 roleRequired) internal pure returns(bool) {\n    // check the bitmask for the role required and return the result\n    return userRole & roleRequired == roleRequired;\n  }\n}\n\n\n/**\n * @title ERC721 token receiver interface\n * @dev Interface for any contract that wants to support safe transfers\n *      from ERC721 asset contracts.\n * @dev See https://github.com/ethereum/EIPs/blob/master/EIPS/eip-721.md\n */\ninterface ERC721Receiver {\n  /**\n   * @notice Handle the receipt of an NFT\n   * @dev The ERC721 smart contract calls this function on the recipient after a `transfer`.\n   *      This function MAY throw to revert and reject the transfer.\n   *      Return of other than the magic value MUST result in the transaction being reverted.\n   * @notice The contract address is always the message sender.\n   *      A wallet/broker/auction application MUST implement the wallet interface\n   *      if it will accept safe transfers.\n   * @param _operator The address which called `safeTransferFrom` function\n   * @param _from The address which previously owned the token\n   * @param _tokenId The NFT identifier which is being transferred\n   * @param _data Additional data with no specified format\n   * @return `bytes4(keccak256(\"onERC721Received(address,address,uint256,bytes)\"))` unless throwing\n   */\n  function onERC721Received(address _operator, address _from, uint256 _tokenId, bytes _data) external returns(bytes4);\n}\n\n\n/**\n * @title ERC165\n * @dev https://github.com/ethereum/EIPs/blob/master/EIPS/eip-165.md\n */\ncontract ERC165 {\n  /**\n   * 0x01ffc9a7 == bytes4(keccak256('supportsInterface(bytes4)'))\n   */\n  bytes4 public constant InterfaceId_ERC165 = 0x01ffc9a7;\n\n  /**\n   * @dev a mapping of interface id to whether or not it's supported\n   */\n  mapping(bytes4 => bool) internal supportedInterfaces;\n\n  /**\n   * @dev A contract implementing SupportsInterfaceWithLookup\n   * implement ERC165 itself\n   */\n  constructor() public {\n    // register itself in a lookup table\n    _registerInterface(InterfaceId_ERC165);\n  }\n\n\n\n  /**\n   * @notice Query if a contract implements an interface\n   * @param _interfaceId The interface identifier, as specified in ERC-165\n   * @dev Interface identification is specified in ERC-165.\n   * @dev This function uses less than 30,000 gas.\n   */\n  function supportsInterface(bytes4 _interfaceId) public constant returns (bool) {\n    // find if interface is supported using a lookup table\n    return supportedInterfaces[_interfaceId];\n  }\n\n  /**\n   * @dev private method for registering an interface\n   */\n  function _registerInterface(bytes4 _interfaceId) internal {\n    require(_interfaceId != 0xffffffff);\n    supportedInterfaces[_interfaceId] = true;\n  }\n}\n\n\n/**\n * @notice Gem is unique tradable entity. Non-fungible.\n * @dev A gem is an ERC721 non-fungible token, which maps Token ID,\n *      a 32 bit number to a set of gem properties -\n *      attributes (mostly immutable by their nature) and state variables (mutable)\n * @dev A gem token supports only minting, it can be only created\n */\ncontract GemERC721 is AccessControl, ERC165 {\n  /// @dev Smart contract version\n  /// @dev Should be incremented manually in this source code\n  ///      each time smart contact source code is changed\n  uint32 public constant TOKEN_VERSION = 0x3;\n\n  /// @dev ERC20 compliant token symbol\n  string public constant symbol = \"GEM\";\n  /// @dev ERC20 compliant token name\n  string public constant name = \"GEM â€“ CryptoMiner World\";\n  /// @dev ERC20 compliant token decimals\n  /// @dev this can be only zero, since ERC721 token is non-fungible\n  uint8 public constant decimals = 0;\n\n  /// @dev A gem data structure\n  /// @dev Occupies 64 bytes of storage (512 bits)\n  struct Gem {\n    /// High 256 bits\n    /// @dev Where gem was found: land plot ID,\n    ///      land block within a plot,\n    ///      gem number (id) within a block of land, immutable\n    uint64 coordinates;\n\n    /// @dev Gem color, one of 12 values, immutable\n    uint8 color;\n\n    /// @dev Level modified time\n    /// @dev Stored as Ethereum Block Number of the transaction\n    ///      when the gem was created\n    uint32 levelModified;\n\n    /// @dev Level value (mutable), one of 1, 2, 3, 4, 5\n    uint8 level;\n\n    /// @dev Grade modified time\n    /// @dev Stored as Ethereum Block Number of the transaction\n    ///      when the gem was created\n    uint32 gradeModified;\n\n    /// @dev High 8 bits store grade type and low 24 bits grade value\n    /// @dev Grade type is one of D (1), C (2), B (3), A (4), AA (5) and AAA (6)\n    uint32 grade;\n\n    /// @dev Store state modified time\n    /// @dev Stored as Ethereum Block Number of the transaction\n    ///      when the gem was created\n    uint32 stateModified;\n\n    /// @dev State value, mutable\n    uint48 state;\n\n\n    /// Low 256 bits\n    /// @dev Gem creation time, immutable, cannot be zero\n    /// @dev Stored as Ethereum Block Number of the transaction\n    ///      when the gem was created\n    uint32 creationTime;\n\n    /// @dev Gem index within an owner's collection of gems, mutable\n    uint32 index;\n\n    /// @dev Initially zero, changes when ownership is transferred\n    /// @dev Stored as Ethereum Block Number of the transaction\n    ///      when the gem's ownership was changed, mutable\n    uint32 ownershipModified;\n\n    /// @dev Gem's owner, initialized upon gem creation, mutable\n    address owner;\n  }\n\n  /// @notice All the emitted gems\n  /// @dev Core of the Gem as ERC721 token\n  /// @dev Maps Gem ID => Gem Data Structure\n  mapping(uint256 => Gem) public gems;\n\n  /// @dev Mapping from a gem ID to an address approved to\n  ///      transfer ownership rights for this gem\n  mapping(uint256 => address) public approvals;\n\n  /// @dev Mapping from owner to operator approvals\n  ///      token owner => approved token operator => is approved\n  mapping(address => mapping(address => bool)) public approvedOperators;\n\n  /// @notice Storage for a collections of tokens\n  /// @notice A collection of tokens is an ordered list of token IDs,\n  ///      owned by a particular address (owner)\n  /// @dev A mapping from owner to a collection of his tokens (IDs)\n  /// @dev ERC20 compliant structure for balances can be derived\n  ///      as a length of each collection in the mapping\n  /// @dev ERC20 balances[owner] is equal to collections[owner].length\n  mapping(address => uint32[]) public collections;\n\n  /// @dev Array with all token ids, used for enumeration\n  /// @dev ERC20 compliant structure for totalSupply can be derived\n  ///      as a length of this collection\n  /// @dev ERC20 totalSupply() is equal to allTokens.length\n  uint32[] public allTokens;\n\n  /// @dev The data in token's state may contain lock(s)\n  ///      (ex.: is gem currently mining or not)\n  /// @dev A locked token cannot be transferred or upgraded\n  /// @dev The token is locked if it contains any bits\n  ///      from the `lockedBitmask` in its `state` set\n  uint64 public lockedBitmask = DEFAULT_MINING_BIT;\n\n  /// @dev Enables ERC721 transfers of the tokens\n  uint32 public constant FEATURE_TRANSFERS = 0x00000001;\n\n  /// @dev Enables ERC721 transfers on behalf\n  uint32 public constant FEATURE_TRANSFERS_ON_BEHALF = 0x00000002;\n\n  /// @dev Enables partial support of ERC20 transfers of the tokens,\n  ///      allowing to transfer only all owned tokens at once\n  //uint32 public constant ERC20_TRANSFERS = 0x00000004;\n\n  /// @dev Enables partial support of ERC20 transfers on behalf\n  ///      allowing to transfer only all owned tokens at once\n  //uint32 public constant ERC20_TRANSFERS_ON_BEHALF = 0x00000008;\n\n  /// @dev Enables full support of ERC20 transfers of the tokens,\n  ///      allowing to transfer arbitrary amount of the tokens at once\n  //uint32 public constant ERC20_INSECURE_TRANSFERS = 0x00000010;\n\n  /// @dev Default bitmask indicating that the gem is `mining`\n  /// @dev Consists of a single bit at position 1 â€“ binary 1\n  /// @dev This bit is cleared by `miningComplete`\n  /// @dev The bit meaning in gem's `state` is as follows:\n  ///      0: not mining\n  ///      1: mining\n  uint64 public constant DEFAULT_MINING_BIT = 0x1; // bit number 1\n\n  /// @notice Exchange is responsible for trading tokens on behalf of token holders\n  /// @dev Role ROLE_EXCHANGE allows executing transfer on behalf of token holders\n  /// @dev Not used\n  //uint32 public constant ROLE_EXCHANGE = 0x00010000;\n\n  /// @notice Level provider is responsible for enabling the workshop\n  /// @dev Role ROLE_LEVEL_PROVIDER allows leveling up the gem\n  uint32 public constant ROLE_LEVEL_PROVIDER = 0x00100000;\n\n  /// @notice Grade provider is responsible for enabling the workshop\n  /// @dev Role ROLE_GRADE_PROVIDER allows modifying gem's grade\n  uint32 public constant ROLE_GRADE_PROVIDER = 0x00200000;\n\n  /// @notice Token state provider is responsible for enabling the mining protocol\n  /// @dev Role ROLE_STATE_PROVIDER allows modifying token's state\n  uint32 public constant ROLE_STATE_PROVIDER = 0x00400000;\n\n  /// @notice Token state provider is responsible for enabling the mining protocol\n  /// @dev Role ROLE_STATE_LOCK_PROVIDER allows modifying token's locked bitmask\n  uint32 public constant ROLE_STATE_LOCK_PROVIDER = 0x00800000;\n\n  /// @notice Token creator is responsible for creating tokens\n  /// @dev Role ROLE_TOKEN_CREATOR allows minting tokens\n  uint32 public constant ROLE_TOKEN_CREATOR = 0x00040000;\n\n  /// @notice Token destroyer is responsible for destroying tokens\n  /// @dev Role ROLE_TOKEN_DESTROYER allows burning tokens\n  //uint32 public constant ROLE_TOKEN_DESTROYER = 0x00080000;\n\n  /// @dev Magic value to be returned upon successful reception of an NFT\n  /// @dev Equal to `bytes4(keccak256(\"onERC721Received(address,address,uint256,bytes)\"))`,\n  ///      which can be also obtained as `ERC721Receiver(0).onERC721Received.selector`\n  bytes4 private constant ERC721_RECEIVED = 0x150b7a02;\n\n  /**\n   * Supported interfaces section\n   */\n\n  /**\n   * ERC721 interface definition in terms of ERC165\n   *\n   * 0x80ac58cd ==\n   *   bytes4(keccak256('balanceOf(address)')) ^\n   *   bytes4(keccak256('ownerOf(uint256)')) ^\n   *   bytes4(keccak256('approve(address,uint256)')) ^\n   *   bytes4(keccak256('getApproved(uint256)')) ^\n   *   bytes4(keccak256('setApprovalForAll(address,bool)')) ^\n   *   bytes4(keccak256('isApprovedForAll(address,address)')) ^\n   *   bytes4(keccak256('transferFrom(address,address,uint256)')) ^\n   *   bytes4(keccak256('safeTransferFrom(address,address,uint256)')) ^\n   *   bytes4(keccak256('safeTransferFrom(address,address,uint256,bytes)'))\n   */\n  bytes4 private constant InterfaceId_ERC721 = 0x80ac58cd;\n\n  /**\n   * ERC721 interface extension â€“ exists(uint256)\n   *\n   * 0x4f558e79 == bytes4(keccak256('exists(uint256)'))\n   */\n  bytes4 private constant InterfaceId_ERC721Exists = 0x4f558e79;\n\n  /**\n   * ERC721 interface extension - ERC721Enumerable\n   *\n   * 0x780e9d63 ==\n   *   bytes4(keccak256('totalSupply()')) ^\n   *   bytes4(keccak256('tokenOfOwnerByIndex(address,uint256)')) ^\n   *   bytes4(keccak256('tokenByIndex(uint256)'))\n   */\n  bytes4 private constant InterfaceId_ERC721Enumerable = 0x780e9d63;\n\n  /**\n   * ERC721 interface extension - ERC721Metadata\n   *\n   * 0x5b5e139f ==\n   *   bytes4(keccak256('name()')) ^\n   *   bytes4(keccak256('symbol()')) ^\n   *   bytes4(keccak256('tokenURI(uint256)'))\n   */\n  bytes4 private constant InterfaceId_ERC721Metadata = 0x5b5e139f;\n\n  /// @dev Event names are self-explanatory:\n  /// @dev Fired in mint()\n  /// @dev Address `_by` allows to track who created a token\n  event Minted(address indexed _by, address indexed _to, uint32 indexed _tokenId);\n\n  /// @dev Fired in burn()\n  /// @dev Address `_by` allows to track who destroyed a token\n  //event Burnt(address indexed _from, address _by, uint32 indexed _tokenId);\n\n  /// @dev Fired in transfer(), transferFor(), mint()\n  /// @dev When minting a token, address `_from` is zero\n  /// @dev ERC20/ERC721 compliant event\n  event Transfer(address indexed _from, address indexed _to, uint256 indexed _tokenId, uint256 _value);\n\n  /// @dev Fired in approve()\n  /// @dev ERC721 compliant event\n  event Approval(address indexed _owner, address indexed _approved, uint256 indexed _tokenId);\n\n  /// @dev Fired in setApprovalForAll()\n  /// @dev ERC721 compliant event\n  event ApprovalForAll(address indexed _owner, address indexed _operator, bool _value);\n\n  /// @dev Fired in levelUp()\n  event LevelUp(address indexed _by, address indexed _owner, uint256 indexed _tokenId, uint8 _levelReached);\n\n  /// @dev Fired in upgradeGrade()\n  event UpgradeComplete(address indexed _by, address indexed _owner, uint256 indexed _tokenId, uint32 _gradeFrom, uint32 _gradeTo);\n\n  /// @dev Fired in setState()\n  event StateModified(address indexed _by, address indexed _owner, uint256 indexed _tokenId, uint48 _stateFrom, uint48 _stateTo);\n\n  /// @dev Creates a Gem ERC721 instance,\n  /// @dev Registers a ERC721 interface using ERC165\n  constructor() public {\n    // register the supported interfaces to conform to ERC721 via ERC165\n    _registerInterface(InterfaceId_ERC721);\n    _registerInterface(InterfaceId_ERC721Exists);\n    _registerInterface(InterfaceId_ERC721Enumerable);\n    _registerInterface(InterfaceId_ERC721Metadata);\n  }\n\n  /**\n   * @dev Gets a gem by ID, representing it as two integers.\n   *      The two integers are tightly packed with a gem data:\n   *      First integer (high bits) contains (from higher to lower bits order):\n   *          coordinates:\n   *            plotId,\n   *            depth (block ID),\n   *            gemNum (gem ID within a block)\n   *          color,\n   *          levelModified,\n   *          level,\n   *          gradeModified,\n   *          grade,\n   *          stateModified,\n   *          state,\n   *      Second integer (low bits) contains (from higher to lower bits order):\n   *          creationTime,\n   *          index,\n   *          ownershipModified,\n   *          owner\n   * @dev Throws if gem doesn't exist\n   * @param _tokenId ID of the gem to fetch\n   */\n  function getPacked(uint256 _tokenId) public constant returns(uint256, uint256) {\n    // validate gem existence\n    require(exists(_tokenId));\n\n    // load the gem from storage\n    Gem memory gem = gems[_tokenId];\n\n    // pack high 256 bits of the result\n    uint256 high = uint256(gem.coordinates) << 192\n                 | uint192(gem.color) << 184\n                 | uint184(gem.levelModified) << 152\n                 | uint152(gem.level) << 144\n                 | uint144(gem.gradeModified) << 112\n                 | uint112(gem.grade) << 80\n                 | uint80(gem.stateModified) << 48\n                 | uint48(gem.state);\n\n    // pack low 256 bits of the result\n    uint256 low  = uint256(gem.creationTime) << 224\n                 | uint224(gem.index) << 192\n                 | uint192(gem.ownershipModified) << 160\n                 | uint160(gem.owner);\n\n    // return the whole 512 bits of result\n    return (high, low);\n  }\n\n  /**\n   * @dev Allows to fetch collection of tokens, including internal token data\n   *       in a single function, useful when connecting to external node like INFURA\n   * @param owner an address to query a collection for\n   */\n  function getPackedCollection(address owner) public constant returns (uint80[]) {\n    // get an array of Gem IDs owned by an `owner` address\n    uint32[] memory tokenIds = getCollection(owner);\n\n    // how many gems are there in a collection\n    uint32 balance = uint32(tokenIds.length);\n\n    // data container to store the result\n    uint80[] memory result = new uint80[](balance);\n\n    // fetch token info one by one and pack into structure\n    for(uint32 i = 0; i < balance; i++) {\n      // token ID to work with\n      uint32 tokenId = tokenIds[i];\n      // get the token properties and pack them together with tokenId\n      uint48 properties = getProperties(tokenId);\n\n      // pack the data\n      result[i] = uint80(tokenId) << 48 | properties;\n    }\n\n    // return the packed data structure\n    return result;\n  }\n\n  /**\n   * @notice Retrieves a collection of tokens owned by a particular address\n   * @notice An order of token IDs is not guaranteed and may change\n   *      when a token from the list is transferred\n   * @param owner an address to query a collection for\n   * @return an ordered list of tokens\n   */\n  function getCollection(address owner) public constant returns(uint32[]) {\n    // read a collection from mapping and return\n    return collections[owner];\n  }\n\n  /**\n   * @dev Allows setting the `lockedBitmask` parameter of the contract,\n   *      which is used to determine if a particular token is locked or not\n   * @dev A locked token cannot be transferred, upgraded or burnt\n   * @dev The token is locked if it contains any bits\n   *      from the `lockedBitmask` in its `state` set\n   * @dev Requires sender to have `ROLE_STATE_PROVIDER` permission.\n   * @param bitmask a value to set `lockedBitmask` to\n   */\n  function setLockedBitmask(uint64 bitmask) public {\n    // check that the call is made by a state lock provider\n    require(__isSenderInRole(ROLE_STATE_LOCK_PROVIDER));\n\n    // update the locked bitmask\n    lockedBitmask = bitmask;\n  }\n\n  /**\n   * @dev Gets the coordinates of a token\n   * @param _tokenId ID of the token to get coordinates for\n   * @return a token coordinates\n   */\n  function getCoordinates(uint256 _tokenId) public constant returns(uint64) {\n    // validate token existence\n    require(exists(_tokenId));\n\n    // obtain token's coordinates from storage and return\n    return gems[_tokenId].coordinates;\n  }\n\n  /**\n   * @dev Gets the land plot ID of a gem\n   * @param _tokenId ID of the gem to get land plot ID value for\n   * @return a token land plot ID\n   */\n  function getPlotId(uint256 _tokenId) public constant returns(uint32) {\n    // extract high 32 bits of the coordinates and return\n    return uint32(getCoordinates(_tokenId) >> 32);\n  }\n\n  /**\n   * @dev Gets the depth (block ID) within plot of land of a gem\n   * @param _tokenId ID of the gem to get depth value for\n   * @return a token depth\n   */\n  function getDepth(uint256 _tokenId) public constant returns(uint16) {\n    // extract middle 16 bits of the coordinates and return\n    return uint16(getCoordinates(_tokenId) >> 16);\n  }\n\n  /**\n   * @dev Gets the gem's number within land block\n   * @param _tokenId ID of the gem to get depth value for\n   * @return a gem number within a land block\n   */\n  function getGemNum(uint256 _tokenId) public constant returns(uint16) {\n    // extract low 16 bits of the coordinates and return\n    return uint16(getCoordinates(_tokenId));\n  }\n\n  /**\n   * @dev Gets the gem's properties â€“ color, level and\n   *      grade - as packed uint32 number\n   * @param _tokenId ID of the gem to get properties for\n   * @return gem's properties - color, level, grade as packed uint32\n   */\n  function getProperties(uint256 _tokenId) public constant returns(uint48) {\n    // validate token existence\n    require(exists(_tokenId));\n\n    // read gem from storage\n    Gem memory gem = gems[_tokenId];\n\n    // pack data structure and return\n    return uint48(gem.color) << 40 | uint40(gem.level) << 32 | gem.grade;\n  }\n\n  /**\n   * @dev Gets the color of a token\n   * @param _tokenId ID of the token to get color for\n   * @return a token color\n   */\n  function getColor(uint256 _tokenId) public constant returns(uint8) {\n    // validate token existence\n    require(exists(_tokenId));\n\n    // obtain token's color from storage and return\n    return gems[_tokenId].color;\n  }\n\n  /**\n   * @dev Gets the level modified date of a token\n   * @param _tokenId ID of the token to get level modification date for\n   * @return a token level modification date\n   */\n  function getLevelModified(uint256 _tokenId) public constant returns(uint32) {\n    // validate token existence\n    require(exists(_tokenId));\n\n    // obtain token's level modified date from storage and return\n    return gems[_tokenId].levelModified;\n  }\n\n  /**\n   * @dev Gets the level of a token\n   * @param _tokenId ID of the token to get level for\n   * @return a token level\n   */\n  function getLevel(uint256 _tokenId) public constant returns(uint8) {\n    // validate token existence\n    require(exists(_tokenId));\n\n    // obtain token's level from storage and return\n    return gems[_tokenId].level;\n  }\n\n  /**\n   * @dev Levels up a gem\n   * @dev Requires sender to have `ROLE_STATE_PROVIDER` permission\n   * @param _tokenId ID of the gem to level up\n   */\n  function levelUp(uint256 _tokenId) public {\n    // check that the call is made by a level provider\n    require(__isSenderInRole(ROLE_LEVEL_PROVIDER));\n\n    // check that token to set state for exists\n    require(exists(_tokenId));\n\n    // update the level modified date\n    gems[_tokenId].levelModified = uint32(block.number);\n\n    // increment the level required\n    gems[_tokenId].level++;\n\n    // emit an event\n    emit LevelUp(msg.sender, ownerOf(_tokenId), _tokenId, gems[_tokenId].level);\n  }\n\n  /**\n   * @dev Gets the grade modified date of a gem\n   * @param _tokenId ID of the gem to get grade modified date for\n   * @return a token grade modified date\n   */\n  function getGradeModified(uint256 _tokenId) public constant returns(uint32) {\n    // validate token existence\n    require(exists(_tokenId));\n\n    // obtain token's grade modified date from storage and return\n    return gems[_tokenId].gradeModified;\n  }\n\n  /**\n   * @dev Gets the grade of a gem\n   * @param _tokenId ID of the gem to get grade for\n   * @return a token grade\n   */\n  function getGrade(uint256 _tokenId) public constant returns(uint32) {\n    // validate token existence\n    require(exists(_tokenId));\n\n    // obtain token's grade from storage and return\n    return gems[_tokenId].grade;\n  }\n\n  /**\n   * @dev Gets the grade type of a gem\n   * @param _tokenId ID of the gem to get grade type for\n   * @return a token grade type\n   */\n  function getGradeType(uint256 _tokenId) public constant returns(uint8) {\n    // extract high 8 bits of the grade and return\n    return uint8(getGrade(_tokenId) >> 24);\n  }\n\n  /**\n   * @dev Gets the grade value of a gem\n   * @param _tokenId ID of the gem to get grade value for\n   * @return a token grade value\n   */\n  function getGradeValue(uint256 _tokenId) public constant returns(uint24) {\n    // extract low 24 bits of the grade and return\n    return uint24(getGrade(_tokenId));\n  }\n\n  /**\n   * @dev Upgrades the grade of the gem\n   * @dev Requires new grade to be higher than an old one\n   * @dev Requires sender to have `ROLE_GRADE_PROVIDER` permission\n   * @param _tokenId ID of the gem to modify the grade for\n   * @param grade new grade to set for the token, should be higher then current state\n   */\n  function upgradeGrade(uint256 _tokenId, uint32 grade) public {\n    // check that the call is made by a grade provider\n    require(__isSenderInRole(ROLE_GRADE_PROVIDER));\n\n    // check that token to set grade for exists\n    require(exists(_tokenId));\n\n    // check if we're not downgrading the gem\n    require(gems[_tokenId].grade < grade);\n\n    // emit an event\n    emit UpgradeComplete(msg.sender, ownerOf(_tokenId), _tokenId, gems[_tokenId].grade, grade);\n\n    // set the grade required\n    gems[_tokenId].grade = grade;\n\n    // update the grade modified date\n    gems[_tokenId].gradeModified = uint32(block.number);\n  }\n\n  /**\n   * @dev Gets the state modified date of a token\n   * @param _tokenId ID of the token to get state modified date for\n   * @return a token state modification date\n   */\n  function getStateModified(uint256 _tokenId) public constant returns(uint32) {\n    // validate token existence\n    require(exists(_tokenId));\n\n    // obtain token's state modified date from storage and return\n    return gems[_tokenId].stateModified;\n  }\n\n  /**\n   * @dev Gets the state of a token\n   * @param _tokenId ID of the token to get state for\n   * @return a token state\n   */\n  function getState(uint256 _tokenId) public constant returns(uint48) {\n    // validate token existence\n    require(exists(_tokenId));\n\n    // obtain token's state from storage and return\n    return gems[_tokenId].state;\n  }\n\n  /**\n   * @dev Sets the state of a token\n   * @dev Requires sender to have `ROLE_STATE_PROVIDER` permission\n   * @param _tokenId ID of the token to set state for\n   * @param state new state to set for the token\n   */\n  function setState(uint256 _tokenId, uint48 state) public {\n    // check that the call is made by a state provider\n    require(__isSenderInRole(ROLE_STATE_PROVIDER));\n\n    // check that token to set state for exists\n    require(exists(_tokenId));\n\n    // emit an event\n    emit StateModified(msg.sender, ownerOf(_tokenId), _tokenId, gems[_tokenId].state, state);\n\n    // set the state required\n    gems[_tokenId].state = state;\n\n    // update the state modified date\n    gems[_tokenId].stateModified = uint32(block.number);\n  }\n\n  /**\n   * @dev Gets the creation time of a token\n   * @param _tokenId ID of the token to get creation time for\n   * @return a token creation time\n   */\n  function getCreationTime(uint256 _tokenId) public constant returns(uint32) {\n    // validate token existence\n    require(exists(_tokenId));\n\n    // obtain token's creation time from storage and return\n    return gems[_tokenId].creationTime;\n  }\n\n  /**\n   * @dev Gets the ownership modified time of a token\n   * @param _tokenId ID of the token to get ownership modified time for\n   * @return a token ownership modified time\n   */\n  function getOwnershipModified(uint256 _tokenId) public constant returns(uint32) {\n    // validate token existence\n    require(exists(_tokenId));\n\n    // obtain token's ownership modified time from storage and return\n    return gems[_tokenId].ownershipModified;\n  }\n\n  /**\n   * @notice Total number of existing tokens (tracked by this contract)\n   * @return A count of valid tokens tracked by this contract,\n   *    where each one of them has an assigned and\n   *    queryable owner not equal to the zero address\n   */\n  function totalSupply() public constant returns (uint256) {\n    // read the length of the `allTokens` collection\n    return allTokens.length;\n  }\n\n  /**\n   * @notice Enumerate valid tokens\n   * @dev Throws if `_index` >= `totalSupply()`.\n   * @param _index a counter less than `totalSupply()`\n   * @return The token ID for the `_index`th token, unsorted\n   */\n  function tokenByIndex(uint256 _index) public constant returns (uint256) {\n    // out of bounds check\n    require(_index < allTokens.length);\n\n    // get the token ID and return\n    return allTokens[_index];\n  }\n\n  /**\n   * @notice Enumerate tokens assigned to an owner\n   * @dev Throws if `_index` >= `balanceOf(_owner)`.\n   * @param _owner an address of the owner to query token from\n   * @param _index a counter less than `balanceOf(_owner)`\n   * @return the token ID for the `_index`th token assigned to `_owner`, unsorted\n   */\n  function tokenOfOwnerByIndex(address _owner, uint256 _index) public constant returns (uint256) {\n    // out of bounds check\n    require(_index < collections[_owner].length);\n\n    // get the token ID from owner collection and return\n    return collections[_owner][_index];\n  }\n\n  /**\n   * @notice Gets an amount of token owned by the given address\n   * @dev Gets the balance of the specified address\n   * @param _owner address to query the balance for\n   * @return an amount owned by the address passed as an input parameter\n   */\n  function balanceOf(address _owner) public constant returns (uint256) {\n    // read the length of the `who`s collection of tokens\n    return collections[_owner].length;\n  }\n\n  /**\n   * @notice Checks if specified token exists\n   * @dev Returns whether the specified token ID exists\n   * @param _tokenId ID of the token to query the existence for\n   * @return whether the token exists (true - exists)\n   */\n  function exists(uint256 _tokenId) public constant returns (bool) {\n    // check if this token exists (owner is not zero)\n    return gems[_tokenId].owner != address(0);\n  }\n\n  /**\n   * @notice Finds an owner address for a token specified\n   * @dev Gets the owner of the specified token from the `gems` mapping\n   * @dev Throws if a token with the ID specified doesn't exist\n   * @param _tokenId ID of the token to query the owner for\n   * @return owner address currently marked as the owner of the given token\n   */\n  function ownerOf(uint256 _tokenId) public constant returns (address) {\n    // check if this token exists\n    require(exists(_tokenId));\n\n    // return owner's address\n    return gems[_tokenId].owner;\n  }\n\n  /**\n   * @dev Creates new token with `tokenId` ID specified and\n   *      assigns an ownership `to` for that token\n   * @dev Allows setting initial token's properties\n   * @param to an address to assign created token ownership to\n   * @param tokenId ID of the token to create\n   */\n  function mint(\n    address to,\n    uint32 tokenId,\n    uint32 plotId,\n    uint16 depth,\n    uint16 gemNum,\n    uint8 color,\n    uint8 level,\n    uint8 gradeType,\n    uint24 gradeValue\n  ) public {\n    // validate destination address\n    require(to != address(0));\n    require(to != address(this));\n\n    // check if caller has sufficient permissions to mint a token\n    // and if feature is enabled globally\n    require(__isSenderInRole(ROLE_TOKEN_CREATOR));\n\n    // delegate call to `__mint`\n    __mint(to, tokenId, plotId, depth, gemNum, color, level, gradeType, gradeValue);\n\n    // fire ERC20 transfer event\n    emit Transfer(address(0), to, tokenId, 1);\n  }\n\n  /**\n   * @notice Transfers ownership rights of a token defined\n   *      by the `tokenId` to a new owner specified by address `to`\n   * @dev Requires the sender of the transaction to be an owner\n   *      of the token specified (`tokenId`)\n   * @param to new owner address\n   * @param _tokenId ID of the token to transfer ownership rights for\n   */\n  function transfer(address to, uint256 _tokenId) public {\n    // check if token transfers feature is enabled\n    require(__isFeatureEnabled(FEATURE_TRANSFERS));\n\n    // call sender gracefully - `from`\n    address from = msg.sender;\n\n    // delegate call to unsafe `__transfer`\n    __transfer(from, to, _tokenId);\n  }\n\n  /**\n   * @notice A.k.a \"transfer a token on behalf\"\n   * @notice Transfers ownership rights of a token defined\n   *      by the `tokenId` to a new owner specified by address `to`\n   * @notice Allows transferring ownership rights by a trading operator\n   *      on behalf of token owner. Allows building an exchange of tokens.\n   * @dev Transfers the ownership of a given token ID to another address\n   * @dev Requires the transaction sender to be one of:\n   *      owner of a gem - then its just a usual `transfer`\n   *      approved â€“ an address explicitly approved earlier by\n   *        the owner of a token to transfer this particular token `tokenId`\n   *      operator - an address explicitly approved earlier by\n   *        the owner to transfer all his tokens on behalf\n   * @param from current owner of the token\n   * @param to address to receive the ownership of the token\n   * @param _tokenId ID of the token to be transferred\n   */\n  function transferFrom(address from, address to, uint256 _tokenId) public {\n    // check if transfers on behalf feature is enabled\n    require(__isFeatureEnabled(FEATURE_TRANSFERS_ON_BEHALF));\n\n    // call sender gracefully - `operator`\n    address operator = msg.sender;\n\n    // find if an approved address exists for this token\n    address approved = approvals[_tokenId];\n\n    // we assume `from` is an owner of the token,\n    // this will be explicitly checked in `__transfer`\n\n    // fetch how much approvals left for an operator\n    bool approvedOperator = approvedOperators[from][operator];\n\n    // operator must have an approval to transfer this particular token\n    // or operator must be approved to transfer all the tokens\n    // or, if nothing satisfies, this is equal to regular transfer,\n    // where `from` is basically a transaction sender and owner of the token\n    if(operator != approved && !approvedOperator) {\n      // transaction sender doesn't have any special permissions\n      // we will treat him as a token owner and sender and try to perform\n      // a regular transfer:\n      // check `from` to be `operator` (transaction sender):\n      require(from == operator);\n\n      // additionally check if token transfers feature is enabled\n      require(__isFeatureEnabled(FEATURE_TRANSFERS));\n    }\n\n    // delegate call to unsafe `__transfer`\n    __transfer(from, to, _tokenId);\n  }\n\n  /**\n   * @notice A.k.a \"safe transfer a token on behalf\"\n   * @notice Transfers ownership rights of a token defined\n   *      by the `tokenId` to a new owner specified by address `to`\n   * @notice Allows transferring ownership rights by a trading operator\n   *      on behalf of token owner. Allows building an exchange of tokens.\n   * @dev Safely transfers the ownership of a given token ID to another address\n   * @dev Requires the transaction sender to be the owner, approved, or operator\n   * @dev When transfer is complete, this function\n   *      checks if `_to` is a smart contract (code size > 0). If so, it calls\n   *      `onERC721Received` on `_to` and throws if the return value is not\n   *      `bytes4(keccak256(\"onERC721Received(address,address,uint256,bytes)\"))`.\n   * @param _from current owner of the token\n   * @param _to address to receive the ownership of the token\n   * @param _tokenId ID of the token to be transferred\n   * @param _data Additional data with no specified format, sent in call to `_to`\n   */\n  function safeTransferFrom(address _from, address _to, uint256 _tokenId, bytes _data) public {\n    // delegate call to usual (unsafe) `transferFrom`\n    transferFrom(_from, _to, _tokenId);\n\n    // check if receiver `_to` supports ERC721 interface\n    if (AddressUtils.isContract(_to)) {\n      // if `_to` is a contract â€“ execute onERC721Received\n      bytes4 response = ERC721Receiver(_to).onERC721Received(msg.sender, _from, _tokenId, _data);\n\n      // expected response is ERC721_RECEIVED\n      require(response == ERC721_RECEIVED);\n    }\n  }\n\n  /**\n   * @notice A.k.a \"safe transfer a token on behalf\"\n   * @notice Transfers ownership rights of a token defined\n   *      by the `tokenId` to a new owner specified by address `to`\n   * @notice Allows transferring ownership rights by a trading operator\n   *      on behalf of token owner. Allows building an exchange of tokens.\n   * @dev Safely transfers the ownership of a given token ID to another address\n   * @dev Requires the transaction sender to be the owner, approved, or operator\n   * @dev Requires from to be an owner of the token\n   * @dev If the target address is a contract, it must implement `onERC721Received`,\n   *      which is called upon a safe transfer, and return the magic value\n   *      `bytes4(keccak256(\"onERC721Received(address,uint256,bytes)\"))`;\n   *      otherwise the transfer is reverted.\n   * @dev This works identically to the other function with an extra data parameter,\n   *      except this function just sets data to \"\".\n   * @param _from current owner of the token\n   * @param _to address to receive the ownership of the token\n   * @param _tokenId ID of the token to be transferred\n   */\n  function safeTransferFrom(address _from, address _to, uint256 _tokenId) public {\n    // delegate call to overloaded `safeTransferFrom`, set data to \"\"\n    safeTransferFrom(_from, _to, _tokenId, \"\");\n  }\n\n  /**\n   * @notice Approves an address to transfer the given token on behalf of its owner\n   *      Can also be used to revoke an approval by setting `to` address to zero\n   * @dev The zero `to` address revokes an approval for a given token\n   * @dev There can only be one approved address per token at a given time\n   * @dev This function can only be called by the token owner\n   * @param _approved address to be approved to transfer the token on behalf of its owner\n   * @param _tokenId ID of the token to be approved for transfer on behalf\n   */\n  function approve(address _approved, uint256 _tokenId) public {\n    // call sender nicely - `from`\n    address from = msg.sender;\n\n    // get token owner address (also ensures that token exists)\n    address owner = ownerOf(_tokenId);\n\n    // caller must own this token\n    require(from == owner);\n    // approval for owner himself is pointless, do not allow\n    require(_approved != owner);\n    // either we're removing approval, or setting it\n    require(approvals[_tokenId] != address(0) || _approved != address(0));\n\n    // set an approval (deletes an approval if to == 0)\n    approvals[_tokenId] = _approved;\n\n    // emit an ERC721 event\n    emit Approval(from, _approved, _tokenId);\n  }\n\n  /**\n   * @notice Removes an approved address, which was previously added by `approve`\n   *      for the given token. Equivalent to calling approve(0, tokenId)\n   * @dev Same as calling approve(0, tokenId)\n   * @param _tokenId ID of the token to remove approved address for\n   */\n  function revokeApproval(uint256 _tokenId) public {\n    // delegate call to `approve`\n    approve(address(0), _tokenId);\n  }\n\n  /**\n   * @dev Sets or unsets the approval of a given operator\n   * @dev An operator is allowed to transfer *all* tokens of the sender on their behalf\n   * @param to operator address to set the approval for\n   * @param approved representing the status of the approval to be set\n   */\n  function setApprovalForAll(address to, bool approved) public {\n    // call sender nicely - `from`\n    address from = msg.sender;\n\n    // validate destination address\n    require(to != address(0));\n\n    // approval for owner himself is pointless, do not allow\n    require(to != from);\n\n    // set an approval\n    approvedOperators[from][to] = approved;\n\n    // emit an ERC721 compliant event\n    emit ApprovalForAll(from, to, approved);\n  }\n\n  /**\n   * @notice Get the approved address for a single token\n   * @dev Throws if `_tokenId` is not a valid token ID.\n   * @param _tokenId ID of the token to find the approved address for\n   * @return the approved address for this token, or the zero address if there is none\n   */\n  function getApproved(uint256 _tokenId) public constant returns (address) {\n    // validate token existence\n    require(exists(_tokenId));\n\n    // find approved address and return\n    return approvals[_tokenId];\n  }\n\n  /**\n   * @notice Query if an address is an authorized operator for another address\n   * @param _owner the address that owns at least one token\n   * @param _operator the address that acts on behalf of the owner\n   * @return true if `_operator` is an approved operator for `_owner`, false otherwise\n   */\n  function isApprovedForAll(address _owner, address _operator) public constant returns (bool) {\n    // is there a positive amount of approvals left\n    return approvedOperators[_owner][_operator];\n  }\n\n  /**\n   * @notice A distinct Uniform Resource Identifier (URI) for a given asset.\n   * @dev Throws if `_tokenId` is not a valid token ID.\n   *      URIs are defined in RFC 3986.\n   * @param _tokenId uint256 ID of the token to query\n   * @return token URI\n   */\n  function tokenURI(uint256 _tokenId) public constant returns (string) {\n    // validate token existence\n    require(exists(_tokenId));\n\n    // token URL consists of base URL part (domain) and token ID\n    return StringUtils.concat(\"http://cryptominerworld.com/gem/\", StringUtils.itoa(_tokenId, 16));\n  }\n\n  /// @dev Creates new token with `tokenId` ID specified and\n  ///      assigns an ownership `to` for this token\n  /// @dev Unsafe: doesn't check if caller has enough permissions to execute the call\n  ///      checks only that the token doesn't exist yet\n  /// @dev Must be kept private at all times\n  function __mint(\n    address to,\n    uint32 tokenId,\n    uint32 plotId,\n    uint16 depth,\n    uint16 gemNum,\n    uint8 color,\n    uint8 level,\n    uint8 gradeType,\n    uint24 gradeValue\n  ) private {\n    // check that `tokenId` is inside valid bounds\n    require(tokenId > 0);\n\n    // ensure that token with such ID doesn't exist\n    require(!exists(tokenId));\n\n    // create new gem in memory\n    Gem memory gem = Gem({\n      coordinates: uint64(plotId) << 32 | uint32(depth) << 16 | gemNum,\n      color: color,\n      levelModified: 0,\n      level: level,\n      gradeModified: 0,\n      grade: uint32(gradeType) << 24 | gradeValue,\n      stateModified: 0,\n      state: 0,\n\n      creationTime: uint32(block.number),\n      // token index within the owner's collection of token\n      // points to the place where the token will be placed to\n      index: uint32(collections[to].length),\n      ownershipModified: 0,\n      owner: to\n    });\n\n    // push newly created `tokenId` to the owner's collection of tokens\n    collections[to].push(tokenId);\n\n    // persist gem to the storage\n    gems[tokenId] = gem;\n\n    // add token ID to the `allTokens` collection,\n    // automatically updates total supply\n    allTokens.push(tokenId);\n\n    // fire Minted event\n    emit Minted(msg.sender, to, tokenId);\n    // fire ERC20/ERC721 transfer event\n    emit Transfer(address(0), to, tokenId, 1);\n  }\n\n  /// @dev Performs a transfer of a token `tokenId` from address `from` to address `to`\n  /// @dev Unsafe: doesn't check if caller has enough permissions to execute the call;\n  ///      checks only for token existence and that ownership belongs to `from`\n  /// @dev Is save to call from `transfer(to, tokenId)` since it doesn't need any additional checks\n  /// @dev Must be kept private at all times\n  function __transfer(address from, address to, uint256 _tokenId) private {\n    // validate source and destination address\n    require(to != address(0));\n    require(to != from);\n    // impossible by design of transfer(), transferFrom(),\n    // approveToken() and approve()\n    assert(from != address(0));\n\n    // validate token existence\n    require(exists(_tokenId));\n\n    // validate token ownership\n    require(ownerOf(_tokenId) == from);\n\n    // transfer is not allowed for a locked gem\n    // (ex.: if ge is currently mining)\n    require(getState(_tokenId) & lockedBitmask == 0);\n\n    // clear approved address for this particular token + emit event\n    __clearApprovalFor(_tokenId);\n\n    // move gem ownership,\n    // update old and new owner's gem collections accordingly\n    __move(from, to, _tokenId);\n\n    // fire ERC20/ERC721 transfer event\n    emit Transfer(from, to, _tokenId, 1);\n  }\n\n  /// @dev Clears approved address for a particular token\n  function __clearApprovalFor(uint256 _tokenId) private {\n    // check if approval exists - we don't want to fire an event in vain\n    if(approvals[_tokenId] != address(0)) {\n      // clear approval\n      delete approvals[_tokenId];\n\n      // emit an ERC721 event\n      emit Approval(msg.sender, address(0), _tokenId);\n    }\n  }\n\n  /// @dev Move a `gem` from owner `from` to a new owner `to`\n  /// @dev Unsafe, doesn't check for consistence\n  /// @dev Must be kept private at all times\n  function __move(address from, address to, uint256 _tokenId) private {\n    // cast token ID to uint32 space\n    uint32 tokenId = uint32(_tokenId);\n\n    // overflow check, failure impossible by design of mint()\n    assert(tokenId == _tokenId);\n\n    // get the gem pointer to the storage\n    Gem storage gem = gems[_tokenId];\n\n    // get a reference to the collection where gem is now\n    uint32[] storage source = collections[from];\n\n    // get a reference to the collection where gem goes to\n    uint32[] storage destination = collections[to];\n\n    // collection `source` cannot be empty, if it is - it's a bug\n    assert(source.length != 0);\n\n    // index of the gem within collection `source`\n    uint32 i = gem.index;\n\n    // we put the last gem in the collection `source` to the position released\n    // get an ID of the last gem in `source`\n    uint32 sourceId = source[source.length - 1];\n\n    // update gem index to point to proper place in the collection `source`\n    gems[sourceId].index = i;\n\n    // put it into the position i within `source`\n    source[i] = sourceId;\n\n    // trim the collection `source` by removing last element\n    source.length--;\n\n    // update gem index according to position in new collection `destination`\n    gem.index = uint32(destination.length);\n\n    // update gem owner\n    gem.owner = to;\n\n    // update ownership transfer date\n    gem.ownershipModified = uint32(block.number);\n\n    // push gem into collection\n    destination.push(tokenId);\n  }\n\n}",
  "abi": "[{\"constant\":true,\"inputs\":[{\"name\":\"_interfaceId\",\"type\":\"bytes4\"}],\"name\":\"supportsInterface\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"ROLE_GRADE_PROVIDER\",\"outputs\":[{\"name\":\"\",\"type\":\"uint32\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"getStateModified\",\"outputs\":[{\"name\":\"\",\"type\":\"uint32\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"name\",\"outputs\":[{\"name\":\"\",\"type\":\"string\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"getApproved\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_approved\",\"type\":\"address\"},{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"approve\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"getCoordinates\",\"outputs\":[{\"name\":\"\",\"type\":\"uint64\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"levelUp\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"operator\",\"type\":\"address\"},{\"name\":\"role\",\"type\":\"uint256\"}],\"name\":\"addOperator\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"getGradeValue\",\"outputs\":[{\"name\":\"\",\"type\":\"uint24\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"ROLE_STATE_LOCK_PROVIDER\",\"outputs\":[{\"name\":\"\",\"type\":\"uint32\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"totalSupply\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"InterfaceId_ERC165\",\"outputs\":[{\"name\":\"\",\"type\":\"bytes4\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"getProperties\",\"outputs\":[{\"name\":\"\",\"type\":\"uint48\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"from\",\"type\":\"address\"},{\"name\":\"to\",\"type\":\"address\"},{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"transferFrom\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"features\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_owner\",\"type\":\"address\"},{\"name\":\"_index\",\"type\":\"uint256\"}],\"name\":\"tokenOfOwnerByIndex\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"decimals\",\"outputs\":[{\"name\":\"\",\"type\":\"uint8\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"TOKEN_VERSION\",\"outputs\":[{\"name\":\"\",\"type\":\"uint32\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"},{\"name\":\"\",\"type\":\"address\"}],\"name\":\"approvedOperators\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"getLevelModified\",\"outputs\":[{\"name\":\"\",\"type\":\"uint32\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"lockedBitmask\",\"outputs\":[{\"name\":\"\",\"type\":\"uint64\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_tokenId\",\"type\":\"uint256\"},{\"name\":\"grade\",\"type\":\"uint32\"}],\"name\":\"upgradeGrade\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"getGradeModified\",\"outputs\":[{\"name\":\"\",\"type\":\"uint32\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_from\",\"type\":\"address\"},{\"name\":\"_to\",\"type\":\"address\"},{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"safeTransferFrom\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"getState\",\"outputs\":[{\"name\":\"\",\"type\":\"uint48\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"getOwnershipModified\",\"outputs\":[{\"name\":\"\",\"type\":\"uint32\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"getPlotId\",\"outputs\":[{\"name\":\"\",\"type\":\"uint32\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"owner\",\"type\":\"address\"}],\"name\":\"getPackedCollection\",\"outputs\":[{\"name\":\"\",\"type\":\"uint80[]\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"},{\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"collections\",\"outputs\":[{\"name\":\"\",\"type\":\"uint32\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"exists\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_index\",\"type\":\"uint256\"}],\"name\":\"tokenByIndex\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"getGemNum\",\"outputs\":[{\"name\":\"\",\"type\":\"uint16\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"approvals\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"allTokens\",\"outputs\":[{\"name\":\"\",\"type\":\"uint32\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"ownerOf\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_owner\",\"type\":\"address\"}],\"name\":\"balanceOf\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"}],\"name\":\"userRoles\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"getDepth\",\"outputs\":[{\"name\":\"\",\"type\":\"uint16\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"DEFAULT_MINING_BIT\",\"outputs\":[{\"name\":\"\",\"type\":\"uint64\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"operator\",\"type\":\"address\"},{\"name\":\"role\",\"type\":\"uint256\"}],\"name\":\"removeRole\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"operator\",\"type\":\"address\"},{\"name\":\"role\",\"type\":\"uint256\"}],\"name\":\"addRole\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"getColor\",\"outputs\":[{\"name\":\"\",\"type\":\"uint8\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"ROLE_STATE_PROVIDER\",\"outputs\":[{\"name\":\"\",\"type\":\"uint32\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"getLevel\",\"outputs\":[{\"name\":\"\",\"type\":\"uint8\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"ROLE_LEVEL_PROVIDER\",\"outputs\":[{\"name\":\"\",\"type\":\"uint32\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"ROLE_TOKEN_CREATOR\",\"outputs\":[{\"name\":\"\",\"type\":\"uint32\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_tokenId\",\"type\":\"uint256\"},{\"name\":\"state\",\"type\":\"uint48\"}],\"name\":\"setState\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"FEATURE_TRANSFERS_ON_BEHALF\",\"outputs\":[{\"name\":\"\",\"type\":\"uint32\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"symbol\",\"outputs\":[{\"name\":\"\",\"type\":\"string\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"getCreationTime\",\"outputs\":[{\"name\":\"\",\"type\":\"uint32\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"gems\",\"outputs\":[{\"name\":\"coordinates\",\"type\":\"uint64\"},{\"name\":\"color\",\"type\":\"uint8\"},{\"name\":\"levelModified\",\"type\":\"uint32\"},{\"name\":\"level\",\"type\":\"uint8\"},{\"name\":\"gradeModified\",\"type\":\"uint32\"},{\"name\":\"grade\",\"type\":\"uint32\"},{\"name\":\"stateModified\",\"type\":\"uint32\"},{\"name\":\"state\",\"type\":\"uint48\"},{\"name\":\"creationTime\",\"type\":\"uint32\"},{\"name\":\"index\",\"type\":\"uint32\"},{\"name\":\"ownershipModified\",\"type\":\"uint32\"},{\"name\":\"owner\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"to\",\"type\":\"address\"},{\"name\":\"approved\",\"type\":\"bool\"}],\"name\":\"setApprovalForAll\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"to\",\"type\":\"address\"},{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"transfer\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"getGradeType\",\"outputs\":[{\"name\":\"\",\"type\":\"uint8\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"operator\",\"type\":\"address\"}],\"name\":\"removeOperator\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"revokeApproval\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_from\",\"type\":\"address\"},{\"name\":\"_to\",\"type\":\"address\"},{\"name\":\"_tokenId\",\"type\":\"uint256\"},{\"name\":\"_data\",\"type\":\"bytes\"}],\"name\":\"safeTransferFrom\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"getPacked\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"FEATURE_TRANSFERS\",\"outputs\":[{\"name\":\"\",\"type\":\"uint32\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"tokenURI\",\"outputs\":[{\"name\":\"\",\"type\":\"string\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"mask\",\"type\":\"uint256\"}],\"name\":\"updateFeatures\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"to\",\"type\":\"address\"},{\"name\":\"tokenId\",\"type\":\"uint32\"},{\"name\":\"plotId\",\"type\":\"uint32\"},{\"name\":\"depth\",\"type\":\"uint16\"},{\"name\":\"gemNum\",\"type\":\"uint16\"},{\"name\":\"color\",\"type\":\"uint8\"},{\"name\":\"level\",\"type\":\"uint8\"},{\"name\":\"gradeType\",\"type\":\"uint8\"},{\"name\":\"gradeValue\",\"type\":\"uint24\"}],\"name\":\"mint\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"getGrade\",\"outputs\":[{\"name\":\"\",\"type\":\"uint32\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"owner\",\"type\":\"address\"}],\"name\":\"getCollection\",\"outputs\":[{\"name\":\"\",\"type\":\"uint32[]\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_owner\",\"type\":\"address\"},{\"name\":\"_operator\",\"type\":\"address\"}],\"name\":\"isApprovedForAll\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"bitmask\",\"type\":\"uint64\"}],\"name\":\"setLockedBitmask\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"_by\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"_to\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"_tokenId\",\"type\":\"uint32\"}],\"name\":\"Minted\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"_from\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"_to\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"_tokenId\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"_value\",\"type\":\"uint256\"}],\"name\":\"Transfer\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"_owner\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"_approved\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"Approval\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"_owner\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"_operator\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"_value\",\"type\":\"bool\"}],\"name\":\"ApprovalForAll\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"_by\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"_owner\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"_tokenId\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"_levelReached\",\"type\":\"uint8\"}],\"name\":\"LevelUp\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"_by\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"_owner\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"_tokenId\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"_gradeFrom\",\"type\":\"uint32\"},{\"indexed\":false,\"name\":\"_gradeTo\",\"type\":\"uint32\"}],\"name\":\"UpgradeComplete\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"_by\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"_owner\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"_tokenId\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"_stateFrom\",\"type\":\"uint48\"},{\"indexed\":false,\"name\":\"_stateTo\",\"type\":\"uint48\"}],\"name\":\"StateModified\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"_by\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"_requested\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"_actual\",\"type\":\"uint256\"}],\"name\":\"FeaturesUpdated\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"_by\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"_to\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"_role\",\"type\":\"uint256\"}],\"name\":\"RoleUpdated\",\"type\":\"event\"}]",
  "bytecode": "60806040526008805467ffffffffffffffff191660011790553480156200002557600080fd5b50600160a060020a03331660009081526001602052604090206000199055620000777f01ffc9a7000000000000000000000000000000000000000000000000000000006401000000006200014d810204565b620000ab7f80ac58cd000000000000000000000000000000000000000000000000000000006401000000006200014d810204565b620000df7f4f558e79000000000000000000000000000000000000000000000000000000006401000000006200014d810204565b620001137f780e9d63000000000000000000000000000000000000000000000000000000006401000000006200014d810204565b620001477f5b5e139f000000000000000000000000000000000000000000000000000000006401000000006200014d810204565b620001ba565b7fffffffff0000000000000000000000000000000000000000000000000000000080821614156200017d57600080fd5b7fffffffff00000000000000000000000000000000000000000000000000000000166000908152600260205260409020805460ff19166001179055565b61321b80620001ca6000396000f3006080604052600436106102fd5763ffffffff60e060020a60003504166301ffc9a78114610302578063034ac7a31461033857806305e0d5b41461036657806306fdde031461037e578063081812fc14610408578063095ea7b31461043c5780630bf37818146104625780630ce90ec2146104975780630f7fa72f146104af57806313b2c5f3146104d357806317c163e91461050357806318160ddd1461051857806319fa8f501461053f5780631b8ca2171461057157806323b872dd146105a45780632b521416146105ce5780632f745c59146105e3578063313ce56714610607578063328921771461063257806334d822201461064757806338272c831461066e5780633862ea9d1461068657806338b486c91461069b5780633e69492d146106bc57806342842e0e146106d457806344c9af28146106fe57806347c76a9f1461071657806348931e251461072e5780634932488c1461074657806349a764cd146107b75780634f558e79146107db5780634f6ccce7146107f35780635988c7161461080b57806363035f661461083a578063634282af146108525780636352211e1461086a57806370a082311461088257806374d5e100146108a357806375e618c9146108c4578063761e0d2d146108dc57806379db5f67146108f15780637fde1c8a1461091557806380057b9a146109395780638353bb511461095157806386481d401461096657806387d3764b1461097e5780638d4e57e6146109935780638f2747b7146109a85780638f6fba8c146109cb57806395d89b41146109e057806397ec23cb146109f5578063a1f0406d14610a0d578063a22cb46514610ab1578063a9059cbb14610ad7578063ac33d90714610afb578063ac8a584a14610b13578063b1e130fc14610b34578063b88d4fde14610b4c578063bdefce8c14610bbb578063c0d6568d14610bec578063c87b56dd14610c01578063d5bb7f6714610c19578063dd6c872414610c31578063e1e0485e14610c89578063e40de88714610ca1578063e985e9c514610cc2578063f8a2449f14610ce9575b600080fd5b34801561030e57600080fd5b50610324600160e060020a031960043516610d0b565b604080519115158252519081900360200190f35b34801561034457600080fd5b5061034d610d2a565b6040805163ffffffff9092168252519081900360200190f35b34801561037257600080fd5b5061034d600435610d31565b34801561038a57600080fd5b50610393610d67565b6040805160208082528351818301528351919283929083019185019080838360005b838110156103cd5781810151838201526020016103b5565b50505050905090810190601f1680156103fa5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34801561041457600080fd5b50610420600435610d9e565b60408051600160a060020a039092168252519081900360200190f35b34801561044857600080fd5b50610460600160a060020a0360043516602435610dd0565b005b34801561046e57600080fd5b5061047a600435610eb1565b6040805167ffffffffffffffff9092168252519081900360200190f35b3480156104a357600080fd5b50610460600435610ee4565b3480156104bb57600080fd5b50610460600160a060020a0360043516602435610ff0565b3480156104df57600080fd5b506104eb600435611092565b6040805162ffffff9092168252519081900360200190f35b34801561050f57600080fd5b5061034d6110a3565b34801561052457600080fd5b5061052d6110aa565b60408051918252519081900360200190f35b34801561054b57600080fd5b506105546110b1565b60408051600160e060020a03199092168252519081900360200190f35b34801561057d57600080fd5b506105896004356110d5565b6040805165ffffffffffff9092168252519081900360200190f35b3480156105b057600080fd5b50610460600160a060020a0360043581169060243516604435611225565b3480156105da57600080fd5b5061052d6112d1565b3480156105ef57600080fd5b5061052d600160a060020a03600435166024356112d7565b34801561061357600080fd5b5061061c61134a565b6040805160ff9092168252519081900360200190f35b34801561063e57600080fd5b5061034d61134f565b34801561065357600080fd5b50610324600160a060020a0360043581169060243516611354565b34801561067a57600080fd5b5061034d600435611374565b34801561069257600080fd5b5061047a6113b0565b3480156106a757600080fd5b5061046060043563ffffffff602435166113c0565b3480156106c857600080fd5b5061034d6004356114f7565b3480156106e057600080fd5b50610460600160a060020a0360043581169060243516604435611538565b34801561070a57600080fd5b50610589600435611559565b34801561072257600080fd5b5061034d600435611591565b34801561073a57600080fd5b5061034d6004356115cf565b34801561075257600080fd5b50610767600160a060020a03600435166115f3565b60408051602080825283518183015283519192839290830191858101910280838360005b838110156107a357818101518382015260200161078b565b505050509050019250505060405180910390f35b3480156107c357600080fd5b5061034d600160a060020a03600435166024356116f4565b3480156107e757600080fd5b5061032460043561173c565b3480156107ff57600080fd5b5061052d60043561176c565b34801561081757600080fd5b506108236004356117b5565b6040805161ffff9092168252519081900360200190f35b34801561084657600080fd5b506104206004356117c0565b34801561085e57600080fd5b5061034d6004356117db565b34801561087657600080fd5b50610420600435611813565b34801561088e57600080fd5b5061052d600160a060020a0360043516611858565b3480156108af57600080fd5b5061052d600160a060020a0360043516611873565b3480156108d057600080fd5b50610823600435611885565b3480156108e857600080fd5b5061047a611892565b3480156108fd57600080fd5b50610460600160a060020a0360043516602435611897565b34801561092157600080fd5b50610460600160a060020a036004351660243561192f565b34801561094557600080fd5b5061061c6004356119d7565b34801561095d57600080fd5b5061034d611a0f565b34801561097257600080fd5b5061061c600435611a16565b34801561098a57600080fd5b5061034d611a53565b34801561099f57600080fd5b5061034d611a5a565b3480156109b457600080fd5b5061046060043565ffffffffffff60243516611a61565b3480156109d757600080fd5b5061034d611b74565b3480156109ec57600080fd5b50610393611b79565b348015610a0157600080fd5b5061034d600435611bb0565b348015610a1957600080fd5b50610a25600435611be2565b6040805167ffffffffffffffff909d168d5260ff9b8c1660208e015263ffffffff9a8b168d82015298909a1660608c015295881660808b015293871660a08a015291861660c089015265ffffffffffff1660e088015284166101008701528316610120860152909116610140840152600160a060020a0390911661016083015251908190036101800190f35b348015610abd57600080fd5b50610460600160a060020a03600435166024351515611cac565b348015610ae357600080fd5b50610460600160a060020a0360043516602435611d49565b348015610b0757600080fd5b5061061c600435611d6d565b348015610b1f57600080fd5b50610460600160a060020a0360043516611d8d565b348015610b4057600080fd5b50610460600435611e50565b348015610b5857600080fd5b50604080516020601f60643560048181013592830184900484028501840190955281845261046094600160a060020a038135811695602480359092169560443595369560849401918190840183828082843750949750611e5e9650505050505050565b348015610bc757600080fd5b50610bd3600435611fcb565b6040805192835260208301919091528051918290030190f35b348015610bf857600080fd5b5061034d611892565b348015610c0d57600080fd5b5061039360043561226a565b348015610c2557600080fd5b506104606004356122c9565b348015610c3d57600080fd5b50610460600160a060020a036004351663ffffffff6024358116906044351661ffff6064358116906084351660ff60a43581169060c43581169060e4351662ffffff610104351661235c565b348015610c9557600080fd5b5061034d600435612410565b348015610cad57600080fd5b50610767600160a060020a0360043516612446565b348015610cce57600080fd5b50610324600160a060020a03600435811690602435166124de565b348015610cf557600080fd5b5061046067ffffffffffffffff6004351661250c565b600160e060020a03191660009081526002602052604090205460ff1690565b6220000081565b6000610d3c8261173c565b1515610d4757600080fd5b5060009081526003602052604090205460b060020a900463ffffffff1690565b60408051808201909152601981527f47454d20e280932043727970746f4d696e657220576f726c6400000000000000602082015281565b6000610da98261173c565b1515610db457600080fd5b50600090815260046020526040902054600160a060020a031690565b336000610ddc83611813565b9050600160a060020a0382811690821614610df657600080fd5b600160a060020a038481169082161415610e0f57600080fd5b600083815260046020526040902054600160a060020a0316151580610e3c5750600160a060020a03841615155b1515610e4757600080fd5b600083815260046020526040808220805473ffffffffffffffffffffffffffffffffffffffff1916600160a060020a0388811691821790925591518693918616917f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b92591a450505050565b6000610ebc8261173c565b1515610ec757600080fd5b5060009081526003602052604090205467ffffffffffffffff1690565b610ef062100000612547565b1515610efb57600080fd5b610f048161173c565b1515610f0f57600080fd5b6000818152600360205260409020805460ff6d010000000000000000000000000063ffffffff43166901000000000000000000026cffffffff000000000000000000199093169290921782810482166001019091169091026dff000000000000000000000000001990911617905580610f8781611813565b6000838152600360209081526040918290205482516d010000000000000000000000000090910460ff1681529151600160a060020a03938416933316927fd693f7897ea5570e5e6cc7ba2f6e9046767ef404654d19d67e4e4c9ff31db53692908290030190a450565b33600160a060020a038181166000908152600160205260408082205492861682528120541561101e57600080fd5b61102c826310000000612571565b151561103757600080fd5b5082811680151561104757600080fd5b600160a060020a038086166000818152600160209081526040918290208590558151858152915192938716926000805160206131d08339815191529281900390910190a35050505050565b600061109d82612410565b92915050565b6280000081565b6007545b90565b7f01ffc9a70000000000000000000000000000000000000000000000000000000081565b60006110df613123565b6110e88361173c565b15156110f357600080fd5b5050600090815260036020908152604091829020825161018081018452815467ffffffffffffffff811682526801000000000000000080820460ff9081169584018690526901000000000000000000830463ffffffff908116978501979097526d0100000000000000000000000000830416606084018190526e010000000000000000000000000000830487166080850152609060020a8304871660a0850181905260b060020a8404881660c086015260d060020a90930465ffffffffffff1660e085015260019094015480871661010085015264010000000080820488166101208601529181049096166101408401526c01000000000000000000000000909504600160a060020a03166101609092019190915264ffffffffff939091029290921665010000000000909102171790565b600080806112336002612578565b151561123e57600080fd5b505050600081815260046020908152604080832054600160a060020a03878116855260058452828520338281168088529190955292909420549293169160ff1690821480159061128c575080155b156112be57600160a060020a03868116908416146112a957600080fd5b6112b36001612578565b15156112be57600080fd5b6112c9868686612586565b505050505050565b60005481565b600160a060020a03821660009081526006602052604081205482106112fb57600080fd5b600160a060020a038316600090815260066020526040902080548390811061131f57fe5b6000918252602090912060088204015460079091166004026101000a900463ffffffff169392505050565b600081565b600381565b600560209081526000928352604080842090915290825290205460ff1681565b600061137f8261173c565b151561138a57600080fd5b506000908152600360205260409020546901000000000000000000900463ffffffff1690565b60085467ffffffffffffffff1681565b6113cc62200000612547565b15156113d757600080fd5b6113e08261173c565b15156113eb57600080fd5b60008281526003602052604090205463ffffffff808316609060020a909204161061141557600080fd5b8161141f83611813565b60008481526003602090815260409182902054825163ffffffff609060020a90920482168152908616918101919091528151600160a060020a03938416933316927f2e248c68b7b360c93d67684c218cada70ca2e1e05d355b7e762dfe4bcc1e2a8c928290030190a4600091825260036020526040909120805475ffffffff0000000000000000000000000000000000001916609060020a63ffffffff938416021771ffffffff000000000000000000000000000019166e010000000000000000000000000000439390931692909202919091179055565b60006115028261173c565b151561150d57600080fd5b506000908152600360205260409020546e010000000000000000000000000000900463ffffffff1690565b6115548383836020604051908101604052806000815250611e5e565b505050565b60006115648261173c565b151561156f57600080fd5b5060009081526003602052604090205460d060020a900465ffffffffffff1690565b600061159c8261173c565b15156115a757600080fd5b5060009081526003602052604090206001015468010000000000000000900463ffffffff1690565b600060206115dc83610eb1565b67ffffffffffffffff169060020a90049050919050565b60608060006060600080600061160888612446565b9550855194508463ffffffff1660405190808252806020026020018201604052801561163e578160200160208202803883390190505b509350600092505b8463ffffffff168363ffffffff1610156116e857858363ffffffff1681518110151561166e57fe5b9060200190602002015191506116898263ffffffff166110d5565b90508065ffffffffffff1660308363ffffffff1669ffffffffffffffffffff169060020a0217848463ffffffff168151811015156116c357fe5b69ffffffffffffffffffff909216602092830290910190910152600190920191611646565b50919695505050505050565b60066020528160005260406000208181548110151561170f57fe5b9060005260206000209060089182820401919006600402915091509054906101000a900463ffffffff1681565b6000908152600360205260409020600101546c010000000000000000000000009004600160a060020a0316151590565b600754600090821061177d57600080fd5b600780548390811061178b57fe5b6000918252602090912060088204015460079091166004026101000a900463ffffffff1692915050565b600061109d82610eb1565b600460205260009081526040902054600160a060020a031681565b60078054829081106117e957fe5b9060005260206000209060089182820401919006600402915054906101000a900463ffffffff1681565b600061181e8261173c565b151561182957600080fd5b506000908152600360205260409020600101546c010000000000000000000000009004600160a060020a031690565b600160a060020a031660009081526006602052604090205490565b60016020526000908152604090205481565b600060106115dc83610eb1565b600181565b33600160a060020a038116600090815260016020526040812054906118c0826310000000612571565b15156118cb57600080fd5b508281168015156118db57600080fd5b600160a060020a038086166000818152600160209081526040918290208054600019871816908190558251908152915192938716926000805160206131d08339815191529281900390910190a35050505050565b33600160a060020a03818116600090815260016020526040808220549286168252812054151561195e57600080fd5b61196c826310000000612571565b151561197757600080fd5b5082811680151561198757600080fd5b600160a060020a0380861660008181526001602090815260409182902080548617908190558251908152915192938716926000805160206131d08339815191529281900390910190a35050505050565b60006119e28261173c565b15156119ed57600080fd5b5060009081526003602052604090205468010000000000000000900460ff1690565b6240000081565b6000611a218261173c565b1515611a2c57600080fd5b506000908152600360205260409020546d0100000000000000000000000000900460ff1690565b6210000081565b6204000081565b611a6d62400000612547565b1515611a7857600080fd5b611a818261173c565b1515611a8c57600080fd5b81611a9683611813565b60008481526003602090815260409182902054825165ffffffffffff60d060020a90920482168152908616918101919091528151600160a060020a03938416933316927f1b755b8ec947974a4b8f50c18c45e32ed3ac8ec062be077abf3975c39e6a39b1928290030190a4600091825260036020526040909120805479ffffffffffffffffffffffffffffffffffffffffffffffffffff1660d060020a65ffffffffffff909316929092029190911779ffffffff00000000000000000000000000000000000000000000191660b060020a4363ffffffff1602179055565b600281565b60408051808201909152600381527f47454d0000000000000000000000000000000000000000000000000000000000602082015281565b6000611bbb8261173c565b1515611bc657600080fd5b5060009081526003602052604090206001015463ffffffff1690565b6003602052600090815260409020805460019091015467ffffffffffffffff8216916801000000000000000080820460ff908116936901000000000000000000840463ffffffff908116946d01000000000000000000000000008104909316936e0100000000000000000000000000008404821693609060020a810483169360b060020a820484169360d060020a90920465ffffffffffff169282821692640100000000830481169291820416906c010000000000000000000000009004600160a060020a03168c565b33600160a060020a0383161515611cc257600080fd5b600160a060020a038381169082161415611cdb57600080fd5b600160a060020a03818116600081815260056020908152604080832094881680845294825291829020805460ff1916871515908117909155825190815291517f17307eab39ab6107e8899845ad3d59bd9653f200f220920489ca2b5937696c319281900390910190a3505050565b6000611d556001612578565b1515611d6057600080fd5b5033611554818484612586565b60006018611d7a83612410565b63ffffffff169060020a90049050919050565b600160a060020a03811660009081526001602052604090205433901515611db357600080fd5b600160a060020a038281169082161415611dcc57600080fd5b600160a060020a03808216600090815260016020526040808220549285168252902054611dff9190631000000017612571565b1515611e0a57600080fd5b600160a060020a03808316600081815260016020908152604080832083905580519283525192938516926000805160206131d08339815191529281900390910190a35050565b611e5b600082610dd0565b50565b6000611e6b858585611225565b611e748461268f565b15611fc45783600160a060020a031663150b7a02338786866040518563ffffffff1660e060020a0281526004018085600160a060020a0316600160a060020a0316815260200184600160a060020a0316600160a060020a0316815260200183815260200180602001828103825283818151815260200191508051906020019080838360005b83811015611f11578181015183820152602001611ef9565b50505050905090810190601f168015611f3e5780820380516001836020036101000a031916815260200191505b5095505050505050602060405180830381600087803b158015611f6057600080fd5b505af1158015611f74573d6000803e3d6000fd5b505050506040513d6020811015611f8a57600080fd5b50519050600160e060020a031981167f150b7a020000000000000000000000000000000000000000000000000000000014611fc457600080fd5b5050505050565b600080611fd6613123565b600080611fe28661173c565b1515611fed57600080fd5b505050600083815260036020908152604091829020825161018081018452815467ffffffffffffffff811680835260ff68010000000000000000808404821696850187905263ffffffff6901000000000000000000850481169886018990526d01000000000000000000000000008504909216606086018190526e010000000000000000000000000000808604841660808801819052609060020a808804861660a08a0181905260b060020a8904871660c08b0181905265ffffffffffff60d060020a909a049990991660e08b018190526001909b01548088166101008c01819052640100000000820489166101208d018190529782049098166101408c01819052600160a060020a036c01000000000000000000000000909204919091166101608c018190527801000000000000000000000000000000000000000000000000998a0277010000000000000000000000000000000000000000000000909e0277ffffffffffffffffffffffffffffffffffffffffffffffff9081169e909e17730100000000000000000000000000000000000000909f0276ffffffffffffffffffffffffffffffffffffffffffffff169e909e179290950272ffffffffffffffffffffffffffffffffffffff16919091179190920271ffffffffffffffffffffffffffffffffffff16176a01000000000000000000009091026dffffffffffffffffffffffffffff1617660100000000000090950269ffffffffffffffffffff1694909417909517985060e060020a0293027bffffffffffffffffffffffffffffffffffffffffffffffffffffffff16929092177401000000000000000000000000000000000000000090920290921617909117915050915091565b60606122758261173c565b151561228057600080fd5b61109d6040805190810160405280602081526020017f687474703a2f2f63727970746f6d696e6572776f726c642e636f6d2f67656d2f8152506122c4846010612697565b612909565b33600160a060020a0381166000908152600160205260409020546122f1816320000000612571565b15156122fc57600080fd5b600080548285161760001985811884161816908190556040805185815260208101929092528051600160a060020a038516927fd7561eaef77f105dc0c307bfb23c571f603f07bb7db5766a68840742fde80b8992908290030190a2505050565b600160a060020a038916151561237157600080fd5b30600160a060020a031689600160a060020a03161415151561239257600080fd5b61239e62040000612547565b15156123a957600080fd5b6123ba898989898989898989612a18565b6040805160018152905163ffffffff8a1691600160a060020a038c16916000917f9ed053bb818ff08b8353cd46f78db1f0799f31c9e4458fdb425c10eccd2efc44919081900360200190a4505050505050505050565b600061241b8261173c565b151561242657600080fd5b50600090815260036020526040902054609060020a900463ffffffff1690565b600160a060020a0381166000908152600660209081526040918290208054835181840281018401909452808452606093928301828280156124d257602002820191906000526020600020906000905b82829054906101000a900463ffffffff1663ffffffff16815260200190600401906020826003010492830192600103820291508084116124955790505b50505050509050919050565b600160a060020a03918216600090815260056020908152604080832093909416825291909152205460ff1690565b61251862800000612547565b151561252357600080fd5b6008805467ffffffffffffffff191667ffffffffffffffff92909216919091179055565b600160a060020a03331660009081526001602052604081205461256a8184612571565b9392505050565b9081161490565b600061109d60005483612571565b600160a060020a038216151561259b57600080fd5b600160a060020a0382811690841614156125b457600080fd5b600160a060020a03831615156125c657fe5b6125cf8161173c565b15156125da57600080fd5b82600160a060020a03166125ed82611813565b600160a060020a03161461260057600080fd5b60085467ffffffffffffffff1661261682611559565b1665ffffffffffff161561262957600080fd5b61263281612ec4565b61263d838383612f42565b8082600160a060020a031684600160a060020a03167f9ed053bb818ff08b8353cd46f78db1f0799f31c9e4458fdb425c10eccd2efc4460016040518082815260200191505060405180910390a4505050565b6000903b1190565b6060806000806000808660ff16600214806126b557508660ff166008145b806126c357508660ff16600a145b806126d157508660ff166010145b15156126dc57600080fd5b87151561271e5760408051808201909152600181527f3000000000000000000000000000000000000000000000000000000000000000602082015295506128fe565b604080516101008082526101208201909252906020820161200080388339019050509450600093505b60008811156127c2578660ff168881151561275e57fe5b069250826030019150600a8360ff16111561277a576007820191505b8451600185019460f860020a840291879190811061279457fe5b906020010190600160f860020a031916908160001a9053508660ff16888115156127ba57fe5b049750612747565b506000925b600281048410156128fa57848460018303038151811015156127e557fe5b90602001015160f860020a900460f860020a02858581518110151561280657fe5b906020010181815160f860020a900460f860020a0218915090600160f860020a031916908160001a905350848481518110151561283f57fe5b90602001015160f860020a900460f860020a028585600184030381518110151561286557fe5b906020010181815160f860020a900460f860020a0218915090600160f860020a031916908160001a905350848460018303038151811015156128a357fe5b90602001015160f860020a900460f860020a0285858151811015156128c457fe5b906020010181815160f860020a900460f860020a0218915090600160f860020a031916908160001a9053506001909301926127c7565b8495505b505050505092915050565b60608060608060008087945086935083518551016040519080825280601f01601f19166020018201604052801561294a578160200160208202803883390190505b509250600091505b84518210156129ad57848281518110151561296957fe5b90602001015160f860020a900460f860020a02838381518110151561298a57fe5b906020010190600160f860020a031916908160001a905350600190910190612952565b5083515b8351811015612a0c5783855182038151811015156129cb57fe5b90602001015160f860020a900460f860020a0283828151811015156129ec57fe5b906020010190600160f860020a031916908160001a9053506001016129b1565b50909695505050505050565b612a20613123565b600063ffffffff8a1611612a3357600080fd5b612a428963ffffffff1661173c565b15612a4c57600080fd5b610180604051908101604052808761ffff1660108a61ffff1663ffffffff169060020a0263ffffffff1660208c63ffffffff1667ffffffffffffffff169060020a02171767ffffffffffffffff1681526020018660ff168152602001600063ffffffff1681526020018560ff168152602001600063ffffffff1681526020018362ffffff1660188660ff1663ffffffff169060020a021763ffffffff168152602001600063ffffffff168152602001600065ffffffffffff1681526020014363ffffffff168152602001600660008d600160a060020a0316600160a060020a031681526020019081526020016000208054905063ffffffff168152602001600063ffffffff1681526020018b600160a060020a03168152509050600660008b600160a060020a0316600160a060020a0316815260200190815260200160002089908060018154018082558091505090600182039060005260206000209060089182820401919006600402909192909190916101000a81548163ffffffff021916908363ffffffff1602179055505080600360008b63ffffffff16815260200190815260200160002060008201518160000160006101000a81548167ffffffffffffffff021916908367ffffffffffffffff16021790555060208201518160000160086101000a81548160ff021916908360ff16021790555060408201518160000160096101000a81548163ffffffff021916908363ffffffff160217905550606082015181600001600d6101000a81548160ff021916908360ff160217905550608082015181600001600e6101000a81548163ffffffff021916908363ffffffff16021790555060a08201518160000160126101000a81548163ffffffff021916908363ffffffff16021790555060c08201518160000160166101000a81548163ffffffff021916908363ffffffff16021790555060e082015181600001601a6101000a81548165ffffffffffff021916908365ffffffffffff1602179055506101008201518160010160006101000a81548163ffffffff021916908363ffffffff1602179055506101208201518160010160046101000a81548163ffffffff021916908363ffffffff1602179055506101408201518160010160086101000a81548163ffffffff021916908363ffffffff16021790555061016082015181600101600c6101000a815481600160a060020a030219169083600160a060020a03160217905550905050600789908060018154018082558091505090600182039060005260206000209060089182820401919006600402909192909190916101000a81548163ffffffff021916908363ffffffff160217905550508863ffffffff168a600160a060020a031633600160a060020a03167fad1f152c061f6e528e6e53a190e109d8a7f4c5206a07f973fcf65428c0df566260405160405180910390a46040805160018152905163ffffffff8b1691600160a060020a038d16916000917f9ed053bb818ff08b8353cd46f78db1f0799f31c9e4458fdb425c10eccd2efc44919081900360200190a450505050505050505050565b600081815260046020526040902054600160a060020a031615611e5b57600081815260046020526040808220805473ffffffffffffffffffffffffffffffffffffffff191690555182919033600160a060020a0316907f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925908390a450565b8060008080808063ffffffff86168614612f5857fe5b6000878152600360209081526040808320600160a060020a03808e1685526006909352818420928c1684529220815492975090955093501515612f9757fe5b6001850154845464010000000090910463ffffffff16925084906000198101908110612fbf57fe5b6000918252602080832060088304015460079092166004026101000a90910463ffffffff90811680845260039092526040909220600101805467ffffffff000000001916640100000000938616938402179055855490925082918691811061302357fe5b90600052602060002090600891828204019190066004026101000a81548163ffffffff021916908363ffffffff1602179055508380548091906001900361306a9190613187565b505081546001948501805467ffffffff00000000191664010000000063ffffffff93841602176bffffffffffffffffffffffff166c01000000000000000000000000600160a060020a039a909a1699909902989098176bffffffff0000000000000000191668010000000000000000438316021790975550805492830181556000908152602090206008830401805460046007909416939093026101000a80870219909316939095169190910291909117909255505050565b6040805161018081018252600080825260208201819052918101829052606081018290526080810182905260a0810182905260c0810182905260e0810182905261010081018290526101208101829052610140810182905261016081019190915290565b81548183558181111561155457600083815260209020611554916110ae9160086007928301819004820192860104015b808211156131cb57600081556001016131b7565b50905600de4cd40876c200276a5c070f12c8512913143450b14c88bfaa4245b24a5092afa165627a7a723058205d62b1d01e04083949e46b340060931da594c1dbe8a7b65e700b8a7c12088d060029"
}