{
  "address": "0xb671f2210b1f6621a2607ea63e6b2dc3e2464d1f",
  "chain": "ETH",
  "chainID": 1,
  "verifier": "etherscan.io",
  "commonName": "",
  "contractName": "RewardEscrow",
  "compilerVersion": "v0.4.25+commit.59dbf8f1",
  "optimization": true,
  "runs": "200",
  "evmVersion": "default",
  "sourceCode": "/**\n *Submitted for verification at Etherscan.io on 2019-05-02\n*/\n\n/* ===============================================\n* Flattened with Solidifier by Coinage\n* \n* https://solidifier.coina.ge\n* ===============================================\n*/\n\n\npragma solidity ^0.4.24;\n\n/**\n * @title SafeMath\n * @dev Math operations with safety checks that revert on error\n */\nlibrary SafeMath {\n\n  /**\n  * @dev Multiplies two numbers, reverts on overflow.\n  */\n  function mul(uint256 a, uint256 b) internal pure returns (uint256) {\n    // Gas optimization: this is cheaper than requiring 'a' not being zero, but the\n    // benefit is lost if 'b' is also tested.\n    // See: https://github.com/OpenZeppelin/openzeppelin-solidity/pull/522\n    if (a == 0) {\n      return 0;\n    }\n\n    uint256 c = a * b;\n    require(c / a == b);\n\n    return c;\n  }\n\n  /**\n  * @dev Integer division of two numbers truncating the quotient, reverts on division by zero.\n  */\n  function div(uint256 a, uint256 b) internal pure returns (uint256) {\n    require(b > 0); // Solidity only automatically asserts when dividing by 0\n    uint256 c = a / b;\n    // assert(a == b * c + a % b); // There is no case in which this doesn't hold\n\n    return c;\n  }\n\n  /**\n  * @dev Subtracts two numbers, reverts on overflow (i.e. if subtrahend is greater than minuend).\n  */\n  function sub(uint256 a, uint256 b) internal pure returns (uint256) {\n    require(b <= a);\n    uint256 c = a - b;\n\n    return c;\n  }\n\n  /**\n  * @dev Adds two numbers, reverts on overflow.\n  */\n  function add(uint256 a, uint256 b) internal pure returns (uint256) {\n    uint256 c = a + b;\n    require(c >= a);\n\n    return c;\n  }\n\n  /**\n  * @dev Divides two numbers and returns the remainder (unsigned integer modulo),\n  * reverts when dividing by zero.\n  */\n  function mod(uint256 a, uint256 b) internal pure returns (uint256) {\n    require(b != 0);\n    return a % b;\n  }\n}\n\n\n/*\n\n-----------------------------------------------------------------\nFILE INFORMATION\n-----------------------------------------------------------------\n\nfile:       SafeDecimalMath.sol\nversion:    2.0\nauthor:     Kevin Brown\n            Gavin Conway\ndate:       2018-10-18\n\n-----------------------------------------------------------------\nMODULE DESCRIPTION\n-----------------------------------------------------------------\n\nA library providing safe mathematical operations for division and\nmultiplication with the capability to round or truncate the results\nto the nearest increment. Operations can return a standard precision\nor high precision decimal. High precision decimals are useful for\nexample when attempting to calculate percentages or fractions\naccurately.\n\n-----------------------------------------------------------------\n*/\n\n\n/**\n * @title Safely manipulate unsigned fixed-point decimals at a given precision level.\n * @dev Functions accepting uints in this contract and derived contracts\n * are taken to be such fixed point decimals of a specified precision (either standard\n * or high).\n */\nlibrary SafeDecimalMath {\n\n    using SafeMath for uint;\n\n    /* Number of decimal places in the representations. */\n    uint8 public constant decimals = 18;\n    uint8 public constant highPrecisionDecimals = 27;\n\n    /* The number representing 1.0. */\n    uint public constant UNIT = 10 ** uint(decimals);\n\n    /* The number representing 1.0 for higher fidelity numbers. */\n    uint public constant PRECISE_UNIT = 10 ** uint(highPrecisionDecimals);\n    uint private constant UNIT_TO_HIGH_PRECISION_CONVERSION_FACTOR = 10 ** uint(highPrecisionDecimals - decimals);\n\n    /** \n     * @return Provides an interface to UNIT.\n     */\n    function unit()\n        external\n        pure\n        returns (uint)\n    {\n        return UNIT;\n    }\n\n    /** \n     * @return Provides an interface to PRECISE_UNIT.\n     */\n    function preciseUnit()\n        external\n        pure \n        returns (uint)\n    {\n        return PRECISE_UNIT;\n    }\n\n    /**\n     * @return The result of multiplying x and y, interpreting the operands as fixed-point\n     * decimals.\n     * \n     * @dev A unit factor is divided out after the product of x and y is evaluated,\n     * so that product must be less than 2**256. As this is an integer division,\n     * the internal division always rounds down. This helps save on gas. Rounding\n     * is more expensive on gas.\n     */\n    function multiplyDecimal(uint x, uint y)\n        internal\n        pure\n        returns (uint)\n    {\n        /* Divide by UNIT to remove the extra factor introduced by the product. */\n        return x.mul(y) / UNIT;\n    }\n\n    /**\n     * @return The result of safely multiplying x and y, interpreting the operands\n     * as fixed-point decimals of the specified precision unit.\n     *\n     * @dev The operands should be in the form of a the specified unit factor which will be\n     * divided out after the product of x and y is evaluated, so that product must be\n     * less than 2**256.\n     *\n     * Unlike multiplyDecimal, this function rounds the result to the nearest increment.\n     * Rounding is useful when you need to retain fidelity for small decimal numbers\n     * (eg. small fractions or percentages).\n     */\n    function _multiplyDecimalRound(uint x, uint y, uint precisionUnit)\n        private\n        pure\n        returns (uint)\n    {\n        /* Divide by UNIT to remove the extra factor introduced by the product. */\n        uint quotientTimesTen = x.mul(y) / (precisionUnit / 10);\n\n        if (quotientTimesTen % 10 >= 5) {\n            quotientTimesTen += 10;\n        }\n\n        return quotientTimesTen / 10;\n    }\n\n    /**\n     * @return The result of safely multiplying x and y, interpreting the operands\n     * as fixed-point decimals of a precise unit.\n     *\n     * @dev The operands should be in the precise unit factor which will be\n     * divided out after the product of x and y is evaluated, so that product must be\n     * less than 2**256.\n     *\n     * Unlike multiplyDecimal, this function rounds the result to the nearest increment.\n     * Rounding is useful when you need to retain fidelity for small decimal numbers\n     * (eg. small fractions or percentages).\n     */\n    function multiplyDecimalRoundPrecise(uint x, uint y)\n        internal\n        pure\n        returns (uint)\n    {\n        return _multiplyDecimalRound(x, y, PRECISE_UNIT);\n    }\n\n    /**\n     * @return The result of safely multiplying x and y, interpreting the operands\n     * as fixed-point decimals of a standard unit.\n     *\n     * @dev The operands should be in the standard unit factor which will be\n     * divided out after the product of x and y is evaluated, so that product must be\n     * less than 2**256.\n     *\n     * Unlike multiplyDecimal, this function rounds the result to the nearest increment.\n     * Rounding is useful when you need to retain fidelity for small decimal numbers\n     * (eg. small fractions or percentages).\n     */\n    function multiplyDecimalRound(uint x, uint y)\n        internal\n        pure\n        returns (uint)\n    {\n        return _multiplyDecimalRound(x, y, UNIT);\n    }\n\n    /**\n     * @return The result of safely dividing x and y. The return value is a high\n     * precision decimal.\n     * \n     * @dev y is divided after the product of x and the standard precision unit\n     * is evaluated, so the product of x and UNIT must be less than 2**256. As\n     * this is an integer division, the result is always rounded down.\n     * This helps save on gas. Rounding is more expensive on gas.\n     */\n    function divideDecimal(uint x, uint y)\n        internal\n        pure\n        returns (uint)\n    {\n        /* Reintroduce the UNIT factor that will be divided out by y. */\n        return x.mul(UNIT).div(y);\n    }\n\n    /**\n     * @return The result of safely dividing x and y. The return value is as a rounded\n     * decimal in the precision unit specified in the parameter.\n     *\n     * @dev y is divided after the product of x and the specified precision unit\n     * is evaluated, so the product of x and the specified precision unit must\n     * be less than 2**256. The result is rounded to the nearest increment.\n     */\n    function _divideDecimalRound(uint x, uint y, uint precisionUnit)\n        private\n        pure\n        returns (uint)\n    {\n        uint resultTimesTen = x.mul(precisionUnit * 10).div(y);\n\n        if (resultTimesTen % 10 >= 5) {\n            resultTimesTen += 10;\n        }\n\n        return resultTimesTen / 10;\n    }\n\n    /**\n     * @return The result of safely dividing x and y. The return value is as a rounded\n     * standard precision decimal.\n     *\n     * @dev y is divided after the product of x and the standard precision unit\n     * is evaluated, so the product of x and the standard precision unit must\n     * be less than 2**256. The result is rounded to the nearest increment.\n     */\n    function divideDecimalRound(uint x, uint y)\n        internal\n        pure\n        returns (uint)\n    {\n        return _divideDecimalRound(x, y, UNIT);\n    }\n\n    /**\n     * @return The result of safely dividing x and y. The return value is as a rounded\n     * high precision decimal.\n     *\n     * @dev y is divided after the product of x and the high precision unit\n     * is evaluated, so the product of x and the high precision unit must\n     * be less than 2**256. The result is rounded to the nearest increment.\n     */\n    function divideDecimalRoundPrecise(uint x, uint y)\n        internal\n        pure\n        returns (uint)\n    {\n        return _divideDecimalRound(x, y, PRECISE_UNIT);\n    }\n\n    /**\n     * @dev Convert a standard decimal representation to a high precision one.\n     */\n    function decimalToPreciseDecimal(uint i)\n        internal\n        pure\n        returns (uint)\n    {\n        return i.mul(UNIT_TO_HIGH_PRECISION_CONVERSION_FACTOR);\n    }\n\n    /**\n     * @dev Convert a high precision decimal to a standard decimal representation.\n     */\n    function preciseDecimalToDecimal(uint i)\n        internal\n        pure\n        returns (uint)\n    {\n        uint quotientTimesTen = i / (UNIT_TO_HIGH_PRECISION_CONVERSION_FACTOR / 10);\n\n        if (quotientTimesTen % 10 >= 5) {\n            quotientTimesTen += 10;\n        }\n\n        return quotientTimesTen / 10;\n    }\n\n}\n\n\n/*\n-----------------------------------------------------------------\nFILE INFORMATION\n-----------------------------------------------------------------\n\nfile:       Owned.sol\nversion:    1.1\nauthor:     Anton Jurisevic\n            Dominic Romanowski\n\ndate:       2018-2-26\n\n-----------------------------------------------------------------\nMODULE DESCRIPTION\n-----------------------------------------------------------------\n\nAn Owned contract, to be inherited by other contracts.\nRequires its owner to be explicitly set in the constructor.\nProvides an onlyOwner access modifier.\n\nTo change owner, the current owner must nominate the next owner,\nwho then has to accept the nomination. The nomination can be\ncancelled before it is accepted by the new owner by having the\nprevious owner change the nomination (setting it to 0).\n\n-----------------------------------------------------------------\n*/\n\n\n/**\n * @title A contract with an owner.\n * @notice Contract ownership can be transferred by first nominating the new owner,\n * who must then accept the ownership, which prevents accidental incorrect ownership transfers.\n */\ncontract Owned {\n    address public owner;\n    address public nominatedOwner;\n\n    /**\n     * @dev Owned Constructor\n     */\n    constructor(address _owner)\n        public\n    {\n        require(_owner != address(0), \"Owner address cannot be 0\");\n        owner = _owner;\n        emit OwnerChanged(address(0), _owner);\n    }\n\n    /**\n     * @notice Nominate a new owner of this contract.\n     * @dev Only the current owner may nominate a new owner.\n     */\n    function nominateNewOwner(address _owner)\n        external\n        onlyOwner\n    {\n        nominatedOwner = _owner;\n        emit OwnerNominated(_owner);\n    }\n\n    /**\n     * @notice Accept the nomination to be owner.\n     */\n    function acceptOwnership()\n        external\n    {\n        require(msg.sender == nominatedOwner, \"You must be nominated before you can accept ownership\");\n        emit OwnerChanged(owner, nominatedOwner);\n        owner = nominatedOwner;\n        nominatedOwner = address(0);\n    }\n\n    modifier onlyOwner\n    {\n        require(msg.sender == owner, \"Only the contract owner may perform this action\");\n        _;\n    }\n\n    event OwnerNominated(address newOwner);\n    event OwnerChanged(address oldOwner, address newOwner);\n}\n\n\ncontract IFeePool {\n    address public FEE_ADDRESS;\n    function amountReceivedFromExchange(uint value) external view returns (uint);\n    function amountReceivedFromTransfer(uint value) external view returns (uint);\n    function feePaid(bytes4 currencyKey, uint amount) external;\n    function appendAccountIssuanceRecord(address account, uint lockedAmount, uint debtEntryIndex) external;\n    function rewardsMinted(uint amount) external;\n    function transferFeeIncurred(uint value) public view returns (uint);\n}\n\n\ncontract ISynthetixState {\n    // A struct for handing values associated with an individual user's debt position\n    struct IssuanceData {\n        // Percentage of the total debt owned at the time\n        // of issuance. This number is modified by the global debt\n        // delta array. You can figure out a user's exit price and\n        // collateralisation ratio using a combination of their initial\n        // debt and the slice of global debt delta which applies to them.\n        uint initialDebtOwnership;\n        // This lets us know when (in relative terms) the user entered\n        // the debt pool so we can calculate their exit price and\n        // collateralistion ratio\n        uint debtEntryIndex;\n    }\n\n    uint[] public debtLedger;\n    uint public issuanceRatio;\n    mapping(address => IssuanceData) public issuanceData;\n\n    function debtLedgerLength() external view returns (uint);\n    function hasIssued(address account) external view returns (bool);\n    function incrementTotalIssuerCount() external;\n    function decrementTotalIssuerCount() external;\n    function setCurrentIssuanceData(address account, uint initialDebtOwnership) external;\n    function lastDebtLedgerEntry() external view returns (uint);\n    function appendDebtLedgerValue(uint value) external;\n    function clearIssuanceData(address account) external;\n}\n\n\ninterface ISynth {\n  function burn(address account, uint amount) external;\n  function issue(address account, uint amount) external;\n  function transfer(address to, uint value) public returns (bool);\n  function triggerTokenFallbackIfNeeded(address sender, address recipient, uint amount) external;\n  function transferFrom(address from, address to, uint value) public returns (bool);\n}\n\n\n/**\n * @title SynthetixEscrow interface\n */\ninterface ISynthetixEscrow {\n    function balanceOf(address account) public view returns (uint);\n    function appendVestingEntry(address account, uint quantity) public;\n}\n\n\n/**\n * @title ExchangeRates interface\n */\ninterface IExchangeRates {\n    function effectiveValue(bytes4 sourceCurrencyKey, uint sourceAmount, bytes4 destinationCurrencyKey) public view returns (uint);\n\n    function rateForCurrency(bytes4 currencyKey) public view returns (uint);\n\n    function anyRateIsStale(bytes4[] currencyKeys) external view returns (bool);\n\n    function rateIsStale(bytes4 currencyKey) external view returns (bool);\n}\n\n\n/**\n * @title Synthetix interface contract\n * @dev pseudo interface, actually declared as contract to hold the public getters \n */\n\n\ncontract ISynthetix {\n\n    // ========== PUBLIC STATE VARIABLES ==========\n\n    IFeePool public feePool;\n    ISynthetixEscrow public escrow;\n    ISynthetixEscrow public rewardEscrow;\n    ISynthetixState public synthetixState;\n    IExchangeRates public exchangeRates;\n\n    // ========== PUBLIC FUNCTIONS ==========\n\n    function balanceOf(address account) public view returns (uint);\n    function transfer(address to, uint value) public returns (bool);\n    function effectiveValue(bytes4 sourceCurrencyKey, uint sourceAmount, bytes4 destinationCurrencyKey) public view returns (uint);\n\n    function synthInitiatedFeePayment(address from, bytes4 sourceCurrencyKey, uint sourceAmount) external returns (bool);\n    function synthInitiatedExchange(\n        address from,\n        bytes4 sourceCurrencyKey,\n        uint sourceAmount,\n        bytes4 destinationCurrencyKey,\n        address destinationAddress) external returns (bool);\n    function collateralisationRatio(address issuer) public view returns (uint);\n    function totalIssuedSynths(bytes4 currencyKey)\n        public\n        view\n        returns (uint);\n    function getSynth(bytes4 currencyKey) public view returns (ISynth);\n    function debtBalanceOf(address issuer, bytes4 currencyKey) public view returns (uint);\n}\n\n\n/*\n-----------------------------------------------------------------\nFILE INFORMATION\n-----------------------------------------------------------------\n\nfile:       RewardEscrow.sol\nversion:    1.0\nauthor:     Jackson Chan\n            Clinton Ennis\n\ndate:       2019-03-01\n\n-----------------------------------------------------------------\nMODULE DESCRIPTION\n-----------------------------------------------------------------\nEscrows the SNX rewards from the inflationary supply awarded to\nusers for staking their SNX and maintaining the c-rationn target.\n\nSNW rewards are escrowed for 1 year from the claim date and users\ncan call vest in 12 months time.\n-----------------------------------------------------------------\n*/\n\n\n/**\n * @title A contract to hold escrowed SNX and free them at given schedules.\n */\ncontract RewardEscrow is Owned {\n\n    using SafeMath for uint;\n\n    /* The corresponding Synthetix contract. */\n    ISynthetix public synthetix;\n\n    IFeePool public feePool;\n\n    /* Lists of (timestamp, quantity) pairs per account, sorted in ascending time order.\n     * These are the times at which each given quantity of SNX vests. */\n    mapping(address => uint[2][]) public vestingSchedules;\n\n    /* An account's total escrowed synthetix balance to save recomputing this for fee extraction purposes. */\n    mapping(address => uint) public totalEscrowedAccountBalance;\n\n    /* An account's total vested reward synthetix. */\n    mapping(address => uint) public totalVestedAccountBalance;\n\n    /* The total remaining escrowed balance, for verifying the actual synthetix balance of this contract against. */\n    uint public totalEscrowedBalance;\n\n    uint constant TIME_INDEX = 0;\n    uint constant QUANTITY_INDEX = 1;\n\n    /* Limit vesting entries to disallow unbounded iteration over vesting schedules.\n    * There are 5 years of the supply scedule */\n    uint constant public MAX_VESTING_ENTRIES = 52*5;\n\n\n    /* ========== CONSTRUCTOR ========== */\n\n    constructor(address _owner, ISynthetix _synthetix, IFeePool _feePool)\n    Owned(_owner)\n    public\n    {\n        synthetix = _synthetix;\n        feePool = _feePool;\n    }\n\n\n    /* ========== SETTERS ========== */\n\n    /**\n     * @notice set the synthetix contract address as we need to transfer SNX when the user vests\n     */\n    function setSynthetix(ISynthetix _synthetix)\n    external\n    onlyOwner\n    {\n        synthetix = _synthetix;\n        emit SynthetixUpdated(_synthetix);\n    }\n\n    /**\n     * @notice set the FeePool contract as it is the only authority to be able to call\n     * appendVestingEntry with the onlyFeePool modifer\n     */\n    function setFeePool(IFeePool _feePool)\n        external\n        onlyOwner\n    {\n        feePool = _feePool;\n        emit FeePoolUpdated(_feePool);\n    }\n\n\n    /* ========== VIEW FUNCTIONS ========== */\n\n    /**\n     * @notice A simple alias to totalEscrowedAccountBalance: provides ERC20 balance integration.\n     */\n    function balanceOf(address account)\n    public\n    view\n    returns (uint)\n    {\n        return totalEscrowedAccountBalance[account];\n    }\n\n    /**\n     * @notice The number of vesting dates in an account's schedule.\n     */\n    function numVestingEntries(address account)\n    public\n    view\n    returns (uint)\n    {\n        return vestingSchedules[account].length;\n    }\n\n    /**\n     * @notice Get a particular schedule entry for an account.\n     * @return A pair of uints: (timestamp, synthetix quantity).\n     */\n    function getVestingScheduleEntry(address account, uint index)\n    public\n    view\n    returns (uint[2])\n    {\n        return vestingSchedules[account][index];\n    }\n\n    /**\n     * @notice Get the time at which a given schedule entry will vest.\n     */\n    function getVestingTime(address account, uint index)\n    public\n    view\n    returns (uint)\n    {\n        return getVestingScheduleEntry(account,index)[TIME_INDEX];\n    }\n\n    /**\n     * @notice Get the quantity of SNX associated with a given schedule entry.\n     */\n    function getVestingQuantity(address account, uint index)\n    public\n    view\n    returns (uint)\n    {\n        return getVestingScheduleEntry(account,index)[QUANTITY_INDEX];\n    }\n\n    /**\n     * @notice Obtain the index of the next schedule entry that will vest for a given user.\n     */\n    function getNextVestingIndex(address account)\n    public\n    view\n    returns (uint)\n    {\n        uint len = numVestingEntries(account);\n        for (uint i = 0; i < len; i++) {\n            if (getVestingTime(account, i) != 0) {\n                return i;\n            }\n        }\n        return len;\n    }\n\n    /**\n     * @notice Obtain the next schedule entry that will vest for a given user.\n     * @return A pair of uints: (timestamp, synthetix quantity). */\n    function getNextVestingEntry(address account)\n    public\n    view\n    returns (uint[2])\n    {\n        uint index = getNextVestingIndex(account);\n        if (index == numVestingEntries(account)) {\n            return [uint(0), 0];\n        }\n        return getVestingScheduleEntry(account, index);\n    }\n\n    /**\n     * @notice Obtain the time at which the next schedule entry will vest for a given user.\n     */\n    function getNextVestingTime(address account)\n    external\n    view\n    returns (uint)\n    {\n        return getNextVestingEntry(account)[TIME_INDEX];\n    }\n\n    /**\n     * @notice Obtain the quantity which the next schedule entry will vest for a given user.\n     */\n    function getNextVestingQuantity(address account)\n    external\n    view\n    returns (uint)\n    {\n        return getNextVestingEntry(account)[QUANTITY_INDEX];\n    }\n\n    /**\n     * @notice return the full vesting schedule entries vest for a given user.\n     */\n    function checkAccountSchedule(address account)\n        public\n        view\n        returns (uint[520])\n    {\n        uint[520] memory _result;\n        uint schedules = numVestingEntries(account);\n        for (uint i = 0; i < schedules; i++) {\n            uint[2] memory pair = getVestingScheduleEntry(account, i);\n            _result[i*2] = pair[0];\n            _result[i*2 + 1] = pair[1];\n        }\n        return _result;\n    }\n\n\n    /* ========== MUTATIVE FUNCTIONS ========== */\n\n    /**\n     * @notice Add a new vesting entry at a given time and quantity to an account's schedule.\n     * @dev A call to this should accompany a previous successfull call to synthetix.transfer(tewardEscrow, amount),\n     * to ensure that when the funds are withdrawn, there is enough balance.\n     * Note; although this function could technically be used to produce unbounded\n     * arrays, it's only withinn the 4 year period of the weekly inflation schedule.\n     * @param account The account to append a new vesting entry to.\n     * @param quantity The quantity of SNX that will be escrowed.\n     */\n    function appendVestingEntry(address account, uint quantity)\n    public\n    onlyFeePool\n    {\n        /* No empty or already-passed vesting entries allowed. */\n        require(quantity != 0, \"Quantity cannot be zero\");\n\n        /* There must be enough balance in the contract to provide for the vesting entry. */\n        totalEscrowedBalance = totalEscrowedBalance.add(quantity);\n        require(totalEscrowedBalance <= synthetix.balanceOf(this), \"Must be enough balance in the contract to provide for the vesting entry\");\n\n        /* Disallow arbitrarily long vesting schedules in light of the gas limit. */\n        uint scheduleLength = vestingSchedules[account].length;\n        require(scheduleLength <= MAX_VESTING_ENTRIES, \"Vesting schedule is too long\");\n\n        /* Escrow the tokens for 1 year. */\n        uint time = now + 52 weeks;\n\n        if (scheduleLength == 0) {\n            totalEscrowedAccountBalance[account] = quantity;\n        } else {\n            /* Disallow adding new vested SNX earlier than the last one.\n             * Since entries are only appended, this means that no vesting date can be repeated. */\n            require(getVestingTime(account, numVestingEntries(account) - 1) < time, \"Cannot add new vested entries earlier than the last one\");\n            totalEscrowedAccountBalance[account] = totalEscrowedAccountBalance[account].add(quantity);\n        }\n\n        vestingSchedules[account].push([time, quantity]);\n\n        emit VestingEntryCreated(account, now, quantity);\n    }\n\n    /**\n     * @notice Allow a user to withdraw any SNX in their schedule that have vested.\n     */\n    function vest()\n    external\n    {\n        uint numEntries = numVestingEntries(msg.sender);\n        uint total;\n        for (uint i = 0; i < numEntries; i++) {\n            uint time = getVestingTime(msg.sender, i);\n            /* The list is sorted; when we reach the first future time, bail out. */\n            if (time > now) {\n                break;\n            }\n            uint qty = getVestingQuantity(msg.sender, i);\n            if (qty == 0) {\n                continue;\n            }\n\n            vestingSchedules[msg.sender][i] = [0, 0];\n            total = total.add(qty);\n        }\n\n        if (total != 0) {\n            totalEscrowedBalance = totalEscrowedBalance.sub(total);\n            totalEscrowedAccountBalance[msg.sender] = totalEscrowedAccountBalance[msg.sender].sub(total);\n            totalVestedAccountBalance[msg.sender] = totalVestedAccountBalance[msg.sender].add(total);\n            synthetix.transfer(msg.sender, total);\n            emit Vested(msg.sender, now, total);\n        }\n    }\n\n    /* ========== MODIFIERS ========== */\n\n    modifier onlyFeePool() {\n        bool isFeePool = msg.sender == address(feePool);\n\n        require(isFeePool, \"Only the FeePool contracts can perform this action\");\n        _;\n    }\n\n\n    /* ========== EVENTS ========== */\n\n    event SynthetixUpdated(address newSynthetix);\n\n    event FeePoolUpdated(address newFeePool);\n\n    event Vested(address indexed beneficiary, uint time, uint value);\n\n    event VestingEntryCreated(address indexed beneficiary, uint time, uint value);\n\n}",
  "bytecode": "608060405234801561001057600080fd5b5060405160608061140183398101604090815281516020830151919092015182600160a060020a03811615156100a757604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601960248201527f4f776e657220616464726573732063616e6e6f74206265203000000000000000604482015290519081900360640190fd5b60008054600160a060020a031916600160a060020a038316908117825560408051928352602083019190915280517fb532073b38c83145e3e5135377a08bf9aab55bc0fd7c1179cd4fb995d2a5159c9281900390910190a15060028054600160a060020a03938416600160a060020a03199182161790915560038054929093169116179055506112c58061013c6000396000f3006080604052600436106101485763ffffffff7c01000000000000000000000000000000000000000000000000000000006000350416631627540c811461014d57806319db22281461017057806319e740c014610191578063204b676a146101c4578063227d517a146101e55780632f5bb66114610206578063326a3cfb14610262578063449d0eb114610283578063458efde3146102ba57806345e5441f146102cf57806353a47bb7146102f65780636b3905c41461032757806370a082311461034857806371e780f314610369578063759b52251461037e57806379ba5097146103935780638da5cb5b146103a857806397f46527146103bd5780639b217f90146103de578063ae2e933b14610402578063b5ddb9c714610417578063d0cc82e31461043b578063da7bd3e914610450578063ee1d036c14610474578063fec9f9da14610498575b600080fd5b34801561015957600080fd5b5061016e600160a060020a03600435166104b9565b005b34801561017c57600080fd5b5061016e600160a060020a03600435166105a2565b34801561019d57600080fd5b506101b2600160a060020a036004351661068b565b60408051918252519081900360200190f35b3480156101d057600080fd5b506101b2600160a060020a03600435166106d2565b3480156101f157600080fd5b506101b2600160a060020a03600435166106ed565b34801561021257600080fd5b50610227600160a060020a03600435166106ff565b6040518082600260200280838360005b8381101561024f578181015183820152602001610237565b5050505090500191505060405180910390f35b34801561026e57600080fd5b506101b2600160a060020a0360043516610752565b34801561028f57600080fd5b506102a4600160a060020a0360043516610764565b6040518151815280826141008083836020610237565b3480156102c657600080fd5b5061016e6107f0565b3480156102db57600080fd5b506101b2600160a060020a03600435166024356044356109fd565b34801561030257600080fd5b5061030b610a3d565b60408051600160a060020a039092168252519081900360200190f35b34801561033357600080fd5b506101b2600160a060020a0360043516610a4c565b34801561035457600080fd5b506101b2600160a060020a0360043516610a65565b34801561037557600080fd5b506101b2610a80565b34801561038a57600080fd5b5061030b610a86565b34801561039f57600080fd5b5061016e610a95565b3480156103b457600080fd5b5061030b610b9d565b3480156103c957600080fd5b506101b2600160a060020a0360043516610bac565b3480156103ea57600080fd5b506101b2600160a060020a0360043516602435610bbe565b34801561040e57600080fd5b5061030b610bd9565b34801561042357600080fd5b5061016e600160a060020a0360043516602435610be8565b34801561044757600080fd5b506101b261102e565b34801561045c57600080fd5b50610227600160a060020a0360043516602435611034565b34801561048057600080fd5b506101b2600160a060020a03600435166024356110a3565b3480156104a457600080fd5b5061016e600160a060020a03600435166110b6565b600054600160a060020a03163314610541576040805160e560020a62461bcd02815260206004820152602f60248201527f4f6e6c792074686520636f6e7472616374206f776e6572206d6179207065726660448201527f6f726d207468697320616374696f6e0000000000000000000000000000000000606482015290519081900360840190fd5b60018054600160a060020a03831673ffffffffffffffffffffffffffffffffffffffff19909116811790915560408051918252517f906a1c6bd7e3091ea86693dd029a831c19049ce77f1dce2ce0bab1cacbabce229181900360200190a150565b600054600160a060020a0316331461062a576040805160e560020a62461bcd02815260206004820152602f60248201527f4f6e6c792074686520636f6e7472616374206f776e6572206d6179207065726660448201527f6f726d207468697320616374696f6e0000000000000000000000000000000000606482015290519081900360840190fd5b60038054600160a060020a03831673ffffffffffffffffffffffffffffffffffffffff19909116811790915560408051918252517f6d1d088acfe4f30d6014f6f693c61c16258f9784a6ed8439b2c59213eecb62959181900360200190a150565b6000806000610699846106d2565b9150600090505b818110156106c7576106b28482610bbe565b156106bf578092506106cb565b6001016106a0565b8192505b5050919050565b600160a060020a031660009081526004602052604090205490565b60066020526000908152604090205481565b6107076111cf565b60006107128361068b565b905061071d836106d2565b81141561073f576040805180820190915260008082526020820152915061074c565b6107498382611034565b91505b50919050565b60056020526000908152604090205481565b61076c6111ea565b6107746111ea565b60008061077f6111cf565b610788866106d2565b9250600091505b828210156107e6576107a18683611034565b8051909150846002840261020881106107b657fe5b60200201528060016020020151846001600285020161020881106107d657fe5b602002015260019091019061078f565b5091949350505050565b6000806000806000610801336106d2565b9450600092505b848310156108a95761081a3384610bbe565b915042821115610829576108a9565b61083333846110a3565b90508015156108415761089e565b60408051808201825260008082526020808301829052338252600490529190912080548590811061086e57fe5b906000526020600020906002020190600261088a92919061120b565b5061089b848263ffffffff61119f16565b93505b600190920191610808565b83156109f6576007546108c2908563ffffffff6111b816565b600755336000908152600560205260409020546108e5908563ffffffff6111b816565b33600090815260056020908152604080832093909355600690522054610911908563ffffffff61119f16565b3360008181526006602090815260408083209490945560025484517fa9059cbb0000000000000000000000000000000000000000000000000000000081526004810194909452602484018990529351600160a060020a039094169363a9059cbb93604480820194918390030190829087803b15801561098f57600080fd5b505af11580156109a3573d6000803e3d6000fd5b505050506040513d60208110156109b957600080fd5b50506040805142815260208101869052815133927ffbeff59d2bfda0d79ea8a29f8c57c66d48c7a13eabbdb90908d9115ec41c9dc6928290030190a25b5050505050565b600460205282600052604060002082815481101515610a1857fe5b906000526020600020906002020181600281101515610a3357fe5b0154925083915050565b600154600160a060020a031681565b6000610a57826106ff565b60005b602002015192915050565b600160a060020a031660009081526005602052604090205490565b60075481565b600254600160a060020a031681565b600154600160a060020a03163314610b1d576040805160e560020a62461bcd02815260206004820152603560248201527f596f75206d757374206265206e6f6d696e61746564206265666f726520796f7560448201527f2063616e20616363657074206f776e6572736869700000000000000000000000606482015290519081900360840190fd5b60005460015460408051600160a060020a03938416815292909116602083015280517fb532073b38c83145e3e5135377a08bf9aab55bc0fd7c1179cd4fb995d2a5159c9281900390910190a1600180546000805473ffffffffffffffffffffffffffffffffffffffff19908116600160a060020a03841617909155169055565b600054600160a060020a031681565b6000610bb7826106ff565b6001610a5a565b6000610bca8383611034565b60005b60200201519392505050565b600354600160a060020a031681565b6003546000908190600160a060020a0316331480610c76576040805160e560020a62461bcd02815260206004820152603260248201527f4f6e6c792074686520466565506f6f6c20636f6e7472616374732063616e207060448201527f6572666f726d207468697320616374696f6e0000000000000000000000000000606482015290519081900360840190fd5b831515610ccd576040805160e560020a62461bcd02815260206004820152601760248201527f5175616e746974792063616e6e6f74206265207a65726f000000000000000000604482015290519081900360640190fd5b600754610ce0908563ffffffff61119f16565b600755600254604080517f70a082310000000000000000000000000000000000000000000000000000000081523060048201529051600160a060020a03909216916370a08231916024808201926020929091908290030181600087803b158015610d4957600080fd5b505af1158015610d5d573d6000803e3d6000fd5b505050506040513d6020811015610d7357600080fd5b50516007541115610e1a576040805160e560020a62461bcd02815260206004820152604760248201527f4d75737420626520656e6f7567682062616c616e636520696e2074686520636f60448201527f6e747261637420746f2070726f7669646520666f72207468652076657374696e60648201527f6720656e74727900000000000000000000000000000000000000000000000000608482015290519081900360a40190fd5b600160a060020a0385166000908152600460205260409020549250610104831115610e8f576040805160e560020a62461bcd02815260206004820152601c60248201527f56657374696e67207363686564756c6520697320746f6f206c6f6e6700000000604482015290519081900360640190fd5b6301dfe20042019150821515610ebf57600160a060020a0385166000908152600560205260409020849055610f93565b81610ed5866001610ecf896106d2565b03610bbe565b10610f50576040805160e560020a62461bcd02815260206004820152603760248201527f43616e6e6f7420616464206e65772076657374656420656e747269657320656160448201527f726c696572207468616e20746865206c617374206f6e65000000000000000000606482015290519081900360840190fd5b600160a060020a038516600090815260056020526040902054610f79908563ffffffff61119f16565b600160a060020a0386166000908152600560205260409020555b600160a060020a0385166000908152600460209081526040808320815180830190925285825281830188905280546001810180835591855292909320610fe2926002908102909101919061124e565b505060408051428152602081018690528151600160a060020a038816927fedd34dc5a5ea12bd847909801d0660781b50e26c7f4cec3c7b308f1ea410635c928290030190a25050505050565b61010481565b61103c6111cf565b600160a060020a038316600090815260046020526040902080548390811061106057fe5b600091825260209091206040805180820191829052926002908102909201919082845b815481526020019060010190808311611083575050505050905092915050565b60006110af8383611034565b6001610bcd565b600054600160a060020a0316331461113e576040805160e560020a62461bcd02815260206004820152602f60248201527f4f6e6c792074686520636f6e7472616374206f776e6572206d6179207065726660448201527f6f726d207468697320616374696f6e0000000000000000000000000000000000606482015290519081900360840190fd5b60028054600160a060020a03831673ffffffffffffffffffffffffffffffffffffffff19909116811790915560408051918252517f46e9c68bd7831071bdd478f1ae4c4a52463961a9d620383a0a121dbfc0e0f06d9181900360200190a150565b6000828201838110156111b157600080fd5b9392505050565b600080838311156111c857600080fd5b5050900390565b60408051808201825290600290829080388339509192915050565b61410060405190810160405280610208906020820280388339509192915050565b826002810192821561123e579160200282015b8281111561123e578251829060ff1690559160200191906001019061121e565b5061124a92915061127c565b5090565b826002810192821561123e579160200282015b8281111561123e578251825591602001919060010190611261565b61129691905b8082111561124a5760008155600101611282565b905600a165627a7a7230582015458fadb7d7d41b8bdffe105531a59f8ff6e82f316fc9edb3c0b0e1ae77ab4b0029000000000000000000000000b64ff7a4a33acdf48d97dab0d764afd0f617688200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
  "constructorArguments": "000000000000000000000000b64ff7a4a33acdf48d97dab0d764afd0f617688200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
  "libraries": [
    {
      "name": "safedecimalmath",
      "address": "0x84d626b2bb4d0f064067e4bf80fce7055d8f3e7b"
    }
  ]
}