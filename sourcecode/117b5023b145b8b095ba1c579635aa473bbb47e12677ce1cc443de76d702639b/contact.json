{
  "address": "0x9462eeb9124c99731cc7617348b3937a8f00b11f",
  "chain": "ETH",
  "chainID": 1,
  "verifier": "etherscan.io",
  "commonName": "",
  "contractName": "Radex",
  "compilerVersion": "v0.4.19+commit.c4cbbb05",
  "optimization": true,
  "runs": "200",
  "evmVersion": "default",
  "sourceCode": "/**\n *Submitted for verification at Etherscan.io on 2017-12-10\n*/\n\npragma solidity ^0.4.11;\n\nlibrary SafeMath {\n  function mul(uint256 a, uint256 b) internal constant returns (uint256) {\n    uint256 c = a * b;\n    assert(a == 0 || c / a == b);\n    return c;\n  }\n\n  function div(uint256 a, uint256 b) internal constant returns (uint256) {\n    // assert(b > 0); // Solidity automatically throws when dividing by 0\n    uint256 c = a / b;\n    // assert(a == b * c + a % b); // There is no case in which this doesn't hold\n    return c;\n  }\n\n  function sub(uint256 a, uint256 b) internal constant returns (uint256) {\n    assert(b <= a);\n    return a - b;\n  }\n\n  function add(uint256 a, uint256 b) internal constant returns (uint256) {\n    uint256 c = a + b;\n    assert(c >= a);\n    return c;\n  }\n}\n\ncontract ERC223 {\n  uint public totalSupply;\n  function balanceOf(address who) constant returns (uint);\n\n  function name() constant returns (string _name);\n  function symbol() constant returns (string _symbol);\n  function decimals() constant returns (uint8 _decimals);\n  function totalSupply() constant returns (uint256 _supply);\n\n  function transfer(address to, uint value) returns (bool ok);\n  function transfer(address to, uint value, bytes data) returns (bool ok);\n  event Transfer(address indexed _from, address indexed _to, uint256 _value);\n  event ERC223Transfer(address indexed _from, address indexed _to, uint256 _value, bytes _data);\n}\n\ncontract ContractReceiver {\n  function tokenFallback(address _from, uint _value, bytes _data);\n}\n\ncontract ERC20Basic {\n  uint256 public totalSupply;\n  uint8   public decimals;\n  function balanceOf(address who) public constant returns (uint256);\n  function transfer(address to, uint256 value) public returns (bool);\n  event Transfer(address indexed from, address indexed to, uint256 value);\n}\n\ncontract ERC20 is ERC20Basic {\n  function allowance(address owner, address spender) public constant returns (uint256);\n  function transferFrom(address from, address to, uint256 value) public returns (bool);\n  function approve(address spender, uint256 value) public returns (bool);\n  event Approval(address indexed owner, address indexed spender, uint256 value);\n}\n\ncontract Radex is ContractReceiver {\n  using SafeMath for uint256;\n\n  struct Order {\n    address owner;\n    address sellToken;\n    address buyToken;\n    uint256 amount;\n    uint256 priceMul;\n    uint256 priceDiv;\n  }\n\n  // fee to be paid towards market makers\n  // fee amount = trade amount divided by feeMultiplier\n  uint256 public  feeMultiplier;\n  address private admin;\n  address private etherAddress = 0x0;\n\n  // person => token => balance\n  mapping(address => mapping(address => uint256)) public balances;\n  mapping(address => mapping(address => uint256)) public commitments;\n\n  mapping(uint256 => Order) orderBook;\n  uint256 public latestOrderId = 0;\n\n  event Deposit(address indexed _token, address indexed _owner, uint256 _amount, uint256 _time);\n  event Withdrawal(address indexed _token, address indexed _owner, uint256 _amount, uint256 _time);\n\n  event NewOrder(uint256 _id, address indexed _owner, address indexed _sellToken, address indexed _buyToken, uint256 _amount, uint256 _priceMul, uint256 _priceDiv, uint256 _time);\n  event OrderCancelled(uint256 indexed _id, uint256 _time);\n  event OrderFulfilled(uint256 indexed _id, uint256 _time);\n\n  event MarketMaker(address indexed _owner, address indexed _token, uint256 _amount, uint256 _time);\n  event Trade(address indexed _from, address indexed _to, uint256 indexed _orderId, uint256 _soldTokens, uint256 _boughtTokens, uint256 _time);\n\n  function Radex() {\n    feeMultiplier = 1000;\n    admin = msg.sender;\n  }\n\n  function createOrder(address sellToken, address buyToken, uint256 amount, uint256 priceMul, uint256 priceDiv) returns(uint256 orderId) {\n    if (amount == 0) { revert(); }\n    if (priceMul == 0) { revert(); }\n    if (priceDiv == 0) { revert(); }\n    if (sellToken == buyToken) { revert(); }\n    if (balances[msg.sender][sellToken] < amount) { revert(); }\n    if (amount.mul(priceMul).div(priceDiv) == 0) { revert(); }\n\n    orderId = latestOrderId++;\n    orderBook[orderId] = Order(msg.sender, sellToken, buyToken, amount, priceMul, priceDiv);\n\n    balances[msg.sender][sellToken] = balances[msg.sender][sellToken].sub(amount);\n    commitments[msg.sender][sellToken] = commitments[msg.sender][sellToken].add(amount);\n\n    NewOrder(orderId, msg.sender, sellToken, buyToken, amount, priceMul, priceDiv, now);\n  }\n\n  function cancelOrder(uint256 orderId) {\n    Order storage order = orderBook[orderId];\n    if (order.amount == 0) { revert(); }\n    if (msg.sender != order.owner) { revert(); }\n\n    commitments[msg.sender][order.sellToken] = commitments[msg.sender][order.sellToken].sub(order.amount);\n    balances[msg.sender][order.sellToken] = balances[msg.sender][order.sellToken].add(order.amount);\n\n    OrderCancelled(orderId, now);\n  }\n\n  function executeOrder(uint256 orderId, uint256 amount) {\n    if (orderId > latestOrderId) { revert(); }\n    Order storage order    = orderBook[orderId];\n    uint256 buyTokenAmount = amount.mul(order.priceMul).div(order.priceDiv);\n    if (amount == 0) { revert(); }\n    if (order.amount < amount) { revert(); }\n    if (msg.sender == order.owner) { revert(); }\n    if (balances[msg.sender][order.buyToken] < buyTokenAmount) { revert(); }\n\n    uint256 fee = amount.div(feeMultiplier);\n\n    balances[order.owner][order.buyToken]     = balances[order.owner][order.buyToken].add(buyTokenAmount);\n    balances[msg.sender][order.buyToken]      = balances[msg.sender][order.buyToken].sub(buyTokenAmount);\n    balances[msg.sender][order.sellToken]     = balances[msg.sender][order.sellToken].add(amount).sub(fee);\n    balances[order.owner][order.sellToken]    = balances[order.owner][order.sellToken].add(fee);\n\n    commitments[order.owner][order.sellToken] = commitments[order.owner][order.sellToken].sub(amount);\n    order.amount = order.amount.sub(amount);\n    if (order.amount == 0) { OrderFulfilled(orderId, now); }\n\n    Trade(msg.sender, order.owner, orderId, amount, buyTokenAmount, now);\n    MarketMaker(order.owner, order.sellToken, fee, now);\n  }\n\n\n  function redeem(address token, uint256 value) {\n    if (value == 0) { revert(); }\n    address caller = msg.sender;\n    if (value > balances[caller][token]) { revert(); }\n\n    balances[caller][token] = balances[caller][token].sub(value);\n    // ETH transfers and token transfers need to be handled differently\n    if (token == etherAddress) {\n      caller.transfer(value);\n    } else {\n      ERC223(token).transfer(caller, value);\n    }\n    Withdrawal(token, msg.sender, value, now);\n  }\n\n  function balanceOf(address token, address user) constant returns (uint256) {\n    return balances[user][token];\n  }\n\n  function commitmentsOf(address token, address user) constant returns (uint256) {\n    return commitments[user][token];\n  }\n\n  // deposits\n  // we're not using the third argument so we comment it out\n  // to silence solidity linter warnings\n  function tokenFallback(address _from, uint _value, bytes /* _data */) {\n    // ERC223 token deposit handler\n    balances[_from][msg.sender] = balances[_from][msg.sender].add(_value);\n    Deposit(msg.sender, _from, _value, now);\n  }\n\n  function fund() payable {\n    // ETH deposit handler\n    balances[msg.sender][etherAddress] = balances[msg.sender][etherAddress].add(msg.value);\n    Deposit(etherAddress, msg.sender, msg.value, now);\n  }\n\n  // register the ERC20<>ERC223 pair with the smart contract\n  function register(address erc20token, address erc223token) {\n    if (msg.sender != admin) { revert(); } // only owner\n    ERC20 erc20 = ERC20(erc20token);\n    uint256 supply = erc20.totalSupply();\n    erc20.approve(erc223token, supply);\n  }\n}",
  "abi": "[{\"constant\":false,\"inputs\":[{\"name\":\"token\",\"type\":\"address\"},{\"name\":\"value\",\"type\":\"uint256\"}],\"name\":\"redeem\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"orderId\",\"type\":\"uint256\"}],\"name\":\"cancelOrder\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"sellToken\",\"type\":\"address\"},{\"name\":\"buyToken\",\"type\":\"address\"},{\"name\":\"amount\",\"type\":\"uint256\"},{\"name\":\"priceMul\",\"type\":\"uint256\"},{\"name\":\"priceDiv\",\"type\":\"uint256\"}],\"name\":\"createOrder\",\"outputs\":[{\"name\":\"orderId\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"latestOrderId\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"erc20token\",\"type\":\"address\"},{\"name\":\"erc223token\",\"type\":\"address\"}],\"name\":\"register\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"},{\"name\":\"\",\"type\":\"address\"}],\"name\":\"commitments\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"fund\",\"outputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_from\",\"type\":\"address\"},{\"name\":\"_value\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"bytes\"}],\"name\":\"tokenFallback\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"},{\"name\":\"\",\"type\":\"address\"}],\"name\":\"balances\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"token\",\"type\":\"address\"},{\"name\":\"user\",\"type\":\"address\"}],\"name\":\"commitmentsOf\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"feeMultiplier\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"orderId\",\"type\":\"uint256\"},{\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"executeOrder\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"token\",\"type\":\"address\"},{\"name\":\"user\",\"type\":\"address\"}],\"name\":\"balanceOf\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"_token\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"_owner\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"_amount\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"_time\",\"type\":\"uint256\"}],\"name\":\"Deposit\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"_token\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"_owner\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"_amount\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"_time\",\"type\":\"uint256\"}],\"name\":\"Withdrawal\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"_id\",\"type\":\"uint256\"},{\"indexed\":true,\"name\":\"_owner\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"_sellToken\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"_buyToken\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"_amount\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"_priceMul\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"_priceDiv\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"_time\",\"type\":\"uint256\"}],\"name\":\"NewOrder\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"_id\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"_time\",\"type\":\"uint256\"}],\"name\":\"OrderCancelled\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"_id\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"_time\",\"type\":\"uint256\"}],\"name\":\"OrderFulfilled\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"_owner\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"_token\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"_amount\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"_time\",\"type\":\"uint256\"}],\"name\":\"MarketMaker\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"_from\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"_to\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"_orderId\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"_soldTokens\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"_boughtTokens\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"_time\",\"type\":\"uint256\"}],\"name\":\"Trade\",\"type\":\"event\"}]",
  "bytecode": "606060405260028054600160a060020a03191690556000600655341561002457600080fd5b6103e860005560018054600160a060020a033316600160a060020a0319909116179055610f7b806100566000396000f3006060604052600436106100ab5763ffffffff60e060020a6000350416631e9a695081146100b0578063514fcac7146100d4578063518e62db146100ea5780636f3b60d61461012a578063aa6773541461013d578063adb6f63f14610162578063b60d428814610187578063c0ee0b8a1461018f578063c23f001f146101f4578063cc7e930c14610219578063e5a70ef71461023e578063ef46e0ca14610251578063f7888aec1461026a575b600080fd5b34156100bb57600080fd5b6100d2600160a060020a036004351660243561028f565b005b34156100df57600080fd5b6100d260043561043e565b34156100f557600080fd5b610118600160a060020a0360043581169060243516604435606435608435610579565b60405190815260200160405180910390f35b341561013557600080fd5b610118610852565b341561014857600080fd5b6100d2600160a060020a0360043581169060243516610858565b341561016d57600080fd5b610118600160a060020a036004358116906024351661095b565b6100d2610978565b341561019a57600080fd5b6100d260048035600160a060020a03169060248035919060649060443590810190830135806020601f82018190048102016040519081016040528181529291906020840183838082843750949650610a2395505050505050565b34156101ff57600080fd5b610118600160a060020a0360043581169060243516610aca565b341561022457600080fd5b610118600160a060020a0360043581169060243516610ae7565b341561024957600080fd5b610118610b13565b341561025c57600080fd5b6100d2600435602435610b19565b341561027557600080fd5b610118600160a060020a0360043581169060243516610ec0565b600081151561029d57600080fd5b5033600160a060020a038181166000908152600360209081526040808320938716835292905220548211156102d157600080fd5b600160a060020a03808216600090815260036020908152604080832093871683529290522054610307908363ffffffff610eec16565b600160a060020a03808316600090815260036020908152604080832088851680855292529091209290925560025416141561037257600160a060020a03811682156108fc0283604051600060405180830381858888f19350505050151561036d57600080fd5b6103eb565b82600160a060020a031663a9059cbb828460006040516020015260405160e060020a63ffffffff8516028152600160a060020a0390921660048301526024820152604401602060405180830381600087803b15156103cf57600080fd5b6102c65a03f115156103e057600080fd5b505050604051805150505b33600160a060020a031683600160a060020a03167fc2b4a290c20fb28939d29f102514fbffd2b73c059ffba8b78250c94161d5fcc6844260405191825260208201526040908101905180910390a3505050565b60008181526005602052604090206003810154151561045c57600080fd5b805433600160a060020a0390811691161461047657600080fd5b6003810154600160a060020a0333811660009081526004602090815260408083206001870154909416835292905220546104b59163ffffffff610eec16565b600160a060020a0333811660008181526004602090815260408083206001880180548716855290835281842096909655600380880154948452825280832095549094168252939093529120546105109163ffffffff610efe16565b600160a060020a033381166000908152600360209081526040808320600187015490941683529290528190209190915582907faa2a006d186dc89a3d6851834c85d16226329ac40bcad6531a5756a38ed1c90f9042905190815260200160405180910390a25050565b600083151561058757600080fd5b82151561059357600080fd5b81151561059f57600080fd5b84600160a060020a031686600160a060020a031614156105be57600080fd5b600160a060020a033381166000908152600360209081526040808320938a1683529290522054849010156105f157600080fd5b61061182610605868663ffffffff610f1416565b9063ffffffff610f3816565b151561061c57600080fd5b50600680546001810190915560c06040519081016040528033600160a060020a0316815260200187600160a060020a0316815260200186600160a060020a0316815260200185815260200184815260200183815250600560008381526020019081526020016000206000820151815473ffffffffffffffffffffffffffffffffffffffff1916600160a060020a0391909116178155602082015160018201805473ffffffffffffffffffffffffffffffffffffffff1916600160a060020a0392909216919091179055604082015160028201805473ffffffffffffffffffffffffffffffffffffffff1916600160a060020a0392909216919091179055606082015181600301556080820151816004015560a082015160059091015550600160a060020a033381166000908152600360209081526040808320938a168352929052205461076f908563ffffffff610eec16565b600160a060020a033381166000818152600360209081526040808320948c16808452948252808320959095559181526004825283812092815291905220546107bd908563ffffffff610efe16565b600160a060020a0333811660008181526004602090815260408083208c86168085529252918290209490945591881692917f506cb18801692179462f2b7b4b6f10bea763984f94a1f1f3cd858e3a645b2329908590899089908990429051808681526020018581526020018481526020018381526020018281526020019550505050505060405180910390a495945050505050565b60065481565b600154600090819033600160a060020a0390811691161461087857600080fd5b83915081600160a060020a03166318160ddd6000604051602001526040518163ffffffff1660e060020a028152600401602060405180830381600087803b15156108c157600080fd5b6102c65a03f115156108d257600080fd5b5050506040518051915050600160a060020a03821663095ea7b3848360006040516020015260405160e060020a63ffffffff8516028152600160a060020a0390921660048301526024820152604401602060405180830381600087803b151561093a57600080fd5b6102c65a03f1151561094b57600080fd5b5050506040518051505050505050565b600460209081526000928352604080842090915290825290205481565b600160a060020a033381166000908152600360209081526040808320600254909416835292905220546109b1903463ffffffff610efe16565b600160a060020a033381166000818152600360209081526040808320600280548716855292529182902094909455925490929116907fdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d790349042905191825260208201526040908101905180910390a3565b600160a060020a0380841660009081526003602090815260408083203390941683529290522054610a5a908363ffffffff610efe16565b600160a060020a03808516600081815260036020908152604080832033909516808452949091529081902093909355917fdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d790859042905191825260208201526040908101905180910390a3505050565b600360209081526000928352604080842090915290825290205481565b600160a060020a0380821660009081526004602090815260408083209386168352929052205492915050565b60005481565b6000806000600654851115610b2d57600080fd5b600560008681526020019081526020016000209250610b618360050154610605856004015487610f1490919063ffffffff16565b9150831515610b6f57600080fd5b8383600301541015610b8057600080fd5b825433600160a060020a0390811691161415610b9b57600080fd5b600160a060020a03338116600090815260036020908152604080832060028801549094168352929052205482901015610bd357600080fd5b600054610be790859063ffffffff610f3816565b8354600160a060020a039081166000908152600360209081526040808320600289015490941683529290522054909150610c27908363ffffffff610efe16565b8354600160a060020a03908116600090815260036020818152604080842060028a0180548716865290835281852096909655338516845291815281832094549093168252929091522054610c81908363ffffffff610eec16565b600160a060020a03338116600090815260036020908152604080832060028901548516845290915280822093909355600186015490911681522054610cd8908290610ccc9087610efe565b9063ffffffff610eec16565b600160a060020a03338116600090815260036020818152604080842060018a018054871686529083528185209690965588548516845291815281832094549093168252929091522054610d31908263ffffffff610efe16565b8354600160a060020a0390811660009081526003602090815260408083206001890180548616855290835281842095909555875484168352600482528083209454909316825292909252902054610d8e908563ffffffff610eec16565b8354600160a060020a0390811660009081526004602090815260408083206001890154909416835292905220556003830154610dd0908563ffffffff610eec16565b600384018190551515610e1257847feb3b41be12efa25c0c65725eeff2e2ad0250e2e5de2aa939e18f36aa656e98804260405190815260200160405180910390a25b82548590600160a060020a039081169033167fe6f814da7244d1ae6c61b54b5684858ba39cad7b9a91884be10060664987d75487864260405180848152602001838152602001828152602001935050505060405180910390a460018301548354600160a060020a0391821691167fac476a0560d6039841f7de6a83293b862be45e3182ab744e10e048952fe7e4e3834260405191825260208201526040908101905180910390a35050505050565b600160a060020a0380821660009081526003602090815260408083209386168352929052205492915050565b600082821115610ef857fe5b50900390565b600082820183811015610f0d57fe5b9392505050565b6000828202831580610f305750828482811515610f2d57fe5b04145b1515610f0d57fe5b6000808284811515610f4657fe5b049493505050505600a165627a7a72305820d62e71e220a0e4c80ad8cdbb637e21f48caa0a7092199314b2a1c5350fc9e1c20029"
}