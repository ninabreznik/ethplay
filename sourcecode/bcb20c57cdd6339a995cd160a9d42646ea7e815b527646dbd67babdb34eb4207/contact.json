{
  "address": "0x5cc161482e82f20840a4aaeb582becbcc4b539d7",
  "chain": "ETH",
  "chainID": 1,
  "verifier": "etherscan.io",
  "commonName": "",
  "contractName": "Locker",
  "compilerVersion": "v0.4.24+commit.e67f0147",
  "optimization": false,
  "runs": "200",
  "evmVersion": "default",
  "sourceCode": "/**\n *Submitted for verification at Etherscan.io on 2018-11-14\n*/\n\npragma solidity 0.4.24;\n\n// File: contracts/generic/Restricted.sol\n\n/*\n    Generic contract to authorise calls to certain functions only from a given address.\n    The address authorised must be a contract (multisig or not, depending on the permission), except for local test\n\n    deployment works as:\n           1. contract deployer account deploys contracts\n           2. constructor grants \"PermissionGranter\" permission to deployer account\n           3. deployer account executes initial setup (no multiSig)\n           4. deployer account grants PermissionGranter permission for the MultiSig contract\n                (e.g. StabilityBoardProxy or PreTokenProxy)\n           5. deployer account revokes its own PermissionGranter permission\n*/\n\npragma solidity 0.4.24;\n\n\ncontract Restricted {\n\n    // NB: using bytes32 rather than the string type because it's cheaper gas-wise:\n    mapping (address => mapping (bytes32 => bool)) public permissions;\n\n    event PermissionGranted(address indexed agent, bytes32 grantedPermission);\n    event PermissionRevoked(address indexed agent, bytes32 revokedPermission);\n\n    modifier restrict(bytes32 requiredPermission) {\n        require(permissions[msg.sender][requiredPermission], \"msg.sender must have permission\");\n        _;\n    }\n\n    constructor(address permissionGranterContract) public {\n        require(permissionGranterContract != address(0), \"permissionGranterContract must be set\");\n        permissions[permissionGranterContract][\"PermissionGranter\"] = true;\n        emit PermissionGranted(permissionGranterContract, \"PermissionGranter\");\n    }\n\n    function grantPermission(address agent, bytes32 requiredPermission) public {\n        require(permissions[msg.sender][\"PermissionGranter\"],\n            \"msg.sender must have PermissionGranter permission\");\n        permissions[agent][requiredPermission] = true;\n        emit PermissionGranted(agent, requiredPermission);\n    }\n\n    function grantMultiplePermissions(address agent, bytes32[] requiredPermissions) public {\n        require(permissions[msg.sender][\"PermissionGranter\"],\n            \"msg.sender must have PermissionGranter permission\");\n        uint256 length = requiredPermissions.length;\n        for (uint256 i = 0; i < length; i++) {\n            grantPermission(agent, requiredPermissions[i]);\n        }\n    }\n\n    function revokePermission(address agent, bytes32 requiredPermission) public {\n        require(permissions[msg.sender][\"PermissionGranter\"],\n            \"msg.sender must have PermissionGranter permission\");\n        permissions[agent][requiredPermission] = false;\n        emit PermissionRevoked(agent, requiredPermission);\n    }\n\n    function revokeMultiplePermissions(address agent, bytes32[] requiredPermissions) public {\n        uint256 length = requiredPermissions.length;\n        for (uint256 i = 0; i < length; i++) {\n            revokePermission(agent, requiredPermissions[i]);\n        }\n    }\n\n}\n\n// File: contracts/generic/SafeMath.sol\n\n/**\n* @title SafeMath\n* @dev Math operations with safety checks that throw on error\n\n    TODO: check against ds-math: https://blog.dapphub.com/ds-math/\n    TODO: move roundedDiv to a sep lib? (eg. Math.sol)\n    TODO: more unit tests!\n*/\npragma solidity 0.4.24;\n\n\nlibrary SafeMath {\n    function mul(uint256 a, uint256 b) internal pure returns (uint256) {\n        uint256 c = a * b;\n        require(a == 0 || c / a == b, \"mul overflow\");\n        return c;\n    }\n\n    function div(uint256 a, uint256 b) internal pure returns (uint256) {\n        require(b > 0, \"div by 0\"); // Solidity automatically throws for div by 0 but require to emit reason\n        uint256 c = a / b;\n        // require(a == b * c + a % b); // There is no case in which this doesn't hold\n        return c;\n    }\n\n    function sub(uint256 a, uint256 b) internal pure returns (uint256) {\n        require(b <= a, \"sub underflow\");\n        return a - b;\n    }\n\n    function add(uint256 a, uint256 b) internal pure returns (uint256) {\n        uint256 c = a + b;\n        require(c >= a, \"add overflow\");\n        return c;\n    }\n\n    // Division, round to nearest integer, round half up\n    function roundedDiv(uint256 a, uint256 b) internal pure returns (uint256) {\n        require(b > 0, \"div by 0\"); // Solidity automatically throws for div by 0 but require to emit reason\n        uint256 halfB = (b % 2 == 0) ? (b / 2) : (b / 2 + 1);\n        return (a % b >= halfB) ? (a / b + 1) : (a / b);\n    }\n\n    // Division, always rounds up\n    function ceilDiv(uint256 a, uint256 b) internal pure returns (uint256) {\n        require(b > 0, \"div by 0\"); // Solidity automatically throws for div by 0 but require to emit reason\n        return (a % b != 0) ? (a / b + 1) : (a / b);\n    }\n\n    function min(uint256 a, uint256 b) internal pure returns (uint256) {\n        return a < b ? a : b;\n    }\n\n    function max(uint256 a, uint256 b) internal pure returns (uint256) {\n        return a < b ? b : a;\n    }    \n}\n\n// File: contracts/interfaces/TransferFeeInterface.sol\n\n/*\n *  transfer fee calculation interface\n *\n */\npragma solidity 0.4.24;\n\n\ninterface TransferFeeInterface {\n    function calculateTransferFee(address from, address to, uint amount) external view returns (uint256 fee);\n}\n\n// File: contracts/interfaces/ERC20Interface.sol\n\n/*\n * ERC20 interface\n * see https://github.com/ethereum/EIPs/issues/20\n */\npragma solidity 0.4.24;\n\n\ninterface ERC20Interface {\n    event Approval(address indexed _owner, address indexed _spender, uint _value);\n    event Transfer(address indexed from, address indexed to, uint amount);\n\n    function transfer(address to, uint value) external returns (bool); // solhint-disable-line no-simple-event-func-name\n    function transferFrom(address from, address to, uint value) external returns (bool);\n    function approve(address spender, uint value) external returns (bool);\n    function balanceOf(address who) external view returns (uint);\n    function allowance(address _owner, address _spender) external view returns (uint remaining);\n\n}\n\n// File: contracts/interfaces/TokenReceiver.sol\n\n/*\n *  receiver contract interface\n * see https://github.com/ethereum/EIPs/issues/677\n */\npragma solidity 0.4.24;\n\n\ninterface TokenReceiver {\n    function transferNotification(address from, uint256 amount, uint data) external;\n}\n\n// File: contracts/interfaces/AugmintTokenInterface.sol\n\n/* Augmint Token interface (abstract contract)\n\nTODO: overload transfer() & transferFrom() instead of transferWithNarrative() & transferFromWithNarrative()\n      when this fix available in web3& truffle also uses that web3: https://github.com/ethereum/web3.js/pull/1185\nTODO: shall we use bytes for narrative?\n */\npragma solidity 0.4.24;\n\n\n\n\n\n\n\ncontract AugmintTokenInterface is Restricted, ERC20Interface {\n    using SafeMath for uint256;\n\n    string public name;\n    string public symbol;\n    bytes32 public peggedSymbol;\n    uint8 public decimals;\n\n    uint public totalSupply;\n    mapping(address => uint256) public balances; // Balances for each account\n    mapping(address => mapping (address => uint256)) public allowed; // allowances added with approve()\n\n    TransferFeeInterface public feeAccount;\n    mapping(bytes32 => bool) public delegatedTxHashesUsed; // record txHashes used by delegatedTransfer\n\n    event TransferFeesChanged(uint transferFeePt, uint transferFeeMin, uint transferFeeMax);\n    event Transfer(address indexed from, address indexed to, uint amount);\n    event AugmintTransfer(address indexed from, address indexed to, uint amount, string narrative, uint fee);\n    event TokenIssued(uint amount);\n    event TokenBurned(uint amount);\n    event Approval(address indexed _owner, address indexed _spender, uint256 _value);\n\n    function transfer(address to, uint value) external returns (bool); // solhint-disable-line no-simple-event-func-name\n    function transferFrom(address from, address to, uint value) external returns (bool);\n    function approve(address spender, uint value) external returns (bool);\n\n    function delegatedTransfer(address from, address to, uint amount, string narrative,\n                                    uint maxExecutorFeeInToken, /* client provided max fee for executing the tx */\n                                    bytes32 nonce, /* random nonce generated by client */\n                                    /* ^^^^ end of signed data ^^^^ */\n                                    bytes signature,\n                                    uint requestedExecutorFeeInToken /* the executor can decide to request lower fee */\n                                ) external;\n\n    function delegatedTransferAndNotify(address from, TokenReceiver target, uint amount, uint data,\n                                    uint maxExecutorFeeInToken, /* client provided max fee for executing the tx */\n                                    bytes32 nonce, /* random nonce generated by client */\n                                    /* ^^^^ end of signed data ^^^^ */\n                                    bytes signature,\n                                    uint requestedExecutorFeeInToken /* the executor can decide to request lower fee */\n                                ) external;\n\n    function increaseApproval(address spender, uint addedValue) external;\n    function decreaseApproval(address spender, uint subtractedValue) external;\n\n    function issueTo(address to, uint amount) external; // restrict it to \"MonetarySupervisor\" in impl.;\n    function burn(uint amount) external;\n\n    function transferAndNotify(TokenReceiver target, uint amount, uint data) external;\n\n    function transferWithNarrative(address to, uint256 amount, string narrative) external;\n    function transferFromWithNarrative(address from, address to, uint256 amount, string narrative) external;\n\n    function setName(string _name) external;\n    function setSymbol(string _symbol) external;\n\n    function allowance(address owner, address spender) external view returns (uint256 remaining);\n\n    function balanceOf(address who) external view returns (uint);\n\n\n}\n\n// File: contracts/generic/ECRecovery.sol\n\n/**\n * @title Eliptic curve signature operations\n *\n * @dev Based on https://github.com/OpenZeppelin/openzeppelin-solidity/blob/master/contracts/ECRecovery.sol\n *\n * TODO Remove this library once solidity supports passing a signature to ecrecover.\n * See https://github.com/ethereum/solidity/issues/864\n *\n */\n\nlibrary ECRecovery {\n\n  /**\n   * @dev Recover signer address from a message by using their signature\n   * @param hash bytes32 message, the hash is the signed message. What is recovered is the signer address.\n   * @param sig bytes signature, the signature is generated using web3.eth.sign()\n   */\n  function recover(bytes32 hash, bytes sig)\n    internal\n    pure\n    returns (address)\n  {\n    bytes32 r;\n    bytes32 s;\n    uint8 v;\n\n    // Check the signature length\n    if (sig.length != 65) {\n      return (address(0));\n    }\n\n    // Divide the signature in r, s and v variables\n    // ecrecover takes the signature parameters, and the only way to get them\n    // currently is to use assembly.\n    // solium-disable-next-line security/no-inline-assembly\n    assembly {\n      r := mload(add(sig, 32))\n      s := mload(add(sig, 64))\n      v := byte(0, mload(add(sig, 96)))\n    }\n\n    // Version of signature should be 27 or 28, but 0 and 1 are also possible versions\n    if (v < 27) {\n      v += 27;\n    }\n\n    // If the version is correct return the signer address\n    if (v != 27 && v != 28) {\n      return (address(0));\n    } else {\n      // solium-disable-next-line arg-overflow\n      return ecrecover(hash, v, r, s);\n    }\n  }\n\n  /**\n   * toEthSignedMessageHash\n   * @dev prefix a bytes32 value with \"\\x19Ethereum Signed Message:\"\n   * @dev and hash the result\n   */\n  function toEthSignedMessageHash(bytes32 hash)\n    internal\n    pure\n    returns (bytes32)\n  {\n    // 32 is the length in bytes of hash,\n    // enforced by the type signature above\n    return keccak256(abi.encodePacked(\"\\x19Ethereum Signed Message:\\n32\", hash));\n  }\n}\n\n// File: contracts/generic/AugmintToken.sol\n\n/* Generic Augmint Token implementation (ERC20 token)\n    This contract manages:\n        * Balances of Augmint holders and transactions between them\n        * Issues/burns tokens\n\n    TODO:\n        - reconsider delegatedTransfer and how to structure it\n        - shall we allow change of txDelegator?\n        - consider generic bytes arg instead of uint for transferAndNotify\n        - consider separate transfer fee params and calculation to separate contract (to feeAccount?)\n*/\npragma solidity 0.4.24;\n\n\n\n\n\n\ncontract AugmintToken is AugmintTokenInterface {\n\n    event FeeAccountChanged(TransferFeeInterface newFeeAccount);\n\n    constructor(address permissionGranterContract, string _name, string _symbol, bytes32 _peggedSymbol, uint8 _decimals, TransferFeeInterface _feeAccount)\n    public Restricted(permissionGranterContract) {\n        require(_feeAccount != address(0), \"feeAccount must be set\");\n        require(bytes(_name).length > 0, \"name must be set\");\n        require(bytes(_symbol).length > 0, \"symbol must be set\");\n\n        name = _name;\n        symbol = _symbol;\n        peggedSymbol = _peggedSymbol;\n        decimals = _decimals;\n\n        feeAccount = _feeAccount;\n\n    }\n\n    function transfer(address to, uint256 amount) external returns (bool) {\n        _transfer(msg.sender, to, amount, \"\");\n        return true;\n    }\n\n    /* Transfers based on an offline signed transfer instruction. */\n    function delegatedTransfer(address from, address to, uint amount, string narrative,\n                                     uint maxExecutorFeeInToken, /* client provided max fee for executing the tx */\n                                     bytes32 nonce, /* random nonce generated by client */\n                                     /* ^^^^ end of signed data ^^^^ */\n                                     bytes signature,\n                                     uint requestedExecutorFeeInToken /* the executor can decide to request lower fee */\n                                     )\n    external {\n        bytes32 txHash = keccak256(abi.encodePacked(this, from, to, amount, narrative, maxExecutorFeeInToken, nonce));\n\n        _checkHashAndTransferExecutorFee(txHash, signature, from, maxExecutorFeeInToken, requestedExecutorFeeInToken);\n\n        _transfer(from, to, amount, narrative);\n    }\n\n    function approve(address _spender, uint256 amount) external returns (bool) {\n        require(_spender != 0x0, \"spender must be set\");\n        allowed[msg.sender][_spender] = amount;\n        emit Approval(msg.sender, _spender, amount);\n        return true;\n    }\n\n    /**\n     ERC20 transferFrom attack protection: https://github.com/DecentLabs/dcm-poc/issues/57\n     approve should be called when allowed[_spender] == 0. To increment allowed value is better\n     to use this function to avoid 2 calls (and wait until the first transaction is mined)\n     Based on MonolithDAO Token.sol */\n    function increaseApproval(address _spender, uint _addedValue) external {\n        require(_spender != 0x0, \"spender must be set\");\n        mapping (address => uint256) allowances = allowed[msg.sender];\n        uint newValue = allowances[_spender].add(_addedValue);\n        allowances[_spender] = newValue;\n        emit Approval(msg.sender, _spender, newValue);\n    }\n\n    function decreaseApproval(address _spender, uint _subtractedValue) external {\n        require(_spender != 0x0, \"spender must be set\");\n        uint oldValue = allowed[msg.sender][_spender];\n        if (_subtractedValue > oldValue) {\n            allowed[msg.sender][_spender] = 0;\n        } else {\n            allowed[msg.sender][_spender] = oldValue.sub(_subtractedValue);\n        }\n        emit Approval(msg.sender, _spender, allowed[msg.sender][_spender]);\n    }\n\n    function transferFrom(address from, address to, uint256 amount) external returns (bool) {\n        _transferFrom(from, to, amount, \"\");\n        return true;\n    }\n\n    // Issue tokens. See MonetarySupervisor but as a rule of thumb issueTo is only allowed:\n    //      - on new loan (by trusted Lender contracts)\n    //      - when converting old tokens using MonetarySupervisor\n    //      - strictly to reserve by Stability Board (via MonetarySupervisor)\n    function issueTo(address to, uint amount) external restrict(\"MonetarySupervisor\") {\n        balances[to] = balances[to].add(amount);\n        totalSupply = totalSupply.add(amount);\n        emit Transfer(0x0, to, amount);\n        emit AugmintTransfer(0x0, to, amount, \"\", 0);\n    }\n\n    // Burn tokens. Anyone can burn from its own account. YOLO.\n    // Used by to burn from Augmint reserve or by Lender contract after loan repayment\n    function burn(uint amount) external {\n        require(balances[msg.sender] >= amount, \"balance must be >= amount\");\n        balances[msg.sender] = balances[msg.sender].sub(amount);\n        totalSupply = totalSupply.sub(amount);\n        emit Transfer(msg.sender, 0x0, amount);\n        emit AugmintTransfer(msg.sender, 0x0, amount, \"\", 0);\n    }\n\n    /* to upgrade feeAccount (eg. for fee calculation changes) */\n    function setFeeAccount(TransferFeeInterface newFeeAccount) external restrict(\"StabilityBoard\") {\n        feeAccount = newFeeAccount;\n        emit FeeAccountChanged(newFeeAccount);\n    }\n\n    /*  transferAndNotify can be used by contracts which require tokens to have only 1 tx (instead of approve + call)\n        Eg. repay loan, lock funds, token sell order on exchange\n        Reverts on failue:\n            - transfer fails\n            - if transferNotification fails (callee must revert on failure)\n            - if targetContract is an account or targetContract doesn't have neither transferNotification or fallback fx\n        TODO: make data param generic bytes (see receiver code attempt in Locker.transferNotification)\n    */\n    function transferAndNotify(TokenReceiver target, uint amount, uint data) external {\n        _transfer(msg.sender, target, amount, \"\");\n\n        target.transferNotification(msg.sender, amount, data);\n    }\n\n    /* transferAndNotify based on an  instruction signed offline  */\n    function delegatedTransferAndNotify(address from, TokenReceiver target, uint amount, uint data,\n                                     uint maxExecutorFeeInToken, /* client provided max fee for executing the tx */\n                                     bytes32 nonce, /* random nonce generated by client */\n                                     /* ^^^^ end of signed data ^^^^ */\n                                     bytes signature,\n                                     uint requestedExecutorFeeInToken /* the executor can decide to request lower fee */\n                                     )\n    external {\n        bytes32 txHash = keccak256(abi.encodePacked(this, from, target, amount, data, maxExecutorFeeInToken, nonce));\n\n        _checkHashAndTransferExecutorFee(txHash, signature, from, maxExecutorFeeInToken, requestedExecutorFeeInToken);\n\n        _transfer(from, target, amount, \"\");\n        target.transferNotification(from, amount, data);\n    }\n\n\n    function transferWithNarrative(address to, uint256 amount, string narrative) external {\n        _transfer(msg.sender, to, amount, narrative);\n    }\n\n    function transferFromWithNarrative(address from, address to, uint256 amount, string narrative) external {\n        _transferFrom(from, to, amount, narrative);\n    }\n\n    /* Allow Stability Board to change the name when a new token contract version\n       is deployed and ready for production use. So that older token contracts\n       are identifiable in 3rd party apps. */\n    function setName(string _name) external restrict(\"StabilityBoard\") {\n        name = _name;\n    }\n\n    /* Allow Stability Board to change the symbol when a new token contract version\n       is deployed and ready for production use. So that older token contracts\n       are identifiable in 3rd party apps. */\n    function setSymbol(string _symbol) external restrict(\"StabilityBoard\") {\n        symbol = _symbol;\n    }\n\n    function balanceOf(address _owner) external view returns (uint256 balance) {\n        return balances[_owner];\n    }\n\n    function allowance(address _owner, address _spender) external view returns (uint256 remaining) {\n        return allowed[_owner][_spender];\n    }\n\n    function _checkHashAndTransferExecutorFee(bytes32 txHash, bytes signature, address signer,\n                                                uint maxExecutorFeeInToken, uint requestedExecutorFeeInToken) private {\n        require(requestedExecutorFeeInToken <= maxExecutorFeeInToken, \"requestedExecutorFee must be <= maxExecutorFee\");\n        require(!delegatedTxHashesUsed[txHash], \"txHash already used\");\n        delegatedTxHashesUsed[txHash] = true;\n\n        address recovered = ECRecovery.recover(ECRecovery.toEthSignedMessageHash(txHash), signature);\n        require(recovered == signer, \"invalid signature\");\n\n        _transfer(signer, msg.sender, requestedExecutorFeeInToken, \"Delegated transfer fee\", 0);\n    }\n\n    function _transferFrom(address from, address to, uint256 amount, string narrative) private {\n        uint fee = feeAccount.calculateTransferFee(from, to, amount);\n        uint amountWithFee = amount.add(fee);\n\n        /* NB: fee is deducted from owner, so transferFrom could fail\n            if amount + fee is not available on owner balance, or allowance */\n        require(balances[from] >= amountWithFee, \"balance must be >= amount + fee\");\n        require(allowed[from][msg.sender] >= amountWithFee, \"allowance must be >= amount + fee\");\n\n        _transfer(from, to, amount, narrative, fee);\n\n        allowed[from][msg.sender] = allowed[from][msg.sender].sub(amountWithFee);\n    }\n\n    function _transfer(address from, address to, uint transferAmount, string narrative) private {\n        uint fee = feeAccount.calculateTransferFee(from, to, transferAmount);\n        _transfer(from, to, transferAmount, narrative, fee);\n    }\n\n    function _transfer(address from, address to, uint transferAmount, string narrative, uint fee) private {\n        require(to != 0x0, \"to must be set\");\n        uint amountWithFee = transferAmount.add(fee);\n        // to emit proper reason instead of failing on from.sub()\n        require(balances[from] >= amountWithFee, \"balance must be >= amount + transfer fee\");\n\n        balances[from] = balances[from].sub(amountWithFee);\n        balances[to] = balances[to].add(transferAmount);\n\n        emit Transfer(from, to, transferAmount);\n\n        if (fee > 0) {\n            balances[feeAccount] = balances[feeAccount].add(fee);\n            emit Transfer(from, feeAccount, fee);\n        }\n\n        emit AugmintTransfer(from, to, transferAmount, narrative, fee);\n    }\n}\n\n// File: contracts/generic/SystemAccount.sol\n\n/* Contract to collect fees from system */\npragma solidity 0.4.24;\n\n\n\n\ncontract SystemAccount is Restricted {\n    event WithdrawFromSystemAccount(address tokenAddress, address to, uint tokenAmount, uint weiAmount,\n                                    string narrative);\n\n    constructor(address permissionGranterContract)\n    public Restricted(permissionGranterContract) {} // solhint-disable-line no-empty-blocks\n\n    function withdraw(AugmintToken tokenAddress, address to, uint tokenAmount, uint weiAmount, string narrative)\n    external restrict(\"StabilityBoard\") {\n        tokenAddress.transferWithNarrative(to, tokenAmount, narrative);\n        if (weiAmount > 0) {\n            to.transfer(weiAmount);\n        }\n        emit WithdrawFromSystemAccount(tokenAddress, to, tokenAmount, weiAmount, narrative);\n    }\n}\n\n// File: contracts/AugmintReserves.sol\n\n/* Contract to hold Augmint reserves (ETH & Token)\n    - ETH as regular ETH balance of the contract\n    - ERC20 token reserve (stored as regular Token balance under the contract address)\n\nNB: reserves are held under the contract address, therefore any transaction on the reserve is limited to the\n    tx-s defined here (i.e. transfer is not allowed even by the contract owner or StabilityBoard or MonetarySupervisor)\n\n */\n\npragma solidity 0.4.24;\n\n\n\n\ncontract AugmintReserves is Restricted {\n\n    event ReserveMigration(address to, uint weiAmount);\n\n    constructor(address permissionGranterContract)\n    public Restricted(permissionGranterContract) {} // solhint-disable-line no-empty-blocks\n\n    function () external payable { // solhint-disable-line no-empty-blocks\n        // to accept ETH sent into reserve (from defaulted loan's collateral )\n    }\n\n    function burn(AugmintTokenInterface augmintToken, uint amount)\n    external restrict(\"MonetarySupervisor\") {\n        augmintToken.burn(amount);\n    }\n\n    function migrate(address to, uint weiAmount)\n    external restrict(\"StabilityBoard\") {\n        if (weiAmount > 0) {\n            to.transfer(weiAmount);\n        }\n        emit ReserveMigration(to, weiAmount);\n    }\n}\n\n// File: contracts/InterestEarnedAccount.sol\n\n/* Contract to hold earned interest from loans repaid\n   premiums for locks are being accrued (i.e. transferred) to Locker */\n\npragma solidity 0.4.24;\n\n\n\n\ncontract InterestEarnedAccount is SystemAccount {\n\n    constructor(address permissionGranterContract) public SystemAccount(permissionGranterContract) {} // solhint-disable-line no-empty-blocks\n\n    function transferInterest(AugmintTokenInterface augmintToken, address locker, uint interestAmount)\n    external restrict(\"MonetarySupervisor\") {\n        augmintToken.transfer(locker, interestAmount);\n    }\n\n}\n\n// File: contracts/MonetarySupervisor.sol\n\n/* MonetarySupervisor\n    - maintains system wide KPIs (eg totalLockAmount, totalLoanAmount)\n    - holds system wide parameters/limits\n    - enforces system wide limits\n    - burns and issues to AugmintReserves\n    - Send funds from reserve to exchange when intervening (not implemented yet)\n    - Converts older versions of AugmintTokens in 1:1 to new\n*/\n\npragma solidity 0.4.24;\n\n\n\n\n\n\n\n\ncontract MonetarySupervisor is Restricted, TokenReceiver { // solhint-disable-line no-empty-blocks\n    using SafeMath for uint256;\n\n    uint public constant PERCENT_100 = 1000000;\n\n    AugmintTokenInterface public augmintToken;\n    InterestEarnedAccount public interestEarnedAccount;\n    AugmintReserves public augmintReserves;\n\n    uint public issuedByStabilityBoard; // token issued by Stability Board\n    uint public burnedByStabilityBoard; // token burned by Stability Board\n\n    uint public totalLoanAmount; // total amount of all loans without interest, in token\n    uint public totalLockedAmount; // total amount of all locks without premium, in token\n\n    /**********\n        Parameters to ensure totalLoanAmount or totalLockedAmount difference is within limits and system also works\n        when total loan or lock amounts are low.\n            for test calculations: https://docs.google.com/spreadsheets/d/1MeWYPYZRIm1n9lzpvbq8kLfQg1hhvk5oJY6NrR401S0\n    **********/\n    struct LtdParams {\n        uint  lockDifferenceLimit; /* only allow a new lock if Loan To Deposit ratio would stay above\n                                            (1 - lockDifferenceLimit) with new lock. Stored as parts per million */\n        uint  loanDifferenceLimit; /* only allow a new loan if Loan To Deposit ratio would stay above\n                                            (1 + loanDifferenceLimit) with new loan. Stored as parts per million */\n        /* allowedDifferenceAmount param is to ensure the system is not \"freezing\" when totalLoanAmount or\n            totalLockAmount is low.\n        It allows a new loan or lock (up to an amount to reach this difference) even if LTD will go below / above\n            lockDifferenceLimit / loanDifferenceLimit with the new lock/loan */\n        uint  allowedDifferenceAmount;\n    }\n\n    LtdParams public ltdParams;\n\n    /* Previously deployed AugmintTokens which are accepted for conversion (see transferNotification() )\n        NB: it's not iterable so old version addresses needs to be added for UI manually after each deploy */\n    mapping(address => bool) public acceptedLegacyAugmintTokens;\n\n    event LtdParamsChanged(uint lockDifferenceLimit, uint loanDifferenceLimit, uint allowedDifferenceAmount);\n\n    event AcceptedLegacyAugmintTokenChanged(address augmintTokenAddress, bool newAcceptedState);\n\n    event LegacyTokenConverted(address oldTokenAddress, address account, uint amount);\n\n    event KPIsAdjusted(uint totalLoanAmountAdjustment, uint totalLockedAmountAdjustment);\n\n    event SystemContractsChanged(InterestEarnedAccount newInterestEarnedAccount, AugmintReserves newAugmintReserves);\n\n    constructor(address permissionGranterContract, AugmintTokenInterface _augmintToken,\n        AugmintReserves _augmintReserves, InterestEarnedAccount _interestEarnedAccount,\n        uint lockDifferenceLimit, uint loanDifferenceLimit, uint allowedDifferenceAmount)\n    public Restricted(permissionGranterContract) {\n        augmintToken = _augmintToken;\n        augmintReserves = _augmintReserves;\n        interestEarnedAccount = _interestEarnedAccount;\n\n        ltdParams = LtdParams(lockDifferenceLimit, loanDifferenceLimit, allowedDifferenceAmount);\n    }\n\n    function issueToReserve(uint amount) external restrict(\"StabilityBoard\") {\n        issuedByStabilityBoard = issuedByStabilityBoard.add(amount);\n        augmintToken.issueTo(augmintReserves, amount);\n    }\n\n    function burnFromReserve(uint amount) external restrict(\"StabilityBoard\") {\n        burnedByStabilityBoard = burnedByStabilityBoard.add(amount);\n        augmintReserves.burn(augmintToken, amount);\n    }\n\n    /* Locker requesting interest when locking funds. Enforcing LTD to stay within range allowed by LTD params\n        NB: it does not know about min loan amount, it's the loan contract's responsibility to enforce it  */\n    function requestInterest(uint amountToLock, uint interestAmount) external {\n        // only whitelisted Locker\n        require(permissions[msg.sender][\"Locker\"], \"msg.sender must have Locker permission\");\n        require(amountToLock <= getMaxLockAmountAllowedByLtd(), \"amountToLock must be <= maxLockAmountAllowedByLtd\");\n\n        totalLockedAmount = totalLockedAmount.add(amountToLock);\n        // next line would revert but require to emit reason:\n        require(augmintToken.balanceOf(address(interestEarnedAccount)) >= interestAmount,\n            \"interestEarnedAccount balance must be >= interestAmount\");\n        interestEarnedAccount.transferInterest(augmintToken, msg.sender, interestAmount); // transfer interest to Locker\n    }\n\n    // Locker notifying when releasing funds to update KPIs\n    function releaseFundsNotification(uint lockedAmount) external {\n        // only whitelisted Locker\n        require(permissions[msg.sender][\"Locker\"], \"msg.sender must have Locker permission\");\n        totalLockedAmount = totalLockedAmount.sub(lockedAmount);\n    }\n\n    /* Issue loan if LTD stays within range allowed by LTD params\n        NB: it does not know about min loan amount, it's the loan contract's responsibility to enforce it */\n    function issueLoan(address borrower, uint loanAmount) external {\n         // only whitelisted LoanManager contracts\n        require(permissions[msg.sender][\"LoanManager\"],\n            \"msg.sender must have LoanManager permission\");\n        require(loanAmount <= getMaxLoanAmountAllowedByLtd(), \"loanAmount must be <= maxLoanAmountAllowedByLtd\");\n        totalLoanAmount = totalLoanAmount.add(loanAmount);\n        augmintToken.issueTo(borrower, loanAmount);\n    }\n\n    function loanRepaymentNotification(uint loanAmount) external {\n        // only whitelisted LoanManager contracts\n        require(permissions[msg.sender][\"LoanManager\"],\n            \"msg.sender must have LoanManager permission\");\n        totalLoanAmount = totalLoanAmount.sub(loanAmount);\n    }\n\n    // NB: this is called by Lender contract with the sum of all loans collected in batch\n    function loanCollectionNotification(uint totalLoanAmountCollected) external {\n        // only whitelisted LoanManager contracts\n        require(permissions[msg.sender][\"LoanManager\"],\n            \"msg.sender must have LoanManager permission\");\n        totalLoanAmount = totalLoanAmount.sub(totalLoanAmountCollected);\n    }\n\n    function setAcceptedLegacyAugmintToken(address legacyAugmintTokenAddress, bool newAcceptedState)\n    external restrict(\"StabilityBoard\") {\n        acceptedLegacyAugmintTokens[legacyAugmintTokenAddress] = newAcceptedState;\n        emit AcceptedLegacyAugmintTokenChanged(legacyAugmintTokenAddress, newAcceptedState);\n    }\n\n    function setLtdParams(uint lockDifferenceLimit, uint loanDifferenceLimit, uint allowedDifferenceAmount)\n    external restrict(\"StabilityBoard\") {\n        ltdParams = LtdParams(lockDifferenceLimit, loanDifferenceLimit, allowedDifferenceAmount);\n        emit LtdParamsChanged(lockDifferenceLimit, loanDifferenceLimit, allowedDifferenceAmount);\n    }\n\n    /* function to migrate old totalLoanAmount and totalLockedAmount from old monetarySupervisor contract\n        when it's upgraded.\n        Set new monetarySupervisor contract in all locker and loanManager contracts before executing this */\n    function adjustKPIs(uint totalLoanAmountAdjustment, uint totalLockedAmountAdjustment)\n    external restrict(\"StabilityBoard\") {\n        totalLoanAmount = totalLoanAmount.add(totalLoanAmountAdjustment);\n        totalLockedAmount = totalLockedAmount.add(totalLockedAmountAdjustment);\n        emit KPIsAdjusted(totalLoanAmountAdjustment, totalLockedAmountAdjustment);\n    }\n\n    /* to allow upgrades of InterestEarnedAccount and AugmintReserves contracts. */\n    function setSystemContracts(InterestEarnedAccount newInterestEarnedAccount, AugmintReserves newAugmintReserves)\n    external restrict(\"StabilityBoard\") {\n        interestEarnedAccount = newInterestEarnedAccount;\n        augmintReserves = newAugmintReserves;\n        emit SystemContractsChanged(newInterestEarnedAccount, newAugmintReserves);\n    }\n\n    /* User can request to convert their tokens from older AugmintToken versions in 1:1\n      transferNotification is called from AugmintToken's transferAndNotify\n     Flow for converting old tokens:\n        1) user calls old token contract's transferAndNotify with the amount to convert,\n                addressing the new MonetarySupervisor Contract\n        2) transferAndNotify transfers user's old tokens to the current MonetarySupervisor contract's address\n        3) transferAndNotify calls MonetarySupervisor.transferNotification\n        4) MonetarySupervisor checks if old AugmintToken is permitted\n        5) MonetarySupervisor issues new tokens to user's account in current AugmintToken\n        6) MonetarySupervisor burns old tokens from own balance\n    */\n    function transferNotification(address from, uint amount, uint /* data, not used */ ) external {\n        AugmintTokenInterface legacyToken = AugmintTokenInterface(msg.sender);\n        require(acceptedLegacyAugmintTokens[legacyToken], \"msg.sender must be allowed in acceptedLegacyAugmintTokens\");\n\n        legacyToken.burn(amount);\n        augmintToken.issueTo(from, amount);\n        emit LegacyTokenConverted(msg.sender, from, amount);\n    }\n\n    /* Helper function for UI.\n        Returns max lock amount based on minLockAmount, interestPt, using LTD params & interestEarnedAccount balance */\n    function getMaxLockAmount(uint minLockAmount, uint interestPt) external view returns (uint maxLock) {\n        uint allowedByEarning = augmintToken.balanceOf(address(interestEarnedAccount)).mul(PERCENT_100).div(interestPt);\n        uint allowedByLtd = getMaxLockAmountAllowedByLtd();\n        maxLock = allowedByEarning < allowedByLtd ? allowedByEarning : allowedByLtd;\n        maxLock = maxLock < minLockAmount ? 0 : maxLock;\n    }\n\n    /* Helper function for UI.\n        Returns max loan amount based on minLoanAmont using LTD params */\n    function getMaxLoanAmount(uint minLoanAmount) external view returns (uint maxLoan) {\n        uint allowedByLtd = getMaxLoanAmountAllowedByLtd();\n        maxLoan = allowedByLtd < minLoanAmount ? 0 : allowedByLtd;\n    }\n\n    /* returns maximum lockable token amount allowed by LTD params. */\n    function getMaxLockAmountAllowedByLtd() public view returns(uint maxLockByLtd) {\n        uint allowedByLtdDifferencePt = totalLoanAmount.mul(PERCENT_100).div(PERCENT_100\n                                            .sub(ltdParams.lockDifferenceLimit));\n        allowedByLtdDifferencePt = totalLockedAmount >= allowedByLtdDifferencePt ?\n                                        0 : allowedByLtdDifferencePt.sub(totalLockedAmount);\n\n        uint allowedByLtdDifferenceAmount =\n            totalLockedAmount >= totalLoanAmount.add(ltdParams.allowedDifferenceAmount) ?\n                0 : totalLoanAmount.add(ltdParams.allowedDifferenceAmount).sub(totalLockedAmount);\n\n        maxLockByLtd = allowedByLtdDifferencePt > allowedByLtdDifferenceAmount ?\n                                        allowedByLtdDifferencePt : allowedByLtdDifferenceAmount;\n    }\n\n    /* returns maximum borrowable token amount allowed by LTD params */\n    function getMaxLoanAmountAllowedByLtd() public view returns(uint maxLoanByLtd) {\n        uint allowedByLtdDifferencePt = totalLockedAmount.mul(ltdParams.loanDifferenceLimit.add(PERCENT_100))\n                                            .div(PERCENT_100);\n        allowedByLtdDifferencePt = totalLoanAmount >= allowedByLtdDifferencePt ?\n                                        0 : allowedByLtdDifferencePt.sub(totalLoanAmount);\n\n        uint allowedByLtdDifferenceAmount =\n            totalLoanAmount >= totalLockedAmount.add(ltdParams.allowedDifferenceAmount) ?\n                0 : totalLockedAmount.add(ltdParams.allowedDifferenceAmount).sub(totalLoanAmount);\n\n        maxLoanByLtd = allowedByLtdDifferencePt > allowedByLtdDifferenceAmount ?\n                                        allowedByLtdDifferencePt : allowedByLtdDifferenceAmount;\n    }\n}\n\n// File: contracts/Locker.sol\n\n/* contract for tracking locked funds\n\n requirements\n  -> lock funds\n  -> unlock funds\n  -> index locks by address\n\n For flows see: https://github.com/Augmint/augmint-contracts/blob/master/docs/lockFlow.png\n\n TODO / think about:\n  -> self-destruct function?\n\n*/\n\npragma solidity 0.4.24;\n\n\n\n\n\n\n\ncontract Locker is Restricted, TokenReceiver {\n\n    using SafeMath for uint256;\n\n    event NewLockProduct(uint32 indexed lockProductId, uint32 perTermInterest, uint32 durationInSecs,\n                    uint32 minimumLockAmount, bool isActive);\n\n    event LockProductActiveChange(uint32 indexed lockProductId, bool newActiveState);\n\n    // NB: amountLocked includes the original amount, plus interest\n    event NewLock(address indexed lockOwner, uint lockId, uint amountLocked, uint interestEarned,\n                    uint40 lockedUntil, uint32 perTermInterest, uint32 durationInSecs);\n\n    event LockReleased(address indexed lockOwner, uint lockId);\n\n    event MonetarySupervisorChanged(MonetarySupervisor newMonetarySupervisor);\n\n    struct LockProduct {\n        // perTermInterest is in millionths (i.e. 1,000,000 = 100%):\n        uint32 perTermInterest;\n        uint32 durationInSecs;\n        uint32 minimumLockAmount;\n        bool isActive;\n    }\n\n    /* NB: we don't need to store lock parameters because lockProducts can't be altered (only disabled/enabled) */\n    struct Lock {\n        uint amountLocked;\n        address owner;\n        uint32 productId;\n        uint40 lockedUntil;\n        bool isActive;\n    }\n\n    AugmintTokenInterface public augmintToken;\n    MonetarySupervisor public monetarySupervisor;\n\n    LockProduct[] public lockProducts;\n\n    Lock[] public locks;\n\n    // lock ids for an account\n    mapping(address => uint[]) public accountLocks;\n\n    constructor(address permissionGranterContract, AugmintTokenInterface _augmintToken,\n                    MonetarySupervisor _monetarySupervisor)\n    public Restricted(permissionGranterContract) {\n        augmintToken = _augmintToken;\n        monetarySupervisor = _monetarySupervisor;\n\n    }\n\n    function addLockProduct(uint32 perTermInterest, uint32 durationInSecs, uint32 minimumLockAmount, bool isActive)\n    external restrict(\"StabilityBoard\") {\n        uint _newLockProductId = lockProducts.push(\n                                    LockProduct(perTermInterest, durationInSecs, minimumLockAmount, isActive)) - 1;\n        uint32 newLockProductId = uint32(_newLockProductId);\n        require(newLockProductId == _newLockProductId, \"lockProduct overflow\");\n        emit NewLockProduct(newLockProductId, perTermInterest, durationInSecs, minimumLockAmount, isActive);\n    }\n\n    function setLockProductActiveState(uint32 lockProductId, bool isActive) external restrict(\"StabilityBoard\") {\n        // next line would revert but require to emit reason:\n        require(lockProductId < lockProducts.length, \"invalid lockProductId\");\n\n        lockProducts[lockProductId].isActive = isActive;\n        emit LockProductActiveChange(lockProductId, isActive);\n    }\n\n    /* lock funds, called from AugmintToken's transferAndNotify\n     Flow for locking tokens:\n        1) user calls token contract's transferAndNotify lockProductId passed in data arg\n        2) transferAndNotify transfers tokens to the Lock contract\n        3) transferAndNotify calls Lock.transferNotification with lockProductId\n    */\n    function transferNotification(address from, uint256 amountToLock, uint _lockProductId) external {\n        require(msg.sender == address(augmintToken), \"msg.sender must be augmintToken\");\n        // next line would revert but require to emit reason:\n        require(_lockProductId < lockProducts.length, \"invalid lockProductId\");\n        uint32 lockProductId = uint32(_lockProductId);\n        /* TODO: make data arg generic bytes\n            uint productId;\n            assembly { // solhint-disable-line no-inline-assembly\n                productId := mload(data)\n        } */\n        _createLock(lockProductId, from, amountToLock);\n    }\n\n    function releaseFunds(uint lockId) external {\n        // next line would revert but require to emit reason:\n        require(lockId < locks.length, \"invalid lockId\");\n        Lock storage lock = locks[lockId];\n        LockProduct storage lockProduct = lockProducts[lock.productId];\n\n        require(lock.isActive, \"lock must be in active state\");\n        require(now >= lock.lockedUntil, \"current time must be later than lockedUntil\");\n\n        lock.isActive = false;\n\n        uint interestEarned = calculateInterest(lockProduct.perTermInterest, lock.amountLocked);\n\n        monetarySupervisor.releaseFundsNotification(lock.amountLocked); // to maintain totalLockAmount\n        augmintToken.transferWithNarrative(lock.owner, lock.amountLocked.add(interestEarned),\n                                                                                \"Funds released from lock\");\n\n        emit LockReleased(lock.owner, lockId);\n    }\n\n    function setMonetarySupervisor(MonetarySupervisor newMonetarySupervisor) external restrict(\"StabilityBoard\") {\n        monetarySupervisor = newMonetarySupervisor;\n        emit MonetarySupervisorChanged(newMonetarySupervisor);\n    }\n\n    function getLockProductCount() external view returns (uint) {\n        return lockProducts.length;\n    }\n\n    // returns <chunkSize> lock products starting from some <offset>\n    // lock products are encoded as [ perTermInterest, durationInSecs, minimumLockAmount, maxLockAmount, isActive ]\n    function getLockProducts(uint offset, uint16 chunkSize)\n    external view returns (uint[5][]) {\n        uint limit = SafeMath.min(offset.add(chunkSize), lockProducts.length);\n        uint[5][] memory response = new uint[5][](limit.sub(offset));\n\n        for (uint i = offset; i < limit; i++) {\n            LockProduct storage lockProduct = lockProducts[i];\n            response[i - offset] = [lockProduct.perTermInterest, lockProduct.durationInSecs, lockProduct.minimumLockAmount,\n                        monetarySupervisor.getMaxLockAmount(lockProduct.minimumLockAmount, lockProduct.perTermInterest),\n                        lockProduct.isActive ? 1 : 0 ];\n        }\n        return response;\n    }\n\n    function getLockCount() external view returns (uint) {\n        return locks.length;\n    }\n\n    function getLockCountForAddress(address lockOwner) external view returns (uint) {\n        return accountLocks[lockOwner].length;\n    }\n\n    // returns <chunkSize> locks starting from some <offset>\n    // lock products are encoded as\n    //       [lockId, owner, amountLocked, interestEarned, lockedUntil, perTermInterest, durationInSecs, isActive ]\n    // NB: perTermInterest is in millionths (i.e. 1,000,000 = 100%):\n    function getLocks(uint offset, uint16 chunkSize)\n    external view returns (uint[8][]) {\n        uint limit = SafeMath.min(offset.add(chunkSize), locks.length);\n        uint[8][] memory response = new uint[8][](limit.sub(offset));\n\n        for (uint i = offset; i < limit; i++) {\n            Lock storage lock = locks[i];\n            LockProduct storage lockProduct = lockProducts[lock.productId];\n            uint interestEarned = calculateInterest(lockProduct.perTermInterest, lock.amountLocked);\n\n            response[i - offset] = [uint(i), uint(lock.owner), lock.amountLocked, interestEarned, lock.lockedUntil,\n                        lockProduct.perTermInterest, lockProduct.durationInSecs, lock.isActive ? 1 : 0];\n        }\n        return response;\n    }\n\n    // returns <chunkSize> locks of a given account, starting from some <offset>\n    // lock products are encoded as\n    //             [lockId, amountLocked, interestEarned, lockedUntil, perTermInterest, durationInSecs, isActive ]\n    function getLocksForAddress(address lockOwner, uint offset, uint16 chunkSize)\n    external view returns (uint[7][]) {\n        uint[] storage locksForAddress = accountLocks[lockOwner];\n        uint limit = SafeMath.min(offset.add(chunkSize), locksForAddress.length);\n        uint[7][] memory response = new uint[7][](limit.sub(offset));\n\n        for (uint i = offset; i < limit; i++) {\n            Lock storage lock = locks[locksForAddress[i]];\n            LockProduct storage lockProduct = lockProducts[lock.productId];\n\n            uint interestEarned = calculateInterest(lockProduct.perTermInterest, lock.amountLocked);\n\n            response[i - offset] = [locksForAddress[i], lock.amountLocked, interestEarned, lock.lockedUntil,\n                        lockProduct.perTermInterest, lockProduct.durationInSecs, lock.isActive ? 1 : 0 ];\n        }\n        return response;\n    }\n\n    function calculateInterest(uint32 perTermInterest, uint amountToLock) public pure returns (uint interestEarned) {\n        interestEarned = amountToLock.mul(perTermInterest).ceilDiv(1000000);\n    }\n\n    // Internal function. assumes amountToLock is already transferred to this Lock contract\n    function _createLock(uint32 lockProductId, address lockOwner, uint amountToLock) internal {\n        LockProduct storage lockProduct = lockProducts[lockProductId];\n        require(lockProduct.isActive, \"lockProduct must be in active state\");\n        require(amountToLock >= lockProduct.minimumLockAmount, \"amountToLock must be >= minimumLockAmount\");\n\n        uint interestEarned = calculateInterest(lockProduct.perTermInterest, amountToLock);\n        uint expiration = now.add(lockProduct.durationInSecs);\n        uint40 lockedUntil = uint40(expiration);\n        require(lockedUntil == expiration, \"lockedUntil overflow\");\n\n        uint lockId = locks.push(Lock(amountToLock, lockOwner, lockProductId, lockedUntil, true)) - 1;\n        accountLocks[lockOwner].push(lockId);\n\n        monetarySupervisor.requestInterest(amountToLock, interestEarned); // update KPIs & transfer interest here\n\n        emit NewLock(lockOwner, lockId, amountToLock, interestEarned, lockedUntil, lockProduct.perTermInterest,\n                    lockProduct.durationInSecs);\n    }\n}",
  "bytecode": "608060405234801561001057600080fd5b506040516060806130dc83398101806040528101908080519060200190929190805190602001909291908051906020019092919050505082600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1614151515610113576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260258152602001807f7065726d697373696f6e4772616e746572436f6e7472616374206d757374206281526020017f652073657400000000000000000000000000000000000000000000000000000081525060400191505060405180910390fd5b60016000808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060007f5065726d697373696f6e4772616e74657200000000000000000000000000000060001916815260200190815260200160002060006101000a81548160ff0219169083151502179055508073ffffffffffffffffffffffffffffffffffffffff167fc65937e3dbcb9fb30f646815dd67a3dbd09ba17718cbcb54efbe3635f8e0a6fe60405180807f5065726d697373696f6e4772616e746572000000000000000000000000000000815250602001905060405180910390a25081600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555080600260006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550505050612e3a806102a26000396000f300608060405260043610610128576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806314f6c8da1461012d578063169f66df146101ab578063277a68891461020257806327b3f030146102535780634d68282f146103065780634de16053146103335780635b2255261461035e5780635fe07013146103c757806364e7e4a414610418578063700b12291461046f5780637b9b9c89146105425780637ea469931461059957806389952c891461061f57806390f549ba1461066257806394493c43146106b95780639ac3317b146106e4578063c29ab95b1461076a578063c3b75b8f146107cb578063c57c3bbd1461080a578063db956a4414610869578063f38a82621461091c578063f4dadc611461096d575b600080fd5b34801561013957600080fd5b5061015860048036038101908080359060200190929190505050610a14565b604051808563ffffffff1663ffffffff1681526020018463ffffffff1663ffffffff1681526020018363ffffffff1663ffffffff1681526020018215151515815260200194505050505060405180910390f35b3480156101b757600080fd5b506101c0610a8c565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34801561020e57600080fd5b5061023d600480360381019080803563ffffffff16906020019092919080359060200190929190505050610ab2565b6040518082815260200191505060405180910390f35b34801561025f57600080fd5b5061028c60048036038101908080359060200190929190803561ffff169060200190929190505050610aea565b60405180806020018281038252838181518152602001915080516000925b818410156102f557828490602001906020020151600560200280838360005b838110156102e45780820151818401526020810190506102c9565b5050505090500192600101926102aa565b925050509250505060405180910390f35b34801561031257600080fd5b5061033160048036038101908080359060200190929190505050610d66565b005b34801561033f57600080fd5b50610348611231565b6040518082815260200191505060405180910390f35b34801561036a57600080fd5b506103ad600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803560001916906020019092919050505061123e565b604051808215151515815260200191505060405180910390f35b3480156103d357600080fd5b50610416600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803560001916906020019092919050505061126d565b005b34801561042457600080fd5b5061046d600480360381019080803573ffffffffffffffffffffffffffffffffffffffff1690602001909291908035906020019092919080359060200190929190505050611452565b005b34801561047b57600080fd5b506104c8600480360381019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919080359060200190929190803561ffff1690602001909291905050506115a9565b60405180806020018281038252838181518152602001915080516000925b8184101561053157828490602001906020020151600760200280838360005b83811015610520578082015181840152602081019050610505565b5050505090500192600101926104e6565b925050509250505060405180910390f35b34801561054e57600080fd5b50610557611805565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b3480156105a557600080fd5b5061061d600480360381019080803573ffffffffffffffffffffffffffffffffffffffff1690602001909291908035906020019082018035906020019080806020026020016040519081016040528093929190818152602001838360200280828437820191505050505050919291929050505061182b565b005b34801561062b57600080fd5b50610660600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050611873565b005b34801561066e57600080fd5b506106a3600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050611a15565b6040518082815260200191505060405180910390f35b3480156106c557600080fd5b506106ce611a61565b6040518082815260200191505060405180910390f35b3480156106f057600080fd5b50610768600480360381019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919080359060200190820180359060200190808060200260200160405190810160405280939291908181526020018383602002808284378201915050505050509192919290505050611a6e565b005b34801561077657600080fd5b506107b5600480360381019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919080359060200190929190505050611bd1565b6040518082815260200191505060405180910390f35b3480156107d757600080fd5b50610808600480360381019080803563ffffffff169060200190929190803515159060200190929190505050611c01565b005b34801561081657600080fd5b50610867600480360381019080803563ffffffff169060200190929190803563ffffffff169060200190929190803563ffffffff169060200190929190803515159060200190929190505050611dfe565b005b34801561087557600080fd5b506108a260048036038101908080359060200190929190803561ffff1690602001909291905050506120fd565b60405180806020018281038252838181518152602001915080516000925b8184101561090b57828490602001906020020151600860200280838360005b838110156108fa5780820151818401526020810190506108df565b5050505090500192600101926108c0565b925050509250505060405180910390f35b34801561092857600080fd5b5061096b600480360381019080803573ffffffffffffffffffffffffffffffffffffffff1690602001909291908035600019169060200190929190505050612327565b005b34801561097957600080fd5b506109986004803603810190808035906020019092919050505061250c565b604051808681526020018573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018463ffffffff1663ffffffff1681526020018364ffffffffff1664ffffffffff168152602001821515151581526020019550505050505060405180910390f35b600381815481101515610a2357fe5b906000526020600020016000915090508060000160009054906101000a900463ffffffff16908060000160049054906101000a900463ffffffff16908060000160089054906101000a900463ffffffff169080600001600c9054906101000a900460ff16905084565b600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b6000610ae2620f4240610ad48563ffffffff168561259f90919063ffffffff16565b61263e90919063ffffffff16565b905092915050565b606060006060600080610b18610b0d8761ffff16896126f490919063ffffffff16565b60038054905061277e565b9350610b2d878561279790919063ffffffff16565b604051908082528060200260200182016040528015610b6657816020015b610b53612da4565b815260200190600190039081610b4b5790505b5092508691505b83821015610d5957600382815481101515610b8457fe5b90600052602060002001905060a0604051908101604052808260000160009054906101000a900463ffffffff1663ffffffff1681526020018260000160049054906101000a900463ffffffff1663ffffffff1681526020018260000160089054906101000a900463ffffffff1663ffffffff168152602001600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663265b5d938460000160089054906101000a900463ffffffff168560000160009054906101000a900463ffffffff166040518363ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808363ffffffff1681526020018263ffffffff16815260200192505050602060405180830381600087803b158015610cc957600080fd5b505af1158015610cdd573d6000803e3d6000fd5b505050506040513d6020811015610cf357600080fd5b8101908080519060200190929190505050815260200182600001600c9054906101000a900460ff16610d26576000610d29565b60015b60ff1681525083888403815181101515610d3f57fe5b906020019060200201819052508180600101925050610b6d565b8294505050505092915050565b600080600060048054905084101515610de7576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252600e8152602001807f696e76616c6964206c6f636b496400000000000000000000000000000000000081525060200191505060405180910390fd5b600484815481101515610df657fe5b9060005260206000209060020201925060038360010160149054906101000a900463ffffffff1663ffffffff16815481101515610e2f57fe5b90600052602060002001915082600101601d9054906101000a900460ff161515610ec1576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601c8152602001807f6c6f636b206d75737420626520696e206163746976652073746174650000000081525060200191505060405180910390fd5b8260010160189054906101000a900464ffffffffff1664ffffffffff164210151515610f7b576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602b8152602001807f63757272656e742074696d65206d757374206265206c61746572207468616e2081526020017f6c6f636b6564556e74696c00000000000000000000000000000000000000000081525060400191505060405180910390fd5b600083600101601d6101000a81548160ff021916908315150217905550610fba8260000160009054906101000a900463ffffffff168460000154610ab2565b9050600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663295777be84600001546040518263ffffffff167c010000000000000000000000000000000000000000000000000000000002815260040180828152602001915050600060405180830381600087803b15801561105157600080fd5b505af1158015611065573d6000803e3d6000fd5b50505050600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663ffdcf0958460010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff166110e38487600001546126f490919063ffffffff16565b6040518363ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200182815260200180602001828103825260188152602001807f46756e64732072656c65617365642066726f6d206c6f636b00000000000000008152506020019350505050600060405180830381600087803b1580156111a157600080fd5b505af11580156111b5573d6000803e3d6000fd5b505050508260010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff167f622ca42598ab680a7def4a7346e1963a82207cf42a5ddb8056ad62cfbda19b88856040518082815260200191505060405180910390a250505050565b6000600380549050905090565b60006020528160005260406000206020528060005260406000206000915091509054906101000a900460ff1681565b6000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060007f5065726d697373696f6e4772616e74657200000000000000000000000000000060001916815260200190815260200160002060009054906101000a900460ff161515611388576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260318152602001807f6d73672e73656e646572206d7573742068617665205065726d697373696f6e4781526020017f72616e746572207065726d697373696f6e00000000000000000000000000000081525060400191505060405180910390fd5b60008060008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000836000191660001916815260200190815260200160002060006101000a81548160ff0219169083151502179055508173ffffffffffffffffffffffffffffffffffffffff167f789770131846de4d1f28418f0f957cdf4fcabe5eccf70067083e20ecece69a348260405180826000191660001916815260200191505060405180910390a25050565b6000600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16141515611519576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601f8152602001807f6d73672e73656e646572206d757374206265206175676d696e74546f6b656e0081525060200191505060405180910390fd5b60038054905082101515611595576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260158152602001807f696e76616c6964206c6f636b50726f647563744964000000000000000000000081525060200191505060405180910390fd5b8190506115a381858561281c565b50505050565b60606000806060600080600080600560008c73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020965061161b6116118a61ffff168c6126f490919063ffffffff16565b888054905061277e565b95506116308a8761279790919063ffffffff16565b60405190808252806020026020018201604052801561166957816020015b611656612dc7565b81526020019060019003908161164e5790505b5094508993505b858410156117f4576004878581548110151561168857fe5b906000526020600020015481548110151561169f57fe5b9060005260206000209060020201925060038360010160149054906101000a900463ffffffff1663ffffffff168154811015156116d857fe5b9060005260206000200191506117068260000160009054906101000a900463ffffffff168460000154610ab2565b905060e060405190810160405280888681548110151561172257fe5b90600052602060002001548152602001846000015481526020018281526020018460010160189054906101000a900464ffffffffff1664ffffffffff1681526020018360000160009054906101000a900463ffffffff1663ffffffff1681526020018360000160049054906101000a900463ffffffff1663ffffffff16815260200184600101601d9054906101000a900460ff166117c15760006117c4565b60015b60ff16815250858b86038151811015156117da57fe5b906020019060200201819052508380600101945050611670565b849750505050505050509392505050565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60008082519150600090505b8181101561186d5761186084848381518110151561185157fe5b9060200190602002015161126d565b8080600101915050611837565b50505050565b7f53746162696c697479426f6172640000000000000000000000000000000000006000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000826000191660001916815260200190815260200160002060009054906101000a900460ff16151561196d576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601f8152602001807f6d73672e73656e646572206d7573742068617665207065726d697373696f6e0081525060200191505060405180910390fd5b81600260006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055507f230749e2d30c004ff4cbe604d7814ccdf13042c157f2690d47e2585997e470c082604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390a15050565b6000600560008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020805490509050919050565b6000600480549050905090565b6000806000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060007f5065726d697373696f6e4772616e74657200000000000000000000000000000060001916815260200190815260200160002060009054906101000a900460ff161515611b8c576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260318152602001807f6d73672e73656e646572206d7573742068617665205065726d697373696f6e4781526020017f72616e746572207065726d697373696f6e00000000000000000000000000000081525060400191505060405180910390fd5b82519150600090505b81811015611bcb57611bbe848483815181101515611baf57fe5b90602001906020020151612327565b8080600101915050611b95565b50505050565b600560205281600052604060002081815481101515611bec57fe5b90600052602060002001600091509150505481565b7f53746162696c697479426f6172640000000000000000000000000000000000006000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000826000191660001916815260200190815260200160002060009054906101000a900460ff161515611cfb576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601f8152602001807f6d73672e73656e646572206d7573742068617665207065726d697373696f6e0081525060200191505060405180910390fd5b6003805490508363ffffffff16101515611d7d576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260158152602001807f696e76616c6964206c6f636b50726f647563744964000000000000000000000081525060200191505060405180910390fd5b8160038463ffffffff16815481101515611d9357fe5b90600052602060002001600001600c6101000a81548160ff0219169083151502179055508263ffffffff167f8b86e3e2da15c800fc123a7c2555729cf7819f68bdf7d98a97a80c43d051bc9f83604051808215151515815260200191505060405180910390a2505050565b6000807f53746162696c697479426f6172640000000000000000000000000000000000006000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000826000191660001916815260200190815260200160002060009054906101000a900460ff161515611efb576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601f8152602001807f6d73672e73656e646572206d7573742068617665207065726d697373696f6e0081525060200191505060405180910390fd5b600160036080604051908101604052808a63ffffffff1681526020018963ffffffff1681526020018863ffffffff16815260200187151581525090806001815401808255809150509060018203906000526020600020016000909192909190915060008201518160000160006101000a81548163ffffffff021916908363ffffffff16021790555060208201518160000160046101000a81548163ffffffff021916908363ffffffff16021790555060408201518160000160086101000a81548163ffffffff021916908363ffffffff160217905550606082015181600001600c6101000a81548160ff0219169083151502179055505050039250829150828263ffffffff16141515612076576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260148152602001807f6c6f636b50726f64756374206f766572666c6f7700000000000000000000000081525060200191505060405180910390fd5b8163ffffffff167f1f8c90040d4429f522e53fbe964004b66d66b4fd7a31d87359d1813adc33568e88888888604051808563ffffffff1663ffffffff1681526020018463ffffffff1663ffffffff1681526020018363ffffffff1663ffffffff1681526020018215151515815260200194505050505060405180910390a250505050505050565b60606000606060008060008061212e6121238961ffff168b6126f490919063ffffffff16565b60048054905061277e565b9550612143898761279790919063ffffffff16565b60405190808252806020026020018201604052801561217c57816020015b612169612dea565b8152602001906001900390816121615790505b5094508893505b858410156123185760048481548110151561219a57fe5b9060005260206000209060020201925060038360010160149054906101000a900463ffffffff1663ffffffff168154811015156121d357fe5b9060005260206000200191506122018260000160009054906101000a900463ffffffff168460000154610ab2565b9050610100604051908101604052808581526020018460010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001846000015481526020018281526020018460010160189054906101000a900464ffffffffff1664ffffffffff1681526020018360000160009054906101000a900463ffffffff1663ffffffff1681526020018360000160049054906101000a900463ffffffff1663ffffffff16815260200184600101601d9054906101000a900460ff166122e55760006122e8565b60015b60ff16815250858a86038151811015156122fe57fe5b906020019060200201819052508380600101945050612183565b84965050505050505092915050565b6000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060007f5065726d697373696f6e4772616e74657200000000000000000000000000000060001916815260200190815260200160002060009054906101000a900460ff161515612442576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260318152602001807f6d73672e73656e646572206d7573742068617665205065726d697373696f6e4781526020017f72616e746572207065726d697373696f6e00000000000000000000000000000081525060400191505060405180910390fd5b60016000808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000836000191660001916815260200190815260200160002060006101000a81548160ff0219169083151502179055508173ffffffffffffffffffffffffffffffffffffffff167fc65937e3dbcb9fb30f646815dd67a3dbd09ba17718cbcb54efbe3635f8e0a6fe8260405180826000191660001916815260200191505060405180910390a25050565b60048181548110151561251b57fe5b90600052602060002090600202016000915090508060000154908060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060010160149054906101000a900463ffffffff16908060010160189054906101000a900464ffffffffff169080600101601d9054906101000a900460ff16905085565b600080828402905060008414806125c057508284828115156125bd57fe5b04145b1515612634576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252600c8152602001807f6d756c206f766572666c6f77000000000000000000000000000000000000000081525060200191505060405180910390fd5b8091505092915050565b600080821115156126b7576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260088152602001807f646976206279203000000000000000000000000000000000000000000000000081525060200191505060405180910390fd5b600082848115156126c457fe5b0614156126dc5781838115156126d657fe5b046126ec565b600182848115156126e957fe5b04015b905092915050565b6000808284019050838110151515612774576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252600c8152602001807f616464206f766572666c6f77000000000000000000000000000000000000000081525060200191505060405180910390fd5b8091505092915050565b600081831061278d578161278f565b825b905092915050565b6000828211151515612811576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252600d8152602001807f73756220756e646572666c6f770000000000000000000000000000000000000081525060200191505060405180910390fd5b818303905092915050565b600080600080600060038863ffffffff1681548110151561283957fe5b90600052602060002001945084600001600c9054906101000a900460ff1615156128f1576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260238152602001807f6c6f636b50726f64756374206d75737420626520696e2061637469766520737481526020017f617465000000000000000000000000000000000000000000000000000000000081525060400191505060405180910390fd5b8460000160089054906101000a900463ffffffff1663ffffffff1686101515156129a9576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260298152602001807f616d6f756e74546f4c6f636b206d757374206265203e3d206d696e696d756d4c81526020017f6f636b416d6f756e74000000000000000000000000000000000000000000000081525060400191505060405180910390fd5b6129c78560000160009054906101000a900463ffffffff1687610ab2565b93506129f68560000160049054906101000a900463ffffffff1663ffffffff16426126f490919063ffffffff16565b9250829150828264ffffffffff16141515612a79576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260148152602001807f6c6f636b6564556e74696c206f766572666c6f7700000000000000000000000081525060200191505060405180910390fd5b6001600460a0604051908101604052808981526020018a73ffffffffffffffffffffffffffffffffffffffff1681526020018b63ffffffff1681526020018564ffffffffff16815260200160011515815250908060018154018082558091505090600182039060005260206000209060020201600090919290919091506000820151816000015560208201518160010160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060408201518160010160146101000a81548163ffffffff021916908363ffffffff16021790555060608201518160010160186101000a81548164ffffffffff021916908364ffffffffff160217905550608082015181600101601d6101000a81548160ff0219169083151502179055505050039050600560008873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819080600181540180825580915050906001820390600052602060002001600090919290919091505550600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166364217bdf87866040518363ffffffff167c01000000000000000000000000000000000000000000000000000000000281526004018083815260200182815260200192505050600060405180830381600087803b158015612cbe57600080fd5b505af1158015612cd2573d6000803e3d6000fd5b505050508673ffffffffffffffffffffffffffffffffffffffff167fa69aa1880e9e76a4474a64a1bc8d02f6eb94abe59641a4d8e858b2c66c768dcf828887868a60000160009054906101000a900463ffffffff168b60000160049054906101000a900463ffffffff16604051808781526020018681526020018581526020018464ffffffffff1664ffffffffff1681526020018363ffffffff1663ffffffff1681526020018263ffffffff1663ffffffff168152602001965050505050505060405180910390a25050505050505050565b60a060405190810160405280600590602082028038833980820191505090505090565b60e060405190810160405280600790602082028038833980820191505090505090565b610100604051908101604052806008906020820280388339808201915050905050905600a165627a7a72305820550ac997da89567ccfb1b21fc648abb2875a72c2f639b6c693bd34e121e26d270029000000000000000000000000de36a8773531406dcbeffdfd3c7b89fced7a9f84000000000000000000000000c994a2deb02543db1f48688438b9903c4b305ce300000000000000000000000027484afe9e6c332fb07f21fac82d442ebe1d22c3",
  "constructorArguments": "000000000000000000000000de36a8773531406dcbeffdfd3c7b89fced7a9f84000000000000000000000000c994a2deb02543db1f48688438b9903c4b305ce300000000000000000000000027484afe9e6c332fb07f21fac82d442ebe1d22c3"
}