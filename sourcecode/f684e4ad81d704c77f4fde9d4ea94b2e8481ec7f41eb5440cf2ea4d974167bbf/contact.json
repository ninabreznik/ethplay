{
  "address": "0x45c5448b3dad405b2ab74b3199b73dee7b2a5e0d",
  "chain": "ETH",
  "chainID": 1,
  "verifier": "etherscan.io",
  "commonName": "",
  "contractName": "HAVesting",
  "compilerVersion": "v0.4.24+commit.e67f0147",
  "optimization": false,
  "runs": "200",
  "evmVersion": "default",
  "sourceCode": "/**\n *Submitted for verification at Etherscan.io on 2018-08-30\n*/\n\npragma solidity ^0.4.24;\n\n// File: openzeppelin-solidity/contracts/math/SafeMath.sol\n\n/**\n * @title SafeMath\n * @dev Math operations with safety checks that throw on error\n */\nlibrary SafeMath {\n\n  /**\n  * @dev Multiplies two numbers, throws on overflow.\n  */\n  function mul(uint256 _a, uint256 _b) internal pure returns (uint256 c) {\n    // Gas optimization: this is cheaper than asserting 'a' not being zero, but the\n    // benefit is lost if 'b' is also tested.\n    // See: https://github.com/OpenZeppelin/openzeppelin-solidity/pull/522\n    if (_a == 0) {\n      return 0;\n    }\n\n    c = _a * _b;\n    assert(c / _a == _b);\n    return c;\n  }\n\n  /**\n  * @dev Integer division of two numbers, truncating the quotient.\n  */\n  function div(uint256 _a, uint256 _b) internal pure returns (uint256) {\n    // assert(_b > 0); // Solidity automatically throws when dividing by 0\n    // uint256 c = _a / _b;\n    // assert(_a == _b * c + _a % _b); // There is no case in which this doesn't hold\n    return _a / _b;\n  }\n\n  /**\n  * @dev Subtracts two numbers, throws on overflow (i.e. if subtrahend is greater than minuend).\n  */\n  function sub(uint256 _a, uint256 _b) internal pure returns (uint256) {\n    assert(_b <= _a);\n    return _a - _b;\n  }\n\n  /**\n  * @dev Adds two numbers, throws on overflow.\n  */\n  function add(uint256 _a, uint256 _b) internal pure returns (uint256 c) {\n    c = _a + _b;\n    assert(c >= _a);\n    return c;\n  }\n}\n\n// File: openzeppelin-solidity/contracts/ownership/Ownable.sol\n\n/**\n * @title Ownable\n * @dev The Ownable contract has an owner address, and provides basic authorization control\n * functions, this simplifies the implementation of \"user permissions\".\n */\ncontract Ownable {\n  address public owner;\n\n\n  event OwnershipRenounced(address indexed previousOwner);\n  event OwnershipTransferred(\n    address indexed previousOwner,\n    address indexed newOwner\n  );\n\n\n  /**\n   * @dev The Ownable constructor sets the original `owner` of the contract to the sender\n   * account.\n   */\n  constructor() public {\n    owner = msg.sender;\n  }\n\n  /**\n   * @dev Throws if called by any account other than the owner.\n   */\n  modifier onlyOwner() {\n    require(msg.sender == owner);\n    _;\n  }\n\n  /**\n   * @dev Allows the current owner to relinquish control of the contract.\n   * @notice Renouncing to ownership will leave the contract without an owner.\n   * It will not be possible to call the functions with the `onlyOwner`\n   * modifier anymore.\n   */\n  function renounceOwnership() public onlyOwner {\n    emit OwnershipRenounced(owner);\n    owner = address(0);\n  }\n\n  /**\n   * @dev Allows the current owner to transfer control of the contract to a newOwner.\n   * @param _newOwner The address to transfer ownership to.\n   */\n  function transferOwnership(address _newOwner) public onlyOwner {\n    _transferOwnership(_newOwner);\n  }\n\n  /**\n   * @dev Transfers control of the contract to a newOwner.\n   * @param _newOwner The address to transfer ownership to.\n   */\n  function _transferOwnership(address _newOwner) internal {\n    require(_newOwner != address(0));\n    emit OwnershipTransferred(owner, _newOwner);\n    owner = _newOwner;\n  }\n}\n\n// File: openzeppelin-solidity/contracts/token/ERC20/ERC20Basic.sol\n\n/**\n * @title ERC20Basic\n * @dev Simpler version of ERC20 interface\n * See https://github.com/ethereum/EIPs/issues/179\n */\ncontract ERC20Basic {\n  function totalSupply() public view returns (uint256);\n  function balanceOf(address _who) public view returns (uint256);\n  function transfer(address _to, uint256 _value) public returns (bool);\n  event Transfer(address indexed from, address indexed to, uint256 value);\n}\n\n// File: openzeppelin-solidity/contracts/token/ERC20/ERC20.sol\n\n/**\n * @title ERC20 interface\n * @dev see https://github.com/ethereum/EIPs/issues/20\n */\ncontract ERC20 is ERC20Basic {\n  function allowance(address _owner, address _spender)\n    public view returns (uint256);\n\n  function transferFrom(address _from, address _to, uint256 _value)\n    public returns (bool);\n\n  function approve(address _spender, uint256 _value) public returns (bool);\n  event Approval(\n    address indexed owner,\n    address indexed spender,\n    uint256 value\n  );\n}\n\n// File: openzeppelin-solidity/contracts/token/ERC20/SafeERC20.sol\n\n/**\n * @title SafeERC20\n * @dev Wrappers around ERC20 operations that throw on failure.\n * To use this library you can add a `using SafeERC20 for ERC20;` statement to your contract,\n * which allows you to call the safe operations as `token.safeTransfer(...)`, etc.\n */\nlibrary SafeERC20 {\n  function safeTransfer(\n    ERC20Basic _token,\n    address _to,\n    uint256 _value\n  )\n    internal\n  {\n    require(_token.transfer(_to, _value));\n  }\n\n  function safeTransferFrom(\n    ERC20 _token,\n    address _from,\n    address _to,\n    uint256 _value\n  )\n    internal\n  {\n    require(_token.transferFrom(_from, _to, _value));\n  }\n\n  function safeApprove(\n    ERC20 _token,\n    address _spender,\n    uint256 _value\n  )\n    internal\n  {\n    require(_token.approve(_spender, _value));\n  }\n}\n\n// File: contracts/HAVesting.sol\n\ncontract HAVesting is Ownable {\n  using SafeMath for uint;\n  using SafeERC20 for ERC20;\n\n    // HA Token contract.\n    ERC20 public token;\n\n    // Vesting grant for a speicifc holder.\n    struct Grant {\n        uint value;\n        uint start;\n        uint cliff;\n        uint end;\n        uint installmentLength; // In seconds.\n        uint transferred;\n        bool revokable;\n    }\n\n    // Holder to grant information mapping.\n    mapping (address => Grant) public grants;\n\n    // Total tokens available for vesting.\n    uint public totalVesting;\n\n    event NewGrant(address indexed _from, address indexed _to, uint _value);\n    event TokensUnlocked(address indexed _to, uint _value);\n    event GrantRevoked(address indexed _holder, uint _refund);\n\n    /// @dev Constructor that initializes the address of the HA token contract.\n    /// @param _token ERC20 The address of the previously deployed HA token contract.\n    constructor(ERC20 _token) public {\n        require(_token != address(0));\n\n        token = _token;\n    }\n\n    /// @dev Grant tokens to a specified address.\n    /// @param _to address The holder address.\n    /// @param _value uint The amount of tokens to be granted.\n    /// @param _start uint The beginning of the vesting period.\n    /// @param _cliff uint Duration of the cliff period (when the first installment is made).\n    /// @param _end uint The end of the vesting period.\n    /// @param _installmentLength uint The length of each vesting installment (in seconds).\n    /// @param _revokable bool Whether the grant is revokable or not.\n    function grantTo(address _to, uint _value, uint _start, uint _cliff, uint _end,\n        uint _installmentLength, bool _revokable)\n        external onlyOwner {\n\n        require(_to != address(0));\n        require(_to != address(this)); // Don't allow holder to be this contract.\n        require(_value > 0);\n\n        // Require that every holder can be granted tokens only once.\n        require(grants[_to].value == 0);\n\n        // Require for time ranges to be consistent and valid.\n        require(_start <= _cliff && _cliff <= _end);\n\n        // Require installment length to be valid and no longer than (end - start).\n        require(_installmentLength > 0 && _installmentLength <= _end.sub(_start));\n\n        // Grant must not exceed the total amount of tokens currently available for vesting.\n        require(totalVesting.add(_value) <= token.balanceOf(address(this)));\n\n        // Assign a new grant.\n        grants[_to] = Grant({\n            value: _value,\n            start: _start,\n            cliff: _cliff,\n            end: _end,\n            installmentLength: _installmentLength,\n            transferred: 0,\n            revokable: _revokable\n        });\n\n        // Since tokens have been granted, reduce the total amount available for vesting.\n        totalVesting = totalVesting.add(_value);\n\n        emit NewGrant(msg.sender, _to, _value);\n    }\n\n    /// @dev Revoke the grant of tokens of a specifed address.\n    /// @param _holder The address which will have its tokens revoked.\n    function revoke(address _holder) public onlyOwner {\n        Grant memory grant = grants[_holder];\n\n        // Grant must be revokable.\n        require(grant.revokable);\n\n        // Calculate amount of remaining tokens that are still available to be\n        // returned to owner.\n        uint refund = grant.value.sub(grant.transferred);\n\n        // Remove grant information.\n        delete grants[_holder];\n\n        // Update total vesting amount and transfer previously calculated tokens to owner.\n        totalVesting = totalVesting.sub(refund);\n        token.transfer(msg.sender, refund);\n\n        emit GrantRevoked(_holder, refund);\n    }\n\n    /// @dev Calculate the total amount of vested tokens of a holder at a given time.\n    /// @param _holder address The address of the holder.\n    /// @param _time uint The specific time to calculate against.\n    /// @return a uint Representing a holder's total amount of vested tokens.\n    function vestedTokens(address _holder, uint _time) external constant returns (uint) {\n        Grant memory grant = grants[_holder];\n        if (grant.value == 0) {\n            return 0;\n        }\n\n        return calculateVestedTokens(grant, _time);\n    }\n\n    /// @dev Calculate amount of vested tokens at a specifc time.\n    /// @param _grant Grant The vesting grant.\n    /// @param _time uint The time to be checked\n    /// @return a uint Representing the amount of vested tokens of a specific grant.\n    function calculateVestedTokens(Grant _grant, uint _time) internal pure returns (uint) {\n        // If we're before the cliff, then nothing is vested.\n        if (_time < _grant.cliff) {\n            return 0;\n        }\n\n        // If we're after the end of the vesting period - everything is vested;\n        if (_time >= _grant.end) {\n            return _grant.value;\n        }\n\n        // Calculate amount of installments past until now.\n        //\n        // NOTE result gets floored because of integer division.\n        uint installmentsPast = _time.sub(_grant.start).div(_grant.installmentLength);\n\n        // Calculate amount of days in entire vesting period.\n        uint vestingDays = _grant.end.sub(_grant.start);\n\n        // Calculate and return installments that have passed according to vesting days that have passed.\n        return _grant.value.mul(installmentsPast.mul(_grant.installmentLength)).div(vestingDays);\n    }\n\n    /// @dev Unlock vested tokens and transfer them to their holder.\n    /// @return a uint Representing the amount of vested tokens transferred to their holder.\n    function unlockVestedTokens() external {\n        Grant storage grant = grants[msg.sender];\n\n        // Require that there will be funds left in grant to tranfser to holder.\n        require(grant.value != 0);\n\n        // Get the total amount of vested tokens, acccording to grant.\n        uint vested = calculateVestedTokens(grant, now);\n        if (vested == 0) {\n            return;\n        }\n\n        // Make sure the holder doesn't transfer more than what he already has.\n        uint transferable = vested.sub(grant.transferred);\n        if (transferable == 0) {\n            return;\n        }\n\n        // Update transferred and total vesting amount, then transfer remaining vested funds to holder.\n        grant.transferred = grant.transferred.add(transferable);\n        totalVesting = totalVesting.sub(transferable);\n        token.transfer(msg.sender, transferable);\n\n        emit TokensUnlocked(msg.sender, transferable);\n    }\n}",
  "bytecode": "608060405234801561001057600080fd5b506040516020806113da83398101806040528101908080519060200190929190505050336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff16141515156100af57600080fd5b80600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550506112da806101006000396000f3006080604052600436106100a4576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff1680631a64adae146100a9578063715018a61461010a57806374a8f103146101215780637678f814146101645780637c17357d146101e557806383fcf973146102105780638da5cb5b14610227578063b869cea31461027e578063f2fde38b14610303578063fc0c546a14610346575b600080fd5b3480156100b557600080fd5b506100f4600480360381019080803573ffffffffffffffffffffffffffffffffffffffff1690602001909291908035906020019092919050505061039d565b6040518082815260200191505060405180910390f35b34801561011657600080fd5b5061011f610475565b005b34801561012d57600080fd5b50610162600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050610577565b005b34801561017057600080fd5b506101e3600480360381019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919080359060200190929190803590602001909291908035906020019092919080359060200190929190803590602001909291908035151590602001909291905050506108a2565b005b3480156101f157600080fd5b506101fa610c94565b6040518082815260200191505060405180910390f35b34801561021c57600080fd5b50610225610c9a565b005b34801561023357600080fd5b5061023c610f27565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34801561028a57600080fd5b506102bf600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050610f4c565b604051808881526020018781526020018681526020018581526020018481526020018381526020018215151515815260200197505050505050505060405180910390f35b34801561030f57600080fd5b50610344600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050610f9b565b005b34801561035257600080fd5b5061035b611002565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b60006103a761126e565b600260008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060e060405190810160405290816000820154815260200160018201548152602001600282015481526020016003820154815260200160048201548152602001600582015481526020016006820160009054906101000a900460ff1615151515815250509050600081600001511415610461576000915061046e565b61046b8184611028565b91505b5092915050565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156104d057600080fd5b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff167ff8df31144d9c2f0f6b59d69b8b98abd5459d07f2742c4df920b25aae33c6482060405160405180910390a260008060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550565b61057f61126e565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156105dc57600080fd5b600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060e060405190810160405290816000820154815260200160018201548152602001600282015481526020016003820154815260200160048201548152602001600582015481526020016006820160009054906101000a900460ff16151515158152505091508160c00151151561069057600080fd5b6106ab8260a0015183600001516110f190919063ffffffff16565b9050600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600080820160009055600182016000905560028201600090556003820160009055600482016000905560058201600090556006820160006101000a81549060ff02191690555050610748816003546110f190919063ffffffff16565b600381905550600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a9059cbb33836040518363ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200182815260200192505050602060405180830381600087803b15801561081357600080fd5b505af1158015610827573d6000803e3d6000fd5b505050506040513d602081101561083d57600080fd5b8101908080519060200190929190505050508273ffffffffffffffffffffffffffffffffffffffff167f740528a7c317c81f0923adc30df75db3f448298c78cdaf548adfcfdb3c84ff6f826040518082815260200191505060405180910390a2505050565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156108fd57600080fd5b600073ffffffffffffffffffffffffffffffffffffffff168773ffffffffffffffffffffffffffffffffffffffff161415151561093957600080fd5b3073ffffffffffffffffffffffffffffffffffffffff168773ffffffffffffffffffffffffffffffffffffffff161415151561097457600080fd5b60008611151561098357600080fd5b6000600260008973ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600001541415156109d457600080fd5b8385111580156109e45750828411155b15156109ef57600080fd5b600082118015610a115750610a0d85846110f190919063ffffffff16565b8211155b1515610a1c57600080fd5b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166370a08231306040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050602060405180830381600087803b158015610ad957600080fd5b505af1158015610aed573d6000803e3d6000fd5b505050506040513d6020811015610b0357600080fd5b8101908080519060200190929190505050610b298760035461110a90919063ffffffff16565b11151515610b3657600080fd5b60e06040519081016040528087815260200186815260200185815260200184815260200183815260200160008152602001821515815250600260008973ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082015181600001556020820151816001015560408201518160020155606082015181600301556080820151816004015560a0820151816005015560c08201518160060160006101000a81548160ff021916908315150217905550905050610c208660035461110a90919063ffffffff16565b6003819055508673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff167ffabf00c3717e5e33d6fcc433d4d70ef919a4101fb7d5c444fe349927034eaa45886040518082815260200191505060405180910390a350505050505050565b60035481565b6000806000600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002092506000836000015414151515610cf457600080fd5b610d618360e060405190810160405290816000820154815260200160018201548152602001600282015481526020016003820154815260200160048201548152602001600582015481526020016006820160009054906101000a900460ff16151515158152505042611028565b91506000821415610d7157610f22565b610d888360050154836110f190919063ffffffff16565b90506000811415610d9857610f22565b610daf81846005015461110a90919063ffffffff16565b8360050181905550610dcc816003546110f190919063ffffffff16565b600381905550600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a9059cbb33836040518363ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200182815260200192505050602060405180830381600087803b158015610e9757600080fd5b505af1158015610eab573d6000803e3d6000fd5b505050506040513d6020811015610ec157600080fd5b8101908080519060200190929190505050503373ffffffffffffffffffffffffffffffffffffffff167fe7b379c6c1fa169e9079c25e9143b127637eef8ec8c9d5c06ddb4ab3e1195888826040518082815260200191505060405180910390a25b505050565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60026020528060005260406000206000915090508060000154908060010154908060020154908060030154908060040154908060050154908060060160009054906101000a900460ff16905087565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16141515610ff657600080fd5b610fff81611126565b50565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b6000806000846040015184101561104257600092506110e9565b84606001518410151561105b57846000015192506110e9565b611088856080015161107a8760200151876110f190919063ffffffff16565b61122090919063ffffffff16565b91506110a5856020015186606001516110f190919063ffffffff16565b90506110e6816110d86110c588608001518661123690919063ffffffff16565b886000015161123690919063ffffffff16565b61122090919063ffffffff16565b92505b505092915050565b60008282111515156110ff57fe5b818303905092915050565b6000818301905082811015151561111d57fe5b80905092915050565b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff161415151561116257600080fd5b8073ffffffffffffffffffffffffffffffffffffffff166000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a3806000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050565b6000818381151561122d57fe5b04905092915050565b6000808314156112495760009050611268565b818302905081838281151561125a57fe5b0414151561126457fe5b8090505b92915050565b60e06040519081016040528060008152602001600081526020016000815260200160008152602001600081526020016000815260200160001515815250905600a165627a7a723058200513fef798bbc00f33ed196acd67fa40895e9561f436ffad8501e6fbc738456e0029000000000000000000000000f12946afa18de9d02fa3b0c0ea784978f0373745",
  "constructorArguments": "000000000000000000000000f12946afa18de9d02fa3b0c0ea784978f0373745"
}