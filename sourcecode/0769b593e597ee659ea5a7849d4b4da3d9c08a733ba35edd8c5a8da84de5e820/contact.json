{
  "address": "0x81c82c4dc43e9bd9c3cf24c2d7bc48c93b62d31f",
  "chain": "ETH",
  "chainID": 1,
  "verifier": "etherscan.io",
  "commonName": "",
  "contractName": "LikeChainRelayMain",
  "compilerVersion": "v0.4.25+commit.59dbf8f1",
  "optimization": true,
  "runs": "200",
  "evmVersion": "default",
  "sourceCode": "/**\n *Submitted for verification at Etherscan.io on 2019-04-16\n*/\n\n//    Copyright (C) 2018 LikeCoin Foundation Limited\n//\n//    This file is part of LikeCoin Smart Contract.\n//\n//    LikeCoin Smart Contract is free software: you can redistribute it and/or modify\n//    it under the terms of the GNU General Public License as published by\n//    the Free Software Foundation, either version 3 of the License, or\n//    (at your option) any later version.\n//\n//    LikeCoin Smart Contract is distributed in the hope that it will be useful,\n//    but WITHOUT ANY WARRANTY; without even the implied warranty of\n//    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n//    GNU General Public License for more details.\n//\n//    You should have received a copy of the GNU General Public License\n//    along with LikeCoin Smart Contract.  If not, see <http://www.gnu.org/licenses/>.\n\npragma solidity ^0.4.25;\n\n// Source: https://github.com/OpenZeppelin/openzeppelin-solidity/blob/5471fc808a17342d738853d7bf3e9e5ef3108074/contracts/token/ERC20/IERC20.sol\n// Copied here to avoid incompatibility with Solidity v0.5.x in latest master branch\n\n/**\n * @title ERC20 interface\n * @dev see https://github.com/ethereum/EIPs/issues/20\n */\ninterface IERC20 {\n    function totalSupply() external view returns (uint256);\n\n    function balanceOf(address who) external view returns (uint256);\n\n    function allowance(address owner, address spender) external view returns (uint256);\n\n    function transfer(address to, uint256 value) external returns (bool);\n\n    function approve(address spender, uint256 value) external returns (bool);\n\n    function transferFrom(address from, address to, uint256 value) external returns (bool);\n\n    event Transfer(address indexed from, address indexed to, uint256 value);\n\n    event Approval(address indexed owner, address indexed spender, uint256 value);\n}\n\n\ncontract LikeChainRelayLogicInterface {\n    function commitWithdrawHash(uint64 height, uint64 round, bytes _payload) public;\n    function updateValidator(address[] _newValidators, bytes _proof) public;\n    function withdraw(bytes _withdrawInfo, bytes _proof) public;\n    function upgradeLogicContract(address _newLogicContract, bytes _proof) public;\n    event Upgraded(uint256 _newLogicContractIndex, address _newLogicContract);\n}\n\ncontract LikeChainRelayState {\n    uint256 public logicContractIndex;\n    address public logicContract;\n\n    IERC20 public tokenContract;\n\n    address[] public validators;\n    \n    struct ValidatorInfo {\n        uint8 index;\n        uint32 power;\n    }\n    \n    mapping(address => ValidatorInfo) public validatorInfo;\n    uint256 public totalVotingPower;\n    uint public lastValidatorUpdateTime;\n\n    uint public latestBlockHeight;\n    bytes32 public latestWithdrawHash;\n\n    mapping(bytes32 => bool) public consumedIds;\n    mapping(bytes32 => bytes32) public reserved;\n}\n\ncontract LikeChainRelayMain is LikeChainRelayState, LikeChainRelayLogicInterface {\n    constructor(\n        address _logicContract,\n        address _tokenContract,\n        address[] _validators,\n        uint32[] _votingPowers\n    ) public {\n        uint len = _validators.length;\n        require(len > 0);\n        require(len < 256);\n        require(_votingPowers.length == len);\n        \n        logicContract = _logicContract;\n        logicContractIndex = 0;\n\n        for (uint8 i = 0; i < len; i += 1) {\n            address v = _validators[i];\n            require(validatorInfo[v].power == 0);\n            uint32 power = _votingPowers[i];\n            require(power > 0);\n            validators.push(v);\n            validatorInfo[v] = ValidatorInfo({\n                index: i,\n                power: power\n            });\n            totalVotingPower += power;\n        }\n        \n        tokenContract = IERC20(_tokenContract);\n    }\n\n    function commitWithdrawHash(uint64 /* height */, uint64 /* round */, bytes /* _payload */) public {\n        require(logicContract.delegatecall(msg.data));\n    }\n\n    function updateValidator(address[] /* _newValidators */, bytes /* _proof */) public {\n        require(logicContract.delegatecall(msg.data));\n    }\n\n    function withdraw(bytes /* _withdrawInfo */, bytes /* _proof */) public {\n        require(logicContract.delegatecall(msg.data));\n    }\n\n    function upgradeLogicContract(address /* _newLogicContract */, bytes /* _proof */) public {\n        require(logicContract.delegatecall(msg.data));\n    }\n}",
  "abi": "[{\"constant\":false,\"inputs\":[{\"name\":\"\",\"type\":\"address[]\"},{\"name\":\"\",\"type\":\"bytes\"}],\"name\":\"updateValidator\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"validators\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"latestWithdrawHash\",\"outputs\":[{\"name\":\"\",\"type\":\"bytes32\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"}],\"name\":\"validatorInfo\",\"outputs\":[{\"name\":\"index\",\"type\":\"uint8\"},{\"name\":\"power\",\"type\":\"uint32\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"\",\"type\":\"bytes\"},{\"name\":\"\",\"type\":\"bytes\"}],\"name\":\"withdraw\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"tokenContract\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"lastValidatorUpdateTime\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"totalVotingPower\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"\",\"type\":\"address\"},{\"name\":\"\",\"type\":\"bytes\"}],\"name\":\"upgradeLogicContract\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"bytes32\"}],\"name\":\"reserved\",\"outputs\":[{\"name\":\"\",\"type\":\"bytes32\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"\",\"type\":\"uint64\"},{\"name\":\"\",\"type\":\"uint64\"},{\"name\":\"\",\"type\":\"bytes\"}],\"name\":\"commitWithdrawHash\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"logicContract\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"logicContractIndex\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"bytes32\"}],\"name\":\"consumedIds\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"latestBlockHeight\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"name\":\"_logicContract\",\"type\":\"address\"},{\"name\":\"_tokenContract\",\"type\":\"address\"},{\"name\":\"_validators\",\"type\":\"address[]\"},{\"name\":\"_votingPowers\",\"type\":\"uint32[]\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"_newLogicContractIndex\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"_newLogicContract\",\"type\":\"address\"}],\"name\":\"Upgraded\",\"type\":\"event\"}]",
  "bytecode": "608060405234801561001057600080fd5b506040516107ae3803806107ae833981016040908152815160208301519183015160608401519084018051929490929101906000808080841161005257600080fd5b610100841061006057600080fd5b8451841461006d57600080fd5b60018054600160a060020a031916600160a060020a038a16179055600080805592505b838360ff1610156101d057858360ff168151811015156100ac57fe5b6020908102909101810151600160a060020a0381166000908152600490925260409091205490925063ffffffff61010090910416156100ea57600080fd5b848360ff168151811015156100fb57fe5b602090810290910101519050600063ffffffff82161161011a57600080fd5b6003805460018082019092557fc2575a0e9e593c00f959f8c92f12db2869c3395a3b0502d05e2516446f71f85b018054600160a060020a031916600160a060020a03851690811790915560408051808201825260ff878116825263ffffffff8681166020808501828152600097885260049091529490952092518354945160ff1990951692169190911764ffffffff00191661010093909116929092029190911790556005805490910190559290920191610090565b505060028054600160a060020a03909616600160a060020a03199096169590951790945550505050506105a6806102086000396000f3006080604052600436106100da5763ffffffff7c01000000000000000000000000000000000000000000000000000000006000350416632277e53a81146100df57806335aa2e44146101745780633cd3f6a7146101a85780634f1811dd146101cf57806350fbe2d91461021257806355a373d6146102a9578063568873ad146102be578063671b3793146102d35780637ed93957146102e8578063926988141461034f578063945ac86314610367578063cc0e97c9146103d7578063d889df34146103ec578063f21a211614610401578063f3f39ee51461042d575b600080fd5b3480156100eb57600080fd5b50604080516020600480358082013583810280860185019096528085526101729536959394602494938501929182918501908490808284375050604080516020601f89358b018035918201839004830284018301909452808352979a9998810197919650918201945092508291508401838280828437509497506104429650505050505050565b005b34801561018057600080fd5b5061018c600435610487565b60408051600160a060020a039092168252519081900360200190f35b3480156101b457600080fd5b506101bd6104af565b60408051918252519081900360200190f35b3480156101db57600080fd5b506101f0600160a060020a03600435166104b5565b6040805160ff909316835263ffffffff90911660208301528051918290030190f35b34801561021e57600080fd5b506040805160206004803580820135601f810184900484028501840190955284845261017294369492936024939284019190819084018382808284375050604080516020601f89358b018035918201839004830284018301909452808352979a9998810197919650918201945092508291508401838280828437509497506104429650505050505050565b3480156102b557600080fd5b5061018c6104d7565b3480156102ca57600080fd5b506101bd6104e6565b3480156102df57600080fd5b506101bd6104ec565b3480156102f457600080fd5b5060408051602060046024803582810135601f8101859004850286018501909652858552610172958335600160a060020a03169536956044949193909101919081908401838280828437509497506104429650505050505050565b34801561035b57600080fd5b506101bd6004356104f2565b34801561037357600080fd5b50604080516020600460443581810135601f810184900484028501840190955284845261017294823567ffffffffffffffff908116956024803590921695369594606494929301919081908401838280828437509497506105049650505050505050565b3480156103e357600080fd5b5061018c61054a565b3480156103f857600080fd5b506101bd610559565b34801561040d57600080fd5b5061041960043561055f565b604080519115158252519081900360200190f35b34801561043957600080fd5b506101bd610574565b600154604051600160a060020a0390911690600090369080838380828437820191505092505050600060405180830381855af4915050151561048357600080fd5b5050565b600380548290811061049557fe5b600091825260209091200154600160a060020a0316905081565b60085481565b60046020526000908152604090205460ff811690610100900463ffffffff1682565b600254600160a060020a031681565b60065481565b60055481565b600a6020526000908152604090205481565b600154604051600160a060020a0390911690600090369080838380828437820191505092505050600060405180830381855af4915050151561054557600080fd5b505050565b600154600160a060020a031681565b60005481565b60096020526000908152604090205460ff1681565b600754815600a165627a7a72305820bcf3dd2fdf1f2d48c0cbbfb2d66a11b4d050ae6ffbf8bd049e0d4049645e0a92002900000000000000000000000026135e15482b65845418e084f614bd340ddb3b8a00000000000000000000000002f61fd266da6e8b102d4121f5ce7b992640cf9800000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000160000000000000000000000000000000000000000000000000000000000000000600000000000000000000000062be52bd46aaeb2bdcd2d123478b1acbfb1d2346000000000000000000000000d2df2a279f931d57042440f694b27048f618b319000000000000000000000000db53bc6aa6cf634669e704c49568d18d539e830d0000000000000000000000001aef7c26e48e5ed83024bcb122931fb30a99d54b000000000000000000000000c6720a4b73ad41ab7147b8ac42eca62250d8fb9a00000000000000000000000049a116b7eda1a5eae5e56a4e285d4dbdfd18aa5e0000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000411a000000000000000000000000000000000000000000000000000000000000411a000000000000000000000000000000000000000000000000000000000000411a000000000000000000000000000000000000000000000000000000000000411a000000000000000000000000000000000000000000000000000000000000411a000000000000000000000000000000000000000000000000000000000000411e",
  "constructorArguments": "00000000000000000000000026135e15482b65845418e084f614bd340ddb3b8a00000000000000000000000002f61fd266da6e8b102d4121f5ce7b992640cf9800000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000160000000000000000000000000000000000000000000000000000000000000000600000000000000000000000062be52bd46aaeb2bdcd2d123478b1acbfb1d2346000000000000000000000000d2df2a279f931d57042440f694b27048f618b319000000000000000000000000db53bc6aa6cf634669e704c49568d18d539e830d0000000000000000000000001aef7c26e48e5ed83024bcb122931fb30a99d54b000000000000000000000000c6720a4b73ad41ab7147b8ac42eca62250d8fb9a00000000000000000000000049a116b7eda1a5eae5e56a4e285d4dbdfd18aa5e0000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000411a000000000000000000000000000000000000000000000000000000000000411a000000000000000000000000000000000000000000000000000000000000411a000000000000000000000000000000000000000000000000000000000000411a000000000000000000000000000000000000000000000000000000000000411a000000000000000000000000000000000000000000000000000000000000411e"
}