{
  "address": "0xdaa3117eac3126cb9eed79bc9f280b9102c51527",
  "chain": "ETH",
  "chainID": 1,
  "verifier": "etherscan.io",
  "commonName": "",
  "contractName": "OptionsEscrow",
  "compilerVersion": "v0.4.25+commit.59dbf8f1",
  "optimization": false,
  "runs": "200",
  "evmVersion": "default",
  "sourceCode": "/**\n *Submitted for verification at Etherscan.io on 2019-04-30\n*/\n\n/**\n * @title SafeMath\n * @dev Math operations with safety checks that throw on error\n */\nlibrary SafeMath {\n\n  /**\n  * @dev Multiplies two numbers, throws on overflow.\n  */\n  function mul(uint256 a, uint256 b) internal pure returns (uint256 c) {\n    // Gas optimization: this is cheaper than asserting 'a' not being zero, but the\n    // benefit is lost if 'b' is also tested.\n    // See: https://github.com/OpenZeppelin/openzeppelin-solidity/pull/522\n    if (a == 0) {\n      return 0;\n    }\n\n    c = a * b;\n    assert(c / a == b);\n    return c;\n  }\n\n  /**\n  * @dev Integer division of two numbers, truncating the quotient.\n  */\n  function div(uint256 a, uint256 b) internal pure returns (uint256) {\n    // assert(b > 0); // Solidity automatically throws when dividing by 0\n    // uint256 c = a / b;\n    // assert(a == b * c + a % b); // There is no case in which this doesn't hold\n    return a / b;\n  }\n\n  /**\n  * @dev Subtracts two numbers, throws on overflow (i.e. if subtrahend is greater than minuend).\n  */\n  function sub(uint256 a, uint256 b) internal pure returns (uint256) {\n    assert(b <= a);\n    return a - b;\n  }\n\n  /**\n  * @dev Adds two numbers, throws on overflow.\n  */\n  function add(uint256 a, uint256 b) internal pure returns (uint256 c) {\n    c = a + b;\n    assert(c >= a);\n    return c;\n  }\n}\n\n\n/**\n * @title Ownable\n * @dev The Ownable contract has an owner address, and provides basic authorization control\n * functions, this simplifies the implementation of \"user permissions\".\n */\ncontract Ownable {\n  address public owner;\n\n\n  event OwnershipRenounced(address indexed previousOwner);\n  event OwnershipTransferred(\n    address indexed previousOwner,\n    address indexed newOwner\n  );\n\n\n  /**\n   * @dev The Ownable constructor sets the original `owner` of the contract to the sender\n   * account.\n   */\n  constructor() public {\n    owner = msg.sender;\n  }\n\n  /**\n   * @dev Throws if called by any account other than the owner.\n   */\n  modifier onlyOwner() {\n    require(msg.sender == owner);\n    _;\n  }\n\n  /**\n   * @dev Allows the current owner to relinquish control of the contract.\n   */\n  function renounceOwnership() public onlyOwner {\n    emit OwnershipRenounced(owner);\n    owner = address(0);\n  }\n\n  /**\n   * @dev Allows the current owner to transfer control of the contract to a newOwner.\n   * @param _newOwner The address to transfer ownership to.\n   */\n  function transferOwnership(address _newOwner) public onlyOwner {\n    _transferOwnership(_newOwner);\n  }\n\n  /**\n   * @dev Transfers control of the contract to a newOwner.\n   * @param _newOwner The address to transfer ownership to.\n   */\n  function _transferOwnership(address _newOwner) internal {\n    require(_newOwner != address(0));\n    emit OwnershipTransferred(owner, _newOwner);\n    owner = _newOwner;\n  }\n}\n\n/**\n * @title ERC20\n * @dev ERC20 token interface\n */\n contract ERC20 {\n    string public name;\n    string public symbol;\n    uint8 public decimals;\n    function totalSupply() public constant returns (uint);\n    function balanceOf(address tokenOwner) public constant returns (uint balance);\n    function allowance(address tokenOwner, address spender) public constant returns (uint remaining);\n    function transfer(address to, uint tokens) public returns (bool success);\n    function approve(address spender, uint tokens) public returns (bool success);\n    function transferFrom(address from, address to, uint tokens) public returns (bool success);\n\n    event Transfer(address indexed from, address indexed to, uint tokens);\n    event Approval(address indexed tokenOwner, address indexed spender, uint tokens);\n }\n\n/**\n * @title OptionsEscrow\n * @dev Escrow that holds tokens for a beneficiary with various vesting schedules and strike prices\n * The contract owner may grant options and reclaim tokens from expired options.\n */\n\ncontract OptionsEscrow is Ownable {\n    using SafeMath for uint;\n\n    struct Option {\n        address beneficiary;\n        uint tokenAmount;\n        uint strikeMultiple;\n        uint128 vestUntil;\n        uint128 expiration;\n    }\n\n    address public token;\n    uint public issuedTokens;\n    uint64 public optionsCount;\n    mapping (address => Option) public grantedOptions;\n\n    event GrantOption(address indexed beneficiary, uint tokenAmount, uint strikeMultiple, uint128 vestUntil, uint128 expiration);\n    event ExerciseOption(address indexed beneficiary, uint exercisedAmount, uint strikeMultiple);\n    event ReclaimOption(address indexed beneficiary);\n\n    /**\n     * @dev Constructor.\n     * @param _token The token for which options are being granted.\n     */\n    constructor(address _token) public {\n        /* require(token != address(0)); */\n\n        token = _token;\n        issuedTokens = 0;\n        optionsCount = 0;\n    }\n\n    /**\n     * @dev Issue an option for a beneficiary with a custom amount, strike price, and vesting schedule\n     *      NOTE: the use of a strike multiple means that the token-to-wei ration must always be positive\n     *            this can be worked around be also adding a strikeDenomination\n     * @param _beneficiary The recipient of the option,\n     * @param _tokenAmount The amount of tokens available to be claimed\n     * @param _strikeMultiple The amount of tokens for each wei provided\n     * @param _vestUntil The timestamp (epoch in seconds) that the option becomes exercisable\n     * @param _expiration The timestamp (epoch in seconds) that the option is no longer exercisable\n     */\n    function issueOption(address _beneficiary,\n                            uint _tokenAmount,\n                            uint _strikeMultiple,\n                         uint128 _vestUntil,\n                         uint128 _expiration) onlyOwner public {\n        uint _issuedTokens = issuedTokens.add(_tokenAmount);\n\n        require(_tokenAmount > 0 &&\n                _expiration > _vestUntil &&\n                _vestUntil > block.timestamp &&\n                ERC20(token).balanceOf(this) > _issuedTokens);\n\n        Option memory option = Option(_beneficiary, _tokenAmount, _strikeMultiple, _vestUntil, _expiration);\n\n        grantedOptions[_beneficiary] = option;\n        optionsCount++;\n        issuedTokens = _issuedTokens;\n\n        emit GrantOption(_beneficiary, _tokenAmount, _strikeMultiple, _vestUntil, _expiration);\n    }\n\n    /**\n     * @dev Allows the beneficiary to exercise a vested option.\n     *      The option can be partially exercised.\n     */\n    function () public payable {\n        Option storage option = grantedOptions[msg.sender];\n\n        require(option.beneficiary == msg.sender &&\n                option.vestUntil <= block.timestamp &&\n                option.expiration > block.timestamp &&\n                option.tokenAmount > 0);\n\n        uint amountExercised = msg.value.mul(option.strikeMultiple);\n        if(amountExercised > option.tokenAmount) {\n            amountExercised = option.tokenAmount;\n        }\n\n        option.tokenAmount = option.tokenAmount.sub(amountExercised);\n        issuedTokens = issuedTokens.sub(amountExercised);\n        require(ERC20(token).transfer(msg.sender, amountExercised));\n\n        emit ExerciseOption(msg.sender, amountExercised, option.strikeMultiple);\n    }\n\n    /**\n     * @dev Allows the owner to reclaim tokens from a list of options that have expired\n     * @param beneficiaries An array of beneficiary addresses\n     */\n    function reclaimExpiredOptionTokens(address[] beneficiaries) public onlyOwner returns (uint reclaimedTokenAmount) {\n        reclaimedTokenAmount = 0;\n        for (uint i=0; i<beneficiaries.length; i++) {\n            Option storage option = grantedOptions[beneficiaries[i]];\n            if (option.expiration <= block.timestamp) {\n                reclaimedTokenAmount = reclaimedTokenAmount.add(option.tokenAmount);\n                option.tokenAmount = 0;\n\n                emit ReclaimOption(beneficiaries[i]);\n            }\n        }\n        issuedTokens = issuedTokens.sub(reclaimedTokenAmount);\n        require(ERC20(token).transfer(owner, reclaimedTokenAmount));\n    }\n\n    /**\n     * @dev Allows the owner to reclaim tokens that have not been issued\n     */\n    function reclaimUnissuedTokens() public onlyOwner returns (uint reclaimedTokenAmount) {\n        reclaimedTokenAmount = ERC20(token).balanceOf(this) - issuedTokens;\n        require(ERC20(token).transfer(owner, reclaimedTokenAmount));\n    }\n\n    /**\n     * @dev Allows the owner to withdraw eth from exercised options\n     */\n    function withdrawEth() public onlyOwner {\n        owner.transfer(address(this).balance);\n    }\n\n    /**\n     * @dev Constant getter to see details of an option\n     * @param _beneficiary The address of beneficiary\n     */\n    function getOption(address _beneficiary) public constant returns(address beneficiary,\n                                                          uint tokenAmount,\n                                                          uint strikeMultiple,\n                                                          uint128 vestUntil,\n                                                          uint128 expiration) {\n        Option memory option = grantedOptions[_beneficiary];\n        beneficiary = option.beneficiary;\n        tokenAmount = option.tokenAmount;\n        strikeMultiple = option.strikeMultiple;\n        vestUntil = option.vestUntil;\n        expiration = option.expiration;\n    }\n}",
  "bytecode": "608060405234801561001057600080fd5b506040516020806119c183398101806040528101908080519060200190929190505050336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555080600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060006002819055506000600360006101000a81548167ffffffffffffffff021916908367ffffffffffffffff160217905550506118cb806100f66000396000f3006080604052600436106100ba576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063029737c4146103b75780631a1dbabb146103e25780632c61fb15146104215780635a9ae4c014610508578063715018a6146105825780638da5cb5b14610599578063a0b5fab3146105f0578063a0ef91df1461067f578063b534b5b714610696578063f2fde38b146106c1578063fc0c546a14610704578063fde6c50d1461075b575b600080600460003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002091503373ffffffffffffffffffffffffffffffffffffffff168260000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614801561018f5750428260030160009054906101000a90046fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff1611155b80156101cc5750428260030160109054906101000a90046fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff16115b80156101dc575060008260010154115b15156101e757600080fd5b6101fe82600201543461084290919063ffffffff16565b9050816001015481111561021457816001015490505b61022b81836001015461087a90919063ffffffff16565b82600101819055506102488160025461087a90919063ffffffff16565b600281905550600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a9059cbb33836040518363ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200182815260200192505050602060405180830381600087803b15801561031357600080fd5b505af1158015610327573d6000803e3d6000fd5b505050506040513d602081101561033d57600080fd5b8101908080519060200190929190505050151561035957600080fd5b3373ffffffffffffffffffffffffffffffffffffffff167f330e8c700945f80f5d57be1c0a1aa494ee3d8a1bf374675a74713a1d752f6f16828460020154604051808381526020018281526020019250505060405180910390a25050005b3480156103c357600080fd5b506103cc610893565b6040518082815260200191505060405180910390f35b3480156103ee57600080fd5b506103f7610b1d565b604051808267ffffffffffffffff1667ffffffffffffffff16815260200191505060405180910390f35b34801561042d57600080fd5b50610462600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050610b37565b604051808673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001858152602001848152602001836fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff168152602001826fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff1681526020019550505050505060405180910390f35b34801561051457600080fd5b5061056c60048036038101908080359060200190820180359060200190808060200260200160405190810160405280939291908181526020018383602002808284378201915050505050509192919290505050610cbf565b6040518082815260200191505060405180910390f35b34801561058e57600080fd5b50610597610f9d565b005b3480156105a557600080fd5b506105ae61109f565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b3480156105fc57600080fd5b5061067d600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803590602001909291908035906020019092919080356fffffffffffffffffffffffffffffffff16906020019092919080356fffffffffffffffffffffffffffffffff1690602001909291905050506110c4565b005b34801561068b57600080fd5b50610694611522565b005b3480156106a257600080fd5b506106ab6115fe565b6040518082815260200191505060405180910390f35b3480156106cd57600080fd5b50610702600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050611604565b005b34801561071057600080fd5b5061071961166b565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34801561076757600080fd5b5061079c600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050611691565b604051808673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001858152602001848152602001836fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff168152602001826fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff1681526020019550505050505060405180910390f35b6000808314156108555760009050610874565b818302905081838281151561086657fe5b0414151561087057fe5b8090505b92915050565b600082821115151561088857fe5b818303905092915050565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156108f057600080fd5b600254600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166370a08231306040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050602060405180830381600087803b1580156109b057600080fd5b505af11580156109c4573d6000803e3d6000fd5b505050506040513d60208110156109da57600080fd5b8101908080519060200190929190505050039050600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a9059cbb6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff16836040518363ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200182815260200192505050602060405180830381600087803b158015610ad457600080fd5b505af1158015610ae8573d6000803e3d6000fd5b505050506040513d6020811015610afe57600080fd5b81019080805190602001909291905050501515610b1a57600080fd5b90565b600360009054906101000a900467ffffffffffffffff1681565b6000806000806000610b47611835565b600460008873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060a060405190810160405290816000820160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200160018201548152602001600282015481526020016003820160009054906101000a90046fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff1681526020016003820160109054906101000a90046fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff1681525050905080600001519550806020015194508060400151935080606001519250806080015191505091939590929450565b60008060008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16141515610d1f57600080fd5b60009250600091505b8351821015610e4f57600460008584815181101515610d4357fe5b9060200190602002015173ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000209050428160030160109054906101000a90046fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff16111515610e4257610ddb81600101548461171f90919063ffffffff16565b9250600081600101819055508382815181101515610df557fe5b9060200190602002015173ffffffffffffffffffffffffffffffffffffffff167f15a33a6be432010435089fb48859b6bf666a1ab6a8587937f087b6eca6cfeb7e60405160405180910390a25b8180600101925050610d28565b610e648360025461087a90919063ffffffff16565b600281905550600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a9059cbb6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff16856040518363ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200182815260200192505050602060405180830381600087803b158015610f5057600080fd5b505af1158015610f64573d6000803e3d6000fd5b505050506040513d6020811015610f7a57600080fd5b81019080805190602001909291905050501515610f9657600080fd5b5050919050565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16141515610ff857600080fd5b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff167ff8df31144d9c2f0f6b59d69b8b98abd5459d07f2742c4df920b25aae33c6482060405160405180910390a260008060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60006110ce611835565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614151561112957600080fd5b61113e8660025461171f90919063ffffffff16565b91506000861180156111735750836fffffffffffffffffffffffffffffffff16836fffffffffffffffffffffffffffffffff16115b8015611190575042846fffffffffffffffffffffffffffffffff16115b8015611292575081600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166370a08231306040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050602060405180830381600087803b15801561125557600080fd5b505af1158015611269573d6000803e3d6000fd5b505050506040513d602081101561127f57600080fd5b8101908080519060200190929190505050115b151561129d57600080fd5b60a0604051908101604052808873ffffffffffffffffffffffffffffffffffffffff168152602001878152602001868152602001856fffffffffffffffffffffffffffffffff168152602001846fffffffffffffffffffffffffffffffff16815250905080600460008973ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550602082015181600101556040820151816002015560608201518160030160006101000a8154816fffffffffffffffffffffffffffffffff02191690836fffffffffffffffffffffffffffffffff16021790555060808201518160030160106101000a8154816fffffffffffffffffffffffffffffffff02191690836fffffffffffffffffffffffffffffffff1602179055509050506003600081819054906101000a900467ffffffffffffffff168092919060010191906101000a81548167ffffffffffffffff021916908367ffffffffffffffff16021790555050816002819055508673ffffffffffffffffffffffffffffffffffffffff167fcd481a3643475b134a9eac8b1f0252620149c4113bac11ac8ab0fd41721e0da48787878760405180858152602001848152602001836fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff168152602001826fffffffffffffffffffffffffffffffff166fffffffffffffffffffffffffffffffff16815260200194505050505060405180910390a250505050505050565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614151561157d57600080fd5b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc3073ffffffffffffffffffffffffffffffffffffffff16319081150290604051600060405180830381858888f193505050501580156115fb573d6000803e3d6000fd5b50565b60025481565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614151561165f57600080fd5b6116688161173b565b50565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60046020528060005260406000206000915090508060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060010154908060020154908060030160009054906101000a90046fffffffffffffffffffffffffffffffff16908060030160109054906101000a90046fffffffffffffffffffffffffffffffff16905085565b6000818301905082811015151561173257fe5b80905092915050565b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff161415151561177757600080fd5b8073ffffffffffffffffffffffffffffffffffffffff166000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a3806000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050565b60a060405190810160405280600073ffffffffffffffffffffffffffffffffffffffff168152602001600081526020016000815260200160006fffffffffffffffffffffffffffffffff16815260200160006fffffffffffffffffffffffffffffffff16815250905600a165627a7a72305820f04d99a725161df12bfb77f08eb2198a646c16296afffdd3a0a59d88ff8640b500290000000000000000000000000b6bc42cb9b89259a3aa986363fa37a9cbf03b8e",
  "constructorArguments": "0000000000000000000000000b6bc42cb9b89259a3aa986363fa37a9cbf03b8e"
}