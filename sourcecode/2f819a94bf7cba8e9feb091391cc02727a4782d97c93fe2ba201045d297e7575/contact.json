{
  "address": "0x04a487afd662c4f9deacc07a7b10cfb686b682a4",
  "chain": "ETH",
  "chainID": 1,
  "verifier": "etherscan.io",
  "commonName": "",
  "contractName": "KyberOasisReserve",
  "compilerVersion": "v0.4.18+commit.9cf6e910",
  "optimization": true,
  "runs": "200",
  "evmVersion": "default",
  "sourceCode": "/**\n *Submitted for verification at Etherscan.io on 2019-02-09\n*/\n\npragma solidity 0.4.18;\n\n// File: /home/yaron/kyber/oasis_set_otc/smart-contracts/contracts/ERC20Interface.sol\n\n// https://github.com/ethereum/EIPs/issues/20\ninterface ERC20 {\n    function totalSupply() public view returns (uint supply);\n    function balanceOf(address _owner) public view returns (uint balance);\n    function transfer(address _to, uint _value) public returns (bool success);\n    function transferFrom(address _from, address _to, uint _value) public returns (bool success);\n    function approve(address _spender, uint _value) public returns (bool success);\n    function allowance(address _owner, address _spender) public view returns (uint remaining);\n    function decimals() public view returns(uint digits);\n    event Approval(address indexed _owner, address indexed _spender, uint _value);\n}\n\n// File: /home/yaron/kyber/oasis_set_otc/smart-contracts/contracts/Utils.sol\n\n/// @title Kyber constants contract\ncontract Utils {\n\n    ERC20 constant internal ETH_TOKEN_ADDRESS = ERC20(0x00eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee);\n    uint  constant internal PRECISION = (10**18);\n    uint  constant internal MAX_QTY   = (10**28); // 10B tokens\n    uint  constant internal MAX_RATE  = (PRECISION * 10**6); // up to 1M tokens per ETH\n    uint  constant internal MAX_DECIMALS = 18;\n    uint  constant internal ETH_DECIMALS = 18;\n    mapping(address=>uint) internal decimals;\n\n    function setDecimals(ERC20 token) internal {\n        if (token == ETH_TOKEN_ADDRESS) decimals[token] = ETH_DECIMALS;\n        else decimals[token] = token.decimals();\n    }\n\n    function getDecimals(ERC20 token) internal view returns(uint) {\n        if (token == ETH_TOKEN_ADDRESS) return ETH_DECIMALS; // save storage access\n        uint tokenDecimals = decimals[token];\n        // technically, there might be token with decimals 0\n        // moreover, very possible that old tokens have decimals 0\n        // these tokens will just have higher gas fees.\n        if(tokenDecimals == 0) return token.decimals();\n\n        return tokenDecimals;\n    }\n\n    function calcDstQty(uint srcQty, uint srcDecimals, uint dstDecimals, uint rate) internal pure returns(uint) {\n        require(srcQty <= MAX_QTY);\n        require(rate <= MAX_RATE);\n\n        if (dstDecimals >= srcDecimals) {\n            require((dstDecimals - srcDecimals) <= MAX_DECIMALS);\n            return (srcQty * rate * (10**(dstDecimals - srcDecimals))) / PRECISION;\n        } else {\n            require((srcDecimals - dstDecimals) <= MAX_DECIMALS);\n            return (srcQty * rate) / (PRECISION * (10**(srcDecimals - dstDecimals)));\n        }\n    }\n\n    function calcSrcQty(uint dstQty, uint srcDecimals, uint dstDecimals, uint rate) internal pure returns(uint) {\n        require(dstQty <= MAX_QTY);\n        require(rate <= MAX_RATE);\n        \n        //source quantity is rounded up. to avoid dest quantity being too low.\n        uint numerator;\n        uint denominator;\n        if (srcDecimals >= dstDecimals) {\n            require((srcDecimals - dstDecimals) <= MAX_DECIMALS);\n            numerator = (PRECISION * dstQty * (10**(srcDecimals - dstDecimals)));\n            denominator = rate;\n        } else {\n            require((dstDecimals - srcDecimals) <= MAX_DECIMALS);\n            numerator = (PRECISION * dstQty);\n            denominator = (rate * (10**(dstDecimals - srcDecimals)));\n        }\n        return (numerator + denominator - 1) / denominator; //avoid rounding down errors\n    }\n}\n\n// File: /home/yaron/kyber/oasis_set_otc/smart-contracts/contracts/Utils2.sol\n\ncontract Utils2 is Utils {\n\n    /// @dev get the balance of a user.\n    /// @param token The token type\n    /// @return The balance\n    function getBalance(ERC20 token, address user) public view returns(uint) {\n        if (token == ETH_TOKEN_ADDRESS)\n            return user.balance;\n        else\n            return token.balanceOf(user);\n    }\n\n    function getDecimalsSafe(ERC20 token) internal returns(uint) {\n\n        if (decimals[token] == 0) {\n            setDecimals(token);\n        }\n\n        return decimals[token];\n    }\n\n    function calcDestAmount(ERC20 src, ERC20 dest, uint srcAmount, uint rate) internal view returns(uint) {\n        return calcDstQty(srcAmount, getDecimals(src), getDecimals(dest), rate);\n    }\n\n    function calcSrcAmount(ERC20 src, ERC20 dest, uint destAmount, uint rate) internal view returns(uint) {\n        return calcSrcQty(destAmount, getDecimals(src), getDecimals(dest), rate);\n    }\n\n    function calcRateFromQty(uint srcAmount, uint destAmount, uint srcDecimals, uint dstDecimals)\n        internal pure returns(uint)\n    {\n        require(srcAmount <= MAX_QTY);\n        require(destAmount <= MAX_QTY);\n\n        if (dstDecimals >= srcDecimals) {\n            require((dstDecimals - srcDecimals) <= MAX_DECIMALS);\n            return (destAmount * PRECISION / ((10 ** (dstDecimals - srcDecimals)) * srcAmount));\n        } else {\n            require((srcDecimals - dstDecimals) <= MAX_DECIMALS);\n            return (destAmount * PRECISION * (10 ** (srcDecimals - dstDecimals)) / srcAmount);\n        }\n    }\n}\n\n// File: /home/yaron/kyber/oasis_set_otc/smart-contracts/contracts/PermissionGroups.sol\n\ncontract PermissionGroups {\n\n    address public admin;\n    address public pendingAdmin;\n    mapping(address=>bool) internal operators;\n    mapping(address=>bool) internal alerters;\n    address[] internal operatorsGroup;\n    address[] internal alertersGroup;\n    uint constant internal MAX_GROUP_SIZE = 50;\n\n    function PermissionGroups() public {\n        admin = msg.sender;\n    }\n\n    modifier onlyAdmin() {\n        require(msg.sender == admin);\n        _;\n    }\n\n    modifier onlyOperator() {\n        require(operators[msg.sender]);\n        _;\n    }\n\n    modifier onlyAlerter() {\n        require(alerters[msg.sender]);\n        _;\n    }\n\n    function getOperators () external view returns(address[]) {\n        return operatorsGroup;\n    }\n\n    function getAlerters () external view returns(address[]) {\n        return alertersGroup;\n    }\n\n    event TransferAdminPending(address pendingAdmin);\n\n    /**\n     * @dev Allows the current admin to set the pendingAdmin address.\n     * @param newAdmin The address to transfer ownership to.\n     */\n    function transferAdmin(address newAdmin) public onlyAdmin {\n        require(newAdmin != address(0));\n        TransferAdminPending(pendingAdmin);\n        pendingAdmin = newAdmin;\n    }\n\n    /**\n     * @dev Allows the current admin to set the admin in one tx. Useful initial deployment.\n     * @param newAdmin The address to transfer ownership to.\n     */\n    function transferAdminQuickly(address newAdmin) public onlyAdmin {\n        require(newAdmin != address(0));\n        TransferAdminPending(newAdmin);\n        AdminClaimed(newAdmin, admin);\n        admin = newAdmin;\n    }\n\n    event AdminClaimed( address newAdmin, address previousAdmin);\n\n    /**\n     * @dev Allows the pendingAdmin address to finalize the change admin process.\n     */\n    function claimAdmin() public {\n        require(pendingAdmin == msg.sender);\n        AdminClaimed(pendingAdmin, admin);\n        admin = pendingAdmin;\n        pendingAdmin = address(0);\n    }\n\n    event AlerterAdded (address newAlerter, bool isAdd);\n\n    function addAlerter(address newAlerter) public onlyAdmin {\n        require(!alerters[newAlerter]); // prevent duplicates.\n        require(alertersGroup.length < MAX_GROUP_SIZE);\n\n        AlerterAdded(newAlerter, true);\n        alerters[newAlerter] = true;\n        alertersGroup.push(newAlerter);\n    }\n\n    function removeAlerter (address alerter) public onlyAdmin {\n        require(alerters[alerter]);\n        alerters[alerter] = false;\n\n        for (uint i = 0; i < alertersGroup.length; ++i) {\n            if (alertersGroup[i] == alerter) {\n                alertersGroup[i] = alertersGroup[alertersGroup.length - 1];\n                alertersGroup.length--;\n                AlerterAdded(alerter, false);\n                break;\n            }\n        }\n    }\n\n    event OperatorAdded(address newOperator, bool isAdd);\n\n    function addOperator(address newOperator) public onlyAdmin {\n        require(!operators[newOperator]); // prevent duplicates.\n        require(operatorsGroup.length < MAX_GROUP_SIZE);\n\n        OperatorAdded(newOperator, true);\n        operators[newOperator] = true;\n        operatorsGroup.push(newOperator);\n    }\n\n    function removeOperator (address operator) public onlyAdmin {\n        require(operators[operator]);\n        operators[operator] = false;\n\n        for (uint i = 0; i < operatorsGroup.length; ++i) {\n            if (operatorsGroup[i] == operator) {\n                operatorsGroup[i] = operatorsGroup[operatorsGroup.length - 1];\n                operatorsGroup.length -= 1;\n                OperatorAdded(operator, false);\n                break;\n            }\n        }\n    }\n}\n\n// File: /home/yaron/kyber/oasis_set_otc/smart-contracts/contracts/Withdrawable.sol\n\n/**\n * @title Contracts that should be able to recover tokens or ethers\n * @author Ilan Doron\n * @dev This allows to recover any tokens or Ethers received in a contract.\n * This will prevent any accidental loss of tokens.\n */\ncontract Withdrawable is PermissionGroups {\n\n    event TokenWithdraw(ERC20 token, uint amount, address sendTo);\n\n    /**\n     * @dev Withdraw all ERC20 compatible tokens\n     * @param token ERC20 The address of the token contract\n     */\n    function withdrawToken(ERC20 token, uint amount, address sendTo) external onlyAdmin {\n        require(token.transfer(sendTo, amount));\n        TokenWithdraw(token, amount, sendTo);\n    }\n\n    event EtherWithdraw(uint amount, address sendTo);\n\n    /**\n     * @dev Withdraw Ethers\n     */\n    function withdrawEther(uint amount, address sendTo) external onlyAdmin {\n        sendTo.transfer(amount);\n        EtherWithdraw(amount, sendTo);\n    }\n}\n\n// File: /home/yaron/kyber/oasis_set_otc/smart-contracts/contracts/KyberReserveInterface.sol\n\n/// @title Kyber Reserve contract\ninterface KyberReserveInterface {\n\n    function trade(\n        ERC20 srcToken,\n        uint srcAmount,\n        ERC20 destToken,\n        address destAddress,\n        uint conversionRate,\n        bool validate\n    )\n        public\n        payable\n        returns(bool);\n\n    function getConversionRate(ERC20 src, ERC20 dest, uint srcQty, uint blockNumber) public view returns(uint);\n}\n\n// File: contracts/oasisContracts/KyberOasisReserve.sol\n\ncontract OtcInterface {\n    function getOffer(uint id) public constant returns (uint, ERC20, uint, ERC20);\n    function getBestOffer(ERC20 sellGem, ERC20 buyGem) public constant returns(uint);\n    function getWorseOffer(uint id) public constant returns(uint);\n    function take(bytes32 id, uint128 maxTakeAmount) public;\n}\n\n\ncontract WethInterface is ERC20 {\n    function deposit() public payable;\n    function withdraw(uint) public;\n}\n\n\ncontract KyberOasisReserve is KyberReserveInterface, Withdrawable, Utils2 {\n\n    uint constant internal COMMON_DECIMALS = 18;\n    address public sanityRatesContract = 0;\n    address public kyberNetwork;\n    OtcInterface public otc;\n    WethInterface public wethToken;\n    mapping(address=>bool) public isTokenListed;\n    mapping(address=>uint) public tokenMinSrcAmount;\n    mapping(address=>uint) public minTokenBalance;\n    mapping(address=>uint) public maxTokenBalance;\n    mapping(address=>uint) public internalPricePremiumBps;\n    mapping(address=>uint) public minOasisSpreadForinternalPricingBps;\n    bool public tradeEnabled;\n    uint public feeBps;\n\n    function KyberOasisReserve(\n        address _kyberNetwork,\n        OtcInterface _otc,\n        WethInterface _wethToken,\n        address _admin,\n        uint _feeBps\n    )\n        public\n    {\n        require(_admin != address(0));\n        require(_kyberNetwork != address(0));\n        require(_otc != address(0));\n        require(_wethToken != address(0));\n        require(_feeBps < 10000);\n        require(getDecimals(_wethToken) == COMMON_DECIMALS);\n\n        kyberNetwork = _kyberNetwork;\n        otc = _otc;\n        wethToken = _wethToken;\n        admin = _admin;\n        feeBps = _feeBps;\n        tradeEnabled = true;\n\n        require(wethToken.approve(otc, 2**255));\n    }\n\n    function() public payable {\n        // anyone can deposit ether\n    }\n\n    function listToken(ERC20 token, uint minSrcAmount) public onlyAdmin {\n        require(token != address(0));\n        require(!isTokenListed[token]);\n        require(getDecimals(token) == COMMON_DECIMALS);\n\n        require(token.approve(otc, 2**255));\n        isTokenListed[token] = true;\n        tokenMinSrcAmount[token] = minSrcAmount;\n        minTokenBalance[token] = 2 ** 255; // disable by default\n        maxTokenBalance[token] = 0; // disable by default;\n        internalPricePremiumBps[token] = 0; // NA by default\n        minOasisSpreadForinternalPricingBps[token] = 0; // NA by default\n    }\n\n    function delistToken(ERC20 token) public onlyAdmin {\n        require(isTokenListed[token]);\n\n        require(token.approve(otc, 0));\n        delete isTokenListed[token];\n        delete tokenMinSrcAmount[token];\n        delete minTokenBalance[token];\n        delete maxTokenBalance[token];\n        delete internalPricePremiumBps[token];\n        delete minOasisSpreadForinternalPricingBps[token];\n    }\n\n    function setInternalPriceAdminParams(ERC20 token,\n                                         uint minSpreadBps,\n                                         uint premiumBps) public onlyAdmin {\n        require(isTokenListed[token]);\n        require(premiumBps <= 500); // premium <= 5%\n        require(minSpreadBps <= 1000); // min spread <= 10%\n\n        internalPricePremiumBps[token] = premiumBps;\n        minOasisSpreadForinternalPricingBps[token] = minSpreadBps;\n    }\n\n    function setInternalInventoryMinMax(ERC20 token,\n                                        uint  minBalance,\n                                        uint  maxBalance) public onlyOperator {\n        require(isTokenListed[token]);\n\n        // don't require anything on min and max balance as it might be used for disable\n        minTokenBalance[token] = minBalance;\n        maxTokenBalance[token] = maxBalance;\n    }\n\n    event TradeExecute(\n        address indexed sender,\n        address src,\n        uint srcAmount,\n        address destToken,\n        uint destAmount,\n        address destAddress\n    );\n\n    function trade(\n        ERC20 srcToken,\n        uint srcAmount,\n        ERC20 destToken,\n        address destAddress,\n        uint conversionRate,\n        bool validate\n    )\n        public\n        payable\n        returns(bool)\n    {\n\n        require(tradeEnabled);\n        require(msg.sender == kyberNetwork);\n\n        require(doTrade(srcToken, srcAmount, destToken, destAddress, conversionRate, validate));\n\n        return true;\n    }\n\n    event TradeEnabled(bool enable);\n\n    function enableTrade() public onlyAdmin returns(bool) {\n        tradeEnabled = true;\n        TradeEnabled(true);\n\n        return true;\n    }\n\n    function disableTrade() public onlyAlerter returns(bool) {\n        tradeEnabled = false;\n        TradeEnabled(false);\n\n        return true;\n    }\n\n    event KyberNetworkSet(address kyberNetwork);\n\n    function setKyberNetwork(address _kyberNetwork) public onlyAdmin {\n        require(_kyberNetwork != address(0));\n\n        kyberNetwork = _kyberNetwork;\n        KyberNetworkSet(kyberNetwork);\n    }\n\n    event FeeBpsSet(uint feeBps);\n\n    function setFeeBps(uint _feeBps) public onlyAdmin {\n        require(_feeBps < 10000);\n\n        feeBps = _feeBps;\n        FeeBpsSet(feeBps);\n    }\n\n    function valueAfterReducingFee(uint val) public view returns(uint) {\n        require(val <= MAX_QTY);\n        return ((10000 - feeBps) * val) / 10000;\n    }\n\n    function valueBeforeFeesWereReduced(uint val) public view returns(uint) {\n        require(val <= MAX_QTY);\n        return val * 10000 / (10000 - feeBps);\n    }\n\n    function valueAfterAddingPremium(ERC20 token, uint val) public view returns(uint) {\n        require(val <= MAX_QTY);\n        uint premium = internalPricePremiumBps[token];\n\n        return val * (10000 + premium) / 10000;\n    }\n    function shouldUseInternalInventory(ERC20 token,\n                                        uint tokenVal,\n                                        uint ethVal,\n                                        bool ethToToken) public view returns(bool) {\n        require(tokenVal <= MAX_QTY);\n\n        uint tokenBalance = token.balanceOf(this);\n        if (ethToToken) {\n            if (tokenBalance < tokenVal) return false;\n            if (tokenBalance - tokenVal < minTokenBalance[token]) return false;\n        }\n        else {\n            if (this.balance < ethVal) return false;\n            if (tokenBalance + tokenVal > maxTokenBalance[token]) return false;\n        }\n\n        // check that spread in first level makes sense\n        uint x1; uint y1; uint x2; uint y2;\n        (,x1,y1) = getMatchingOffer(token, wethToken, 0);\n        (,y2,x2) = getMatchingOffer(wethToken, token, 0);\n\n        require(x1 <= MAX_QTY && x2 <= MAX_QTY && y1 <= MAX_QTY && y2 <= MAX_QTY);\n\n        // check if there is an arbitrage\n        if (x1*y2 > x2*y1) return false;\n\n        // spread is (x1/y1 - x2/y2) / (x1/y1)\n        if (10000 * (x2*y1 - x1*y2) < x1*y2*minOasisSpreadForinternalPricingBps[token]) return false;\n\n\n        return true;\n    }\n\n    function getConversionRate(ERC20 src, ERC20 dest, uint srcQty, uint blockNumber) public view returns(uint) {\n        uint  rate;\n        uint  actualSrcQty;\n        ERC20 actualSrc;\n        ERC20 actualDest;\n        uint offerPayAmt;\n        uint offerBuyAmt;\n\n        blockNumber;\n\n        if (!tradeEnabled) return 0;\n        if (!validTokens(src, dest)) return 0;\n\n        if (src == ETH_TOKEN_ADDRESS) {\n            actualSrc = wethToken;\n            actualDest = dest;\n            actualSrcQty = srcQty;\n        } else if (dest == ETH_TOKEN_ADDRESS) {\n            actualSrc = src;\n            actualDest = wethToken;\n\n            if (srcQty < tokenMinSrcAmount[src]) {\n                /* remove rounding errors and present rate for 0 src amount. */\n                actualSrcQty = tokenMinSrcAmount[src];\n            } else {\n                actualSrcQty = srcQty;\n            }\n        } else {\n            return 0;\n        }\n\n        // otc's terminology is of offer maker, so their sellGem is the taker's dest token.\n        (, offerPayAmt, offerBuyAmt) = getMatchingOffer(actualDest, actualSrc, actualSrcQty);\n\n        // make sure to take only one level of order book to avoid gas inflation.\n        if (actualSrcQty > offerBuyAmt) return 0;\n\n        bool tradeFromInventory = false;\n        uint valueWithPremium = valueAfterAddingPremium(token, offerPayAmt);\n        ERC20 token;\n        if (src == ETH_TOKEN_ADDRESS) {\n            token = dest;\n            tradeFromInventory = shouldUseInternalInventory(token,\n                                                            valueWithPremium,\n                                                            offerBuyAmt,\n                                                            true);\n        }\n        else {\n            token = src;\n            tradeFromInventory = shouldUseInternalInventory(token,\n                                                            offerBuyAmt,\n                                                            valueWithPremium,\n                                                            false);\n        }\n\n        rate = calcRateFromQty(offerBuyAmt, offerPayAmt, COMMON_DECIMALS, COMMON_DECIMALS);\n\n        if (tradeFromInventory) return valueAfterAddingPremium(token,rate);\n        else return valueAfterReducingFee(rate);\n    }\n\n    function doTrade(\n        ERC20 srcToken,\n        uint srcAmount,\n        ERC20 destToken,\n        address destAddress,\n        uint conversionRate,\n        bool validate\n    )\n        internal\n        returns(bool)\n    {\n        uint actualDestAmount;\n\n        require(validTokens(srcToken, destToken));\n\n        // can skip validation if done at kyber network level\n        if (validate) {\n            require(conversionRate > 0);\n            if (srcToken == ETH_TOKEN_ADDRESS)\n                require(msg.value == srcAmount);\n            else\n                require(msg.value == 0);\n        }\n\n        uint userExpectedDestAmount = calcDstQty(srcAmount, COMMON_DECIMALS, COMMON_DECIMALS, conversionRate);\n        require(userExpectedDestAmount > 0); // sanity check\n\n        uint destAmountIncludingFees = valueBeforeFeesWereReduced(userExpectedDestAmount);\n\n        if (srcToken == ETH_TOKEN_ADDRESS) {\n            if(!shouldUseInternalInventory(destToken,\n                                           userExpectedDestAmount,\n                                           0,\n                                           true)) {\n                wethToken.deposit.value(msg.value)();\n\n                actualDestAmount = takeMatchingOffer(wethToken, destToken, srcAmount);\n                require(actualDestAmount >= destAmountIncludingFees);\n            }\n\n            // transfer back only requested dest amount.\n            require(destToken.transfer(destAddress, userExpectedDestAmount));\n        } else {\n            require(srcToken.transferFrom(msg.sender, this, srcAmount));\n\n            if(!shouldUseInternalInventory(srcToken,\n                                           0,\n                                           userExpectedDestAmount,\n                                           false)) {\n                actualDestAmount = takeMatchingOffer(srcToken, wethToken, srcAmount);\n                require(actualDestAmount >= destAmountIncludingFees);\n                wethToken.withdraw(actualDestAmount);\n            }\n\n            // transfer back only requested dest amount.\n            destAddress.transfer(userExpectedDestAmount);\n        }\n\n        TradeExecute(msg.sender, srcToken, srcAmount, destToken, userExpectedDestAmount, destAddress);\n\n        return true;\n    }\n\n    function takeMatchingOffer(\n        ERC20 srcToken,\n        ERC20 destToken,\n        uint srcAmount\n    )\n        internal\n        returns(uint actualDestAmount)\n    {\n        uint offerId;\n        uint offerPayAmt;\n        uint offerBuyAmt;\n\n        // otc's terminology is of offer maker, so their sellGem is our (the taker's) dest token.\n        (offerId, offerPayAmt, offerBuyAmt) = getMatchingOffer(destToken, srcToken, srcAmount);\n\n        require(srcAmount <= MAX_QTY);\n        require(offerPayAmt <= MAX_QTY);\n        actualDestAmount = srcAmount * offerPayAmt / offerBuyAmt;\n\n        require(uint128(actualDestAmount) == actualDestAmount);\n        otc.take(bytes32(offerId), uint128(actualDestAmount));  // Take the portion of the offer that we need\n        return;\n    }\n\n    function getMatchingOffer(\n        ERC20 offerSellGem,\n        ERC20 offerBuyGem,\n        uint payAmount\n    )\n        internal\n        view\n        returns(\n            uint offerId,\n            uint offerPayAmount,\n            uint offerBuyAmount\n        )\n    {\n        offerId = otc.getBestOffer(offerSellGem, offerBuyGem);\n        (offerPayAmount, , offerBuyAmount, ) = otc.getOffer(offerId);\n        uint depth = 1;\n\n        while (payAmount > offerBuyAmount) {\n            offerId = otc.getWorseOffer(offerId); // We look for the next best offer\n            if (offerId == 0 || ++depth > 7) {\n                offerId = 0;\n                offerPayAmount = 0;\n                offerBuyAmount = 0;\n                break;\n            }\n            (offerPayAmount, , offerBuyAmount, ) = otc.getOffer(offerId);\n        }\n\n        return;\n    }\n\n    function validTokens(ERC20 src, ERC20 dest) internal view returns (bool valid) {\n        return ((isTokenListed[src] && ETH_TOKEN_ADDRESS == dest) ||\n                (isTokenListed[dest] && ETH_TOKEN_ADDRESS == src));\n    }\n}",
  "bytecode": "606060405260078054600160a060020a031916905534156200002057600080fd5b60405160a080620028f4833981016040528080519190602001805191906020018051919060200180519190602001805160008054600160a060020a03191633600160a060020a03908116919091179091559092508316151590506200008457600080fd5b600160a060020a03851615156200009a57600080fd5b600160a060020a0384161515620000b057600080fd5b600160a060020a0383161515620000c657600080fd5b6127108110620000d557600080fd5b6012620000f08464010000000062001bf96200021d82021704565b14620000fb57600080fd5b60088054600160a060020a0319908116600160a060020a03888116919091179092556009805482168784161790819055600a8054831687851617908190556000805490931686851617835560128590556011805460ff1916600117905583169263095ea7b3929116907f800000000000000000000000000000000000000000000000000000000000000090604051602001526040517c010000000000000000000000000000000000000000000000000000000063ffffffff8516028152600160a060020a0390921660048301526024820152604401602060405180830381600087803b1515620001ea57600080fd5b6102c65a03f11515620001fc57600080fd5b5050506040518051905015156200021257600080fd5b505050505062000300565b600080600160a060020a03831673eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee1415620002505760129150620002fa565b50600160a060020a038216600090815260066020526040902054801515620002f65782600160a060020a031663313ce5676000604051602001526040518163ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401602060405180830381600087803b1515620002d257600080fd5b6102c65a03f11515620002e457600080fd5b505050604051805190509150620002fa565b8091505b50919050565b6125e480620003106000396000f3006060604052600436106101d35763ffffffff60e060020a60003504166299d38681146101d557806301a12fd3146101fc5780630717d7c31461021b5780631db950781461023d57806324a9d8531461026e5780632678224714610281578063274544ce146102b057806327a099d8146102d257806336b61e3c146103385780633ccdbb281461034b578063408ee7fe1461037457806347e6924f146103935780634b57b0be146103a657806354a325a6146103b95780635b714690146103d85780635cf4a0da146103ee5780636940030f1461040d5780636cf69811146104205780636f3d80431461044c57806372c27b621461046257806375829def1461047857806377f50f97146104975780637acc8678146104aa5780637c423f54146104c95780637cd44272146104dc57806390b7e28f146105075780639870d7fe14610526578063abffc9ac14610545578063ac8a584a14610564578063b78b842d14610583578063ce56c45414610596578063d1a75930146105b8578063d4fac45d146105d7578063d621e813146105fc578063d6b45f791461060f578063e2c44ac51461062e578063e69ec65314610653578063f845584214610672578063f851a44014610697578063fda51fe0146106aa575b005b34156101e057600080fd5b6101e86106d4565b604051901515815260200160405180910390f35b341561020757600080fd5b6101d3600160a060020a036004351661073c565b341561022657600080fd5b6101d3600160a060020a03600435166024356108ac565b341561024857600080fd5b61025c600160a060020a0360043516610a3a565b60405190815260200160405180910390f35b341561027957600080fd5b61025c610a4c565b341561028c57600080fd5b610294610a52565b604051600160a060020a03909116815260200160405180910390f35b34156102bb57600080fd5b61025c600160a060020a0360043516602435610a61565b34156102dd57600080fd5b6102e5610aa8565b60405160208082528190810183818151815260200191508051906020019060200280838360005b8381101561032457808201518382015260200161030c565b505050509050019250505060405180910390f35b341561034357600080fd5b610294610b10565b341561035657600080fd5b6101d3600160a060020a036004358116906024359060443516610b1f565b341561037f57600080fd5b6101d3600160a060020a0360043516610c16565b341561039e57600080fd5b610294610d12565b34156103b157600080fd5b610294610d21565b34156103c457600080fd5b6101d3600160a060020a0360043516610d30565b34156103e357600080fd5b61025c600435610dc2565b34156103f957600080fd5b61025c600160a060020a0360043516610df9565b341561041857600080fd5b6101e8610e0b565b6101e8600160a060020a03600435811690602435906044358116906064351660843560a4351515610e78565b341561045757600080fd5b61025c600435610ecd565b341561046d57600080fd5b6101d3600435610ef8565b341561048357600080fd5b6101d3600160a060020a0360043516610f5c565b34156104a257600080fd5b6101d3610ff7565b34156104b557600080fd5b6101d3600160a060020a0360043516611091565b34156104d457600080fd5b6102e5611173565b34156104e757600080fd5b61025c600160a060020a03600435811690602435166044356064356111d9565b341561051257600080fd5b61025c600160a060020a03600435166113bc565b341561053157600080fd5b6101d3600160a060020a03600435166113ce565b341561055057600080fd5b6101d3600160a060020a036004351661149e565b341561056f57600080fd5b6101d3600160a060020a03600435166115bd565b341561058e57600080fd5b610294611729565b34156105a157600080fd5b6101d3600435600160a060020a0360243516611738565b34156105c357600080fd5b61025c600160a060020a03600435166117cb565b34156105e257600080fd5b61025c600160a060020a03600435811690602435166117dd565b341561060757600080fd5b6101e861188f565b341561061a57600080fd5b61025c600160a060020a0360043516611898565b341561063957600080fd5b6101d3600160a060020a03600435166024356044356118aa565b341561065e57600080fd5b6101e8600160a060020a0360043516611920565b341561067d57600080fd5b6101d3600160a060020a0360043516602435604435611935565b34156106a257600080fd5b6102946119c0565b34156106b557600080fd5b6101e8600160a060020a036004351660243560443560643515156119cf565b6000805433600160a060020a039081169116146106f057600080fd5b6011805460ff191660019081179091557f7d7f00509dd73ac4449f698ae75ccc797895eff5fa9d446d3df387598a26e73590604051901515815260200160405180910390a15060015b90565b6000805433600160a060020a0390811691161461075857600080fd5b600160a060020a03821660009081526003602052604090205460ff16151561077f57600080fd5b50600160a060020a0381166000908152600360205260408120805460ff191690555b6005548110156108a85781600160a060020a03166005828154811015156107c457fe5b600091825260209091200154600160a060020a031614156108a0576005805460001981019081106107f157fe5b60009182526020909120015460058054600160a060020a03909216918390811061081757fe5b60009182526020909120018054600160a060020a031916600160a060020a0392909216919091179055600580549061085390600019830161255f565b507f5611bf3e417d124f97bf2c788843ea8bb502b66079fbee02158ef30b172cb762826000604051600160a060020a039092168252151560208201526040908101905180910390a16108a8565b6001016107a1565b5050565b60005433600160a060020a039081169116146108c757600080fd5b600160a060020a03821615156108dc57600080fd5b600160a060020a0382166000908152600b602052604090205460ff161561090257600080fd5b601261090d83611bf9565b1461091757600080fd5b600954600160a060020a038084169163095ea7b391167f800000000000000000000000000000000000000000000000000000000000000060006040516020015260405160e060020a63ffffffff8516028152600160a060020a0390921660048301526024820152604401602060405180830381600087803b151561099a57600080fd5b6102c65a03f115156109ab57600080fd5b5050506040518051905015156109c057600080fd5b600160a060020a039091166000908152600b60209081526040808320805460ff19166001179055600c825280832093909355600d81528282207f80000000000000000000000000000000000000000000000000000000000000009055600e8152828220829055600f81528282208290556010905290812055565b600f6020526000908152604090205481565b60125481565b600154600160a060020a031681565b6000806b204fce5e3e25026110000000831115610a7d57600080fd5b50600160a060020a0383166000908152600f6020526040902054612710808201840204949350505050565b610ab0612588565b6004805480602002602001604051908101604052809291908181526020018280548015610b0657602002820191906000526020600020905b8154600160a060020a03168152600190910190602001808311610ae8575b5050505050905090565b600954600160a060020a031681565b60005433600160a060020a03908116911614610b3a57600080fd5b82600160a060020a031663a9059cbb828460006040516020015260405160e060020a63ffffffff8516028152600160a060020a0390921660048301526024820152604401602060405180830381600087803b1515610b9757600080fd5b6102c65a03f11515610ba857600080fd5b505050604051805190501515610bbd57600080fd5b7f72cb8a894ddb372ceec3d2a7648d86f17d5a15caae0e986c53109b8a9a9385e6838383604051600160a060020a03938416815260208101929092529091166040808301919091526060909101905180910390a1505050565b60005433600160a060020a03908116911614610c3157600080fd5b600160a060020a03811660009081526003602052604090205460ff1615610c5757600080fd5b60055460329010610c6757600080fd5b7f5611bf3e417d124f97bf2c788843ea8bb502b66079fbee02158ef30b172cb762816001604051600160a060020a039092168252151560208201526040908101905180910390a1600160a060020a0381166000908152600360205260409020805460ff191660019081179091556005805490918101610ce6838261255f565b5060009182526020909120018054600160a060020a031916600160a060020a0392909216919091179055565b600754600160a060020a031681565b600a54600160a060020a031681565b60005433600160a060020a03908116911614610d4b57600080fd5b600160a060020a0381161515610d6057600080fd5b60088054600160a060020a031916600160a060020a0383811691909117918290557f38622430bb6defd4452b087e8d0b4a6d1c4d35c179c2d7d875d4abb272b9d88b9116604051600160a060020a03909116815260200160405180910390a150565b60006b204fce5e3e25026110000000821115610ddd57600080fd5b601254612710038261271002811515610df257fe5b0492915050565b600c6020526000908152604090205481565b600160a060020a03331660009081526003602052604081205460ff161515610e3257600080fd5b6011805460ff191690557f7d7f00509dd73ac4449f698ae75ccc797895eff5fa9d446d3df387598a26e7356000604051901515815260200160405180910390a150600190565b60115460009060ff161515610e8c57600080fd5b60085433600160a060020a03908116911614610ea757600080fd5b610eb5878787878787611cbd565b1515610ec057600080fd5b5060019695505050505050565b60006b204fce5e3e25026110000000821115610ee857600080fd5b6012546127109081038302610df2565b60005433600160a060020a03908116911614610f1357600080fd5b6127108110610f2157600080fd5b60128190557f4f78c4ceb393a616bbd264a4584a9ad15d722042ce1e135e6a8380217f5cb42b8160405190815260200160405180910390a150565b60005433600160a060020a03908116911614610f7757600080fd5b600160a060020a0381161515610f8c57600080fd5b6001547f3b81caf78fa51ecbc8acb482fd7012a277b428d9b80f9d156e8a54107496cc4090600160a060020a0316604051600160a060020a03909116815260200160405180910390a160018054600160a060020a031916600160a060020a0392909216919091179055565b60015433600160a060020a0390811691161461101257600080fd5b6001546000547f65da1cfc2c2e81576ad96afb24a581f8e109b7a403b35cbd3243a1c99efdb9ed91600160a060020a039081169116604051600160a060020a039283168152911660208201526040908101905180910390a16001805460008054600160a060020a0319908116600160a060020a03841617909155169055565b60005433600160a060020a039081169116146110ac57600080fd5b600160a060020a03811615156110c157600080fd5b7f3b81caf78fa51ecbc8acb482fd7012a277b428d9b80f9d156e8a54107496cc4081604051600160a060020a03909116815260200160405180910390a16000547f65da1cfc2c2e81576ad96afb24a581f8e109b7a403b35cbd3243a1c99efdb9ed908290600160a060020a0316604051600160a060020a039283168152911660208201526040908101905180910390a160008054600160a060020a031916600160a060020a0392909216919091179055565b61117b612588565b6005805480602002602001604051908101604052809291908181526020018280548015610b0657602002820191906000526020600020908154600160a060020a03168152600190910190602001808311610ae8575050505050905090565b600080600080600080600080600080601160009054906101000a900460ff16151561120757600099506113ab565b6112118e8e612065565b151561122057600099506113ab565b600160a060020a038e1673eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee141561125e57600a548c9850600160a060020a031696508c95506112fd565b600160a060020a038d1673eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee14156112f4578d9650600a60009054906101000a9004600160a060020a03169550600c60008f600160a060020a0316600160a060020a03168152602001908152602001600020548c10156112eb57600160a060020a038e166000908152600c602052604090205497506112ef565b8b97505b6112fd565b600099506113ab565b61130886888a6120fa565b9096509450508388111561131f57600099506113ab565b6000925061132d8186610a61565b9150600160a060020a038e1673eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee141561136a57508b61136381838660016119cf565b925061137c565b508c61137981858460006119cf565b92505b6113898486601280612339565b985082156113a25761139b818a610a61565b99506113ab565b61139b89610ecd565b505050505050505050949350505050565b600e6020526000908152604090205481565b60005433600160a060020a039081169116146113e957600080fd5b600160a060020a03811660009081526002602052604090205460ff161561140f57600080fd5b6004546032901061141f57600080fd5b7f091a7a4b85135fdd7e8dbc18b12fabe5cc191ea867aa3c2e1a24a102af61d58b816001604051600160a060020a039092168252151560208201526040908101905180910390a1600160a060020a0381166000908152600260205260409020805460ff191660019081179091556004805490918101610ce6838261255f565b60005433600160a060020a039081169116146114b957600080fd5b600160a060020a0381166000908152600b602052604090205460ff1615156114e057600080fd5b600954600160a060020a038083169163095ea7b391166000806040516020015260405160e060020a63ffffffff8516028152600160a060020a0390921660048301526024820152604401602060405180830381600087803b151561154357600080fd5b6102c65a03f1151561155457600080fd5b50505060405180519050151561156957600080fd5b600160a060020a03166000908152600b60209081526040808320805460ff19169055600c8252808320839055600d8252808320839055600e8252808320839055600f82528083208390556010909152812055565b6000805433600160a060020a039081169116146115d957600080fd5b600160a060020a03821660009081526002602052604090205460ff16151561160057600080fd5b50600160a060020a0381166000908152600260205260408120805460ff191690555b6004548110156108a85781600160a060020a031660048281548110151561164557fe5b600091825260209091200154600160a060020a031614156117215760048054600019810190811061167257fe5b60009182526020909120015460048054600160a060020a03909216918390811061169857fe5b60009182526020909120018054600160a060020a031916600160a060020a03929092169190911790556004805460001901906116d4908261255f565b507f091a7a4b85135fdd7e8dbc18b12fabe5cc191ea867aa3c2e1a24a102af61d58b826000604051600160a060020a039092168252151560208201526040908101905180910390a16108a8565b600101611622565b600854600160a060020a031681565b60005433600160a060020a0390811691161461175357600080fd5b600160a060020a03811682156108fc0283604051600060405180830381858888f19350505050151561178457600080fd5b7fec47e7ed86c86774d1a72c19f35c639911393fe7c1a34031fdbd260890da90de8282604051918252600160a060020a031660208201526040908101905180910390a15050565b600d6020526000908152604090205481565b6000600160a060020a03831673eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee14156118155750600160a060020a03811631611889565b82600160a060020a03166370a082318360006040516020015260405160e060020a63ffffffff8416028152600160a060020a039091166004820152602401602060405180830381600087803b151561186c57600080fd5b6102c65a03f1151561187d57600080fd5b50505060405180519150505b92915050565b60115460ff1681565b60106020526000908152604090205481565b600160a060020a03331660009081526002602052604090205460ff1615156118d157600080fd5b600160a060020a0383166000908152600b602052604090205460ff1615156118f857600080fd5b600160a060020a039092166000908152600d6020908152604080832093909355600e90522055565b600b6020526000908152604090205460ff1681565b60005433600160a060020a0390811691161461195057600080fd5b600160a060020a0383166000908152600b602052604090205460ff16151561197757600080fd5b6101f481111561198657600080fd5b6103e882111561199557600080fd5b600160a060020a039092166000908152600f6020908152604080832094909455601090529190912055565b600054600160a060020a031681565b600080808080806b204fce5e3e250261100000008911156119ef57600080fd5b89600160a060020a03166370a082313060006040516020015260405160e060020a63ffffffff8416028152600160a060020a039091166004820152602401602060405180830381600087803b1515611a4657600080fd5b6102c65a03f11515611a5757600080fd5b50505060405180519550508615611aa95788851015611a795760009550611bec565b600160a060020a038a166000908152600d60205260409020548986031015611aa45760009550611bec565b611aef565b8730600160a060020a0316311015611ac45760009550611bec565b600160a060020a038a166000908152600e6020526040902054858a011115611aef5760009550611bec565b600a54611b08908b90600160a060020a031660006120fa565b600a549196509450611b269150600160a060020a03168b60006120fa565b93509150506b204fce5e3e250261100000008411801590611b5357506b204fce5e3e250261100000008211155b8015611b6b57506b204fce5e3e250261100000008311155b8015611b8357506b204fce5e3e250261100000008111155b1515611b8e57600080fd5b8282028185021115611ba35760009550611bec565b601060008b600160a060020a0316600160a060020a03168152602001908152602001600020548185020281850284840203612710021015611be75760009550611bec565b600195505b5050505050949350505050565b600080600160a060020a03831673eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee1415611c2a5760129150611cb7565b50600160a060020a038216600090815260066020526040902054801515611cb35782600160a060020a031663313ce5676000604051602001526040518163ffffffff1660e060020a028152600401602060405180830381600087803b1515611c9157600080fd5b6102c65a03f11515611ca257600080fd5b505050604051805190509150611cb7565b8091505b50919050565b600080600080611ccd8a89612065565b1515611cd857600080fd5b8415611d2c5760008611611ceb57600080fd5b600160a060020a038a1673eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee1415611d2157348914611d1c57600080fd5b611d2c565b3415611d2c57600080fd5b611d3989601280896123dc565b915060008211611d4857600080fd5b611d5182610dc2565b9050600160a060020a038a1673eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee1415611e8f57611d868883600060016119cf565b1515611e0757600a54600160a060020a031663d0e30db0346040518263ffffffff1660e060020a0281526004016000604051808303818588803b1515611dcb57600080fd5b6125ee5a03f11515611ddc57600080fd5b5050600a54611df89250600160a060020a03169050898b612469565b925080831015611e0757600080fd5b87600160a060020a031663a9059cbb888460006040516020015260405160e060020a63ffffffff8516028152600160a060020a0390921660048301526024820152604401602060405180830381600087803b1515611e6457600080fd5b6102c65a03f11515611e7557600080fd5b505050604051805190501515611e8a57600080fd5b611fe8565b89600160a060020a03166323b872dd33308c60006040516020015260405160e060020a63ffffffff8616028152600160a060020a0393841660048201529190921660248201526044810191909152606401602060405180830381600087803b1515611ef957600080fd5b6102c65a03f11515611f0a57600080fd5b505050604051805190501515611f1f57600080fd5b611f2d8a60008460006119cf565b1515611fb757600a54611f4b908b90600160a060020a03168b612469565b925080831015611f5a57600080fd5b600a54600160a060020a0316632e1a7d4d8460405160e060020a63ffffffff84160281526004810191909152602401600060405180830381600087803b1515611fa257600080fd5b6102c65a03f11515611fb357600080fd5b5050505b600160a060020a03871682156108fc0283604051600060405180830381858888f193505050501515611fe857600080fd5b33600160a060020a03167fea9415385bae08fe9f6dc457b02577166790cde83bb18cc340aac6cb81b824de8b8b8b868c604051600160a060020a039586168152602081019490945291841660408085019190915260608401919091529216608082015260a001905180910390a25060019998505050505050505050565b600160a060020a0382166000908152600b602052604081205460ff1680156120a9575073eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee600160a060020a038316145b806120f35750600160a060020a0382166000908152600b602052604090205460ff1680156120f3575073eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee600160a060020a038416145b9392505050565b600954600090819081908190600160a060020a0316630374fc6f8888846040516020015260405160e060020a63ffffffff8516028152600160a060020a03928316600482015291166024820152604401602060405180830381600087803b151561216357600080fd5b6102c65a03f1151561217457600080fd5b5050506040518051600954909550600160a060020a03169050634579268a8560006040516080015260405160e060020a63ffffffff84160281526004810191909152602401608060405180830381600087803b15156121d257600080fd5b6102c65a03f115156121e357600080fd5b50505060405180519060200180519060200180519060200180515092955093506001925050505b8185111561232f57600954600160a060020a031663943911bc8560006040516020015260405160e060020a63ffffffff84160281526004810191909152602401602060405180830381600087803b151561226357600080fd5b6102c65a03f1151561227457600080fd5b505050604051805194505083158061228f5750600101600781115b156122a55760009350600092506000915061232f565b600954600160a060020a0316634579268a8560006040516080015260405160e060020a63ffffffff84160281526004810191909152602401608060405180830381600087803b15156122f657600080fd5b6102c65a03f1151561230757600080fd5b505050604051805190602001805190602001805190602001805150929550935061220a915050565b5093509350939050565b60006b204fce5e3e2502611000000085111561235457600080fd5b6b204fce5e3e2502611000000084111561236d57600080fd5b8282106123a8576012838303111561238457600080fd5b84838303600a0a02670de0b6b3a764000085028115156123a057fe5b0490506123d4565b601282840311156123b857600080fd5b84828403600a0a670de0b6b3a76400008602028115156123a057fe5b949350505050565b60006b204fce5e3e250261100000008511156123f757600080fd5b69d3c21bcecceda100000082111561240e57600080fd5b83831061243d576012848403111561242557600080fd5b670de0b6b3a7640000858302858503600a0a026123a0565b6012838503111561244d57600080fd5b828403600a0a670de0b6b3a7640000028286028115156123a057fe5b60008060008061247a8688876120fa565b919450925090506b204fce5e3e2502611000000085111561249a57600080fd5b6b204fce5e3e250261100000008211156124b357600080fd5b808286028115156124c057fe5b0493506fffffffffffffffffffffffffffffffff841684146124e157600080fd5b600954600160a060020a03166349606455848660405160e060020a63ffffffff851602815260048101929092526fffffffffffffffffffffffffffffffff166024820152604401600060405180830381600087803b151561254157600080fd5b6102c65a03f1151561255257600080fd5b5050505050509392505050565b8154818355818115116125835760008381526020902061258391810190830161259a565b505050565b60206040519081016040526000815290565b61073991905b808211156125b457600081556001016125a0565b50905600a165627a7a723058204e52624c64c5ccd181a3fa63451602912c63ac18e03527754d6d27675c07c07a0029000000000000000000000000706abce058db29eb36578c463cf295f180a1fe9c00000000000000000000000039755357759ce0d7f32dc8dc45414cca409ae24e000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000d0643bc0d0c879f175556509dbcee9373379d5c30000000000000000000000000000000000000000000000000000000000000019",
  "constructorArguments": "000000000000000000000000706abce058db29eb36578c463cf295f180a1fe9c00000000000000000000000039755357759ce0d7f32dc8dc45414cca409ae24e000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000d0643bc0d0c879f175556509dbcee9373379d5c30000000000000000000000000000000000000000000000000000000000000019"
}