{
  "address": "0x517f5e4e7fda6792b338227d4f6eb34c83c5499d",
  "chain": "ETH",
  "chainID": 1,
  "verifier": "etherscan.io",
  "commonName": "",
  "contractName": "ERC20Swap",
  "compilerVersion": "v0.5.0+commit.1d4f565a",
  "optimization": true,
  "runs": "200",
  "evmVersion": "default",
  "sourceCode": "/**\n *Submitted for verification at Etherscan.io on 2019-02-25\n*/\n\npragma solidity ^0.5.0;\n\ninterface SwapInterface {\n    // Public variables\n    function brokerFees(address _broker) external view returns (uint256);\n    function redeemedAt(bytes32 _swapID) external view returns(uint256);\n\n    /// @notice Initiates the atomic swap.\n    ///\n    /// @param _swapID The unique atomic swap id.\n    /// @param _spender The address of the withdrawing trader.\n    /// @param _secretLock The hash of the secret (Hash Lock).\n    /// @param _timelock The unix timestamp when the swap expires.\n    /// @param _value The value of the atomic swap.\n    function initiate(\n        bytes32 _swapID,\n        address payable _spender,\n        bytes32 _secretLock,\n        uint256 _timelock,\n        uint256 _value\n    ) external payable;\n\n    /// @notice Initiates the atomic swap with broker fees.\n    ///\n    /// @param _swapID The unique atomic swap id.\n    /// @param _spender The address of the withdrawing trader.\n    /// @param _broker The address of the broker.\n    /// @param _brokerFee The fee to be paid to the broker on success.\n    /// @param _secretLock The hash of the secret (Hash Lock).\n    /// @param _timelock The unix timestamp when the swap expires.\n    /// @param _value The value of the atomic swap.\n    function initiateWithFees(\n        bytes32 _swapID,\n        address payable _spender,\n        address payable _broker,\n        uint256 _brokerFee,\n        bytes32 _secretLock,\n        uint256 _timelock,\n        uint256 _value\n    ) external payable;\n\n    /// @notice Redeems an atomic swap.\n    ///\n    /// @param _swapID The unique atomic swap id.\n    /// @param _receiver The receiver's address.\n    /// @param _secretKey The secret of the atomic swap.\n    function redeem(bytes32 _swapID, address payable _receiver, bytes32 _secretKey) external;\n\n    /// @notice Redeems an atomic swap to the spender. Can be called by anyone.\n    ///\n    /// @param _swapID The unique atomic swap id.\n    /// @param _secretKey The secret of the atomic swap.\n    function redeemToSpender(bytes32 _swapID, bytes32 _secretKey) external;\n\n    /// @notice Refunds an atomic swap.\n    ///\n    /// @param _swapID The unique atomic swap id.\n    function refund(bytes32 _swapID) external;\n\n    /// @notice Allows broker fee withdrawals.\n    ///\n    /// @param _amount The withdrawal amount.\n    function withdrawBrokerFees(uint256 _amount) external;\n\n    /// @notice Audits an atomic swap.\n    ///\n    /// @param _swapID The unique atomic swap id.\n    function audit(\n        bytes32 _swapID\n    ) external view returns (\n        uint256 timelock,\n        uint256 value,\n        address to, uint256 brokerFee,\n        address broker,\n        address from,\n        bytes32 secretLock\n    );\n\n    /// @notice Audits the secret of an atomic swap.\n    ///\n    /// @param _swapID The unique atomic swap id.\n    function auditSecret(bytes32 _swapID) external view  returns (bytes32 secretKey);\n\n    /// @notice Checks whether a swap is refundable or not.\n    ///\n    /// @param _swapID The unique atomic swap id.\n    function refundable(bytes32 _swapID) external view returns (bool);\n\n    /// @notice Checks whether a swap is initiatable or not.\n    ///\n    /// @param _swapID The unique atomic swap id.\n    function initiatable(bytes32 _swapID) external view returns (bool);\n\n    /// @notice Checks whether a swap is redeemable or not.\n    ///\n    /// @param _swapID The unique atomic swap id.\n    function redeemable(bytes32 _swapID) external view returns (bool);\n\n    /// @notice Generates a deterministic swap id using initiate swap details.\n    ///\n    /// @param _secretLock The hash of the secret.\n    /// @param _timelock The expiry timestamp.\n    function swapID(bytes32 _secretLock, uint256 _timelock) external pure returns (bytes32);\n}\n\ncontract BaseSwap is SwapInterface {\n    string public VERSION; // Passed in as a constructor parameter.\n\n    struct Swap {\n        uint256 timelock;\n        uint256 value;\n        uint256 brokerFee;\n        bytes32 secretLock;\n        bytes32 secretKey;\n        address payable funder;\n        address payable spender;\n        address payable broker;\n    }\n\n    enum States {\n        INVALID,\n        OPEN,\n        CLOSED,\n        EXPIRED\n    }\n\n    // Events\n    event LogOpen(bytes32 _swapID, address _spender, bytes32 _secretLock);\n    event LogExpire(bytes32 _swapID);\n    event LogClose(bytes32 _swapID, bytes32 _secretKey);\n\n    // Storage\n    mapping (bytes32 => Swap) internal swaps;\n    mapping (bytes32 => States) private _swapStates;\n    mapping (address => uint256) private _brokerFees;\n    mapping (bytes32 => uint256) private _redeemedAt;\n\n    /// @notice Throws if the swap is not invalid (i.e. has already been opened)\n    modifier onlyInvalidSwaps(bytes32 _swapID) {\n        require(_swapStates[_swapID] == States.INVALID, \"swap opened previously\");\n        _;\n    }\n\n    /// @notice Throws if the swap is not open.\n    modifier onlyOpenSwaps(bytes32 _swapID) {\n        require(_swapStates[_swapID] == States.OPEN, \"swap not open\");\n        _;\n    }\n\n    /// @notice Throws if the swap is not closed.\n    modifier onlyClosedSwaps(bytes32 _swapID) {\n        require(_swapStates[_swapID] == States.CLOSED, \"swap not redeemed\");\n        _;\n    }\n\n    /// @notice Throws if the swap is not expirable.\n    modifier onlyExpirableSwaps(bytes32 _swapID) {\n        /* solium-disable-next-line security/no-block-members */\n        require(now >= swaps[_swapID].timelock, \"swap not expirable\");\n        _;\n    }\n\n    /// @notice Throws if the secret key is not valid.\n    modifier onlyWithSecretKey(bytes32 _swapID, bytes32 _secretKey) {\n        require(swaps[_swapID].secretLock == sha256(abi.encodePacked(_secretKey)), \"invalid secret\");\n        _;\n    }\n\n    /// @notice Throws if the caller is not the authorized spender.\n    modifier onlySpender(bytes32 _swapID, address _spender) {\n        require(swaps[_swapID].spender == _spender, \"unauthorized spender\");\n        _;\n    }\n\n    /// @notice The contract constructor.\n    ///\n    /// @param _VERSION A string defining the contract version.\n    constructor(string memory _VERSION) public {\n        VERSION = _VERSION;\n    }\n\n    /// @notice Initiates the atomic swap.\n    ///\n    /// @param _swapID The unique atomic swap id.\n    /// @param _spender The address of the withdrawing trader.\n    /// @param _secretLock The hash of the secret (Hash Lock).\n    /// @param _timelock The unix timestamp when the swap expires.\n    /// @param _value The value of the atomic swap.\n    function initiate(\n        bytes32 _swapID,\n        address payable _spender,\n        bytes32 _secretLock,\n        uint256 _timelock,\n        uint256 _value\n    ) public onlyInvalidSwaps(_swapID) payable {\n        // Store the details of the swap.\n        Swap memory swap = Swap({\n            timelock: _timelock,\n            brokerFee: 0,\n            value: _value,\n            funder: msg.sender,\n            spender: _spender,\n            broker: address(0x0),\n            secretLock: _secretLock,\n            secretKey: 0x0\n        });\n        swaps[_swapID] = swap;\n        _swapStates[_swapID] = States.OPEN;\n\n        // Logs open event\n        emit LogOpen(_swapID, _spender, _secretLock);\n    }\n\n    /// @notice Initiates the atomic swap with fees.\n    ///\n    /// @param _swapID The unique atomic swap id.\n    /// @param _spender The address of the withdrawing trader.\n    /// @param _broker The address of the broker.\n    /// @param _brokerFee The fee to be paid to the broker on success.\n    /// @param _secretLock The hash of the secret (Hash Lock).\n    /// @param _timelock The unix timestamp when the swap expires.\n    /// @param _value The value of the atomic swap.\n    function initiateWithFees(\n        bytes32 _swapID,\n        address payable _spender,\n        address payable _broker,\n        uint256 _brokerFee,\n        bytes32 _secretLock,\n        uint256 _timelock,\n        uint256 _value\n    ) public onlyInvalidSwaps(_swapID) payable {\n        require(_value >= _brokerFee, \"fee must be less than value\");\n\n        // Store the details of the swap.\n        Swap memory swap = Swap({\n            timelock: _timelock,\n            brokerFee: _brokerFee,\n            value: _value - _brokerFee,\n            funder: msg.sender,\n            spender: _spender,\n            broker: _broker,\n            secretLock: _secretLock,\n            secretKey: 0x0\n        });\n        swaps[_swapID] = swap;\n        _swapStates[_swapID] = States.OPEN;\n\n        // Logs open event\n        emit LogOpen(_swapID, _spender, _secretLock);\n    }\n\n    /// @notice Redeems an atomic swap.\n    ///\n    /// @param _swapID The unique atomic swap id.\n    /// @param _receiver The receiver's address.\n    /// @param _secretKey The secret of the atomic swap.\n    function redeem(bytes32 _swapID, address payable _receiver, bytes32 _secretKey) public onlyOpenSwaps(_swapID) onlyWithSecretKey(_swapID, _secretKey) onlySpender(_swapID, msg.sender) {\n        require(_receiver != address(0x0), \"invalid receiver\");\n\n        // Close the swap.\n        swaps[_swapID].secretKey = _secretKey;\n        _swapStates[_swapID] = States.CLOSED;\n        /* solium-disable-next-line security/no-block-members */\n        _redeemedAt[_swapID] = now;\n\n        // Update the broker fees to the broker.\n        _brokerFees[swaps[_swapID].broker] += swaps[_swapID].brokerFee;\n\n        // Logs close event\n        emit LogClose(_swapID, _secretKey);\n    }\n\n    /// @notice Redeems an atomic swap to the spender. Can be called by anyone.\n    ///\n    /// @param _swapID The unique atomic swap id.\n    /// @param _secretKey The secret of the atomic swap.\n    function redeemToSpender(bytes32 _swapID, bytes32 _secretKey) public onlyOpenSwaps(_swapID) onlyWithSecretKey(_swapID, _secretKey) {\n        // Close the swap.\n        swaps[_swapID].secretKey = _secretKey;\n        _swapStates[_swapID] = States.CLOSED;\n        /* solium-disable-next-line security/no-block-members */\n        _redeemedAt[_swapID] = now;\n\n        // Update the broker fees to the broker.\n        _brokerFees[swaps[_swapID].broker] += swaps[_swapID].brokerFee;\n\n        // Logs close event\n        emit LogClose(_swapID, _secretKey);\n    }\n\n    /// @notice Refunds an atomic swap.\n    ///\n    /// @param _swapID The unique atomic swap id.\n    function refund(bytes32 _swapID) public onlyOpenSwaps(_swapID) onlyExpirableSwaps(_swapID) {\n        // Expire the swap.\n        _swapStates[_swapID] = States.EXPIRED;\n\n        // Logs expire event\n        emit LogExpire(_swapID);\n    }\n\n    /// @notice Allows broker fee withdrawals.\n    ///\n    /// @param _amount The withdrawal amount.\n    function withdrawBrokerFees(uint256 _amount) public {\n        require(_amount <= _brokerFees[msg.sender], \"insufficient withdrawable fees\");\n        _brokerFees[msg.sender] -= _amount;\n    }\n\n    /// @notice Audits an atomic swap.\n    ///\n    /// @param _swapID The unique atomic swap id.\n    function audit(bytes32 _swapID) external view returns (uint256 timelock, uint256 value, address to, uint256 brokerFee, address broker, address from, bytes32 secretLock) {\n        Swap memory swap = swaps[_swapID];\n        return (\n            swap.timelock,\n            swap.value,\n            swap.spender,\n            swap.brokerFee,\n            swap.broker,\n            swap.funder,\n            swap.secretLock\n        );\n    }\n\n    /// @notice Audits the secret of an atomic swap.\n    ///\n    /// @param _swapID The unique atomic swap id.\n    function auditSecret(bytes32 _swapID) external view onlyClosedSwaps(_swapID) returns (bytes32 secretKey) {\n        return swaps[_swapID].secretKey;\n    }\n\n    /// @notice Checks whether a swap is refundable or not.\n    ///\n    /// @param _swapID The unique atomic swap id.\n    function refundable(bytes32 _swapID) external view returns (bool) {\n        /* solium-disable-next-line security/no-block-members */\n        return (now >= swaps[_swapID].timelock && _swapStates[_swapID] == States.OPEN);\n    }\n\n    /// @notice Checks whether a swap is initiatable or not.\n    ///\n    /// @param _swapID The unique atomic swap id.\n    function initiatable(bytes32 _swapID) external view returns (bool) {\n        return (_swapStates[_swapID] == States.INVALID);\n    }\n\n    /// @notice Checks whether a swap is redeemable or not.\n    ///\n    /// @param _swapID The unique atomic swap id.\n    function redeemable(bytes32 _swapID) external view returns (bool) {\n        return (_swapStates[_swapID] == States.OPEN);\n    }\n\n    function redeemedAt(bytes32 _swapID) external view returns (uint256) {\n        return _redeemedAt[_swapID];\n    }\n\n    function brokerFees(address _broker) external view returns (uint256) {\n        return _brokerFees[_broker];\n    }\n\n    /// @notice Generates a deterministic swap id using initiate swap details.\n    ///\n    /// @param _secretLock The hash of the secret.\n    /// @param _timelock The expiry timestamp.\n    function swapID(bytes32 _secretLock, uint256 _timelock) external pure returns (bytes32) {\n        return keccak256(abi.encodePacked(_secretLock, _timelock));\n    }\n}\n\n/**\n * @title SafeMath\n * @dev Unsigned math operations with safety checks that revert on error\n */\nlibrary SafeMath {\n    /**\n    * @dev Multiplies two unsigned integers, reverts on overflow.\n    */\n    function mul(uint256 a, uint256 b) internal pure returns (uint256) {\n        // Gas optimization: this is cheaper than requiring 'a' not being zero, but the\n        // benefit is lost if 'b' is also tested.\n        // See: https://github.com/OpenZeppelin/openzeppelin-solidity/pull/522\n        if (a == 0) {\n            return 0;\n        }\n\n        uint256 c = a * b;\n        require(c / a == b);\n\n        return c;\n    }\n\n    /**\n    * @dev Integer division of two unsigned integers truncating the quotient, reverts on division by zero.\n    */\n    function div(uint256 a, uint256 b) internal pure returns (uint256) {\n        // Solidity only automatically asserts when dividing by 0\n        require(b > 0);\n        uint256 c = a / b;\n        // assert(a == b * c + a % b); // There is no case in which this doesn't hold\n\n        return c;\n    }\n\n    /**\n    * @dev Subtracts two unsigned integers, reverts on overflow (i.e. if subtrahend is greater than minuend).\n    */\n    function sub(uint256 a, uint256 b) internal pure returns (uint256) {\n        require(b <= a);\n        uint256 c = a - b;\n\n        return c;\n    }\n\n    /**\n    * @dev Adds two unsigned integers, reverts on overflow.\n    */\n    function add(uint256 a, uint256 b) internal pure returns (uint256) {\n        uint256 c = a + b;\n        require(c >= a);\n\n        return c;\n    }\n\n    /**\n    * @dev Divides two unsigned integers and returns the remainder (unsigned integer modulo),\n    * reverts when dividing by zero.\n    */\n    function mod(uint256 a, uint256 b) internal pure returns (uint256) {\n        require(b != 0);\n        return a % b;\n    }\n}\n\n/**\n * @title Math\n * @dev Assorted math operations\n */\nlibrary Math {\n    /**\n    * @dev Returns the largest of two numbers.\n    */\n    function max(uint256 a, uint256 b) internal pure returns (uint256) {\n        return a >= b ? a : b;\n    }\n\n    /**\n    * @dev Returns the smallest of two numbers.\n    */\n    function min(uint256 a, uint256 b) internal pure returns (uint256) {\n        return a < b ? a : b;\n    }\n\n    /**\n    * @dev Calculates the average of two numbers. Since these are integers,\n    * averages of an even and odd number cannot be represented, and will be\n    * rounded down.\n    */\n    function average(uint256 a, uint256 b) internal pure returns (uint256) {\n        // (a + b) / 2 can overflow, so we distribute\n        return (a / 2) + (b / 2) + ((a % 2 + b % 2) / 2);\n    }\n}\n\n/// @notice Implements safeTransfer, safeTransferFrom and\n/// safeApprove for CompatibleERC20.\n///\n/// See https://github.com/ethereum/solidity/issues/4116\n///\n/// This library allows interacting with ERC20 tokens that implement any of\n/// these interfaces:\n///\n/// (1) transfer returns true on success, false on failure\n/// (2) transfer returns true on success, reverts on failure\n/// (3) transfer returns nothing on success, reverts on failure\n///\n/// Additionally, safeTransferFromWithFees will return the final token\n/// value received after accounting for token fees.\nlibrary CompatibleERC20Functions {\n    using SafeMath for uint256;\n\n    /// @notice Calls transfer on the token and reverts if the call fails.\n    function safeTransfer(CompatibleERC20 self, address to, uint256 amount) internal {\n        self.transfer(to, amount);\n        require(previousReturnValue(), \"transfer failed\");\n    }\n\n    /// @notice Calls transferFrom on the token and reverts if the call fails.\n    function safeTransferFrom(CompatibleERC20 self, address from, address to, uint256 amount) internal {\n        self.transferFrom(from, to, amount);\n        require(previousReturnValue(), \"transferFrom failed\");\n    }\n\n    /// @notice Calls approve on the token and reverts if the call fails.\n    function safeApprove(CompatibleERC20 self, address spender, uint256 amount) internal {\n        self.approve(spender, amount);\n        require(previousReturnValue(), \"approve failed\");\n    }\n\n    /// @notice Calls transferFrom on the token, reverts if the call fails and\n    /// returns the value transferred after fees.\n    function safeTransferFromWithFees(CompatibleERC20 self, address from, address to, uint256 amount) internal returns (uint256) {\n        uint256 balancesBefore = self.balanceOf(to);\n        self.transferFrom(from, to, amount);\n        require(previousReturnValue(), \"transferFrom failed\");\n        uint256 balancesAfter = self.balanceOf(to);\n        return Math.min(amount, balancesAfter.sub(balancesBefore));\n    }\n\n    /// @notice Checks the return value of the previous function. Returns true\n    /// if the previous function returned 32 non-zero bytes or returned zero\n    /// bytes.\n    function previousReturnValue() private pure returns (bool)\n    {\n        uint256 returnData = 0;\n\n        assembly { /* solium-disable-line security/no-inline-assembly */\n            // Switch on the number of bytes returned by the previous call\n            switch returndatasize\n\n            // 0 bytes: ERC20 of type (3), did not throw\n            case 0 {\n                returnData := 1\n            }\n\n            // 32 bytes: ERC20 of types (1) or (2)\n            case 32 {\n                // Copy the return data into scratch space\n                returndatacopy(0, 0, 32)\n\n                // Load  the return data into returnData\n                returnData := mload(0)\n            }\n\n            // Other return size: return false\n            default { }\n        }\n\n        return returnData != 0;\n    }\n}\n\n/// @notice ERC20 interface which doesn't specify the return type for transfer,\n/// transferFrom and approve.\ninterface CompatibleERC20 {\n    // Modified to not return boolean\n    function transfer(address to, uint256 value) external;\n    function transferFrom(address from, address to, uint256 value) external;\n    function approve(address spender, uint256 value) external;\n\n    // Not modifier\n    function totalSupply() external view returns (uint256);\n    function balanceOf(address who) external view returns (uint256);\n    function allowance(address owner, address spender) external view returns (uint256);\n    event Transfer(address indexed from, address indexed to, uint256 value);\n    event Approval(address indexed owner, address indexed spender, uint256 value);\n}\n\n/// @notice ERC20Swap implements the ERC20Swap interface.\ncontract ERC20Swap is SwapInterface, BaseSwap {\n    using CompatibleERC20Functions for CompatibleERC20;\n\n    address public TOKEN_ADDRESS; // Address of the ERC20 contract. Passed in as a constructor parameter\n\n    /// @notice The contract constructor.\n    ///\n    /// @param _VERSION A string defining the contract version.\n    constructor(string memory _VERSION, address _TOKEN_ADDRESS) BaseSwap(_VERSION) public {\n        TOKEN_ADDRESS = _TOKEN_ADDRESS;\n    }\n\n    /// @notice Initiates the atomic swap.\n    ///\n    /// @param _swapID The unique atomic swap id.\n    /// @param _spender The address of the withdrawing trader.\n    /// @param _secretLock The hash of the secret (Hash Lock).\n    /// @param _timelock The unix timestamp when the swap expires.\n    /// @param _value The value of the atomic swap.\n    function initiate(\n        bytes32 _swapID,\n        address payable _spender,\n        bytes32 _secretLock,\n        uint256 _timelock,\n        uint256 _value\n    ) public payable {\n        // To abide by the interface, the function is payable but throws if\n        // msg.value is non-zero\n        require(msg.value == 0, \"eth value must be zero\");\n        require(_spender != address(0x0), \"spender must not be zero\");\n\n        // Transfer the token to the contract\n        // TODO: Initiator will first need to call\n        // ERC20(TOKEN_ADDRESS).approve(address(this), _value)\n        // before this contract can make transfers on the initiator's behalf.\n        CompatibleERC20(TOKEN_ADDRESS).safeTransferFrom(msg.sender, address(this), _value);\n\n        BaseSwap.initiate(\n            _swapID,\n            _spender,\n            _secretLock,\n            _timelock,\n            _value\n        );\n    }\n\n    /// @notice Initiates the atomic swap with broker fees.\n    ///\n    /// @param _swapID The unique atomic swap id.\n    /// @param _spender The address of the withdrawing trader.\n    /// @param _broker The address of the broker.\n    /// @param _brokerFee The fee to be paid to the broker on success.\n    /// @param _secretLock The hash of the secret (Hash Lock).\n    /// @param _timelock The unix timestamp when the swap expires.\n    /// @param _value The value of the atomic swap.\n    function initiateWithFees(\n        bytes32 _swapID,\n        address payable _spender,\n        address payable _broker,\n        uint256 _brokerFee,\n        bytes32 _secretLock,\n        uint256 _timelock,\n        uint256 _value\n    ) public payable {\n        // To abide by the interface, the function is payable but throws if\n        // msg.value is non-zero\n        require(msg.value == 0, \"eth value must be zero\");\n        require(_spender != address(0x0), \"spender must not be zero\");\n\n        // Transfer the token to the contract\n        // TODO: Initiator will first need to call\n        // ERC20(TOKEN_ADDRESS).approve(address(this), _value)\n        // before this contract can make transfers on the initiator's behalf.\n        CompatibleERC20(TOKEN_ADDRESS).safeTransferFrom(msg.sender, address(this), _value);\n\n        BaseSwap.initiateWithFees(\n            _swapID,\n            _spender,\n            _broker,\n            _brokerFee,\n            _secretLock,\n            _timelock,\n            _value\n        );\n    }\n\n    /// @notice Redeems an atomic swap.\n    ///\n    /// @param _swapID The unique atomic swap id.\n    /// @param _secretKey The secret of the atomic swap.\n    function redeem(bytes32 _swapID, address payable _receiver, bytes32 _secretKey) public {\n        BaseSwap.redeem(\n            _swapID,\n            _receiver,\n            _secretKey\n        );\n\n        // Transfer the ERC20 funds from this contract to the withdrawing trader.\n        CompatibleERC20(TOKEN_ADDRESS).safeTransfer(_receiver, swaps[_swapID].value);\n    }\n\n    /// @notice Redeems an atomic swap to the spender. Can be called by anyone.\n    ///\n    /// @param _swapID The unique atomic swap id.\n    /// @param _secretKey The secret of the atomic swap.\n    function redeemToSpender(bytes32 _swapID, bytes32 _secretKey) public {\n        BaseSwap.redeemToSpender(\n            _swapID,\n            _secretKey\n        );\n\n        // Transfer the ERC20 funds from this contract to the withdrawing trader.\n        CompatibleERC20(TOKEN_ADDRESS).safeTransfer(swaps[_swapID].spender, swaps[_swapID].value);\n    }\n\n    /// @notice Refunds an atomic swap.\n    ///\n    /// @param _swapID The unique atomic swap id.\n    function refund(bytes32 _swapID) public {\n        BaseSwap.refund(_swapID);\n\n        // Transfer the ERC20 value from this contract back to the funding trader.\n        CompatibleERC20(TOKEN_ADDRESS).safeTransfer(swaps[_swapID].funder, swaps[_swapID].value + swaps[_swapID].brokerFee);\n    }\n\n    /// @notice Allows broker fee withdrawals.\n    ///\n    /// @param _amount The withdrawal amount.\n    function withdrawBrokerFees(uint256 _amount) public {\n        BaseSwap.withdrawBrokerFees(_amount);\n\n        CompatibleERC20(TOKEN_ADDRESS).safeTransfer(msg.sender, _amount);\n    }\n}",
  "bytecode": "60806040523480156200001157600080fd5b506040516200199538038062001995833981018060405260408110156200003757600080fd5b8101908080516401000000008111156200005057600080fd5b820160208101848111156200006457600080fd5b81516401000000008111828201871017156200007f57600080fd5b5050602091820151815191945092508391620000a191600091840190620000ca565b505060058054600160a060020a031916600160a060020a0392909216919091179055506200016f565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106200010d57805160ff19168380011785556200013d565b828001600101855582156200013d579182015b828111156200013d57825182559160200191906001019062000120565b506200014b9291506200014f565b5090565b6200016c91905b808211156200014b576000815560010162000156565b90565b611816806200017f6000396000f3fe6080604052600436106100e55763ffffffff7c0100000000000000000000000000000000000000000000000000000000600035041663027a257781146100ea57806309ece6181461012a5780630bdf5300146101685780634b2ac3fa146101995780634c6d37ff146101db57806368f06b29146102055780637249fbb61461022f578063976d00f4146102595780639fb3147514610283578063b8688e3f146102ad578063bc4fcc4a146102fb578063c140635b14610325578063c23b1a8514610395578063d68db544146103d4578063e1ec380c14610404578063ffa1ad7414610437575b600080fd5b610128600480360360a081101561010057600080fd5b50803590600160a060020a0360208201351690604081013590606081013590608001356104c1565b005b34801561013657600080fd5b506101546004803603602081101561014d57600080fd5b50356105a9565b604080519115158252519081900360200190f35b34801561017457600080fd5b5061017d6105d1565b60408051600160a060020a039092168252519081900360200190f35b3480156101a557600080fd5b506101c9600480360360408110156101bc57600080fd5b50803590602001356105e0565b60408051918252519081900360200190f35b3480156101e757600080fd5b50610128600480360360208110156101fe57600080fd5b503561060c565b34801561021157600080fd5b506101546004803603602081101561022857600080fd5b5035610635565b34801561023b57600080fd5b506101286004803603602081101561025257600080fd5b503561063e565b34801561026557600080fd5b506101c96004803603602081101561027c57600080fd5b5035610689565b34801561028f57600080fd5b50610154600480360360208110156102a657600080fd5b5035610717565b610128600480360360e08110156102c357600080fd5b50803590600160a060020a03602082013581169160408101359091169060608101359060808101359060a08101359060c0013561073d565b34801561030757600080fd5b506101c96004803603602081101561031e57600080fd5b5035610829565b34801561033157600080fd5b5061034f6004803603602081101561034857600080fd5b503561083b565b604080519788526020880196909652600160a060020a03948516878701526060870193909352908316608086015290911660a084015260c0830152519081900360e00190f35b3480156103a157600080fd5b50610128600480360360608110156103b857600080fd5b50803590600160a060020a0360208201351690604001356108e3565b3480156103e057600080fd5b50610128600480360360408110156103f757600080fd5b5080359060200135610926565b34801561041057600080fd5b506101c96004803603602081101561042757600080fd5b5035600160a060020a031661096e565b34801561044357600080fd5b5061044c610989565b6040805160208082528351818301528351919283929083019185019080838360005b8381101561048657818101518382015260200161046e565b50505050905090810190601f1680156104b35780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b3415610517576040805160e560020a62461bcd02815260206004820152601660248201527f6574682076616c7565206d757374206265207a65726f00000000000000000000604482015290519081900360640190fd5b600160a060020a0384161515610577576040805160e560020a62461bcd02815260206004820152601860248201527f7370656e646572206d757374206e6f74206265207a65726f0000000000000000604482015290519081900360640190fd5b60055461059590600160a060020a031633308463ffffffff610a1716565b6105a28585858585610b06565b5050505050565b6000805b60008381526002602052604090205460ff1660038111156105ca57fe5b1492915050565b600554600160a060020a031681565b604080516020808201949094528082019290925280518083038201815260609092019052805191012090565b61061581610d36565b60055461063290600160a060020a0316338363ffffffff610db616565b50565b600060016105ad565b61064781610ea8565b600081815260016020819052604090912060058082015460028301549290930154905461063293600160a060020a03918216939116910163ffffffff610db616565b600081600260008281526002602052604090205460ff1660038111156106ab57fe5b14610700576040805160e560020a62461bcd02815260206004820152601160248201527f73776170206e6f742072656465656d6564000000000000000000000000000000604482015290519081900360640190fd5b505060009081526001602052604090206004015490565b6000818152600160205260408120544210801590610737575060016105ad565b92915050565b3415610793576040805160e560020a62461bcd02815260206004820152601660248201527f6574682076616c7565206d757374206265207a65726f00000000000000000000604482015290519081900360640190fd5b600160a060020a03861615156107f3576040805160e560020a62461bcd02815260206004820152601860248201527f7370656e646572206d757374206e6f74206265207a65726f0000000000000000604482015290519081900360640190fd5b60055461081190600160a060020a031633308463ffffffff610a1716565b61082087878787878787610fd8565b50505050505050565b60009081526004602052604090205490565b600080600080600080600061084e6117a6565b50505060009586525050600160208181526040958690208651610100810188528154808252938201549281018390526002820154978101889052600382015460608201819052600483015460808301526005830154600160a060020a0390811660a084018190526006850154821660c0850181905260079095015490911660e090930183905294999398929750919550935090565b6108ee838383611262565b6000838152600160208190526040909120015460055461092191600160a060020a0390911690849063ffffffff610db616565b505050565b6109308282611556565b6000828152600160208190526040909120600681015491015460055461096a92600160a060020a039182169291169063ffffffff610db616565b5050565b600160a060020a031660009081526003602052604090205490565b6000805460408051602060026001851615610100026000190190941693909304601f81018490048402820184019092528181529291830182828015610a0f5780601f106109e457610100808354040283529160200191610a0f565b820191906000526020600020905b8154815290600101906020018083116109f257829003601f168201915b505050505081565b604080517f23b872dd000000000000000000000000000000000000000000000000000000008152600160a060020a0385811660048301528481166024830152604482018490529151918616916323b872dd9160648082019260009290919082900301818387803b158015610a8a57600080fd5b505af1158015610a9e573d6000803e3d6000fd5b50505050610aaa611772565b1515610b00576040805160e560020a62461bcd02815260206004820152601360248201527f7472616e7366657246726f6d206661696c656400000000000000000000000000604482015290519081900360640190fd5b50505050565b846000808281526002602052604090205460ff166003811115610b2557fe5b14610b7a576040805160e560020a62461bcd02815260206004820152601660248201527f73776170206f70656e65642070726576696f75736c7900000000000000000000604482015290519081900360640190fd5b610b826117a6565b61010060405190810160405280858152602001848152602001600081526020018681526020016000600102815260200133600160a060020a0316815260200187600160a060020a031681526020016000600160a060020a031681525090508060016000898152602001908152602001600020600082015181600001556020820151816001015560408201518160020155606082015181600301556080820151816004015560a08201518160050160006101000a815481600160a060020a030219169083600160a060020a0316021790555060c08201518160060160006101000a815481600160a060020a030219169083600160a060020a0316021790555060e08201518160070160006101000a815481600160a060020a030219169083600160a060020a0316021790555090505060016002600089815260200190815260200160002060006101000a81548160ff02191690836003811115610ce057fe5b021790555060408051888152600160a060020a038816602082015280820187905290517f497d46e9505eefe8b910d1a02e6b40d8769510023b0053c3ac4b9574b81c97bf9181900360600190a150505050505050565b33600090815260036020526040902054811115610d9d576040805160e560020a62461bcd02815260206004820152601e60248201527f696e73756666696369656e7420776974686472617761626c6520666565730000604482015290519081900360640190fd5b3360009081526003602052604090208054919091039055565b82600160a060020a031663a9059cbb83836040518363ffffffff167c01000000000000000000000000000000000000000000000000000000000281526004018083600160a060020a0316600160a060020a0316815260200182815260200192505050600060405180830381600087803b158015610e3257600080fd5b505af1158015610e46573d6000803e3d6000fd5b50505050610e52611772565b1515610921576040805160e560020a62461bcd02815260206004820152600f60248201527f7472616e73666572206661696c65640000000000000000000000000000000000604482015290519081900360640190fd5b80600160008281526002602052604090205460ff166003811115610ec857fe5b14610f1d576040805160e560020a62461bcd02815260206004820152600d60248201527f73776170206e6f74206f70656e00000000000000000000000000000000000000604482015290519081900360640190fd5b6000828152600160205260409020548290421015610f85576040805160e560020a62461bcd02815260206004820152601260248201527f73776170206e6f7420657870697261626c650000000000000000000000000000604482015290519081900360640190fd5b600083815260026020908152604091829020805460ff19166003179055815185815291517feb711459e1247171382f0da0387b86239b8e3ca60af3b15a9ff2f1eb3d7f6a1d9281900390910190a1505050565b866000808281526002602052604090205460ff166003811115610ff757fe5b1461104c576040805160e560020a62461bcd02815260206004820152601660248201527f73776170206f70656e65642070726576696f75736c7900000000000000000000604482015290519081900360640190fd5b848210156110a4576040805160e560020a62461bcd02815260206004820152601b60248201527f666565206d757374206265206c657373207468616e2076616c75650000000000604482015290519081900360640190fd5b6110ac6117a6565b6101006040519081016040528085815260200187850381526020018781526020018681526020016000600102815260200133600160a060020a0316815260200189600160a060020a0316815260200188600160a060020a0316815250905080600160008b8152602001908152602001600020600082015181600001556020820151816001015560408201518160020155606082015181600301556080820151816004015560a08201518160050160006101000a815481600160a060020a030219169083600160a060020a0316021790555060c08201518160060160006101000a815481600160a060020a030219169083600160a060020a0316021790555060e08201518160070160006101000a815481600160a060020a030219169083600160a060020a031602179055509050506001600260008b815260200190815260200160002060006101000a81548160ff0219169083600381111561120a57fe5b0217905550604080518a8152600160a060020a038a16602082015280820187905290517f497d46e9505eefe8b910d1a02e6b40d8769510023b0053c3ac4b9574b81c97bf9181900360600190a1505050505050505050565b82600160008281526002602052604090205460ff16600381111561128257fe5b146112d7576040805160e560020a62461bcd02815260206004820152600d60248201527f73776170206e6f74206f70656e00000000000000000000000000000000000000604482015290519081900360640190fd5b8382600281604051602001808281526020019150506040516020818303038152906040526040518082805190602001908083835b6020831061132a5780518252601f19909201916020918201910161130b565b51815160209384036101000a60001901801990921691161790526040519190930194509192505080830381855afa158015611369573d6000803e3d6000fd5b5050506040513d602081101561137e57600080fd5b5051600083815260016020526040902060030154146113e7576040805160e560020a62461bcd02815260206004820152600e60248201527f696e76616c696420736563726574000000000000000000000000000000000000604482015290519081900360640190fd5b60008681526001602052604090206006015486903390600160a060020a0316811461145c576040805160e560020a62461bcd02815260206004820152601460248201527f756e617574686f72697a6564207370656e646572000000000000000000000000604482015290519081900360640190fd5b600160a060020a03871615156114bc576040805160e560020a62461bcd02815260206004820152601060248201527f696e76616c696420726563656976657200000000000000000000000000000000604482015290519081900360640190fd5b600088815260016020908152604080832060048082018b90556002808552838620805460ff191682179055908452828520429055810154600790910154600160a060020a031684526003835292819020805490930190925581518a815290810188905281517f07da1fa25a1d885732677ce9c192cbec27051a4b69d391c9a64850f5a5112ba0929181900390910190a15050505050505050565b81600160008281526002602052604090205460ff16600381111561157657fe5b146115cb576040805160e560020a62461bcd02815260206004820152600d60248201527f73776170206e6f74206f70656e00000000000000000000000000000000000000604482015290519081900360640190fd5b8282600281604051602001808281526020019150506040516020818303038152906040526040518082805190602001908083835b6020831061161e5780518252601f1990920191602091820191016115ff565b51815160209384036101000a60001901801990921691161790526040519190930194509192505080830381855afa15801561165d573d6000803e3d6000fd5b5050506040513d602081101561167257600080fd5b5051600083815260016020526040902060030154146116db576040805160e560020a62461bcd02815260206004820152600e60248201527f696e76616c696420736563726574000000000000000000000000000000000000604482015290519081900360640190fd5b600085815260016020908152604080832060048082018990556002808552838620805460ff191682179055908452828520429055810154600790910154600160a060020a0316845260038352928190208054909301909255815187815290810186905281517f07da1fa25a1d885732677ce9c192cbec27051a4b69d391c9a64850f5a5112ba0929181900390910190a15050505050565b6000803d801561178957602081146117925761179e565b6001915061179e565b60206000803e60005191505b501515905090565b6040805161010081018252600080825260208201819052918101829052606081018290526080810182905260a0810182905260c0810182905260e08101919091529056fea165627a7a7230582055a628c076ff78cd5690cc607bc34a3b11d5bb9c7831086a3000bada55025609002900000000000000000000000000000000000000000000000000000000000000400000000000000000000000002260fac5e5542a773aa44fbcfedf7c193bc2c5990000000000000000000000000000000000000000000000000000000000000005312e302e31000000000000000000000000000000000000000000000000000000",
  "constructorArguments": "00000000000000000000000000000000000000000000000000000000000000400000000000000000000000002260fac5e5542a773aa44fbcfedf7c193bc2c5990000000000000000000000000000000000000000000000000000000000000005312e302e31000000000000000000000000000000000000000000000000000000"
}