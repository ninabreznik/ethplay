{
  "address": "0xdf6767a7715381867738cf211290f61697ecd938",
  "chain": "ETH",
  "chainID": 1,
  "verifier": "etherscan.io",
  "commonName": "",
  "contractName": "TokenTransfer",
  "compilerVersion": "v0.4.24+commit.e67f0147",
  "optimization": true,
  "runs": "999",
  "evmVersion": "default",
  "sourceCode": "/**\n *Submitted for verification at Etherscan.io on 2019-02-05\n*/\n\npragma solidity ^0.4.24;\n\n/**\n * @title Module\n * @dev Interface for a module. \n * A module MUST implement the addModule() method to ensure that a wallet with at least one module\n * can never end up in a \"frozen\" state.\n * @author Julien Niset - <[email protected]>\n */\ninterface Module {\n\n    /**\n     * @dev Inits a module for a wallet by e.g. setting some wallet specific parameters in storage.\n     * @param _wallet The wallet.\n     */\n    function init(BaseWallet _wallet) external;\n\n    /**\n     * @dev Adds a module to a wallet.\n     * @param _wallet The target wallet.\n     * @param _module The modules to authorise.\n     */\n    function addModule(BaseWallet _wallet, Module _module) external;\n\n    /**\n    * @dev Utility method to recover any ERC20 token that was sent to the\n    * module by mistake. \n    * @param _token The token to recover.\n    */\n    function recoverToken(address _token) external;\n}\n\n/**\n * @title BaseModule\n * @dev Basic module that contains some methods common to all modules.\n * @author Julien Niset - <[email protected]>\n */\ncontract BaseModule is Module {\n\n    // The adddress of the module registry.\n    ModuleRegistry internal registry;\n\n    event ModuleCreated(bytes32 name);\n    event ModuleInitialised(address wallet);\n\n    constructor(ModuleRegistry _registry, bytes32 _name) public {\n        registry = _registry;\n        emit ModuleCreated(_name);\n    }\n\n    /**\n     * @dev Throws if the sender is not the target wallet of the call.\n     */\n    modifier onlyWallet(BaseWallet _wallet) {\n        require(msg.sender == address(_wallet), \"BM: caller must be wallet\");\n        _;\n    }\n\n    /**\n     * @dev Throws if the sender is not the owner of the target wallet or the module itself.\n     */\n    modifier onlyOwner(BaseWallet _wallet) {\n        require(msg.sender == address(this) || isOwner(_wallet, msg.sender), \"BM: must be an owner for the wallet\");\n        _;\n    }\n\n    /**\n     * @dev Throws if the sender is not the owner of the target wallet.\n     */\n    modifier strictOnlyOwner(BaseWallet _wallet) {\n        require(isOwner(_wallet, msg.sender), \"BM: msg.sender must be an owner for the wallet\");\n        _;\n    }\n\n    /**\n     * @dev Inits the module for a wallet by logging an event.\n     * The method can only be called by the wallet itself.\n     * @param _wallet The wallet.\n     */\n    function init(BaseWallet _wallet) external onlyWallet(_wallet) {\n        emit ModuleInitialised(_wallet);\n    }\n\n    /**\n     * @dev Adds a module to a wallet. First checks that the module is registered.\n     * @param _wallet The target wallet.\n     * @param _module The modules to authorise.\n     */\n    function addModule(BaseWallet _wallet, Module _module) external strictOnlyOwner(_wallet) {\n        require(registry.isRegisteredModule(_module), \"BM: module is not registered\");\n        _wallet.authoriseModule(_module, true);\n    }\n\n    /**\n    * @dev Utility method enbaling anyone to recover ERC20 token sent to the\n    * module by mistake and transfer them to the Module Registry. \n    * @param _token The token to recover.\n    */\n    function recoverToken(address _token) external {\n        uint total = ERC20(_token).balanceOf(address(this));\n        ERC20(_token).transfer(address(registry), total);\n    }\n\n    /**\n     * @dev Helper method to check if an address is the owner of a target wallet.\n     * @param _wallet The target wallet.\n     * @param _addr The address.\n     */\n    function isOwner(BaseWallet _wallet, address _addr) internal view returns (bool) {\n        return _wallet.owner() == _addr;\n    }\n}\n\n/**\n * @title RelayerModule\n * @dev Base module containing logic to execute transactions signed by eth-less accounts and sent by a relayer. \n * @author Julien Niset - <[email protected]>\n */\ncontract RelayerModule is Module {\n\n    uint256 constant internal BLOCKBOUND = 10000;\n\n    mapping (address => RelayerConfig) public relayer; \n\n    struct RelayerConfig {\n        uint256 nonce;\n        mapping (bytes32 => bool) executedTx;\n    }\n\n    event TransactionExecuted(address indexed wallet, bool indexed success, bytes32 signedHash);\n\n    /**\n     * @dev Throws if the call did not go through the execute() method.\n     */\n    modifier onlyExecute {\n        require(msg.sender == address(this), \"RM: must be called via execute()\");\n        _;\n    }\n\n    /* ***************** Abstract method ************************* */\n\n    /**\n    * @dev Gets the number of valid signatures that must be provided to execute a\n    * specific relayed transaction.\n    * @param _wallet The target wallet.\n    * @param _data The data of the relayed transaction.\n    * @return The number of required signatures.\n    */\n    function getRequiredSignatures(BaseWallet _wallet, bytes _data) internal view returns (uint256);\n\n    /**\n    * @dev Validates the signatures provided with a relayed transaction.\n    * The method MUST throw if one or more signatures are not valid.\n    * @param _wallet The target wallet.\n    * @param _data The data of the relayed transaction.\n    * @param _signHash The signed hash representing the relayed transaction.\n    * @param _signatures The signatures as a concatenated byte array.\n    */\n    function validateSignatures(BaseWallet _wallet, bytes _data, bytes32 _signHash, bytes _signatures) internal view returns (bool);\n\n    /* ************************************************************ */\n\n    /**\n    * @dev Executes a relayed transaction.\n    * @param _wallet The target wallet.\n    * @param _data The data for the relayed transaction\n    * @param _nonce The nonce used to prevent replay attacks.\n    * @param _signatures The signatures as a concatenated byte array.\n    * @param _gasPrice The gas price to use for the gas refund.\n    * @param _gasLimit The gas limit to use for the gas refund.\n    */\n    function execute(\n        BaseWallet _wallet,\n        bytes _data, \n        uint256 _nonce, \n        bytes _signatures, \n        uint256 _gasPrice,\n        uint256 _gasLimit\n    )\n        external\n        returns (bool success)\n    {\n        uint startGas = gasleft();\n        bytes32 signHash = getSignHash(address(this), _wallet, 0, _data, _nonce, _gasPrice, _gasLimit);\n        require(checkAndUpdateUniqueness(_wallet, _nonce, signHash), \"RM: Duplicate request\");\n        require(verifyData(address(_wallet), _data), \"RM: the wallet authorized is different then the target of the relayed data\");\n        uint256 requiredSignatures = getRequiredSignatures(_wallet, _data);\n        if((requiredSignatures * 65) == _signatures.length) {\n            if(verifyRefund(_wallet, _gasLimit, _gasPrice, requiredSignatures)) {\n                if(requiredSignatures == 0 || validateSignatures(_wallet, _data, signHash, _signatures)) {\n                    // solium-disable-next-line security/no-call-value\n                    success = address(this).call(_data);\n                    refund(_wallet, startGas - gasleft(), _gasPrice, _gasLimit, requiredSignatures, msg.sender);\n                }\n            }\n        }\n        emit TransactionExecuted(_wallet, success, signHash); \n    }\n\n    /**\n    * @dev Gets the current nonce for a wallet.\n    * @param _wallet The target wallet.\n    */\n    function getNonce(BaseWallet _wallet) external view returns (uint256 nonce) {\n        return relayer[_wallet].nonce;\n    }\n\n    /**\n    * @dev Generates the signed hash of a relayed transaction according to ERC 1077.\n    * @param _from The starting address for the relayed transaction (should be the module)\n    * @param _to The destination address for the relayed transaction (should be the wallet)\n    * @param _value The value for the relayed transaction\n    * @param _data The data for the relayed transaction\n    * @param _nonce The nonce used to prevent replay attacks.\n    * @param _gasPrice The gas price to use for the gas refund.\n    * @param _gasLimit The gas limit to use for the gas refund.\n    */\n    function getSignHash(\n        address _from,\n        address _to, \n        uint256 _value, \n        bytes _data, \n        uint256 _nonce,\n        uint256 _gasPrice,\n        uint256 _gasLimit\n    ) \n        internal \n        pure\n        returns (bytes32) \n    {\n        return keccak256(\n            abi.encodePacked(\n                \"\\x19Ethereum Signed Message:\\n32\",\n                keccak256(abi.encodePacked(byte(0x19), byte(0), _from, _to, _value, _data, _nonce, _gasPrice, _gasLimit))\n        ));\n    }\n\n    /**\n    * @dev Checks if the relayed transaction is unique.\n    * @param _wallet The target wallet.\n    * @param _nonce The nonce\n    * @param _signHash The signed hash of the transaction\n    */\n    function checkAndUpdateUniqueness(BaseWallet _wallet, uint256 _nonce, bytes32 _signHash) internal returns (bool) {\n        if(relayer[_wallet].executedTx[_signHash] == true) {\n            return false;\n        }\n        relayer[_wallet].executedTx[_signHash] = true;\n        return true;\n    }\n\n    /**\n    * @dev Checks that a nonce has the correct format and is valid. \n    * It must be constructed as nonce = {block number}{timestamp} where each component is 16 bytes.\n    * @param _wallet The target wallet.\n    * @param _nonce The nonce\n    */\n    function checkAndUpdateNonce(BaseWallet _wallet, uint256 _nonce) internal returns (bool) {\n        if(_nonce <= relayer[_wallet].nonce) {\n            return false;\n        }   \n        uint256 nonceBlock = (_nonce & 0xffffffffffffffffffffffffffffffff00000000000000000000000000000000) >> 128;\n        if(nonceBlock > block.number + BLOCKBOUND) {\n            return false;\n        }\n        relayer[_wallet].nonce = _nonce;\n        return true;    \n    }\n\n    /**\n    * @dev Recovers the signer at a given position from a list of concatenated signatures.\n    * @param _signedHash The signed hash\n    * @param _signatures The concatenated signatures.\n    * @param _index The index of the signature to recover.\n    */\n    function recoverSigner(bytes32 _signedHash, bytes _signatures, uint _index) internal pure returns (address) {\n        uint8 v;\n        bytes32 r;\n        bytes32 s;\n        // we jump 32 (0x20) as the first slot of bytes contains the length\n        // we jump 65 (0x41) per signature\n        // for v we load 32 bytes ending with v (the first 31 come from s) then apply a mask\n        // solium-disable-next-line security/no-inline-assembly\n        assembly {\n            r := mload(add(_signatures, add(0x20,mul(0x41,_index))))\n            s := mload(add(_signatures, add(0x40,mul(0x41,_index))))\n            v := and(mload(add(_signatures, add(0x41,mul(0x41,_index)))), 0xff)\n        }\n        require(v == 27 || v == 28); \n        return ecrecover(_signedHash, v, r, s);\n    }\n\n    /**\n    * @dev Refunds the gas used to the Relayer. \n    * For security reasons the default behavior is to not refund calls with 0 or 1 signatures. \n    * @param _wallet The target wallet.\n    * @param _gasUsed The gas used.\n    * @param _gasPrice The gas price for the refund.\n    * @param _gasLimit The gas limit for the refund.\n    * @param _signatures The number of signatures used in the call.\n    * @param _relayer The address of the Relayer.\n    */\n    function refund(BaseWallet _wallet, uint _gasUsed, uint _gasPrice, uint _gasLimit, uint _signatures, address _relayer) internal {\n        uint256 amount = 29292 + _gasUsed; // 21000 (transaction) + 7620 (execution of refund) + 672 to log the event + _gasUsed\n        // only refund if gas price not null, more than 1 signatures, gas less than gasLimit\n        if(_gasPrice > 0 && _signatures > 1 && amount <= _gasLimit) {\n            if(_gasPrice > tx.gasprice) {\n                amount = amount * tx.gasprice;\n            }\n            else {\n                amount = amount * _gasPrice;\n            }\n            _wallet.invoke(_relayer, amount, \"\");\n        }\n    }\n\n    /**\n    * @dev Returns false if the refund is expected to fail.\n    * @param _wallet The target wallet.\n    * @param _gasUsed The expected gas used.\n    * @param _gasPrice The expected gas price for the refund.\n    */\n    function verifyRefund(BaseWallet _wallet, uint _gasUsed, uint _gasPrice, uint _signatures) internal view returns (bool) {\n        if(_gasPrice > 0 \n            && _signatures > 1 \n            && (address(_wallet).balance < _gasUsed * _gasPrice || _wallet.authorised(this) == false)) {\n            return false;\n        }\n        return true;\n    }\n\n    /**\n    * @dev Checks that the wallet address provided as the first parameter of the relayed data is the same\n    * as the wallet passed as the input of the execute() method. \n    @return false if the addresses are different.\n    */\n    function verifyData(address _wallet, bytes _data) private pure returns (bool) {\n        require(_data.length >= 36, \"RM: Invalid dataWallet\");\n        address dataWallet;\n        // solium-disable-next-line security/no-inline-assembly\n        assembly {\n            //_data = {length:32}{sig:4}{_wallet:32}{...}\n            dataWallet := mload(add(_data, 0x24))\n        }\n        return dataWallet == _wallet;\n    }\n\n    /**\n    * @dev Parses the data to extract the method signature. \n    */\n    function functionPrefix(bytes _data) internal pure returns (bytes4 prefix) {\n        require(_data.length >= 4, \"RM: Invalid functionPrefix\");\n        // solium-disable-next-line security/no-inline-assembly\n        assembly {\n            prefix := mload(add(_data, 0x20))\n        }\n    }\n}\n\n/**\n * @title LimitManager\n * @dev Module to transfer tokens (ETH or ERC20) based on a security context (daily limit, whitelist, etc).\n * @author Julien Niset - <[email protected]>\n */\ncontract LimitManager is BaseModule {\n\n    // large limit when the limit can be considered disabled\n    uint128 constant internal LIMIT_DISABLED = uint128(-1); // 3.40282366920938463463374607431768211455e+38\n\n    using SafeMath for uint256;\n\n    struct LimitManagerConfig {\n        // The global limit\n        Limit limit;\n        // whitelist\n        DailySpent dailySpent;\n    } \n\n    struct Limit {\n        // the current limit\n        uint128 current;\n        // the pending limit if any\n        uint128 pending;\n        // when the pending limit becomes the current limit\n        uint64 changeAfter;\n    }\n\n    struct DailySpent {\n        // The amount already spent during the current period\n        uint128 alreadySpent;\n        // The end of the current period\n        uint64 periodEnd;\n    }\n\n    // wallet specific storage\n    mapping (address => LimitManagerConfig) internal limits;\n    // The default limit\n    uint256 public defaultLimit;\n\n    // *************** Events *************************** //\n\n    event LimitChanged(address indexed wallet, uint indexed newLimit, uint64 indexed startAfter);\n\n    // *************** Constructor ********************** //\n\n    constructor(uint256 _defaultLimit) public {\n        defaultLimit = _defaultLimit;\n    }\n\n    // *************** External/Public Functions ********************* //\n\n    /**\n     * @dev Inits the module for a wallet by setting the limit to the default value.\n     * @param _wallet The target wallet.\n     */\n    function init(BaseWallet _wallet) external onlyWallet(_wallet) {\n        Limit storage limit = limits[_wallet].limit;\n        if(limit.current == 0 && limit.changeAfter == 0) {\n            limit.current = uint128(defaultLimit);\n        }\n    }\n\n    /**\n     * @dev Changes the global limit. \n     * The limit is expressed in ETH and the change is pending for the security period.\n     * @param _wallet The target wallet.\n     * @param _newLimit The new limit.\n     * @param _securityPeriod The security period.\n     */\n    function changeLimit(BaseWallet _wallet, uint256 _newLimit, uint256 _securityPeriod) internal {\n        Limit storage limit = limits[_wallet].limit;\n        // solium-disable-next-line security/no-block-members\n        uint128 currentLimit = (limit.changeAfter > 0 && limit.changeAfter < now) ? limit.pending : limit.current;\n        limit.current = currentLimit;\n        limit.pending = uint128(_newLimit);\n        // solium-disable-next-line security/no-block-members\n        limit.changeAfter = uint64(now.add(_securityPeriod));\n        // solium-disable-next-line security/no-block-members\n        emit LimitChanged(_wallet, _newLimit, uint64(now.add(_securityPeriod)));\n    }\n\n    // *************** Internal Functions ********************* //\n\n    /**\n    * @dev Gets the current global limit for a wallet.\n    * @param _wallet The target wallet.\n    * @return the current limit expressed in ETH.\n    */\n    function getCurrentLimit(BaseWallet _wallet) public view returns (uint256 _currentLimit) {\n        Limit storage limit = limits[_wallet].limit;\n        _currentLimit = uint256(currentLimit(limit.current, limit.pending, limit.changeAfter));\n    }\n\n    /**\n    * @dev Gets a pending limit for a wallet if any.\n    * @param _wallet The target wallet.\n    * @return the pending limit (in ETH) and the time at chich it will become effective.\n    */\n    function getPendingLimit(BaseWallet _wallet) external view returns (uint256 _pendingLimit, uint64 _changeAfter) {\n        Limit storage limit = limits[_wallet].limit;\n        // solium-disable-next-line security/no-block-members\n        return ((now < limit.changeAfter)? (uint256(limit.pending), limit.changeAfter) : (0,0));\n    }\n\n    /**\n    * @dev Gets the amount of tokens that has not yet been spent during the current period.\n    * @param _wallet The target wallet.\n    * @return the amount of tokens (in ETH) that has not been spent yet and the end of the period.\n    */\n    function getDailyUnspent(BaseWallet _wallet) external view returns (uint256 _unspent, uint64 _periodEnd) {\n        uint256 globalLimit = getCurrentLimit(_wallet);\n        DailySpent storage expense = limits[_wallet].dailySpent;\n        // solium-disable-next-line security/no-block-members\n        if(now > expense.periodEnd) {\n            _unspent = globalLimit;\n            _periodEnd = uint64(now + 24 hours);\n        }\n        else {\n            _unspent = globalLimit - expense.alreadySpent;\n            _periodEnd = expense.periodEnd;\n        }\n    }\n\n    /**\n    * @dev Helper method to check if a transfer is within the limit.\n    * If yes the daily unspent for the current period is updated.\n    * @param _wallet The target wallet.\n    * @param _amount The amount for the transfer\n    */\n    function checkAndUpdateDailySpent(BaseWallet _wallet, uint _amount) internal returns (bool) {\n        Limit storage limit = limits[_wallet].limit;\n        uint128 current = currentLimit(limit.current, limit.pending, limit.changeAfter);\n        if(isWithinDailyLimit(_wallet, current, _amount)) {\n            updateDailySpent(_wallet, current, _amount);\n            return true;\n        }\n        return false;\n    }\n\n    /**\n    * @dev Helper method to update the daily spent for the current period.\n    * @param _wallet The target wallet.\n    * @param _limit The current limit for the wallet.\n    * @param _amount The amount to add to the daily spent.\n    */\n    function updateDailySpent(BaseWallet _wallet, uint128 _limit, uint _amount) internal {\n        if(_limit != LIMIT_DISABLED) {\n            DailySpent storage expense = limits[_wallet].dailySpent;\n            if (expense.periodEnd < now) {\n                expense.periodEnd = uint64(now + 24 hours);\n                expense.alreadySpent = uint128(_amount);\n            }\n            else {\n                expense.alreadySpent += uint128(_amount);\n            }\n        }\n    }\n\n    /**\n    * @dev Checks if a transfer amount is withing the daily limit for a wallet.\n    * @param _wallet The target wallet.\n    * @param _limit The current limit for the wallet.\n    * @param _amount The transfer amount.\n    * @return true if the transfer amount is withing the daily limit.\n    */\n    function isWithinDailyLimit(BaseWallet _wallet, uint _limit, uint _amount) internal view returns (bool)  {\n        DailySpent storage expense = limits[_wallet].dailySpent;\n        if(_limit == LIMIT_DISABLED) {\n            return true;\n        }\n        else if (expense.periodEnd < now) {\n            return (_amount <= _limit);\n        } else {\n            return (expense.alreadySpent + _amount <= _limit && expense.alreadySpent + _amount >= expense.alreadySpent);\n        }\n    }\n\n    /**\n    * @dev Helper method to get the current limit from a Limit struct.\n    * @param _current The value of the current parameter\n    * @param _pending The value of the pending parameter\n    * @param _changeAfter The value of the changeAfter parameter\n    */\n    function currentLimit(uint128 _current, uint128 _pending, uint64 _changeAfter) internal view returns (uint128) {\n        if(_changeAfter > 0 && _changeAfter < now) {\n            return _pending;\n        }\n        return _current;\n    }\n}\n\n/**\n * ERC20 contract interface.\n */\ncontract ERC20 {\n    function totalSupply() public view returns (uint);\n    function decimals() public view returns (uint);\n    function balanceOf(address tokenOwner) public view returns (uint balance);\n    function allowance(address tokenOwner, address spender) public view returns (uint remaining);\n    function transfer(address to, uint tokens) public returns (bool success);\n    function approve(address spender, uint tokens) public returns (bool success);\n    function transferFrom(address from, address to, uint tokens) public returns (bool success);\n}\n\n/* The MIT License (MIT)\n\nCopyright (c) 2016 Smart Contract Solutions, Inc.\n\nPermission is hereby granted, free of charge, to any person obtaining\na copy of this software and associated documentation files (the\n\"Software\"), to deal in the Software without restriction, including\nwithout limitation the rights to use, copy, modify, merge, publish,\ndistribute, sublicense, and/or sell copies of the Software, and to\npermit persons to whom the Software is furnished to do so, subject to\nthe following conditions:\n\nThe above copyright notice and this permission notice shall be included\nin all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\nOR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\nMERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\nIN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\nCLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\nTORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\nSOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. */\n/**\n * @title SafeMath\n * @dev Math operations with safety checks that throw on error\n */\nlibrary SafeMath {\n\n    /**\n    * @dev Multiplies two numbers, reverts on overflow.\n    */\n    function mul(uint256 a, uint256 b) internal pure returns (uint256) {\n        // Gas optimization: this is cheaper than requiring 'a' not being zero, but the\n        // benefit is lost if 'b' is also tested.\n        // See: https://github.com/OpenZeppelin/openzeppelin-solidity/pull/522\n        if (a == 0) {\n            return 0;\n        }\n\n        uint256 c = a * b;\n        require(c / a == b);\n\n        return c;\n    }\n\n    /**\n    * @dev Integer division of two numbers truncating the quotient, reverts on division by zero.\n    */\n    function div(uint256 a, uint256 b) internal pure returns (uint256) {\n        require(b > 0); // Solidity only automatically asserts when dividing by 0\n        uint256 c = a / b;\n        // assert(a == b * c + a % b); // There is no case in which this doesn't hold\n\n        return c;\n    }\n\n    /**\n    * @dev Subtracts two numbers, reverts on overflow (i.e. if subtrahend is greater than minuend).\n    */\n    function sub(uint256 a, uint256 b) internal pure returns (uint256) {\n        require(b <= a);\n        uint256 c = a - b;\n\n        return c;\n    }\n\n    /**\n    * @dev Adds two numbers, reverts on overflow.\n    */\n    function add(uint256 a, uint256 b) internal pure returns (uint256) {\n        uint256 c = a + b;\n        require(c >= a);\n\n        return c;\n    }\n\n    /**\n    * @dev Divides two numbers and returns the remainder (unsigned integer modulo),\n    * reverts when dividing by zero.\n    */\n    function mod(uint256 a, uint256 b) internal pure returns (uint256) {\n        require(b != 0);\n        return a % b;\n    }\n\n    /**\n    * @dev Returns ceil(a / b).\n    */\n    function ceil(uint256 a, uint256 b) internal pure returns (uint256) {\n        uint256 c = a / b;\n        if(a % b == 0) {\n            return c;\n        }\n        else {\n            return c + 1;\n        }\n    }\n}\n\n/**\n * @title Owned\n * @dev Basic contract to define an owner.\n * @author Julien Niset - <[email protected]>\n */\ncontract Owned {\n\n    // The owner\n    address public owner;\n\n    event OwnerChanged(address indexed _newOwner);\n\n    /**\n     * @dev Throws if the sender is not the owner.\n     */\n    modifier onlyOwner {\n        require(msg.sender == owner, \"Must be owner\");\n        _;\n    }\n\n    constructor() public {\n        owner = msg.sender;\n    }\n\n    /**\n     * @dev Lets the owner transfer ownership of the contract to a new owner.\n     * @param _newOwner The new owner.\n     */\n    function changeOwner(address _newOwner) external onlyOwner {\n        require(_newOwner != address(0), \"Address must not be null\");\n        owner = _newOwner;\n        emit OwnerChanged(_newOwner);\n    }\n}\n\n/**\n * @title ModuleRegistry\n * @dev Registry of authorised modules. \n * Modules must be registered before they can be authorised on a wallet.\n * @author Julien Niset - <[email protected]>\n */\ncontract ModuleRegistry is Owned {\n\n    mapping (address => Info) internal modules;\n    mapping (address => Info) internal upgraders;\n\n    event ModuleRegistered(address indexed module, bytes32 name);\n    event ModuleDeRegistered(address module);\n    event UpgraderRegistered(address indexed upgrader, bytes32 name);\n    event UpgraderDeRegistered(address upgrader);\n\n    struct Info {\n        bool exists;\n        bytes32 name;\n    }\n\n    /**\n     * @dev Registers a module.\n     * @param _module The module.\n     * @param _name The unique name of the module.\n     */\n    function registerModule(address _module, bytes32 _name) external onlyOwner {\n        require(!modules[_module].exists, \"MR: module already exists\");\n        modules[_module] = Info({exists: true, name: _name});\n        emit ModuleRegistered(_module, _name);\n    }\n\n    /**\n     * @dev Deregisters a module.\n     * @param _module The module.\n     */\n    function deregisterModule(address _module) external onlyOwner {\n        require(modules[_module].exists, \"MR: module does not exists\");\n        delete modules[_module];\n        emit ModuleDeRegistered(_module);\n    }\n\n        /**\n     * @dev Registers an upgrader.\n     * @param _upgrader The upgrader.\n     * @param _name The unique name of the upgrader.\n     */\n    function registerUpgrader(address _upgrader, bytes32 _name) external onlyOwner {\n        require(!upgraders[_upgrader].exists, \"MR: upgrader already exists\");\n        upgraders[_upgrader] = Info({exists: true, name: _name});\n        emit UpgraderRegistered(_upgrader, _name);\n    }\n\n    /**\n     * @dev Deregisters an upgrader.\n     * @param _upgrader The _upgrader.\n     */\n    function deregisterUpgrader(address _upgrader) external onlyOwner {\n        require(upgraders[_upgrader].exists, \"MR: upgrader does not exists\");\n        delete upgraders[_upgrader];\n        emit UpgraderDeRegistered(_upgrader);\n    }\n\n    /**\n    * @dev Utility method enbaling the owner of the registry to claim any ERC20 token that was sent to the\n    * registry.\n    * @param _token The token to recover.\n    */\n    function recoverToken(address _token) external onlyOwner {\n        uint total = ERC20(_token).balanceOf(address(this));\n        ERC20(_token).transfer(msg.sender, total);\n    } \n\n    /**\n     * @dev Gets the name of a module from its address.\n     * @param _module The module address.\n     * @return the name.\n     */\n    function moduleInfo(address _module) external view returns (bytes32) {\n        return modules[_module].name;\n    }\n\n    /**\n     * @dev Gets the name of an upgrader from its address.\n     * @param _upgrader The upgrader address.\n     * @return the name.\n     */\n    function upgraderInfo(address _upgrader) external view returns (bytes32) {\n        return upgraders[_upgrader].name;\n    }\n\n    /**\n     * @dev Checks if a module is registered.\n     * @param _module The module address.\n     * @return true if the module is registered.\n     */\n    function isRegisteredModule(address _module) external view returns (bool) {\n        return modules[_module].exists;\n    }\n\n    /**\n     * @dev Checks if a list of modules are registered.\n     * @param _modules The list of modules address.\n     * @return true if all the modules are registered.\n     */\n    function isRegisteredModule(address[] _modules) external view returns (bool) {\n        for(uint i = 0; i < _modules.length; i++) {\n            if (!modules[_modules[i]].exists) {\n                return false;\n            }\n        }\n        return true;\n    }  \n\n    /**\n     * @dev Checks if an upgrader is registered.\n     * @param _upgrader The upgrader address.\n     * @return true if the upgrader is registered.\n     */\n    function isRegisteredUpgrader(address _upgrader) external view returns (bool) {\n        return upgraders[_upgrader].exists;\n    } \n}\n\n/**\n * @title BaseWallet\n * @dev Simple modular wallet that authorises modules to call its invoke() method.\n * Based on https://gist.github.com/Arachnid/a619d31f6d32757a4328a428286da186 by \n * @author Julien Niset - <[email protected]>\n */\ncontract BaseWallet {\n\n    // The implementation of the proxy\n    address public implementation;\n    // The owner \n    address public owner;\n    // The authorised modules\n    mapping (address => bool) public authorised;\n    // The enabled static calls\n    mapping (bytes4 => address) public enabled;\n    // The number of modules\n    uint public modules;\n    \n    event AuthorisedModule(address indexed module, bool value);\n    event EnabledStaticCall(address indexed module, bytes4 indexed method);\n    event Invoked(address indexed module, address indexed target, uint indexed value, bytes data);\n    event Received(uint indexed value, address indexed sender, bytes data);\n    event OwnerChanged(address owner);\n    \n    /**\n     * @dev Throws if the sender is not an authorised module.\n     */\n    modifier moduleOnly {\n        require(authorised[msg.sender], \"BW: msg.sender not an authorized module\");\n        _;\n    }\n\n    /**\n     * @dev Inits the wallet by setting the owner and authorising a list of modules.\n     * @param _owner The owner.\n     * @param _modules The modules to authorise.\n     */\n    function init(address _owner, address[] _modules) external {\n        require(owner == address(0) && modules == 0, \"BW: wallet already initialised\");\n        require(_modules.length > 0, \"BW: construction requires at least 1 module\");\n        owner = _owner;\n        modules = _modules.length;\n        for(uint256 i = 0; i < _modules.length; i++) {\n            require(authorised[_modules[i]] == false, \"BW: module is already added\");\n            authorised[_modules[i]] = true;\n            Module(_modules[i]).init(this);\n            emit AuthorisedModule(_modules[i], true);\n        }\n    }\n    \n    /**\n     * @dev Enables/Disables a module.\n     * @param _module The target module.\n     * @param _value Set to true to authorise the module.\n     */\n    function authoriseModule(address _module, bool _value) external moduleOnly {\n        if (authorised[_module] != _value) {\n            if(_value == true) {\n                modules += 1;\n                authorised[_module] = true;\n                Module(_module).init(this);\n            }\n            else {\n                modules -= 1;\n                require(modules > 0, \"BW: wallet must have at least one module\");\n                delete authorised[_module];\n            }\n            emit AuthorisedModule(_module, _value);\n        }\n    }\n\n    /**\n    * @dev Enables a static method by specifying the target module to which the call\n    * must be delegated.\n    * @param _module The target module.\n    * @param _method The static method signature.\n    */\n    function enableStaticCall(address _module, bytes4 _method) external moduleOnly {\n        require(authorised[_module], \"BW: must be an authorised module for static call\");\n        enabled[_method] = _module;\n        emit EnabledStaticCall(_module, _method);\n    }\n\n    /**\n     * @dev Sets a new owner for the wallet.\n     * @param _newOwner The new owner.\n     */\n    function setOwner(address _newOwner) external moduleOnly {\n        require(_newOwner != address(0), \"BW: address cannot be null\");\n        owner = _newOwner;\n        emit OwnerChanged(_newOwner);\n    }\n    \n    /**\n     * @dev Performs a generic transaction.\n     * @param _target The address for the transaction.\n     * @param _value The value of the transaction.\n     * @param _data The data of the transaction.\n     */\n    function invoke(address _target, uint _value, bytes _data) external moduleOnly {\n        // solium-disable-next-line security/no-call-value\n        require(_target.call.value(_value)(_data), \"BW: call to target failed\");\n        emit Invoked(msg.sender, _target, _value, _data);\n    }\n\n    /**\n     * @dev This method makes it possible for the wallet to comply to interfaces expecting the wallet to\n     * implement specific static methods. It delegates the static call to a target contract if the data corresponds \n     * to an enabled method, or logs the call otherwise.\n     */\n    function() public payable {\n        if(msg.data.length > 0) { \n            address module = enabled[msg.sig];\n            if(module == address(0)) {\n                emit Received(msg.value, msg.sender, msg.data);\n            } \n            else {\n                require(authorised[module], \"BW: must be an authorised module for static call\");\n                // solium-disable-next-line security/no-inline-assembly\n                assembly {\n                    calldatacopy(0, 0, calldatasize())\n                    let result := staticcall(gas, module, 0, calldatasize(), 0, 0)\n                    returndatacopy(0, 0, returndatasize())\n                    switch result \n                    case 0 {revert(0, returndatasize())} \n                    default {return (0, returndatasize())}\n                }\n            }\n        }\n    }\n}\n\ncontract TokenPriceProvider {\n\n    using SafeMath for uint256;\n\n    // Mock token address for ETH\n    address constant internal ETH_TOKEN_ADDRESS = 0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE;\n    // Address of Kyber's trading contract\n    address constant internal KYBER_NETWORK_ADDRESS = 0x818E6FECD516Ecc3849DAf6845e3EC868087B755;\n\n    mapping(address => uint256) public cachedPrices;\n\n    function syncPrice(ERC20 token) public {\n        uint256 expectedRate;\n        (expectedRate,) = kyberNetwork().getExpectedRate(token, ERC20(ETH_TOKEN_ADDRESS), 10000);\n        cachedPrices[token] = expectedRate;\n    }\n\n    //\n    // Convenience functions\n    //\n\n    function syncPriceForTokenList(ERC20[] tokens) public {\n        for(uint16 i = 0; i < tokens.length; i++) {\n            syncPrice(tokens[i]);\n        }\n    }\n\n    /**\n     * @dev Converts the value of _amount tokens in ether.\n     * @param _amount the amount of tokens to convert (in 'token wei' twei)\n     * @param _token the ERC20 token contract\n     * @return the ether value (in wei) of _amount tokens with contract _token\n     */\n    function getEtherValue(uint256 _amount, address _token) public view returns (uint256) {\n        uint256 decimals = ERC20(_token).decimals();\n        uint256 price = cachedPrices[_token];\n        return price.mul(_amount).div(10**decimals);\n    }\n\n    //\n    // Internal\n    //\n\n    function kyberNetwork() internal view returns (KyberNetwork) {\n        return KyberNetwork(KYBER_NETWORK_ADDRESS);\n    }\n}\n\ncontract KyberNetwork {\n\n    function getExpectedRate(\n        ERC20 src,\n        ERC20 dest,\n        uint srcQty\n    )\n        public\n        view\n        returns (uint expectedRate, uint slippageRate);\n\n    function trade(\n        ERC20 src,\n        uint srcAmount,\n        ERC20 dest,\n        address destAddress,\n        uint maxDestAmount,\n        uint minConversionRate,\n        address walletId\n    )\n        public\n        payable\n        returns(uint);\n}\n\n/**\n * @title Storage\n * @dev Base contract for the storage of a wallet.\n * @author Julien Niset - <[email protected]>\n */\ncontract Storage {\n\n    /**\n     * @dev Throws if the caller is not an authorised module.\n     */\n    modifier onlyModule(BaseWallet _wallet) {\n        require(_wallet.authorised(msg.sender), \"TS: must be an authorized module to call this method\");\n        _;\n    }\n}\n\n/**\n * @title GuardianStorage\n * @dev Contract storing the state of wallets related to guardians and lock.\n * The contract only defines basic setters and getters with no logic. Only modules authorised\n * for a wallet can modify its state.\n * @author Julien Niset - <[email protected]>\n * @author Olivier Van Den Biggelaar - <[email protected]>\n */\ncontract GuardianStorage is Storage {\n\n    struct GuardianStorageConfig {\n        // the list of guardians\n        address[] guardians;\n        // the info about guardians\n        mapping (address => GuardianInfo) info;\n        // the lock's release timestamp\n        uint256 lock; \n        // the module that set the last lock\n        address locker;\n    }\n\n    struct GuardianInfo {\n        bool exists;\n        uint128 index;\n    }\n\n    // wallet specific storage\n    mapping (address => GuardianStorageConfig) internal configs;\n\n    // *************** External Functions ********************* //\n\n    /**\n     * @dev Lets an authorised module add a guardian to a wallet.\n     * @param _wallet The target wallet.\n     * @param _guardian The guardian to add.\n     */\n    function addGuardian(BaseWallet _wallet, address _guardian) external onlyModule(_wallet) {\n        GuardianStorageConfig storage config = configs[_wallet];\n        config.info[_guardian].exists = true;\n        config.info[_guardian].index = uint128(config.guardians.push(_guardian) - 1);\n    }\n\n    /**\n     * @dev Lets an authorised module revoke a guardian from a wallet.\n     * @param _wallet The target wallet.\n     * @param _guardian The guardian to revoke.\n     */\n    function revokeGuardian(BaseWallet _wallet, address _guardian) external onlyModule(_wallet) {\n        GuardianStorageConfig storage config = configs[_wallet];\n        address lastGuardian = config.guardians[config.guardians.length - 1];\n        if (_guardian != lastGuardian) {\n            uint128 targetIndex = config.info[_guardian].index;\n            config.guardians[targetIndex] = lastGuardian;\n            config.info[lastGuardian].index = targetIndex;\n        }\n        config.guardians.length--;\n        delete config.info[_guardian];\n    }\n\n    /**\n     * @dev Returns the number of guardians for a wallet.\n     * @param _wallet The target wallet.\n     * @return the number of guardians.\n     */\n    function guardianCount(BaseWallet _wallet) external view returns (uint256) {\n        return configs[_wallet].guardians.length;\n    }\n    \n    /**\n     * @dev Gets the list of guaridans for a wallet.\n     * @param _wallet The target wallet.\n     * @return the list of guardians.\n     */\n    function getGuardians(BaseWallet _wallet) external view returns (address[]) {\n        GuardianStorageConfig storage config = configs[_wallet];\n        address[] memory guardians = new address[](config.guardians.length);\n        for (uint256 i = 0; i < config.guardians.length; i++) {\n            guardians[i] = config.guardians[i];\n        }\n        return guardians;\n    }\n\n    /**\n     * @dev Checks if an account is a guardian for a wallet.\n     * @param _wallet The target wallet.\n     * @param _guardian The account.\n     * @return true if the account is a guardian for a wallet.\n     */\n    function isGuardian(BaseWallet _wallet, address _guardian) external view returns (bool) {\n        return configs[_wallet].info[_guardian].exists;\n    }\n\n    /**\n     * @dev Lets an authorised module set the lock for a wallet.\n     * @param _wallet The target wallet.\n     * @param _releaseAfter The epoch time at which the lock should automatically release.\n     */\n    function setLock(BaseWallet _wallet, uint256 _releaseAfter) external onlyModule(_wallet) {\n        configs[_wallet].lock = _releaseAfter;\n        if(_releaseAfter != 0 && msg.sender != configs[_wallet].locker) {\n            configs[_wallet].locker = msg.sender;\n        }\n    }\n\n    /**\n     * @dev Checks if the lock is set for a wallet.\n     * @param _wallet The target wallet.\n     * @return true if the lock is set for the wallet.\n     */\n    function isLocked(BaseWallet _wallet) external view returns (bool) {\n        return configs[_wallet].lock > now;\n    }\n\n    /**\n     * @dev Gets the time at which the lock of a wallet will release.\n     * @param _wallet The target wallet.\n     * @return the time at which the lock of a wallet will release, or zero if there is no lock set.\n     */\n    function getLock(BaseWallet _wallet) external view returns (uint256) {\n        return configs[_wallet].lock;\n    }\n\n    /**\n     * @dev Gets the address of the last module that modified the lock for a wallet.\n     * @param _wallet The target wallet.\n     * @return the address of the last module that modified the lock for a wallet.\n     */\n    function getLocker(BaseWallet _wallet) external view returns (address) {\n        return configs[_wallet].locker;\n    }\n}\n\n/**\n * @title TransferStorage\n * @dev Contract storing the state of wallets related to transfers (limit and whitelist).\n * The contract only defines basic setters and getters with no logic. Only modules authorised\n * for a wallet can modify its state.\n * @author Julien Niset - <[email protected]>\n */\ncontract TransferStorage is Storage {\n\n    // wallet specific storage\n    mapping (address => mapping (address => uint256)) internal whitelist;\n\n    // *************** External Functions ********************* //\n\n    /**\n     * @dev Lets an authorised module add or remove an account from the whitelist of a wallet.\n     * @param _wallet The target wallet.\n     * @param _target The account to add/remove.\n     * @param _value True for addition, false for revokation.\n     */\n    function setWhitelist(BaseWallet _wallet, address _target, uint256 _value) external onlyModule(_wallet) {\n        whitelist[_wallet][_target] = _value;\n    }\n\n    /**\n     * @dev Gets the whitelist state of an account for a wallet.\n     * @param _wallet The target wallet.\n     * @param _target The account.\n     * @return the epoch time at which an account strats to be whitelisted, or zero if the account is not whitelisted.\n     */\n    function getWhitelist(BaseWallet _wallet, address _target) external view returns (uint256) {\n        return whitelist[_wallet][_target];\n    }\n}\n\n/**\n * @title TokenTransfer\n * @dev Module to transfer tokens (ETH or ERC20) based on a security context (daily limit, whitelist, etc).\n * @author Julien Niset - <[email protected]>\n */\ncontract TokenTransfer is BaseModule, RelayerModule, LimitManager {\n\n    bytes32 constant NAME = \"TokenTransfer\";\n\n    bytes4 constant internal EXECUTE_PENDING_PREFIX = bytes4(keccak256(\"executePendingTransfer(address,address,address,uint256,bytes,uint256)\"));\n\n    bytes constant internal EMPTY_BYTES = \"\";\n\n    using SafeMath for uint256;\n\n    // Mock token address for ETH\n    address constant internal ETH_TOKEN = 0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE;\n    // large limit when the limit can be considered disabled\n    uint128 constant internal LIMIT_DISABLED = uint128(-1); // 3.40282366920938463463374607431768211455e+38\n\n    struct TokenTransferConfig {\n        // Mapping between pending transfer hash and their timestamp\n        mapping (bytes32 => uint256) pendingTransfers;\n    }\n\n    // wallet specific storage\n    mapping (address => TokenTransferConfig) internal configs;\n\n    // The security period\n    uint256 public securityPeriod;\n    // The execution window\n    uint256 public securityWindow;\n    // The Guardian storage \n    GuardianStorage public guardianStorage;\n    // The Token storage\n    TransferStorage public transferStorage;\n    // The Token price provider\n    TokenPriceProvider public priceProvider;\n\n    // *************** Events *************************** //\n\n    event Transfer(address indexed wallet, address indexed token, uint256 indexed amount, address to, bytes data);    \n    event AddedToWhitelist(address indexed wallet, address indexed target, uint64 whitelistAfter);\n    event RemovedFromWhitelist(address indexed wallet, address indexed target);\n    event PendingTransferCreated(address indexed wallet, bytes32 indexed id, uint256 indexed executeAfter, address token, address to, uint256 amount, bytes data);\n    event PendingTransferExecuted(address indexed wallet, bytes32 indexed id);\n    event PendingTransferCanceled(address indexed wallet, bytes32 indexed id);\n\n    // *************** Modifiers *************************** //\n\n    /**\n     * @dev Throws if the caller is not the owner or an authorised module.\n     */\n    modifier onlyOwnerOrModule(BaseWallet _wallet) {\n        require(isOwner(_wallet, msg.sender) || _wallet.authorised(msg.sender), \"TT: must be wallet owner or module\");\n        _;\n    }\n\n    /**\n     * @dev Throws if the wallet is locked.\n     */\n    modifier onlyWhenUnlocked(BaseWallet _wallet) {\n        // solium-disable-next-line security/no-block-members\n        require(!guardianStorage.isLocked(_wallet), \"TT: wallet must be unlocked\");\n        _;\n    }\n\n    // *************** Constructor ********************** //\n\n    constructor(\n        ModuleRegistry _registry,\n        TransferStorage _transferStorage, \n        GuardianStorage _guardianStorage, \n        address _priceProvider,\n        uint256 _securityPeriod,\n        uint256 _securityWindow, \n        uint256 _defaultLimit\n    ) \n        BaseModule(_registry, NAME)\n        LimitManager(_defaultLimit)\n        public \n    {\n        transferStorage = _transferStorage;\n        guardianStorage = _guardianStorage;\n        priceProvider = TokenPriceProvider(_priceProvider);\n        securityPeriod = _securityPeriod;\n        securityWindow = _securityWindow;\n    }\n\n    // *************** External/Public Functions ********************* //\n\n    /**\n    * @dev lets the owner transfer tokens (ETH or ERC20) from a wallet.\n    * @param _wallet The target wallet.\n    * @param _token The address of the token to transfer.\n    * @param _to The destination address\n    * @param _amount The amoutn of token to transfer\n    * @param _data The data for the transaction\n    */\n    function transferToken(\n        BaseWallet _wallet, \n        address _token, \n        address _to, \n        uint256 _amount, \n        bytes _data\n    ) \n        external \n        onlyOwnerOrModule(_wallet) \n        onlyWhenUnlocked(_wallet)\n    {\n        if(isWhitelisted(_wallet, _to)) {\n            // eth transfer to whitelist\n            if(_token == ETH_TOKEN) {\n                transferETH(_wallet, _to, _amount, _data);\n            }\n            // erc20 transfer to whitelist\n            else {\n                transferERC20(_wallet, _token, _to, _amount, _data);\n            }\n        }\n        else {\n            if(_token == ETH_TOKEN) {\n                // eth transfer under the limit\n                if (checkAndUpdateDailySpent(_wallet, _amount)) {\n                    transferETH(_wallet, _to, _amount, _data);\n                }\n                // eth transfer above the limit\n                else {\n                    addPendingTransfer(_wallet, ETH_TOKEN, _to, _amount, _data); \n                }\n            }\n            else {\n                uint256 etherAmount = priceProvider.getEtherValue(_amount, _token);\n                // erc20 transfer under the limit\n                if (checkAndUpdateDailySpent(_wallet, etherAmount)) {\n                    transferERC20(_wallet, _token, _to, _amount, _data);\n                }\n                // erc20 transfer above the limit\n                else {\n                    addPendingTransfer(_wallet, _token, _to, _amount, _data); \n                }\n            }\n        }\n    }\n\n    /**\n     * @dev Adds an address to the whitelist of a wallet. \n     * @param _wallet The target wallet.\n     * @param _target The address to add.\n     */\n    function addToWhitelist(\n        BaseWallet _wallet, \n        address _target\n    ) \n        external \n        onlyOwner(_wallet) \n        onlyWhenUnlocked(_wallet)\n    {\n        require(!isWhitelisted(_wallet, _target), \"TT: target already whitelisted\");\n        // solium-disable-next-line security/no-block-members\n        uint256 whitelistAfter = now.add(securityPeriod);\n        transferStorage.setWhitelist(_wallet, _target, whitelistAfter);\n        emit AddedToWhitelist(_wallet, _target, uint64(whitelistAfter));\n    }\n\n    /**\n     * @dev Removes an address from the whitelist of a wallet. \n     * @param _wallet The target wallet.\n     * @param _target The address to remove.\n     */\n    function removeFromWhitelist(\n        BaseWallet _wallet, \n        address _target\n    ) \n        external \n        onlyOwner(_wallet) \n        onlyWhenUnlocked(_wallet)\n    {\n        require(isWhitelisted(_wallet, _target), \"TT: target not whitelisted\");\n        transferStorage.setWhitelist(_wallet, _target, 0);\n        emit RemovedFromWhitelist(_wallet, _target);\n    }\n\n    /**\n    * @dev Executes a pending transfer for a wallet. \n    * The destination address is automatically added to the whitelist.\n    * The method can be called by anyone to enable orchestration.\n    * @param _wallet The target wallet.\n    * @param _token The token of the pending transfer. \n    * @param _to The destination address of the pending transfer.\n    * @param _amount The amount of token to transfer of the pending transfer.\n    * @param _block The block at which the pending transfer was created.\n    */\n    function executePendingTransfer(\n        BaseWallet _wallet,\n        address _token, \n        address _to, \n        uint _amount, \n        bytes _data,\n        uint _block \n    ) \n        public \n        onlyWhenUnlocked(_wallet)\n    {\n        bytes32 id = keccak256(abi.encodePacked(_token, _to, _amount, _data, _block));\n        uint executeAfter = configs[_wallet].pendingTransfers[id];\n        uint executeBefore = executeAfter.add(securityWindow);\n        require(executeAfter <= now && now <= executeBefore, \"TT: outside of the execution window\");\n        removePendingTransfer(_wallet, id);\n        if(_token == ETH_TOKEN) {\n            transferETH(_wallet, _to, _amount, _data);\n        }\n        else {\n            transferERC20(_wallet, _token, _to, _amount, _data);\n        }\n        emit PendingTransferExecuted(_wallet, id);\n    }\n\n    /**\n    * @dev Cancels a pending transfer for a wallet. \n    * @param _wallet The target wallet.\n    * @param _id the pending transfer Id. \n    */\n    function cancelPendingTransfer(\n        BaseWallet _wallet, \n        bytes32 _id\n    ) \n        public \n        onlyOwner(_wallet) \n        onlyWhenUnlocked(_wallet) \n    {\n        require(configs[_wallet].pendingTransfers[_id] > 0, \"TT: unknown pending transfer\");\n        removePendingTransfer(_wallet, _id);\n        emit PendingTransferCanceled(_wallet, _id);\n    }\n\n    /**\n     * @dev Lets the owner of a wallet change its global limit. \n     * The limit is expressed in ETH. Changes to the limit take 24 hours.\n     * @param _wallet The target wallet.\n     * @param _newLimit The new limit.\n     */\n    function changeLimit(BaseWallet _wallet, uint256 _newLimit) public onlyOwner(_wallet) onlyWhenUnlocked(_wallet) {\n        changeLimit(_wallet, _newLimit, securityPeriod);\n    }\n\n    /**\n     * @dev Convenience method to disable the limit\n     * The limit is disabled by setting it to an arbitrary large value.\n     * @param _wallet The target wallet.\n     */\n    function disableLimit(BaseWallet _wallet) external onlyOwner(_wallet) onlyWhenUnlocked(_wallet) {\n        changeLimit(_wallet, LIMIT_DISABLED, securityPeriod);\n    }\n\n    /**\n    * @dev Checks if an address is whitelisted for a wallet.\n    * @param _wallet The target wallet.\n    * @param _target The address. \n    * @return true if the address is whitelisted.\n    */\n    function isWhitelisted(BaseWallet _wallet, address _target) public view returns (bool _isWhitelisted) {\n        uint whitelistAfter = transferStorage.getWhitelist(_wallet, _target);\n        // solium-disable-next-line security/no-block-members\n        return whitelistAfter > 0 && whitelistAfter < now;\n    }\n\n    /**\n    * @dev Gets the info of a pending transfer for a wallet.\n    * @param _wallet The target wallet.\n    * @param _id The pending transfer Id.\n    * @return the epoch time at which the pending transfer can be executed.\n    */\n    function getPendingTransfer(BaseWallet _wallet, bytes32 _id) external view returns (uint64 _executeAfter) {\n        _executeAfter = uint64(configs[_wallet].pendingTransfers[_id]);\n    }\n\n    // *************** Internal Functions ********************* //\n\n    /**\n    * @dev Helper method to transfer ETH for a wallet.\n    * @param _wallet The target wallet.\n    * @param _to The recipient.\n    * @param _value The amount of ETH to transfer\n    * @param _data The data to *log* with the transfer.\n    */\n    function transferETH(BaseWallet _wallet, address _to, uint256 _value, bytes _data) internal {\n        _wallet.invoke(_to, _value, EMPTY_BYTES);\n        emit Transfer(_wallet, ETH_TOKEN, _value, _to, _data);\n    }\n\n    /**\n    * @dev Helper method to transfer ERC20 for a wallet.\n    * @param _wallet The target wallet.\n    * @param _token The ERC20 address.\n    * @param _to The recipient.\n    * @param _value The amount of token to transfer\n    * @param _data The data to pass with the trnasfer.\n    */\n    function transferERC20(BaseWallet _wallet, address _token, address _to, uint256 _value, bytes _data) internal {\n        bytes memory methodData = abi.encodeWithSignature(\"transfer(address,uint256)\", _to, _value);\n        _wallet.invoke(_token, 0, methodData);\n        emit Transfer(_wallet, _token, _value, _to, _data);\n    }\n\n    /**\n     * @dev Creates a new pending transfer for a wallet.\n     * @param _wallet The target wallet.\n     * @param _token The token for the transfer.\n     * @param _to The recipient for the transfer.\n     * @param _amount The amount of token to transfer.\n     * @param _data The data associated to the transfer.\n     * @return the identifier for the new pending transfer.\n     */\n    function addPendingTransfer(BaseWallet _wallet, address _token, address _to, uint _amount, bytes _data) internal returns (bytes32) {\n        bytes32 id = keccak256(abi.encodePacked(_token, _to, _amount, _data, block.number));\n        uint executeAfter = now.add(securityPeriod);\n        configs[_wallet].pendingTransfers[id] = executeAfter;\n        emit PendingTransferCreated(_wallet, id, executeAfter, _token, _to, _amount, _data);\n    }\n\n    /**\n    * @dev Removes an existing pending transfer.\n    * @param _wallet The target wallet\n    * @param _id The id of the transfer to remove.\n    */\n    function removePendingTransfer(BaseWallet _wallet, bytes32 _id) internal {\n        delete configs[_wallet].pendingTransfers[_id];\n    }\n\n    // *************** Implementation of RelayerModule methods ********************* //\n\n    // Overrides refund to add the refund in the daily limit.\n    function refund(BaseWallet _wallet, uint _gasUsed, uint _gasPrice, uint _gasLimit, uint _signatures, address _relayer) internal {\n        // 21000 (transaction) + 7620 (execution of refund) + 7324 (execution of updateDailySpent) + 672 to log the event + _gasUsed\n        uint256 amount = 36616 + _gasUsed; \n        if(_gasPrice > 0 && _signatures > 0 && amount <= _gasLimit) {\n            if(_gasPrice > tx.gasprice) {\n                amount = amount * tx.gasprice;\n            }\n            else {\n                amount = amount * _gasPrice;\n            }\n            updateDailySpent(_wallet, uint128(getCurrentLimit(_wallet)), amount);\n            _wallet.invoke(_relayer, amount, \"\");\n        }\n    }\n\n    // Overrides verifyRefund to add the refund in the daily limit.\n    function verifyRefund(BaseWallet _wallet, uint _gasUsed, uint _gasPrice, uint _signatures) internal view returns (bool) {\n        if(_gasPrice > 0 && _signatures > 0 && (\n            address(_wallet).balance < _gasUsed * _gasPrice \n            || isWithinDailyLimit(_wallet, getCurrentLimit(_wallet), _gasUsed * _gasPrice) == false\n            || _wallet.authorised(this) == false\n        ))\n        {\n            return false;\n        }\n        return true;\n    }\n\n    // Overrides to use the incremental nonce and save some gas\n    function checkAndUpdateUniqueness(BaseWallet _wallet, uint256 _nonce, bytes32 _signHash) internal returns (bool) {\n        return checkAndUpdateNonce(_wallet, _nonce);\n    }\n\n    function validateSignatures(BaseWallet _wallet, bytes _data, bytes32 _signHash, bytes _signatures) internal view returns (bool) {\n        address signer = recoverSigner(_signHash, _signatures, 0);\n        return isOwner(_wallet, signer); // \"TT: signer must be owner\"\n    }\n\n    function getRequiredSignatures(BaseWallet _wallet, bytes _data) internal view returns (uint256) {\n        bytes4 methodId = functionPrefix(_data);\n        if (methodId == EXECUTE_PENDING_PREFIX) {\n            return 0;\n        }\n        return 1;\n    }\n}",
  "abi": "[{\"constant\":true,\"inputs\":[],\"name\":\"securityWindow\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_wallet\",\"type\":\"address\"}],\"name\":\"init\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_wallet\",\"type\":\"address\"}],\"name\":\"getNonce\",\"outputs\":[{\"name\":\"nonce\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_wallet\",\"type\":\"address\"},{\"name\":\"_token\",\"type\":\"address\"},{\"name\":\"_to\",\"type\":\"address\"},{\"name\":\"_amount\",\"type\":\"uint256\"},{\"name\":\"_data\",\"type\":\"bytes\"}],\"name\":\"transferToken\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_wallet\",\"type\":\"address\"}],\"name\":\"getCurrentLimit\",\"outputs\":[{\"name\":\"_currentLimit\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_wallet\",\"type\":\"address\"},{\"name\":\"_target\",\"type\":\"address\"}],\"name\":\"addToWhitelist\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_wallet\",\"type\":\"address\"},{\"name\":\"_module\",\"type\":\"address\"}],\"name\":\"addModule\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_wallet\",\"type\":\"address\"},{\"name\":\"_token\",\"type\":\"address\"},{\"name\":\"_to\",\"type\":\"address\"},{\"name\":\"_amount\",\"type\":\"uint256\"},{\"name\":\"_data\",\"type\":\"bytes\"},{\"name\":\"_block\",\"type\":\"uint256\"}],\"name\":\"executePendingTransfer\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_wallet\",\"type\":\"address\"}],\"name\":\"getDailyUnspent\",\"outputs\":[{\"name\":\"_unspent\",\"type\":\"uint256\"},{\"name\":\"_periodEnd\",\"type\":\"uint64\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"securityPeriod\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"transferStorage\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_token\",\"type\":\"address\"}],\"name\":\"recoverToken\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_wallet\",\"type\":\"address\"}],\"name\":\"getPendingLimit\",\"outputs\":[{\"name\":\"_pendingLimit\",\"type\":\"uint256\"},{\"name\":\"_changeAfter\",\"type\":\"uint64\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_wallet\",\"type\":\"address\"}],\"name\":\"disableLimit\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_wallet\",\"type\":\"address\"},{\"name\":\"_data\",\"type\":\"bytes\"},{\"name\":\"_nonce\",\"type\":\"uint256\"},{\"name\":\"_signatures\",\"type\":\"bytes\"},{\"name\":\"_gasPrice\",\"type\":\"uint256\"},{\"name\":\"_gasLimit\",\"type\":\"uint256\"}],\"name\":\"execute\",\"outputs\":[{\"name\":\"success\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_wallet\",\"type\":\"address\"},{\"name\":\"_newLimit\",\"type\":\"uint256\"}],\"name\":\"changeLimit\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_wallet\",\"type\":\"address\"},{\"name\":\"_id\",\"type\":\"bytes32\"}],\"name\":\"cancelPendingTransfer\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_wallet\",\"type\":\"address\"},{\"name\":\"_target\",\"type\":\"address\"}],\"name\":\"isWhitelisted\",\"outputs\":[{\"name\":\"_isWhitelisted\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"priceProvider\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"}],\"name\":\"relayer\",\"outputs\":[{\"name\":\"nonce\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"guardianStorage\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_wallet\",\"type\":\"address\"},{\"name\":\"_id\",\"type\":\"bytes32\"}],\"name\":\"getPendingTransfer\",\"outputs\":[{\"name\":\"_executeAfter\",\"type\":\"uint64\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"defaultLimit\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_wallet\",\"type\":\"address\"},{\"name\":\"_target\",\"type\":\"address\"}],\"name\":\"removeFromWhitelist\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"name\":\"_registry\",\"type\":\"address\"},{\"name\":\"_transferStorage\",\"type\":\"address\"},{\"name\":\"_guardianStorage\",\"type\":\"address\"},{\"name\":\"_priceProvider\",\"type\":\"address\"},{\"name\":\"_securityPeriod\",\"type\":\"uint256\"},{\"name\":\"_securityWindow\",\"type\":\"uint256\"},{\"name\":\"_defaultLimit\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"wallet\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"token\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"amount\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"to\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"data\",\"type\":\"bytes\"}],\"name\":\"Transfer\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"wallet\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"target\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"whitelistAfter\",\"type\":\"uint64\"}],\"name\":\"AddedToWhitelist\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"wallet\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"target\",\"type\":\"address\"}],\"name\":\"RemovedFromWhitelist\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"wallet\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"id\",\"type\":\"bytes32\"},{\"indexed\":true,\"name\":\"executeAfter\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"token\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"to\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"amount\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"data\",\"type\":\"bytes\"}],\"name\":\"PendingTransferCreated\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"wallet\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"id\",\"type\":\"bytes32\"}],\"name\":\"PendingTransferExecuted\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"wallet\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"id\",\"type\":\"bytes32\"}],\"name\":\"PendingTransferCanceled\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"wallet\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"newLimit\",\"type\":\"uint256\"},{\"indexed\":true,\"name\":\"startAfter\",\"type\":\"uint64\"}],\"name\":\"LimitChanged\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"wallet\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"success\",\"type\":\"bool\"},{\"indexed\":false,\"name\":\"signedHash\",\"type\":\"bytes32\"}],\"name\":\"TransactionExecuted\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"name\",\"type\":\"bytes32\"}],\"name\":\"ModuleCreated\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"wallet\",\"type\":\"address\"}],\"name\":\"ModuleInitialised\",\"type\":\"event\"}]",
  "bytecode": "608060405234801561001057600080fd5b5060405160e0806136378339810160408181528251602080850151838601516060870151608088015160a089015160c09099015160008054600160a060020a031916600160a060020a0389161790557f546f6b656e5472616e7366657200000000000000000000000000000000000000808a52975196999498939792969195909384938b9390927f3019c8fc80239e3dff8f781212ae2004839c2cb61d6c70acd279ac65392145df928290030190a150506003555060088054600160a060020a0319908116600160a060020a0397881617909155600780548216958716959095179094556009805490941692909416919091179091556005556006555061351b8061011c6000396000f30060806040526004361061013c5763ffffffff7c01000000000000000000000000000000000000000000000000000000006000350416626fda35811461014157806319ab453c146101685780632d0335ab1461018b5780632df546f4146101ac57806343cd5c7e146101ea578063575182431461020b5780635a1db8c4146102325780635ed4bf81146102595780637cb8f8ba146102d65780637cc0d90614610319578063961bfeee1461032e5780639be65a601461035f578063a0aec10514610380578063a3411c0a146103a1578063aacaaf88146103c2578063b20f3f3714610419578063b377a9d51461043d578063b6b3527214610461578063b888879e14610488578063c9b5ef8e1461049d578063d89784fc146104be578063e1ee38ec146104d3578063e26b013b14610514578063f8d3277d14610529575b600080fd5b34801561014d57600080fd5b50610156610550565b60408051918252519081900360200190f35b34801561017457600080fd5b50610189600160a060020a0360043516610556565b005b34801561019757600080fd5b50610156600160a060020a0360043516610640565b3480156101b857600080fd5b5061018960048035600160a060020a03908116916024803583169260443516916064359160843590810191013561065b565b3480156101f657600080fd5b50610156600160a060020a0360043516610b1f565b34801561021757600080fd5b50610189600160a060020a0360043581169060243516610b96565b34801561023e57600080fd5b50610189600160a060020a0360043581169060243516610e79565b34801561026557600080fd5b50604080516020601f60843560048181013592830184900484028501840190955281845261018994600160a060020a03813581169560248035831696604435909316956064359536959460a494939190910191908190840183828082843750949750509335945061107f9350505050565b3480156102e257600080fd5b506102f7600160a060020a036004351661140d565b6040805192835267ffffffffffffffff90911660208301528051918290030190f35b34801561032557600080fd5b506101566114b5565b34801561033a57600080fd5b506103436114bb565b60408051600160a060020a039092168252519081900360200190f35b34801561036b57600080fd5b50610189600160a060020a03600435166114ca565b34801561038c57600080fd5b506102f7600160a060020a03600435166115fe565b3480156103ad57600080fd5b50610189600160a060020a036004351661167a565b3480156103ce57600080fd5b5061040560048035600160a060020a031690602480358082019290810135916044359160643591820191013560843560a435611821565b604080519115158252519081900360200190f35b34801561042557600080fd5b50610189600160a060020a0360043516602435611b1b565b34801561044957600080fd5b50610189600160a060020a0360043516602435611cae565b34801561046d57600080fd5b50610405600160a060020a0360043581169060243516611ef8565b34801561049457600080fd5b50610343611fb0565b3480156104a957600080fd5b50610156600160a060020a0360043516611fbf565b3480156104ca57600080fd5b50610343611fd1565b3480156104df57600080fd5b506104f7600160a060020a0360043516602435611fe0565b6040805167ffffffffffffffff9092168252519081900360200190f35b34801561052057600080fd5b50610156612007565b34801561053557600080fd5b50610189600160a060020a036004358116906024351661200d565b60065481565b60008133600160a060020a038216146105be57604080516000805160206134d0833981519152815260206004820152601960248201527f424d3a2063616c6c6572206d7573742062652077616c6c657400000000000000604482015290519081900360640190fd5b600160a060020a038316600090815260026020526040902080549092506fffffffffffffffffffffffffffffffff161580156106065750600182015467ffffffffffffffff16155b1561063b5760035482546fffffffffffffffffffffffffffffffff19166fffffffffffffffffffffffffffffffff9091161782555b505050565b600160a060020a031660009081526001602052604090205490565b60008661066881336122c2565b806106fc5750604080517fd6eb1bbf0000000000000000000000000000000000000000000000000000000081523360048201529051600160a060020a0383169163d6eb1bbf9160248083019260209291908290030181600087803b1580156106cf57600080fd5b505af11580156106e3573d6000803e3d6000fd5b505050506040513d60208110156106f957600080fd5b50515b151561077d57604080516000805160206134d0833981519152815260206004820152602260248201527f54543a206d7573742062652077616c6c6574206f776e6572206f72206d6f647560448201527f6c65000000000000000000000000000000000000000000000000000000000000606482015290519081900360840190fd5b600754604080517f4a4fbeec000000000000000000000000000000000000000000000000000000008152600160a060020a03808c16600483015291518b939290921691634a4fbeec916024808201926020929091908290030181600087803b1580156107e857600080fd5b505af11580156107fc573d6000803e3d6000fd5b505050506040513d602081101561081257600080fd5b50511561086e57604080516000805160206134d0833981519152815260206004820152601b60248201527f54543a2077616c6c6574206d75737420626520756e6c6f636b65640000000000604482015290519081900360640190fd5b6108788988611ef8565b1561092557600160a060020a03881673eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee14156108e3576108de89888888888080601f01602080910402602001604051908101604052809392919081815260200183838082843750612362945050505050565b610920565b6109208989898989898080601f01602080910402602001604051908101604052809392919081815260200183838082843750612552945050505050565b610b14565b600160a060020a03881673eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee14156109ec576109548987612783565b15610995576108de89888888888080601f01602080910402602001604051908101604052809392919081815260200183838082843750612362945050505050565b6109e68973eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee898989898080601f01602080910402602001604051908101604052809392919081815260200183838082843750612827945050505050565b50610b14565b600954604080517fce55c85200000000000000000000000000000000000000000000000000000000815260048101899052600160a060020a038b811660248301529151919092169163ce55c8529160448083019260209291908290030181600087803b158015610a5b57600080fd5b505af1158015610a6f573d6000803e3d6000fd5b505050506040513d6020811015610a8557600080fd5b50519250610a938984612783565b15610ad5576109208989898989898080601f01602080910402602001604051908101604052809392919081815260200183838082843750612552945050505050565b610b128989898989898080601f01602080910402602001604051908101604052809392919081815260200183838082843750612827945050505050565b505b505050505050505050565b600160a060020a038116600090815260026020526040812080546001820154610b7d916fffffffffffffffffffffffffffffffff80821692700100000000000000000000000000000000909204169067ffffffffffffffff16612a51565b6fffffffffffffffffffffffffffffffff169392505050565b60008233301480610bac5750610bac81336122c2565b1515610c2d57604080516000805160206134d0833981519152815260206004820152602360248201527f424d3a206d75737420626520616e206f776e657220666f72207468652077616c60448201527f6c65740000000000000000000000000000000000000000000000000000000000606482015290519081900360840190fd5b600754604080517f4a4fbeec000000000000000000000000000000000000000000000000000000008152600160a060020a038088166004830152915187939290921691634a4fbeec916024808201926020929091908290030181600087803b158015610c9857600080fd5b505af1158015610cac573d6000803e3d6000fd5b505050506040513d6020811015610cc257600080fd5b505115610d1e57604080516000805160206134d0833981519152815260206004820152601b60248201527f54543a2077616c6c6574206d75737420626520756e6c6f636b65640000000000604482015290519081900360640190fd5b610d288585611ef8565b15610d8257604080516000805160206134d0833981519152815260206004820152601e60248201527f54543a2074617267657420616c72656164792077686974656c69737465640000604482015290519081900360640190fd5b600554610d9690429063ffffffff612a8b16565b600854604080517f80bfbe68000000000000000000000000000000000000000000000000000000008152600160a060020a03898116600483015288811660248301526044820185905291519396509116916380bfbe689160648082019260009290919082900301818387803b158015610e0e57600080fd5b505af1158015610e22573d6000803e3d6000fd5b50506040805167ffffffffffffffff871681529051600160a060020a038089169450891692507f1f57f9641d3e8733ed672fef5ac85464bd7215ef2f21e83428e8408248b13dcd9181900360200190a35050505050565b81610e8481336122c2565b1515610f0557604080516000805160206134d0833981519152815260206004820152602e60248201527f424d3a206d73672e73656e646572206d75737420626520616e206f776e65722060448201527f666f72207468652077616c6c6574000000000000000000000000000000000000606482015290519081900360840190fd5b60008054604080517f0bcd4ebb000000000000000000000000000000000000000000000000000000008152600160a060020a03868116600483015291519190921692630bcd4ebb92602480820193602093909283900390910190829087803b158015610f7057600080fd5b505af1158015610f84573d6000803e3d6000fd5b505050506040513d6020811015610f9a57600080fd5b50511515610ff757604080516000805160206134d0833981519152815260206004820152601c60248201527f424d3a206d6f64756c65206973206e6f74207265676973746572656400000000604482015290519081900360640190fd5b604080517f1f17732d000000000000000000000000000000000000000000000000000000008152600160a060020a03848116600483015260016024830152915191851691631f17732d9160448082019260009290919082900301818387803b15801561106257600080fd5b505af1158015611076573d6000803e3d6000fd5b50505050505050565b600754604080517f4a4fbeec000000000000000000000000000000000000000000000000000000008152600160a060020a03808a1660048301529151600093849384938c939190921691634a4fbeec91602480830192602092919082900301818887803b1580156110ef57600080fd5b505af1158015611103573d6000803e3d6000fd5b505050506040513d602081101561111957600080fd5b50511561117557604080516000805160206134d0833981519152815260206004820152601b60248201527f54543a2077616c6c6574206d75737420626520756e6c6f636b65640000000000604482015290519081900360640190fd5b88888888886040516020018086600160a060020a0316600160a060020a03166c0100000000000000000000000002815260140185600160a060020a0316600160a060020a03166c0100000000000000000000000002815260140184815260200183805190602001908083835b602083106112005780518252601f1990920191602091820191016111e1565b51815160209384036101000a600019018019909216911617905292019384525060408051808503815293820190819052835193975095508594508601925081905083835b602083106112635780518252601f199092019160209182019101611244565b6001836020036101000a03801982511681845116808217855250505050505090500191505060405180910390209350600460008b600160a060020a0316600160a060020a03168152602001908152602001600020600001600085600019166000191681526020019081526020016000205492506112eb60065484612a8b90919063ffffffff16565b91504283111580156112fd5750814211155b151561137e57604080516000805160206134d0833981519152815260206004820152602360248201527f54543a206f757473696465206f662074686520657865637574696f6e2077696e60448201527f646f770000000000000000000000000000000000000000000000000000000000606482015290519081900360840190fd5b6113888a85612a9d565b600160a060020a03891673eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee14156113be576113b98a898989612362565b6113cb565b6113cb8a8a8a8a8a612552565b6040518490600160a060020a038c16907f53d984c4cd3917405bdcc3baabad7c1269dd3baf7c2c53ca571d8d7de9629bc990600090a350505050505050505050565b60008060008061141c85610b1f565b600160a060020a03861660009081526002602081905260409091200180549193509150700100000000000000000000000000000000900467ffffffffffffffff164211156114745781935042620151800192506114ae565b80546fffffffffffffffffffffffffffffffff811683039450700100000000000000000000000000000000900467ffffffffffffffff1692505b5050915091565b60055481565b600854600160a060020a031681565b604080517f70a082310000000000000000000000000000000000000000000000000000000081523060048201529051600091600160a060020a038416916370a082319160248082019260209290919082900301818787803b15801561152e57600080fd5b505af1158015611542573d6000803e3d6000fd5b505050506040513d602081101561155857600080fd5b505160008054604080517fa9059cbb000000000000000000000000000000000000000000000000000000008152600160a060020a0392831660048201526024810185905290519394509085169263a9059cbb92604480840193602093929083900390910190829087803b1580156115ce57600080fd5b505af11580156115e2573d6000803e3d6000fd5b505050506040513d60208110156115f857600080fd5b50505050565b600160a060020a0381166000908152600260205260408120600181015482919067ffffffffffffffff16421061163657600080611670565b805460018201547001000000000000000000000000000000009091046fffffffffffffffffffffffffffffffff169067ffffffffffffffff165b9250925050915091565b803330148061168e575061168e81336122c2565b151561170f57604080516000805160206134d0833981519152815260206004820152602360248201527f424d3a206d75737420626520616e206f776e657220666f72207468652077616c60448201527f6c65740000000000000000000000000000000000000000000000000000000000606482015290519081900360840190fd5b600754604080517f4a4fbeec000000000000000000000000000000000000000000000000000000008152600160a060020a038086166004830152915185939290921691634a4fbeec916024808201926020929091908290030181600087803b15801561177a57600080fd5b505af115801561178e573d6000803e3d6000fd5b505050506040513d60208110156117a457600080fd5b50511561180057604080516000805160206134d0833981519152815260206004820152601b60248201527f54543a2077616c6c6574206d75737420626520756e6c6f636b65640000000000604482015290519081900360640190fd5b61063b836000196fffffffffffffffffffffffffffffffff16600554612ac5565b6000806000805a925061186c308d60008e8e8080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050508d8b8b612c23565b91506118798c8a84612e17565b15156118d457604080516000805160206134d0833981519152815260206004820152601560248201527f524d3a204475706c696361746520726571756573740000000000000000000000604482015290519081900360640190fd5b61190e8c8c8c8080601f01602080910402602001604051908101604052809392919081815260200183838082843750612e2b945050505050565b15156119b557604080516000805160206134d0833981519152815260206004820152604a60248201527f524d3a207468652077616c6c657420617574686f72697a65642069732064696660448201527f666572656e74207468656e2074686520746172676574206f662074686520726560648201527f6c61796564206461746100000000000000000000000000000000000000000000608482015290519081900360a40190fd5b6119ef8c8c8c8080601f01602080910402602001604051908101604052809392919081815260200183838082843750612ea6945050505050565b905060418102871415611aca57611a088c868884612f71565b15611aca57801580611a835750611a838c8c8c8080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050848b8b8080601f01602080910402602001604051908101604052809392919081815260200183838082843750613062945050505050565b15611aca5730600160a060020a03168b8b604051808383808284378201915050925050506000604051808303816000865af19150509350611aca8c5a850388888533613087565b60408051838152905185151591600160a060020a038f16917f6bb0b384ce772133df63560651bc8c727c53306cec1d51e2cbf8ea35fb8f2ec19181900360200190a350505098975050505050505050565b8133301480611b2f5750611b2f81336122c2565b1515611bb057604080516000805160206134d0833981519152815260206004820152602360248201527f424d3a206d75737420626520616e206f776e657220666f72207468652077616c60448201527f6c65740000000000000000000000000000000000000000000000000000000000606482015290519081900360840190fd5b600754604080517f4a4fbeec000000000000000000000000000000000000000000000000000000008152600160a060020a038087166004830152915186939290921691634a4fbeec916024808201926020929091908290030181600087803b158015611c1b57600080fd5b505af1158015611c2f573d6000803e3d6000fd5b505050506040513d6020811015611c4557600080fd5b505115611ca157604080516000805160206134d0833981519152815260206004820152601b60248201527f54543a2077616c6c6574206d75737420626520756e6c6f636b65640000000000604482015290519081900360640190fd5b6115f88484600554612ac5565b8133301480611cc25750611cc281336122c2565b1515611d4357604080516000805160206134d0833981519152815260206004820152602360248201527f424d3a206d75737420626520616e206f776e657220666f72207468652077616c60448201527f6c65740000000000000000000000000000000000000000000000000000000000606482015290519081900360840190fd5b600754604080517f4a4fbeec000000000000000000000000000000000000000000000000000000008152600160a060020a038087166004830152915186939290921691634a4fbeec916024808201926020929091908290030181600087803b158015611dae57600080fd5b505af1158015611dc2573d6000803e3d6000fd5b505050506040513d6020811015611dd857600080fd5b505115611e3457604080516000805160206134d0833981519152815260206004820152601b60248201527f54543a2077616c6c6574206d75737420626520756e6c6f636b65640000000000604482015290519081900360640190fd5b600160a060020a038416600090815260046020908152604080832086845290915281205411611eb257604080516000805160206134d0833981519152815260206004820152601c60248201527f54543a20756e6b6e6f776e2070656e64696e67207472616e7366657200000000604482015290519081900360640190fd5b611ebc8484612a9d565b6040518390600160a060020a038616907f2914460f2e2359d06bcda666d815164a8e77d104644dfbe6360885abfa2da59c90600090a350505050565b600854604080517f13f4a0ea000000000000000000000000000000000000000000000000000000008152600160a060020a03858116600483015284811660248301529151600093849316916313f4a0ea91604480830192602092919082900301818787803b158015611f6957600080fd5b505af1158015611f7d573d6000803e3d6000fd5b505050506040513d6020811015611f9357600080fd5b50519050600081118015611fa657504281105b91505b5092915050565b600954600160a060020a031681565b60016020526000908152604090205481565b600754600160a060020a031681565b600160a060020a039091166000908152600460209081526040808320938352929052205490565b60035481565b8133301480612021575061202181336122c2565b15156120a257604080516000805160206134d0833981519152815260206004820152602360248201527f424d3a206d75737420626520616e206f776e657220666f72207468652077616c60448201527f6c65740000000000000000000000000000000000000000000000000000000000606482015290519081900360840190fd5b600754604080517f4a4fbeec000000000000000000000000000000000000000000000000000000008152600160a060020a038087166004830152915186939290921691634a4fbeec916024808201926020929091908290030181600087803b15801561210d57600080fd5b505af1158015612121573d6000803e3d6000fd5b505050506040513d602081101561213757600080fd5b50511561219357604080516000805160206134d0833981519152815260206004820152601b60248201527f54543a2077616c6c6574206d75737420626520756e6c6f636b65640000000000604482015290519081900360640190fd5b61219d8484611ef8565b15156121f857604080516000805160206134d0833981519152815260206004820152601a60248201527f54543a20746172676574206e6f742077686974656c6973746564000000000000604482015290519081900360640190fd5b600854604080517f80bfbe68000000000000000000000000000000000000000000000000000000008152600160a060020a038781166004830152868116602483015260006044830181905292519316926380bfbe689260648084019391929182900301818387803b15801561226c57600080fd5b505af1158015612280573d6000803e3d6000fd5b5050604051600160a060020a038087169350871691507fd288ab5da2e1f37cf384a1565a3f905ad289b092fbdd31950dbbfef148c04f8890600090a350505050565b600081600160a060020a031683600160a060020a0316638da5cb5b6040518163ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401602060405180830381600087803b15801561232557600080fd5b505af1158015612339573d6000803e3d6000fd5b505050506040513d602081101561234f57600080fd5b5051600160a060020a0316149392505050565b83600160a060020a0316638f6f0332848460206040519081016040528060008152506040518463ffffffff167c01000000000000000000000000000000000000000000000000000000000281526004018084600160a060020a0316600160a060020a0316815260200183815260200180602001828103825283818151815260200191508051906020019080838360005b8381101561240a5781810151838201526020016123f2565b50505050905090810190601f1680156124375780820380516001836020036101000a031916815260200191505b50945050505050600060405180830381600087803b15801561245857600080fd5b505af115801561246c573d6000803e3d6000fd5b505050508173eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee600160a060020a031685600160a060020a03167fd5c97f2e041b2046be3b4337472f05720760a198f4d7d84980b7155eec7cca6f86856040518083600160a060020a0316600160a060020a0316815260200180602001828103825283818151815260200191508051906020019080838360005b838110156125115781810151838201526020016124f9565b50505050905090810190601f16801561253e5780820380516001836020036101000a031916815260200191505b50935050505060405180910390a450505050565b60408051600160a060020a038086166024808401919091526044808401879052845180850382018152606494850186526020810180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff167fa9059cbb0000000000000000000000000000000000000000000000000000000017815295517f8f6f03320000000000000000000000000000000000000000000000000000000081528a8516600482019081526000948201859052606093820193845282519682019690965281519196948c1695638f6f0332958c959489949293909260849091019190808383895b8381101561264d578181015183820152602001612635565b50505050905090810190601f16801561267a5780820380516001836020036101000a031916815260200191505b50945050505050600060405180830381600087803b15801561269b57600080fd5b505af11580156126af573d6000803e3d6000fd5b505050508285600160a060020a031687600160a060020a03167fd5c97f2e041b2046be3b4337472f05720760a198f4d7d84980b7155eec7cca6f87866040518083600160a060020a0316600160a060020a0316815260200180602001828103825283818151815260200191508051906020019080838360005b83811015612740578181015183820152602001612728565b50505050905090810190601f16801561276d5780820380516001836020036101000a031916815260200191505b50935050505060405180910390a4505050505050565b600160a060020a03821660009081526002602052604081208054600182015483916127e2916fffffffffffffffffffffffffffffffff808316927001000000000000000000000000000000009004169067ffffffffffffffff16612a51565b905061280185826fffffffffffffffffffffffffffffffff1686613169565b1561281a5761281185828661321d565b6001925061281f565b600092505b505092915050565b600080600086868686436040516020018086600160a060020a0316600160a060020a03166c0100000000000000000000000002815260140185600160a060020a0316600160a060020a03166c0100000000000000000000000002815260140184815260200183805190602001908083835b602083106128b75780518252601f199092019160209182019101612898565b51815160209384036101000a600019018019909216911617905292019384525060408051808503815293820190819052835193975095508594508601925081905083835b6020831061291a5780518252601f1990920191602091820191016128fb565b6001836020036101000a0380198251168184511680821785525050505050509050019150506040518091039020915061295e60055442612a8b90919063ffffffff16565b600160a060020a03808a166000818152600460209081526040808320888452825280832086905580518d86168152948c168583015284018a90526080606085018181528a51918601919091528951959650869588957fc63146cfd39cd6097f6e314e8595c4554faf95175b45c6215517903c12e765d9948f948f948f948f9493919260a085019290860191908190849084905b83811015612a095781810151838201526020016129f1565b50505050905090810190601f168015612a365780820380516001836020036101000a031916815260200191505b509550505050505060405180910390a4505095945050505050565b6000808267ffffffffffffffff16118015612a755750428267ffffffffffffffff16105b15612a81575081612a84565b50825b9392505050565b600082820183811015612a8457600080fd5b600160a060020a03909116600090815260046020908152604080832093835292905290812055565b600160a060020a0383166000908152600260205260408120600181015490919067ffffffffffffffff1681108015612b0c575060018201544267ffffffffffffffff909116105b612b295781546fffffffffffffffffffffffffffffffff16612b52565b815470010000000000000000000000000000000090046fffffffffffffffffffffffffffffffff165b82546fffffffffffffffffffffffffffffffff868116700100000000000000000000000000000000028184166fffffffffffffffffffffffffffffffff1990931692909217161783559050612bad428463ffffffff612a8b16565b60018301805467ffffffffffffffff191667ffffffffffffffff92909216919091179055612bdb4284612a8b565b67ffffffffffffffff168486600160a060020a03167f8a747eae44b6307d1b112c127968367d02d9f52ffef8533b3e899983ff2b1d4a60405160405180910390a45050505050565b6040517f190000000000000000000000000000000000000000000000000000000000000060208083018281526000602185018190526c01000000000000000000000000600160a060020a03808e16820260228801528c16026036860152604a85018a90528851909485938d938d938d938d938d938d938d939192606a909201918701908083835b60208310612cc95780518252601f199092019160209182019101612caa565b6001836020036101000a03801982511681845116808217855250505050505090500184815260200183815260200182815260200199505050505050505050506040516020818303038152906040526040518082805190602001908083835b60208310612d465780518252601f199092019160209182019101612d27565b51815160209384036101000a6000190180199092169116179052604080519290940182900382207f19457468657265756d205369676e6564204d6573736167653a0a33320000000083830152603c8084019190915284518084039091018152605c9092019384905281519195509293508392850191508083835b60208310612ddf5780518252601f199092019160209182019101612dc0565b5181516020939093036101000a600019018019909116921691909117905260405192018290039091209b9a5050505050505050505050565b6000612e23848461332a565b949350505050565b6000806024835110151515612e8f57604080516000805160206134d0833981519152815260206004820152601660248201527f524d3a20496e76616c6964206461746157616c6c657400000000000000000000604482015290519081900360640190fd5b505060240151600160a060020a0390811691161490565b600080612eb2836133b7565b604080517f6578656375746550656e64696e675472616e7366657228616464726573732c6181527f6464726573732c616464726573732c75696e743235362c62797465732c75696e60208201527f74323536290000000000000000000000000000000000000000000000000000008183015290519081900360450190209091507fffffffff0000000000000000000000000000000000000000000000000000000080831691161415612f675760009150611fa9565b5060019392505050565b60008083118015612f825750600082115b801561304a575082840285600160a060020a0316311080612fb55750612fb385612fab87610b1f565b858702613169565b155b8061304a5750604080517fd6eb1bbf0000000000000000000000000000000000000000000000000000000081523060048201529051600160a060020a0387169163d6eb1bbf9160248083019260209291908290030181600087803b15801561301c57600080fd5b505af1158015613030573d6000803e3d6000fd5b505050506040513d602081101561304657600080fd5b5051155b1561305757506000612e23565b506001949350505050565b60008061307184846000613422565b905061307d86826122c2565b9695505050505050565b618f08850160008511801561309c5750600083115b80156130a85750838111155b15611076573a8511156130bc573a026130bf565b84025b6130d2876130cc89610b1f565b8361321d565b604080517f8f6f0332000000000000000000000000000000000000000000000000000000008152600160a060020a03848116600483015260248201849052606060448301526000606483018190529251908a1692638f6f03329260a4808201939182900301818387803b15801561314857600080fd5b505af115801561315c573d6000803e3d6000fd5b5050505050505050505050565b600160a060020a03831660009081526002602081905260408220016fffffffffffffffffffffffffffffffff8414156131a55760019150613215565b80544270010000000000000000000000000000000090910467ffffffffffffffff1610156131d857838311159150613215565b80546fffffffffffffffffffffffffffffffff1683018410801590613212575080546fffffffffffffffffffffffffffffffff1683810110155b91505b509392505050565b60006fffffffffffffffffffffffffffffffff838116146115f85750600160a060020a03831660009081526002602081905260409091200180544270010000000000000000000000000000000090910467ffffffffffffffff1610156132f35780547fffffffffffffffff0000000000000000ffffffffffffffffffffffffffffffff1670010000000000000000000000000000000042620151800167ffffffffffffffff1602176fffffffffffffffffffffffffffffffff19166fffffffffffffffffffffffffffffffff83161781556115f8565b80546fffffffffffffffffffffffffffffffff8082168401166fffffffffffffffffffffffffffffffff1990911617815550505050565b600160a060020a038216600090815260016020526040812054819083116133545760009150611fa9565b507001000000000000000000000000000000006fffffffffffffffffffffffffffffffff1983160443612710018111156133915760009150611fa9565b5050600160a060020a039190911660009081526001602081905260409091209190915590565b6000600482511015151561341a57604080516000805160206134d0833981519152815260206004820152601a60248201527f524d3a20496e76616c69642066756e6374696f6e507265666978000000000000604482015290519081900360640190fd5b506020015190565b6041808202830160208101516040820151919092015160009260ff9190911691601b83148061345457508260ff16601c145b151561345f57600080fd5b60408051600080825260208083018085528b905260ff8716838501526060830186905260808301859052925160019360a0808501949193601f19840193928390039091019190865af11580156134b9573d6000803e3d6000fd5b5050604051601f19015198975050505050505050560008c379a000000000000000000000000000000000000000000000000000000000a165627a7a72305820e351226896c4f75e3b7a6e3fa5da814764857740dfb45715cba7ea7639a357030029000000000000000000000000c17d432bd8e8850fd7b32b0270f5afac65db0105000000000000000000000000391f0e86da951c03b1183c60b195090671adea8800000000000000000000000044da3a8051ba88eab0440db3779cab9d679ae76f00000000000000000000000058933d34b80ef1a1a0a22121d650410f9a9cd24f0000000000000000000000000000000000000000000000000000000000015180000000000000000000000000000000000000000000000000000000000000a8c00000000000000000000000000000000000000000000000008ac7230489e80000",
  "constructorArguments": "000000000000000000000000c17d432bd8e8850fd7b32b0270f5afac65db0105000000000000000000000000391f0e86da951c03b1183c60b195090671adea8800000000000000000000000044da3a8051ba88eab0440db3779cab9d679ae76f00000000000000000000000058933d34b80ef1a1a0a22121d650410f9a9cd24f0000000000000000000000000000000000000000000000000000000000015180000000000000000000000000000000000000000000000000000000000000a8c00000000000000000000000000000000000000000000000008ac7230489e80000"
}