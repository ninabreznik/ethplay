{
  "address": "0xf6a6e8dbfdaf43a372c703f02f12cb91d105d537",
  "chain": "ETH",
  "chainID": 1,
  "verifier": "etherscan.io",
  "commonName": "",
  "contractName": "BZxProxy",
  "compilerVersion": "v0.5.2+commit.1df8f40c",
  "optimization": true,
  "runs": "200",
  "evmVersion": "default",
  "sourceCode": "/**\n *Submitted for verification at Etherscan.io on 2019-01-23\n*/\n\n/**\n * Copyright 2017–2018, bZeroX, LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0.\n */\n \npragma solidity 0.5.2;\n\n\n/**\n * @title Ownable\n * @dev The Ownable contract has an owner address, and provides basic authorization control\n * functions, this simplifies the implementation of \"user permissions\".\n */\ncontract Ownable {\n  address public owner;\n\n\n  event OwnershipTransferred(\n    address indexed previousOwner,\n    address indexed newOwner\n  );\n\n\n  /**\n   * @dev The Ownable constructor sets the original `owner` of the contract to the sender\n   * account.\n   */\n  constructor() public {\n    owner = msg.sender;\n  }\n\n  /**\n   * @dev Throws if called by any account other than the owner.\n   */\n  modifier onlyOwner() {\n    require(msg.sender == owner);\n    _;\n  }\n\n  /**\n   * @dev Allows the current owner to transfer control of the contract to a newOwner.\n   * @param _newOwner The address to transfer ownership to.\n   */\n  function transferOwnership(address _newOwner) public onlyOwner {\n    _transferOwnership(_newOwner);\n  }\n\n  /**\n   * @dev Transfers control of the contract to a newOwner.\n   * @param _newOwner The address to transfer ownership to.\n   */\n  function _transferOwnership(address _newOwner) internal {\n    require(_newOwner != address(0));\n    emit OwnershipTransferred(owner, _newOwner);\n    owner = _newOwner;\n  }\n}\n\n/**\n * @title Helps contracts guard against reentrancy attacks.\n * @author Remco Bloemen <[email protected]π.com>, Eenae <[email protected]>\n * @dev If you mark a function `nonReentrant`, you should also\n * mark it `external`.\n */\ncontract ReentrancyGuard {\n\n  /// @dev Constant for unlocked guard state - non-zero to prevent extra gas costs.\n  /// See: https://github.com/OpenZeppelin/openzeppelin-solidity/issues/1056\n  uint256 private constant REENTRANCY_GUARD_FREE = 1;\n\n  /// @dev Constant for locked guard state\n  uint256 private constant REENTRANCY_GUARD_LOCKED = 2;\n\n  /**\n   * @dev We use a single lock for the whole contract.\n   */\n  uint256 private reentrancyLock = REENTRANCY_GUARD_FREE;\n\n  /**\n   * @dev Prevents a contract from calling itself, directly or indirectly.\n   * If you mark a function `nonReentrant`, you should also\n   * mark it `external`. Calling one `nonReentrant` function from\n   * another is not supported. Instead, you can implement a\n   * `private` function doing the actual work, and an `external`\n   * wrapper marked as `nonReentrant`.\n   */\n  modifier nonReentrant() {\n    require(reentrancyLock == REENTRANCY_GUARD_FREE);\n    reentrancyLock = REENTRANCY_GUARD_LOCKED;\n    _;\n    reentrancyLock = REENTRANCY_GUARD_FREE;\n  }\n\n}\n\ncontract GasTracker {\n\n    uint256 internal gasUsed;\n\n    modifier tracksGas() {\n        // tx call 21k gas\n        gasUsed = gasleft() + 21000;\n\n        _; // modified function body inserted here\n\n        gasUsed = 0; // zero out the storage so we don't persist anything\n    }\n}\n\ncontract BZxObjects {\n\n    struct ListIndex {\n        uint256 index;\n        bool isSet;\n    }\n\n    struct LoanOrder {\n        address loanTokenAddress;\n        address interestTokenAddress;\n        address collateralTokenAddress;\n        address oracleAddress;\n        uint256 loanTokenAmount;\n        uint256 interestAmount;\n        uint256 initialMarginAmount;\n        uint256 maintenanceMarginAmount;\n        uint256 maxDurationUnixTimestampSec;\n        bytes32 loanOrderHash;\n    }\n\n    struct LoanOrderAux {\n        address makerAddress;\n        address takerAddress;\n        address feeRecipientAddress;\n        address tradeTokenToFillAddress;\n        uint256 lenderRelayFee;\n        uint256 traderRelayFee;\n        uint256 makerRole;\n        uint256 expirationUnixTimestampSec;\n        bool withdrawOnOpen;\n        string description;\n    }\n\n    struct LoanPosition {\n        address trader;\n        address collateralTokenAddressFilled;\n        address positionTokenAddressFilled;\n        uint256 loanTokenAmountFilled;\n        uint256 loanTokenAmountUsed;\n        uint256 collateralTokenAmountFilled;\n        uint256 positionTokenAmountFilled;\n        uint256 loanStartUnixTimestampSec;\n        uint256 loanEndUnixTimestampSec;\n        bool active;\n        uint256 positionId;\n    }\n\n    struct PositionRef {\n        bytes32 loanOrderHash;\n        uint256 positionId;\n    }\n\n    struct LenderInterest {\n        uint256 interestOwedPerDay;\n        uint256 interestPaid;\n        uint256 interestPaidDate;\n    }\n\n    struct TraderInterest {\n        uint256 interestOwedPerDay;\n        uint256 interestPaid;\n        uint256 interestDepositTotal;\n        uint256 interestUpdatedDate;\n    }\n}\n\ncontract BZxEvents {\n\n    event LogLoanAdded (\n        bytes32 indexed loanOrderHash,\n        address adderAddress,\n        address indexed makerAddress,\n        address indexed feeRecipientAddress,\n        uint256 lenderRelayFee,\n        uint256 traderRelayFee,\n        uint256 maxDuration,\n        uint256 makerRole\n    );\n\n    event LogLoanTaken (\n        address indexed lender,\n        address indexed trader,\n        address loanTokenAddress,\n        address collateralTokenAddress,\n        uint256 loanTokenAmount,\n        uint256 collateralTokenAmount,\n        uint256 loanEndUnixTimestampSec,\n        bool firstFill,\n        bytes32 indexed loanOrderHash,\n        uint256 positionId\n    );\n\n    event LogLoanCancelled(\n        address indexed makerAddress,\n        uint256 cancelLoanTokenAmount,\n        uint256 remainingLoanTokenAmount,\n        bytes32 indexed loanOrderHash\n    );\n\n    event LogLoanClosed(\n        address indexed lender,\n        address indexed trader,\n        address loanCloser,\n        bool isLiquidation,\n        bytes32 indexed loanOrderHash,\n        uint256 positionId\n    );\n\n    event LogPositionTraded(\n        bytes32 indexed loanOrderHash,\n        address indexed trader,\n        address sourceTokenAddress,\n        address destTokenAddress,\n        uint256 sourceTokenAmount,\n        uint256 destTokenAmount,\n        uint256 positionId\n    );\n\n    event LogWithdrawPosition(\n        bytes32 indexed loanOrderHash,\n        address indexed trader,\n        uint256 positionAmount,\n        uint256 remainingPosition,\n        uint256 positionId\n    );\n\n    event LogPayInterestForOracle(\n        address indexed lender,\n        address indexed oracleAddress,\n        address indexed interestTokenAddress,\n        uint256 amountPaid,\n        uint256 totalAccrued\n    );\n\n    event LogPayInterestForOrder(\n        bytes32 indexed loanOrderHash,\n        address indexed lender,\n        address indexed interestTokenAddress,\n        uint256 amountPaid,\n        uint256 totalAccrued,\n        uint256 loanCount\n    );\n\n    event LogChangeTraderOwnership(\n        bytes32 indexed loanOrderHash,\n        address indexed oldOwner,\n        address indexed newOwner\n    );\n\n    event LogChangeLenderOwnership(\n        bytes32 indexed loanOrderHash,\n        address indexed oldOwner,\n        address indexed newOwner\n    );\n\n    event LogUpdateLoanAsLender(\n        bytes32 indexed loanOrderHash,\n        address indexed lender,\n        uint256 loanTokenAmountAdded,\n        uint256 loanTokenAmountFillable,\n        uint256 expirationUnixTimestampSec\n    );\n}\n\ncontract BZxStorage is BZxObjects, BZxEvents, ReentrancyGuard, Ownable, GasTracker {\n    uint256 internal constant MAX_UINT = 2**256 - 1;\n\n    address public bZRxTokenContract;\n    address public bZxEtherContract;\n    address public wethContract;\n    address payable public vaultContract;\n    address public oracleRegistryContract;\n    address public bZxTo0xContract;\n    address public bZxTo0xV2Contract;\n    bool public DEBUG_MODE = false;\n\n    // Loan Orders\n    mapping (bytes32 => LoanOrder) public orders; // mapping of loanOrderHash to on chain loanOrders\n    mapping (bytes32 => LoanOrderAux) public orderAux; // mapping of loanOrderHash to on chain loanOrder auxiliary parameters\n    mapping (bytes32 => uint256) public orderFilledAmounts; // mapping of loanOrderHash to loanTokenAmount filled\n    mapping (bytes32 => uint256) public orderCancelledAmounts; // mapping of loanOrderHash to loanTokenAmount cancelled\n    mapping (bytes32 => address) public orderLender; // mapping of loanOrderHash to lender (only one lender per order)\n\n    // Loan Positions\n    mapping (uint256 => LoanPosition) public loanPositions; // mapping of position ids to loanPositions\n    mapping (bytes32 => mapping (address => uint256)) public loanPositionsIds; // mapping of loanOrderHash to mapping of trader address to position id\n\n    // Lists\n    mapping (address => bytes32[]) public orderList; // mapping of lenders and trader addresses to array of loanOrderHashes\n    mapping (bytes32 => mapping (address => ListIndex)) public orderListIndex; // mapping of loanOrderHash to mapping of lenders and trader addresses to ListIndex objects\n\n    mapping (bytes32 => uint256[]) public orderPositionList; // mapping of loanOrderHash to array of order position ids\n\n    PositionRef[] public positionList; // array of loans that need to be checked for liquidation or expiration\n    mapping (uint256 => ListIndex) public positionListIndex; // mapping of position ids to ListIndex objects\n\n    // Interest\n    mapping (address => mapping (address => uint256)) public tokenInterestPaid; // mapping of lender address to mapping of interest token address to amount of interest that has ever been paid to a lender\n    mapping (address => mapping (address => mapping (address => LenderInterest))) public lenderOracleInterest; // mapping of lender address to mapping of oracle to mapping of interest token to LenderInterest objects\n    mapping (bytes32 => LenderInterest) public lenderOrderInterest; // mapping of loanOrderHash to LenderInterest objects\n    mapping (uint256 => TraderInterest) public traderLoanInterest; // mapping of position ids to TraderInterest objects\n\n    // Other Storage\n    mapping (address => address) public oracleAddresses; // mapping of oracles to their current logic contract\n    mapping (bytes32 => mapping (address => bool)) public preSigned; // mapping of hash => signer => signed\n    mapping (address => mapping (address => bool)) public allowedValidators; // mapping of signer => validator => approved\n    mapping (bytes => bytes) internal db; // general use storage container\n    mapping (bytes => bytes[]) internal dbArray; // general use storage array container\n}\n\ncontract BZxProxiable {\n    mapping (bytes4 => address) public targets;\n\n    mapping (bytes4 => bool) public targetIsPaused;\n\n    function initialize(address _target) public;\n}\n\ncontract BZxProxy is BZxStorage, BZxProxiable {\n    \n    constructor(\n        address _settings) \n        public\n    {\n        (bool result,) = _settings.delegatecall.gas(gasleft())(abi.encodeWithSignature(\"initialize(address)\", _settings));\n        require(result, \"BZxProxy::constructor: failed\");\n    }\n    \n    function() \n        external\n        payable \n    {\n        require(!targetIsPaused[msg.sig], \"BZxProxy::Function temporarily paused\");\n\n        address target = targets[msg.sig];\n        require(target != address(0), \"BZxProxy::Target not found\");\n\n        bytes memory data = msg.data;\n        assembly {\n            let result := delegatecall(gas, target, add(data, 0x20), mload(data), 0, 0)\n            let size := returndatasize\n            let ptr := mload(0x40)\n            returndatacopy(ptr, 0, size)\n            switch result\n            case 0 { revert(ptr, size) }\n            default { return(ptr, size) }\n        }\n    }\n\n    function initialize(\n        address)\n        public\n    {\n        revert();\n    }\n}",
  "bytecode": "608060405260016000556009805460a060020a60ff021916905534801561002557600080fd5b506040516020806112778339810180604052602081101561004557600080fd5b505160018054600160a060020a031916331790556000600160a060020a0382165a60408051600160a060020a0386166024808301919091528251808303909101815260449091018252602081018051600160e060020a03167fc4d66de80000000000000000000000000000000000000000000000000000000017815291518151919290918291908083835b602083106100ef5780518252601f1990920191602091820191016100d0565b6001836020036101000a0380198251168184511680821785525050505050509050019150506000604051808303818686f4925050503d8060008114610150576040519150601f19603f3d011682016040523d82523d6000602084013e610155565b606091505b505090508015156101c757604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601d60248201527f425a7850726f78793a3a636f6e7374727563746f723a206661696c6564000000604482015290519081900360640190fd5b505061109f806101d86000396000f3fe608060405260043610610200576000357c01000000000000000000000000000000000000000000000000000000009004806386042ec61161011f578063a72480ae116100b2578063d9fd734111610081578063d9fd734114610a6f578063de3f26eb14610a99578063f2fde38b14610aae578063f4fb9b2f14610ae157610200565b8063a72480ae146108ce578063b7a025f9146109fb578063c4d66de814610a10578063cce37f3e14610a4557610200565b80639437d0ea116100ee5780639437d0ea1461076c5780639ae6b1861461079c5780639c3f1e90146107b15780639e312dac1461083d57610200565b806386042ec6146106b95780638638aa65146106f25780638da5cb5b146107075780639048617a1461071c57610200565b80634b4056c511610197578063779dec5b11610166578063779dec5b146105ed5780637955f60f146106025780637b8e35141461064557806382c174d01461068057610200565b80634b4056c5146105185780635c445c861461056057806364a71040146105a557806371eb125e146105ba57610200565b80632cbf27d2116101d35780632cbf27d21461043a57806342ad3526146104875780634780eac1146104d95780634a7c3d50146104ee57610200565b8063093983bd1461036357806316a6bff6146103a95780632035d73b146103dd5780632274346b14610425575b60008035600160e060020a031916815260208052604090205460ff1615610272576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602581526020018061104f6025913960400191505060405180910390fd5b60008035600160e060020a0319168152601f6020526040902054600160a060020a031680151561030357604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601a60248201527f425a7850726f78793a3a546172676574206e6f7420666f756e64000000000000604482015290519081900360640190fd5b60606000368080601f016020809104026020016040519081016040528093929190818152602001838380828437600092018290525084519495509384935091505060208401855af43d604051816000823e82801561035f578282f35b8282fd5b34801561036f57600080fd5b5061038d6004803603602081101561038657600080fd5b5035610b1a565b60408051600160a060020a039092168252519081900360200190f35b3480156103b557600080fd5b5061038d600480360360208110156103cc57600080fd5b5035600160e060020a031916610b35565b3480156103e957600080fd5b506104116004803603602081101561040057600080fd5b5035600160e060020a031916610b50565b604080519115158252519081900360200190f35b34801561043157600080fd5b5061038d610b64565b34801561044657600080fd5b506104756004803603604081101561045d57600080fd5b50600160a060020a0381358116916020013516610b73565b60408051918252519081900360200190f35b34801561049357600080fd5b506104c0600480360360408110156104aa57600080fd5b5080359060200135600160a060020a0316610b90565b6040805192835290151560208301528051918290030190f35b3480156104e557600080fd5b5061038d610bb7565b3480156104fa57600080fd5b506104c06004803603602081101561051157600080fd5b5035610bc6565b34801561052457600080fd5b506105426004803603602081101561053b57600080fd5b5035610be2565b60408051938452602084019290925282820152519081900360600190f35b34801561056c57600080fd5b506105426004803603606081101561058357600080fd5b50600160a060020a038135811691602081013582169160409091013516610c03565b3480156105b157600080fd5b5061038d610c35565b3480156105c657600080fd5b5061038d600480360360208110156105dd57600080fd5b5035600160a060020a0316610c44565b3480156105f957600080fd5b5061038d610c5f565b34801561060e57600080fd5b5061062c6004803603602081101561062557600080fd5b5035610c6e565b6040805192835260208301919091528051918290030190f35b34801561065157600080fd5b506104116004803603604081101561066857600080fd5b50600160a060020a0381358116916020013516610c9a565b34801561068c57600080fd5b50610411600480360360408110156106a357600080fd5b5080359060200135600160a060020a0316610cba565b3480156106c557600080fd5b50610475600480360360408110156106dc57600080fd5b5080359060200135600160a060020a0316610cda565b3480156106fe57600080fd5b50610411610cf7565b34801561071357600080fd5b5061038d610d18565b34801561072857600080fd5b506107466004803603602081101561073f57600080fd5b5035610d27565b604080519485526020850193909352838301919091526060830152519081900360800190f35b34801561077857600080fd5b506104756004803603604081101561078f57600080fd5b5080359060200135610d4e565b3480156107a857600080fd5b5061038d610d7e565b3480156107bd57600080fd5b506107db600480360360208110156107d457600080fd5b5035610d8d565b60408051600160a060020a039b8c168152998b1660208b0152978a1689890152959098166060880152608087019390935260a086019190915260c085015260e08401526101008301939093526101208201929092529051908190036101400190f35b34801561084957600080fd5b506108676004803603602081101561086057600080fd5b5035610def565b60408051600160a060020a039c8d1681529a8c1660208c015298909a16898901526060890196909652608088019490945260a087019290925260c086015260e085015261010084015215156101208301526101408201929092529051908190036101600190f35b3480156108da57600080fd5b506108f8600480360360208110156108f157600080fd5b5035610e59565b604051808b600160a060020a0316600160a060020a031681526020018a600160a060020a0316600160a060020a0316815260200189600160a060020a0316600160a060020a0316815260200188600160a060020a0316600160a060020a031681526020018781526020018681526020018581526020018481526020018315151515815260200180602001828103825283818151815260200191508051906020019080838360005b838110156109b757818101518382015260200161099f565b50505050905090810190601f1680156109e45780820380516001836020036101000a031916815260200191505b509b50505050505050505050505060405180910390f35b348015610a0757600080fd5b5061038d610f4b565b348015610a1c57600080fd5b50610a4360048036036020811015610a3357600080fd5b5035600160a060020a0316610f5a565b005b348015610a5157600080fd5b5061047560048036036020811015610a6857600080fd5b5035610f5f565b348015610a7b57600080fd5b5061047560048036036020811015610a9257600080fd5b5035610f71565b348015610aa557600080fd5b5061038d610f83565b348015610aba57600080fd5b50610a4360048036036020811015610ad157600080fd5b5035600160a060020a0316610f92565b348015610aed57600080fd5b5061047560048036036040811015610b0457600080fd5b50600160a060020a038135169060200135610fb5565b600e60205260009081526040902054600160a060020a031681565b601f60205260009081526040902054600160a060020a031681565b602080526000908152604090205460ff1681565b600654600160a060020a031681565b601660209081526000928352604080842090915290825290205481565b60126020908152600092835260408084209091529082529020805460019091015460ff1682565b600554600160a060020a031681565b6015602052600090815260409020805460019091015460ff1682565b60186020526000908152604090208054600182015460029092015490919083565b601760209081526000938452604080852082529284528284209052825290208054600182015460029092015490919083565b600454600160a060020a031681565b601a60205260009081526040902054600160a060020a031681565b600354600160a060020a031681565b6014805482908110610c7c57fe5b60009182526020909120600290910201805460019091015490915082565b601c60209081526000928352604080842090915290825290205460ff1681565b601b60209081526000928352604080842090915290825290205460ff1681565b601060209081526000928352604080842090915290825290205481565b60095474010000000000000000000000000000000000000000900460ff1681565b600154600160a060020a031681565b60196020526000908152604090208054600182015460028301546003909301549192909184565b601360205281600052604060002081815481101515610d6957fe5b90600052602060002001600091509150505481565b600954600160a060020a031681565b600a602052600090815260409020805460018201546002830154600384015460048501546005860154600687015460078801546008890154600990990154600160a060020a03988916999789169896871697959096169593949293919290918a565b600f60205260009081526040902080546001820154600283015460038401546004850154600586015460068701546007880154600889015460098a0154600a909a0154600160a060020a03998a169a988a16999097169795969495939492939192909160ff16908b565b600b602090815260009182526040918290208054600180830154600280850154600386015460048701546005880154600689015460078a015460088b015460098c0180548f516101009c8216159c909c02600019011698909804601f81018e90048e028b018e01909e528d8a52600160a060020a039a8b169d988b169c968b169b9a90951699939892979196909560ff90951694909190830182828015610f415780601f10610f1657610100808354040283529160200191610f41565b820191906000526020600020905b815481529060010190602001808311610f2457829003601f168201915b505050505090508a565b600854600160a060020a031681565b600080fd5b600c6020526000908152604090205481565b600d6020526000908152604090205481565b600754600160a060020a031681565b600154600160a060020a03163314610fa957600080fd5b610fb281610fd0565b50565b601160205281600052604060002081815481101515610d6957fe5b600160a060020a0381161515610fe557600080fd5b600154604051600160a060020a038084169216907f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e090600090a36001805473ffffffffffffffffffffffffffffffffffffffff1916600160a060020a039290921691909117905556fe425a7850726f78793a3a46756e6374696f6e2074656d706f726172696c7920706175736564a165627a7a723058205b1ba7fba6b1a78dde514c725b2fa9f2aaaef5b9a6b3433187736ca47776ecd70029000000000000000000000000120d0b8383938796d0623a05a1b85cb08da54cff",
  "constructorArguments": "000000000000000000000000120d0b8383938796d0623a05a1b85cb08da54cff"
}