{
  "address": "0xd60cff99be043d2d2f1c770d7081d9b509c569f3",
  "chain": "ETH",
  "chainID": 1,
  "verifier": "etherscan.io",
  "commonName": "",
  "contractName": "MultiSigWallet",
  "compilerVersion": "v0.4.24+commit.e67f0147",
  "optimization": false,
  "runs": "200",
  "evmVersion": "default",
  "sourceCode": "/**\n *Submitted for verification at Etherscan.io on 2019-01-21\n*/\n\npragma solidity ^0.4.24;\n\n/**\n * @title MultiSig\n * @dev Simple MultiSig using off-chain signing.\n * @author Julien Niset - <[emailÂ protected]>\n */\ncontract MultiSigWallet {\n\n    uint constant public MAX_OWNER_COUNT = 10;\n\n    // Incrementing counter to prevent replay attacks\n    uint256 public nonce;   \n    // The threshold           \n    uint256 public threshold; \n    // The number of owners\n    uint256 public ownersCount;\n    // Mapping to check if an address is an owner\n    mapping (address => bool) public isOwner; \n\n    // Events\n    event OwnerAdded(address indexed owner);\n    event OwnerRemoved(address indexed owner);\n    event ThresholdChanged(uint256 indexed newThreshold);\n    event Executed(address indexed destination, uint256 indexed value, bytes data);\n    event Received(uint256 indexed value, address indexed from);\n\n    /**\n     * @dev Throws is the calling account is not the multisig.\n     */\n    modifier onlyWallet() {\n        require(msg.sender == address(this), \"MSW: Calling account is not wallet\");\n        _;\n    }\n\n    /**\n     * @dev Constructor.\n     * @param _threshold The threshold of the multisig.\n     * @param _owners The owners of the multisig.\n     */\n    constructor(uint256 _threshold, address[] _owners) public {\n        require(_owners.length > 0 && _owners.length <= MAX_OWNER_COUNT, \"MSW: Not enough or too many owners\");\n        require(_threshold > 0 && _threshold <= _owners.length, \"MSW: Invalid threshold\");\n        ownersCount = _owners.length;\n        threshold = _threshold;\n        for(uint256 i = 0; i < _owners.length; i++) {\n            isOwner[_owners[i]] = true;\n            emit OwnerAdded(_owners[i]);\n        }\n        emit ThresholdChanged(_threshold);\n    }\n\n    /**\n     * @dev Only entry point of the multisig. The method will execute any transaction provided that it \n     * receieved enough signatures from the wallet owners.  \n     * @param _to The destination address for the transaction to execute.\n     * @param _value The value parameter for the transaction to execute.\n     * @param _data The data parameter for the transaction to execute.\n     * @param _signatures Concatenated signatures ordered based on increasing signer's address.\n     */\n    function execute(address _to, uint _value, bytes _data, bytes _signatures) public {\n        uint8 v;\n        bytes32 r;\n        bytes32 s;\n        uint256 count = _signatures.length / 65;\n        require(count >= threshold, \"MSW: Not enough signatures\");\n        bytes32 txHash = keccak256(abi.encodePacked(byte(0x19), byte(0), address(this), _to, _value, _data, nonce));\n        nonce += 1;\n        uint256 valid;\n        address lastSigner = 0;\n        for(uint256 i = 0; i < count; i++) {\n            (v,r,s) = splitSignature(_signatures, i);\n            address recovered = ecrecover(keccak256(abi.encodePacked(\"\\x19Ethereum Signed Message:\\n32\",txHash)), v, r, s);\n            require(recovered > lastSigner, \"MSW: Badly ordered signatures\"); // make sure signers are different\n            lastSigner = recovered;\n            if(isOwner[recovered]) {\n                valid += 1;\n                if(valid >= threshold) {\n                    require(_to.call.value(_value)(_data), \"MSW: External call failed\");\n                    emit Executed(_to, _value, _data);\n                    return;\n                }\n            }\n        }\n        // If we reach that point then the transaction is not executed\n        revert(\"MSW: Not enough valid signatures\");\n    }\n\n    /**\n     * @dev Adds an owner to the multisig. This method can only be called by the multisig itself \n     * (i.e. it must go through the execute method and be confirmed by the owners).\n     * @param _owner The address of the new owner.\n     */\n    function addOwner(address _owner) public onlyWallet {\n        require(ownersCount < MAX_OWNER_COUNT, \"MSW: MAX_OWNER_COUNT reached\");\n        require(isOwner[_owner] == false, \"MSW: Already owner\");\n        ownersCount += 1;\n        isOwner[_owner] = true;\n        emit OwnerAdded(_owner);\n    }\n\n    /**\n     * @dev Removes an owner from the multisig. This method can only be called by the multisig itself \n     * (i.e. it must go through the execute method and be confirmed by the owners).\n     * @param _owner The address of the removed owner.\n     */\n    function removeOwner(address _owner) public onlyWallet {\n        require(ownersCount > threshold, \"MSW: Too few owners left\");\n        require(isOwner[_owner] == true, \"MSW: Not an owner\");\n        ownersCount -= 1;\n        delete isOwner[_owner];\n        emit OwnerRemoved(_owner);\n    }\n\n    /**\n     * @dev Changes the threshold of the multisig. This method can only be called by the multisig itself \n     * (i.e. it must go through the execute method and be confirmed by the owners).\n     * @param _newThreshold The new threshold.\n     */\n    function changeThreshold(uint256 _newThreshold) public onlyWallet {\n        require(_newThreshold > 0 && _newThreshold <= ownersCount, \"MSW: Invalid new threshold\");\n        threshold = _newThreshold;\n        emit ThresholdChanged(_newThreshold);\n    }\n\n    /**\n     * @dev Makes it possible for the multisig to receive ETH.\n     */\n    function () external payable {\n        emit Received(msg.value, msg.sender);        \n    }\n\n        /**\n     * @dev Parses the signatures and extract (r, s, v) for a signature at a given index.\n     * A signature is {bytes32 r}{bytes32 s}{uint8 v} in compact form and signatures are concatenated.\n     * @param _signatures concatenated signatures\n     * @param _index which signature to read (0, 1, 2, ...)\n     */\n    function splitSignature(bytes _signatures, uint256 _index) internal pure returns (uint8 v, bytes32 r, bytes32 s) {\n        // we jump 32 (0x20) as the first slot of bytes contains the length\n        // we jump 65 (0x41) per signature\n        // for v we load 32 bytes ending with v (the first 31 come from s) tehn apply a mask\n        assembly {\n            r := mload(add(_signatures, add(0x20,mul(0x41,_index))))\n            s := mload(add(_signatures, add(0x40,mul(0x41,_index))))\n            v := and(mload(add(_signatures, add(0x41,mul(0x41,_index)))), 0xff)\n        }\n        require(v == 27 || v == 28, \"MSW: Invalid v\"); \n    }\n\n}",
  "bytecode": "608060405234801561001057600080fd5b506040516115b83803806115b8833981018060405281019080805190602001909291908051820192919050505060008082511180156100515750600a825111155b15156100eb576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260228152602001807f4d53573a204e6f7420656e6f756768206f7220746f6f206d616e79206f776e6581526020017f727300000000000000000000000000000000000000000000000000000000000081525060400191505060405180910390fd5b6000831180156100fc575081518311155b1515610170576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260168152602001807f4d53573a20496e76616c6964207468726573686f6c640000000000000000000081525060200191505060405180910390fd5b815160028190555082600181905550600090505b81518110156102635760016003600084848151811015156101a157fe5b9060200190602002015173ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff021916908315150217905550818181518110151561020a57fe5b9060200190602002015173ffffffffffffffffffffffffffffffffffffffff167f994a936646fe87ffe4f1e469d3d6aa417d6b855598397f323de5b449f765f0c360405160405180910390a28080600101915050610184565b827f6c4ce60fd690e1216286a10b875c5662555f10774484e58142cedd7a90781baa60405160405180910390a2505050611316806102a26000396000f300608060405260043610610099576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063173825d9146100df5780632f54bf6e1461012257806342cde4e81461017d578063694e80c3146101a85780637065cb48146101d5578063affed0e014610218578063b948854614610243578063d74f8edd1461026e578063da0980c714610299575b3373ffffffffffffffffffffffffffffffffffffffff16347f8863e458255c600ae3e61be347822f3ee57088c8538b68b5dd2357e682e59e1960405160405180910390a3005b3480156100eb57600080fd5b50610120600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050610372565b005b34801561012e57600080fd5b50610163600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050610624565b604051808215151515815260200191505060405180910390f35b34801561018957600080fd5b50610192610644565b6040518082815260200191505060405180910390f35b3480156101b457600080fd5b506101d36004803603810190808035906020019092919050505061064a565b005b3480156101e157600080fd5b50610216600480360381019080803573ffffffffffffffffffffffffffffffffffffffff1690602001909291905050506107d0565b005b34801561022457600080fd5b5061022d610a8a565b6040518082815260200191505060405180910390f35b34801561024f57600080fd5b50610258610a90565b6040518082815260200191505060405180910390f35b34801561027a57600080fd5b50610283610a96565b6040518082815260200191505060405180910390f35b3480156102a557600080fd5b50610370600480360381019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919080359060200190929190803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509192919290803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509192919290505050610a9b565b005b3073ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614151561043b576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260228152602001807f4d53573a2043616c6c696e67206163636f756e74206973206e6f742077616c6c81526020017f657400000000000000000000000000000000000000000000000000000000000081525060400191505060405180910390fd5b6001546002541115156104b6576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260188152602001807f4d53573a20546f6f20666577206f776e657273206c656674000000000000000081525060200191505060405180910390fd5b60011515600360008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff16151514151561057e576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260118152602001807f4d53573a204e6f7420616e206f776e657200000000000000000000000000000081525060200191505060405180910390fd5b6001600260008282540392505081905550600360008273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81549060ff02191690558073ffffffffffffffffffffffffffffffffffffffff167f58619076adf5bb0943d100ef88d52d7c3fd691b19d3a9071b555b651fbf418da60405160405180910390a250565b60036020528060005260406000206000915054906101000a900460ff1681565b60015481565b3073ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16141515610713576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260228152602001807f4d53573a2043616c6c696e67206163636f756e74206973206e6f742077616c6c81526020017f657400000000000000000000000000000000000000000000000000000000000081525060400191505060405180910390fd5b60008111801561072557506002548111155b1515610799576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601a8152602001807f4d53573a20496e76616c6964206e6577207468726573686f6c6400000000000081525060200191505060405180910390fd5b80600181905550807f6c4ce60fd690e1216286a10b875c5662555f10774484e58142cedd7a90781baa60405160405180910390a250565b3073ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16141515610899576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260228152602001807f4d53573a2043616c6c696e67206163636f756e74206973206e6f742077616c6c81526020017f657400000000000000000000000000000000000000000000000000000000000081525060400191505060405180910390fd5b600a600254101515610913576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601c8152602001807f4d53573a204d41585f4f574e45525f434f554e5420726561636865640000000081525060200191505060405180910390fd5b60001515600360008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff1615151415156109db576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260128152602001807f4d53573a20416c7265616479206f776e6572000000000000000000000000000081525060200191505060405180910390fd5b60016002600082825401925050819055506001600360008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083151502179055508073ffffffffffffffffffffffffffffffffffffffff167f994a936646fe87ffe4f1e469d3d6aa417d6b855598397f323de5b449f765f0c360405160405180910390a250565b60005481565b60025481565b600a81565b600080600080600080600080600060418a51811515610ab657fe5b0495506001548610151515610b33576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601a8152602001807f4d53573a204e6f7420656e6f756768207369676e61747572657300000000000081525060200191505060405180910390fd5b60197f01000000000000000000000000000000000000000000000000000000000000000260007f010000000000000000000000000000000000000000000000000000000000000002308f8f8f60005460405160200180887effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff19168152600101877effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681526001018673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166c010000000000000000000000000281526014018573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166c0100000000000000000000000002815260140184815260200183805190602001908083835b602083101515610cd65780518252602082019150602081019050602083039250610cb1565b6001836020036101000a0380198251168184511680821785525050505050509050018281526020019750505050505050506040516020818303038152906040526040518082805190602001908083835b602083101515610d4b5780518252602082019150602081019050602083039250610d26565b6001836020036101000a038019825116818451168082178552505050505050905001915050604051809103902094506001600080828254019250508190555060009250600091505b858210156111b157610da58a8361122e565b809950819a50829b5050505060018560405160200180807f19457468657265756d205369676e6564204d6573736167653a0a333200000000815250601c0182600019166000191681526020019150506040516020818303038152906040526040518082805190602001908083835b602083101515610e385780518252602082019150602081019050602083039250610e13565b6001836020036101000a03801982511681845116808217855250505050505090500191505060405180910390208a8a8a604051600081526020016040526040518085600019166000191681526020018460ff1660ff1681526020018360001916600019168152602001826000191660001916815260200194505050505060206040516020810390808403906000865af1158015610ed9573d6000803e3d6000fd5b5050506020604051035190508273ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff16111515610f88576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601d8152602001807f4d53573a204261646c79206f726465726564207369676e61747572657300000081525060200191505060405180910390fd5b809250600360008273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff16156111a457600184019350600154841015156111a3578c73ffffffffffffffffffffffffffffffffffffffff168c8c60405180828051906020019080838360005b83811015611034578082015181840152602081019050611019565b50505050905090810190601f1680156110615780820380516001836020036101000a031916815260200191505b5091505060006040518083038185875af19250505015156110ea576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260198152602001807f4d53573a2045787465726e616c2063616c6c206661696c65640000000000000081525060200191505060405180910390fd5b8b8d73ffffffffffffffffffffffffffffffffffffffff167fcaf938de11c367272220bfd1d2baa99ca46665e7bc4d85f00adb51b90fe1fa9f8d6040518080602001828103825283818151815260200191508051906020019080838360005b83811015611164578082015181840152602081019050611149565b50505050905090810190601f1680156111915780820380516001836020036101000a031916815260200191505b509250505060405180910390a361121f565b5b8180600101925050610d93565b6040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260208152602001807f4d53573a204e6f7420656e6f7567682076616c6964207369676e61747572657381525060200191505060405180910390fd5b50505050505050505050505050565b600080600083604102602001850151915083604102604001850151905060ff84604102604101860151169250601b8360ff16148061126f5750601c8360ff16145b15156112e3576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252600e8152602001807f4d53573a20496e76616c6964207600000000000000000000000000000000000081525060200191505060405180910390fd5b92509250925600a165627a7a723058209488e018355c99588cf58aedde8b17fa1f0193d85d1805d5730a59e5b88b1c2e00290000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000030000000000000000000000001c385bbb6bd2edb66fb5b752532b3e9ef705d25d00000000000000000000000036b300079b70822dfcd73911fc7d932f45cfb9160000000000000000000000004a804ddb1a75de64d0101d8c53f75cdcf654ff24",
  "constructorArguments": "0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000030000000000000000000000001c385bbb6bd2edb66fb5b752532b3e9ef705d25d00000000000000000000000036b300079b70822dfcd73911fc7d932f45cfb9160000000000000000000000004a804ddb1a75de64d0101d8c53f75cdcf654ff24"
}