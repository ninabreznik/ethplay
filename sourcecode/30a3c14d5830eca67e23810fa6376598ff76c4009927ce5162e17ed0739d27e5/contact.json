{
  "address": "0xccd7ce9ec004bfbd5711245f917d6109813a909c",
  "chain": "ETH",
  "chainID": 1,
  "verifier": "etherscan.io",
  "commonName": "",
  "contractName": "WeiDex",
  "compilerVersion": "v0.4.24+commit.e67f0147",
  "optimization": true,
  "runs": "200",
  "evmVersion": "default",
  "sourceCode": "/**\n *Submitted for verification at Etherscan.io on 2018-10-01\n*/\n\npragma solidity 0.4.24;\n\n/**\n * @title Ownable\n * @dev The Ownable contract has an owner address, and provides basic authorization control\n * functions, this simplifies the implementation of \"user permissions\".\n */\ncontract Ownable {\n\n    address public owner;\n\n    event OwnershipTransferred(address indexed previousOwner, address indexed newOwner);\n\n    /**\n     * @dev The Ownable constructor sets the original `owner` of the contract to the sender\n     * account.\n     */\n    constructor()\n        public\n    {\n        owner = msg.sender;\n    }\n\n    /**\n     * @dev Throws if called by any account other than the owner.\n     */\n    modifier onlyOwner()\n    {\n        require(\n            msg.sender == owner,\n            \"Only the owner of that contract can execute this method\"\n        );\n        _;\n    }\n\n    /**\n     * @dev Allows the current owner to transfer control of the contract to a newOwner.\n     * @param newOwner The address to transfer ownership to.\n     */\n    function transferOwnership(address newOwner)\n        public\n        onlyOwner\n    {\n        require(\n            newOwner != address(0x0),\n            \"Invalid address\"\n        );\n\n        emit OwnershipTransferred(owner, newOwner);\n        owner = newOwner;\n    }\n\n}\n// Inspired by https://github.com/AdExNetwork/adex-protocol-eth/blob/master/contracts/libs/SafeERC20.sol\n// The old ERC20 token standard defines transfer and transferFrom without return value.\n// So the current ERC20 token standard is incompatible with this one.\ninterface IOldERC20 {\n\tfunction transfer(address to, uint256 value)\n        external;\n\n\tfunction transferFrom(address from, address to, uint256 value)\n        external;\n\n\tfunction approve(address spender, uint256 value)\n        external;\n\n    event Transfer(\n        address indexed from,\n        address indexed to,\n        uint256 value\n    );\n\n    event Approval(\n        address indexed owner,\n        address indexed spender,\n        uint256 value\n    );\n}\n\nlibrary SafeOldERC20 {\n\t// definitely not a pure fn but the compiler complains otherwise\n    function checkSuccess()\n        private\n        pure\n\t\treturns (bool)\n\t{\n        uint256 returnValue = 0;\n\n        assembly {\n\t\t\t// check number of bytes returned from last function call\n\t\t\tswitch returndatasize\n\n\t\t\t// no bytes returned: assume success\n\t\t\tcase 0x0 {\n\t\t\t\treturnValue := 1\n\t\t\t}\n\n\t\t\t// 32 bytes returned: check if non-zero\n\t\t\tcase 0x20 {\n\t\t\t\t// copy 32 bytes into scratch space\n\t\t\t\treturndatacopy(0x0, 0x0, 0x20)\n\n\t\t\t\t// load those bytes into returnValue\n\t\t\t\treturnValue := mload(0x0)\n\t\t\t}\n\n\t\t\t// not sure what was returned: don't mark as success\n\t\t\tdefault { }\n        }\n\n        return returnValue != 0;\n    }\n\n    function transfer(address token, address to, uint256 amount) internal {\n        IOldERC20(token).transfer(to, amount);\n        require(checkSuccess(), \"Transfer failed\");\n    }\n\n    function transferFrom(address token, address from, address to, uint256 amount) internal {\n        IOldERC20(token).transferFrom(from, to, amount);\n        require(checkSuccess(), \"Transfer From failed\");\n    }\n}\n\nlibrary CrowdsaleLib {\n\n    struct Crowdsale {\n        uint256 startTime;\n        uint256 endTime;\n        uint256 capacity;\n        uint256 leftAmount;\n        uint256 tokenRatio;\n        uint256 minContribution;\n        uint256 maxContribution;\n        uint256 weiRaised;\n        address wallet;\n    }\n\n    function isValid(Crowdsale storage _self)\n        internal\n        view\n        returns (bool)\n    {\n        return (\n            (_self.startTime >= now) &&\n            (_self.endTime >= _self.startTime) &&\n            (_self.tokenRatio > 0) &&\n            (_self.wallet != address(0))\n        );\n    }\n\n    function isOpened(Crowdsale storage _self)\n        internal\n        view\n        returns (bool)\n    {\n        return (now >= _self.startTime && now <= _self.endTime);\n    }\n\n    function createCrowdsale(\n        address _wallet,\n        uint256[8] _values\n    )\n        internal\n        pure\n        returns (Crowdsale memory)\n    {\n        return Crowdsale({\n            startTime: _values[0],\n            endTime: _values[1],\n            capacity: _values[2],\n            leftAmount: _values[3],\n            tokenRatio: _values[4],\n            minContribution: _values[5],\n            maxContribution: _values[6],\n            weiRaised: _values[7],\n            wallet: _wallet\n        });\n    }\n}\n\ncontract IUpgradableExchange {\n\n    uint8 public VERSION;\n\n    event FundsMigrated(address indexed user, address indexed exchangeAddress);\n\n    function allowOrRestrictMigrations() external;\n\n    function migrateFunds(address[] _tokens) external;\n\n    function migrateEthers() private;\n\n    function migrateTokens(address[] _tokens) private;\n\n    function importEthers(address _user) external payable;\n\n    function importTokens(address _tokenAddress, uint256 _tokenAmount, address _user) external;\n\n}\n\n/**\n * @title ERC20 interface\n * @dev see https://github.com/ethereum/EIPs/issues/20\n */\ninterface IERC20 {\n    function totalSupply() external view returns (uint256);\n\n    function balanceOf(address who) external view returns (uint256);\n\n    function allowance(address owner, address spender)\n        external view returns (uint256);\n\n    function transfer(address to, uint256 value) external returns (bool);\n\n    function approve(address spender, uint256 value)\n        external returns (bool);\n\n    function transferFrom(address from, address to, uint256 value)\n        external returns (bool);\n\n    event Transfer(\n        address indexed from,\n        address indexed to,\n        uint256 value\n    );\n\n    event Approval(\n        address indexed owner,\n        address indexed spender,\n        uint256 value\n    );\n}\n\nlibrary OrderLib {\n\n    struct Order {\n        uint256 makerSellAmount;\n        uint256 makerBuyAmount;\n        uint256 nonce;\n        address maker;\n        address makerSellToken;\n        address makerBuyToken;\n    }\n\n    /**\n    * @dev Hashes the order.\n    * @param order Order to be hashed.\n    * @return hash result\n    */\n    function createHash(Order memory order)\n        internal\n        view\n        returns (bytes32)\n    {\n        return keccak256(\n            abi.encodePacked(\n                order.maker,\n                order.makerSellToken,\n                order.makerSellAmount,\n                order.makerBuyToken,\n                order.makerBuyAmount,\n                order.nonce,\n                this\n            )\n        );\n    }\n\n    /**\n    * @dev Creates order struct from value arrays.\n    * @param addresses Array of trade's maker, makerToken and takerToken.\n    * @param values Array of trade's makerTokenAmount, takerTokenAmount, expires and nonce.\n    * @return Order struct\n    */\n    function createOrder(\n        address[3] addresses,\n        uint256[3] values\n    )\n        internal\n        pure\n        returns (Order memory)\n    {\n        return Order({\n            maker: addresses[0],\n            makerSellToken: addresses[1],\n            makerSellAmount: values[0],\n            makerBuyToken: addresses[2],\n            makerBuyAmount: values[1],\n            nonce: values[2]\n        });\n    }\n\n}\n\n/**\n * @title Math\n * @dev Math operations with safety checks that throw on error\n */\nlibrary Math {\n\n    /**\n     * @dev Multiplies two numbers, throws on overflow.\n     */\n    function mul(uint256 a, uint256 b)\n        internal\n        pure\n        returns(uint256 c)\n    {\n        if (a == 0) {\n            return 0;\n        }\n        c = a * b;\n        assert(c / a == b);\n        return c;\n    }\n\n    /**\n     * @dev Integer division of two numbers, truncating the quotient.\n     */\n    function div(uint256 a, uint256 b)\n        internal\n        pure\n        returns(uint256)\n    {\n        return a / b;\n    }\n\n    /**\n     * @dev Subtracts two numbers, throws on overflow (i.e. if subtrahend is greater than minuend).\n     */\n    function sub(uint256 a, uint256 b)\n        internal\n        pure\n        returns(uint256)\n    {\n        assert(b <= a);\n        return a - b;\n    }\n\n    /**\n     * @dev Adds two numbers, throws on overflow.\n     */\n    function add(uint256 a, uint256 b)\n        internal\n        pure\n        returns(uint256 c)\n    {\n        c = a + b;\n        assert(c >= a);\n        return c;\n    }\n\n    /**\n    * @dev Calculate the ration between two assets. For example ETH/WDX\n    * @param _numerator uint256 base currency\n    * @param _denominator uint256 quote currency\n    */\n    function calculateRate(\n        uint256 _numerator,\n        uint256 _denominator\n    )\n        internal\n        pure\n        returns(uint256)\n    {\n        return div(mul(_numerator, 1e18), _denominator);\n    }\n\n    /**\n    * @dev Calculate the fee in WDX\n    * @param _fee uint256 full fee\n    * @param _referralFeeRate uint256 referral fee rate\n    */\n    function calculateReferralFee(uint256 _fee, uint256 _referralFeeRate) internal pure returns (uint256) {\n        return div(_fee, _referralFeeRate);\n    }\n\n    /**\n    * @dev Calculate the fee in WDX\n    * @param _etherAmount uint256 amount in Ethers\n    * @param _tokenRatio uint256 the rate between ETH/WDX\n    * @param _feeRate uint256 the fee rate\n    */\n    function calculateWdxFee(uint256 _etherAmount, uint256 _tokenRatio, uint256 _feeRate) internal pure returns (uint256) {\n        return div(div(mul(_etherAmount, 1e18), _tokenRatio), mul(_feeRate, 2));\n    }\n}\n\n/**\n * @title Token contract\n * @dev extending ERC20 to support ExchangeOffering functionality.\n */\ncontract Token is IERC20 {\n    function getBonusFactor(uint256 _startTime, uint256 _endTime, uint256 _weiAmount)\n        public view returns (uint256);\n\n    function isUserWhitelisted(address _user)\n        public view returns (bool);\n}\n\ncontract Exchange is Ownable {\n\n    using Math for uint256;\n\n    using OrderLib for OrderLib.Order;\n\n    uint256 public feeRate;\n\n    mapping(address => mapping(address => uint256)) public balances;\n\n    mapping(bytes32 => uint256) public filledAmounts;\n\n    address constant public ETH = address(0x0);\n\n    address public feeAccount;\n\n    constructor(\n        address _feeAccount,\n        uint256 _feeRate\n    )\n        public\n    {\n        feeAccount = _feeAccount;\n        feeRate = _feeRate;\n    }\n\n    enum ErrorCode {\n        INSUFFICIENT_MAKER_BALANCE,\n        INSUFFICIENT_TAKER_BALANCE,\n        INSUFFICIENT_ORDER_AMOUNT\n    }\n\n    event Deposit(\n        address indexed tokenAddress,\n        address indexed user,\n        uint256 amount,\n        uint256 balance\n    );\n\n    event Withdraw(\n        address indexed tokenAddress,\n        address indexed user,\n        uint256 amount,\n        uint256 balance\n    );\n\n    event CancelOrder(\n        address indexed makerBuyToken,\n        address indexed makerSellToken,\n        address indexed maker,\n        bytes32 orderHash,\n        uint256 nonce\n    );\n\n    event TakeOrder(\n        address indexed maker,\n        address taker,\n        address indexed makerBuyToken,\n        address indexed makerSellToken,\n        uint256 takerGivenAmount,\n        uint256 takerReceivedAmount,\n        bytes32 orderHash,\n        uint256 nonce\n    );\n\n    event Error(\n        uint8 eventId,\n        bytes32 orderHash\n    );\n\n    /**\n    * @dev Owner can set the exchange fee\n    * @param _feeRate uint256 new fee rate\n    */\n    function setFee(uint256 _feeRate)\n        external\n        onlyOwner\n    {\n        feeRate = _feeRate;\n    }\n\n    /**\n    * @dev Owner can set the new fee account\n    * @param _feeAccount address\n    */\n    function setFeeAccount(address _feeAccount)\n        external\n        onlyOwner\n    {\n        feeAccount = _feeAccount;\n    }\n\n    /**\n    * @dev Allows user to deposit Ethers in the exchange contract.\n    * Only the respected user can withdraw these Ethers.\n    */\n    function depositEthers() external payable\n    {\n        address user = msg.sender;\n        _depositEthers(user);\n        emit Deposit(ETH, user, msg.value, balances[ETH][user]);\n    }\n\n    /**\n    * @dev Allows user to deposit Ethers for beneficiary in the exchange contract.\n    * @param _beneficiary address\n    * Only the beneficiary can withdraw these Ethers.\n    */\n    function depositEthersFor(\n        address\n        _beneficiary\n    )\n        external\n        payable\n    {\n        _depositEthers(_beneficiary);\n        emit Deposit(ETH, _beneficiary, msg.value, balances[ETH][_beneficiary]);\n    }\n\n    /**\n    * @dev Allows user to deposit Tokens in the exchange contract.\n    * Only the respected user can withdraw these tokens.\n    * @param _tokenAddress address representing the token contract address.\n    * @param _amount uint256 representing the token amount to be deposited.\n    */\n    function depositTokens(\n        address _tokenAddress,\n        uint256 _amount\n    )\n        external\n    {\n        address user = msg.sender;\n        _depositTokens(_tokenAddress, _amount, user);\n        emit Deposit(_tokenAddress, user, _amount, balances[_tokenAddress][user]);\n    }\n\n        /**\n    * @dev Allows user to deposit Tokens for beneficiary in the exchange contract.\n    * Only the beneficiary can withdraw these tokens.\n    * @param _tokenAddress address representing the token contract address.\n    * @param _amount uint256 representing the token amount to be deposited.\n    * @param _beneficiary address representing the token amount to be deposited.\n    */\n    function depositTokensFor(\n        address _tokenAddress,\n        uint256 _amount,\n        address _beneficiary\n    )\n        external\n    {\n        _depositTokens(_tokenAddress, _amount, _beneficiary);\n        emit Deposit(_tokenAddress, _beneficiary, _amount, balances[_tokenAddress][_beneficiary]);\n    }\n\n    /**\n    * @dev Internal version of deposit Ethers.\n    */\n    function _depositEthers(\n        address\n        _beneficiary\n    )\n        internal\n    {\n        balances[ETH][_beneficiary] = balances[ETH][_beneficiary].add(msg.value);\n    }\n\n    /**\n    * @dev Internal version of deposit Tokens.\n    */\n    function _depositTokens(\n        address _tokenAddress,\n        uint256 _amount,\n        address _beneficiary\n    )\n        internal\n    {\n        balances[_tokenAddress][_beneficiary] = balances[_tokenAddress][_beneficiary].add(_amount);\n\n        require(\n            Token(_tokenAddress).transferFrom(msg.sender, this, _amount),\n            \"Token transfer is not successfull (maybe you haven't used approve first?)\"\n        );\n    }\n\n    /**\n    * @dev Allows user to withdraw Ethers from the exchange contract.\n    * Throws if the user balance is lower than the requested amount.\n    * @param _amount uint256 representing the amount to be withdrawn.\n    */\n    function withdrawEthers(uint256 _amount) external\n    {\n        address user = msg.sender;\n\n        require(\n            balances[ETH][user] >= _amount,\n            \"Not enough funds to withdraw.\"\n        );\n\n        balances[ETH][user] = balances[ETH][user].sub(_amount);\n\n        user.transfer(_amount);\n\n        emit Withdraw(ETH, user, _amount, balances[ETH][user]);\n    }\n\n    /**\n    * @dev Allows user to withdraw specific Token from the exchange contract.\n    * Throws if the user balance is lower than the requested amount.\n    * @param _tokenAddress address representing the token contract address.\n    * @param _amount uint256 representing the amount to be withdrawn.\n    */\n    function withdrawTokens(\n        address _tokenAddress,\n        uint256 _amount\n    )\n        external\n    {\n        address user = msg.sender;\n\n        require(\n            balances[_tokenAddress][user] >= _amount,\n            \"Not enough funds to withdraw.\"\n        );\n\n        balances[_tokenAddress][user] = balances[_tokenAddress][user].sub(_amount);\n\n        require(\n            Token(_tokenAddress).transfer(user, _amount),\n            \"Token transfer is not successfull.\"\n        );\n\n        emit Withdraw(_tokenAddress, user, _amount, balances[_tokenAddress][user]);\n    }\n\n    /**\n    * @dev Allows user to transfer specific Token inside the exchange.\n    * @param _tokenAddress address representing the token address.\n    * @param _to address representing the beneficier.\n    * @param _amount uint256 representing the amount to be transferred.\n    */\n    function transfer(\n        address _tokenAddress,\n        address _to,\n        uint256 _amount\n    )\n        external\n    {\n        address user = msg.sender;\n\n        require(\n            balances[_tokenAddress][user] >= _amount,\n            \"Not enough funds to transfer.\"\n        );\n\n        balances[_tokenAddress][user] = balances[_tokenAddress][user].sub(_amount);\n\n        balances[_tokenAddress][_to] = balances[_tokenAddress][_to].add(_amount);\n    }\n\n    /**\n    * @dev Common take order implementation\n    * @param _order OrderLib.Order memory - order info\n    * @param _takerSellAmount uint256 - amount being given by the taker\n    * @param _v uint8 part of the signature\n    * @param _r bytes32 part of the signature (from 0 to 32 bytes)\n    * @param _s bytes32 part of the signature (from 32 to 64 bytes)\n    */\n    function takeOrder(\n        OrderLib.Order memory _order,\n        uint256 _takerSellAmount,\n        uint8 _v,\n        bytes32 _r,\n        bytes32 _s\n    )\n        internal\n        returns (uint256)\n    {\n        bytes32 orderHash = _order.createHash();\n\n        require(\n            ecrecover(keccak256(abi.encodePacked(\"\\x19Ethereum Signed Message:\\n32\", orderHash)), _v, _r, _s) == _order.maker,\n            \"Order maker is invalid.\"\n        );\n\n        if(balances[_order.makerBuyToken][msg.sender] < _takerSellAmount) {\n            emit Error(uint8(ErrorCode.INSUFFICIENT_TAKER_BALANCE), orderHash);\n            return 0;\n        }\n\n        uint256 receivedAmount = (_order.makerSellAmount.mul(_takerSellAmount)).div(_order.makerBuyAmount);\n\n        if(balances[_order.makerSellToken][_order.maker] < receivedAmount) {\n            emit Error(uint8(ErrorCode.INSUFFICIENT_MAKER_BALANCE), orderHash);\n            return 0;\n        }\n\n        if(filledAmounts[orderHash].add(_takerSellAmount) > _order.makerBuyAmount) {\n            emit Error(uint8(ErrorCode.INSUFFICIENT_ORDER_AMOUNT), orderHash);\n            return 0;\n        }\n\n        filledAmounts[orderHash] = filledAmounts[orderHash].add(_takerSellAmount);\n\n        balances[_order.makerBuyToken][msg.sender] = balances[_order.makerBuyToken][msg.sender].sub(_takerSellAmount);\n        balances[_order.makerBuyToken][_order.maker] = balances[_order.makerBuyToken][_order.maker].add(_takerSellAmount);\n\n        balances[_order.makerSellToken][msg.sender] = balances[_order.makerSellToken][msg.sender].add(receivedAmount);\n        balances[_order.makerSellToken][_order.maker] = balances[_order.makerSellToken][_order.maker].sub(receivedAmount);\n\n        emit TakeOrder(\n            _order.maker,\n            msg.sender,\n            _order.makerBuyToken,\n            _order.makerSellToken,\n            _takerSellAmount,\n            receivedAmount,\n            orderHash,\n            _order.nonce\n        );\n\n        return receivedAmount;\n    }\n\n    /**\n    * @dev Order maker can call this function in order to cancel it.\n    * What actually happens is that the order become\n    * fulfilled in the \"filledAmounts\" mapping. Thus we avoid someone calling\n    * \"takeOrder\" directly from the contract if the order hash is available to him.\n    * @param _orderAddresses address[3]\n    * @param _orderValues uint256[3]\n    * @param _v uint8 parameter parsed from the signature recovery\n    * @param _r bytes32 parameter parsed from the signature (from 0 to 32 bytes)\n    * @param _s bytes32 parameter parsed from the signature (from 32 to 64 bytes)\n    */\n    function cancelOrder(\n        address[3] _orderAddresses,\n        uint256[3] _orderValues,\n        uint8 _v,\n        bytes32 _r,\n        bytes32 _s\n    )\n        public\n    {\n        OrderLib.Order memory order = OrderLib.createOrder(_orderAddresses, _orderValues);\n        bytes32 orderHash = order.createHash();\n\n        require(\n            ecrecover(keccak256(abi.encodePacked(\"\\x19Ethereum Signed Message:\\n32\", orderHash)), _v, _r, _s) == msg.sender,\n            \"Only order maker can cancel it.\"\n        );\n\n        filledAmounts[orderHash] = filledAmounts[orderHash].add(order.makerBuyAmount);\n\n        emit CancelOrder(\n            order.makerBuyToken,\n            order.makerSellToken,\n            msg.sender,\n            orderHash,\n            order.nonce\n        );\n    }\n\n    /**\n    * @dev Cancel multiple orders in a single transaction.\n    * @param _orderAddresses address[3][]\n    * @param _orderValues uint256[3][]\n    * @param _v uint8[] parameter parsed from the signature recovery\n    * @param _r bytes32[] parameter parsed from the signature (from 0 to 32 bytes)\n    * @param _s bytes32[] parameter parsed from the signature (from 32 to 64 bytes)\n    */\n    function cancelMultipleOrders(\n        address[3][] _orderAddresses,\n        uint256[3][] _orderValues,\n        uint8[] _v,\n        bytes32[] _r,\n        bytes32[] _s\n    )\n        external\n    {\n        for (uint256 index = 0; index < _orderAddresses.length; index++) {\n            cancelOrder(\n                _orderAddresses[index],\n                _orderValues[index],\n                _v[index],\n                _r[index],\n                _s[index]\n            );\n        }\n    }\n}\n\ncontract DailyVolumeUpdater is Ownable {\n\n    using Math for uint256;\n\n    uint256 public dailyVolume;\n\n    uint256 public dailyVolumeCap;\n\n    uint256 private lastDay;\n\n    constructor()\n        public\n    {\n        dailyVolume = 0;\n        dailyVolumeCap = 1000 ether;\n        lastDay = today();\n    }\n\n    /**\n    * @dev Allows the owner to change the daily volume capacity.\n    * @param _dailyVolumeCap uint256 representing the daily volume capacity\n    */\n    function setDailyVolumeCap(uint256 _dailyVolumeCap)\n        public\n        onlyOwner\n    {\n        dailyVolumeCap = _dailyVolumeCap;\n    }\n\n    /**\n    * @dev Internal function that increments the daily volume.\n    * @param _volume uint256 representing the amount of volume increasement.\n    */\n    function updateVolume(uint256 _volume)\n        internal\n    {\n        if(today() > lastDay) {\n            dailyVolume = _volume;\n            lastDay = today();\n        } else {\n            dailyVolume = dailyVolume.add(_volume);\n        }\n    }\n\n    /**\n    * @dev Internal function to check if the volume capacity is reached.\n    * @return Whether the volume is reached or not.\n    */\n    function isVolumeReached()\n        internal\n        view\n        returns(bool)\n    {\n        return dailyVolume >= dailyVolumeCap;\n    }\n\n    /**\n    * @dev Private function to determine today's index\n    * @return uint256 of today's index.\n    */\n    function today()\n        private\n        view\n        returns(uint256)\n    {\n        return block.timestamp.div(1 days);\n    }\n}\n\ncontract DiscountTokenExchange is Exchange, DailyVolumeUpdater {\n\n    uint256 internal discountTokenRatio;\n\n    uint256 private minimumTokenAmountForUpdate;\n\n    address public discountTokenAddress;\n\n    bool internal initialized = false;\n\n    constructor(\n        address _discountTokenAddress,\n        uint256 _discountTokenRatio\n    )\n        public\n    {\n        discountTokenAddress = _discountTokenAddress;\n        discountTokenRatio = _discountTokenRatio;\n    }\n\n    modifier onlyOnce() {\n        require(\n            initialized == false,\n            \"Exchange is already initialized\"\n        );\n        _;\n    }\n\n    /**\n    * @dev Update the token discount contract.\n    * @param _discountTokenAddress address of the token used for fee discount\n    * @param _discountTokenRatio uint256 initial rate of the token discount contract\n    */\n    function setDiscountToken(\n        address _discountTokenAddress,\n        uint256 _discountTokenRatio,\n        uint256 _minimumTokenAmountForUpdate\n    )\n        public\n        onlyOwner\n        onlyOnce\n    {\n        discountTokenAddress = _discountTokenAddress;\n        discountTokenRatio = _discountTokenRatio;\n        minimumTokenAmountForUpdate = _minimumTokenAmountForUpdate;\n        initialized = true;\n    }\n\n    /**\n    * @dev Update the token ratio.\n    * Add a minimum requirement for the amount of tokens being traded\n    * to avoid possible intentional manipulation\n    * @param _etherAmount uint256 amount in Ethers (wei)\n    * @param _tokenAmount uint256 amount in Tokens\n    */\n    function updateTokenRatio(\n        uint256 _etherAmount,\n        uint256 _tokenAmount\n    )\n        internal\n    {\n        if(_tokenAmount >= minimumTokenAmountForUpdate) {\n            discountTokenRatio = _etherAmount.calculateRate(_tokenAmount);\n        }\n    }\n\n    /**\n    * @dev Set the minimum requirement for updating the price.\n    * This should be called whenever the rate of the token\n    * has changed massively.\n    * In order to avoid token price manipulation (that will reduce the fee)\n    * The minimum amount requirement take place.\n    * For example: Someone buys or sells 0.0000000001 Tokens with\n    * high rate against ETH and after that execute a trade,\n    * reducing his fees to approximately zero.\n    * Having the mimimum amount requirement for updating\n    * the price will protect us from such cases because\n    * it will not be worth to do it.\n    * @param _minimumTokenAmountForUpdate - the new mimimum amount of\n    * tokens for updating the ratio (price)\n    */\n    function setMinimumTokenAmountForUpdate(\n        uint256 _minimumTokenAmountForUpdate\n    )\n        external\n        onlyOwner\n    {\n        minimumTokenAmountForUpdate = _minimumTokenAmountForUpdate;\n    }\n\n    /**\n    * @dev Execute WeiDexToken Sale Order based on the order input parameters\n    * and the signature from the maker's signing.\n    * @param _orderAddresses address[3] representing\n    * [0] address of the order maker\n    * [1] address of WeiDexToken\n    * [2] address of Ether (0x0)\n    * @param _orderValues uint256[4] representing\n    * [0] amount in WDX\n    * [1] amount in Ethers (wei)\n    * [2] order nonce used for hash uniqueness\n    * @param _takerSellAmount uint256 - amount being asked from the taker, should be in ethers\n    * @param _v uint8 parameter parsed from the signature recovery\n    * @param _r bytes32 parameter parsed from the signature (from 0 to 32 bytes)\n    * @param _s bytes32 parameter parsed from the signature (from 32 to 64 bytes)\n    */\n    function takeSellTokenOrder(\n        address[3] _orderAddresses,\n        uint256[3] _orderValues,\n        uint256 _takerSellAmount,\n        uint8 _v,\n        bytes32 _r,\n        bytes32 _s\n    )\n        external\n    {\n        require(\n            _orderAddresses[1] == discountTokenAddress,\n            \"Should sell WeiDex Tokens\"\n        );\n\n        require(\n            0 < takeOrder(OrderLib.createOrder(_orderAddresses, _orderValues), _takerSellAmount, _v, _r, _s),\n            \"Trade failure\"\n        );\n        updateVolume(_takerSellAmount);\n        updateTokenRatio(_orderValues[1], _orderValues[0]);\n    }\n\n    /**\n    * @dev Execute WeiDexToken Buy Order based on the order input parameters\n    * and the signature from the maker's signing.\n    * @param _orderAddresses address[3] representing\n    * [0] address of the order maker\n    * [1] address of Ether (0x0)\n    * [2] address of WeiDexToken\n    * @param _orderValues uint256[4] representing\n    * [0] amount in Ethers\n    * [1] amount in WDX\n    * [2] order nonce used for hash uniqueness\n    * @param _takerSellAmount uint256 - amount being asked from the taker\n    * @param _v uint8 parameter parsed from the signature recovery\n    * @param _r bytes32 parameter parsed from the signature (from 0 to 32 bytes)\n    * @param _s bytes32 parameter parsed from the signature (from 32 to 64 bytes)\n    */\n    function takeBuyTokenOrder(\n        address[3] _orderAddresses,\n        uint256[3] _orderValues,\n        uint256 _takerSellAmount,\n        uint8 _v,\n        bytes32 _r,\n        bytes32 _s\n    )\n        external\n    {\n        require(\n            _orderAddresses[2] == discountTokenAddress,\n            \"Should buy WeiDex Tokens\"\n        );\n\n        uint256 receivedAmount = takeOrder(OrderLib.createOrder(_orderAddresses, _orderValues), _takerSellAmount, _v, _r, _s);\n        require(0 < receivedAmount, \"Trade failure\");\n        updateVolume(receivedAmount);\n        updateTokenRatio(_orderValues[0], _orderValues[1]);\n    }\n}\n\ncontract ReferralExchange is Exchange {\n\n    uint256 public referralFeeRate;\n\n    mapping(address => address) public referrals;\n\n    constructor(\n        uint256 _referralFeeRate\n    )\n        public\n    {\n        referralFeeRate = _referralFeeRate;\n    }\n\n    event ReferralBalanceUpdated(\n        address refererAddress,\n        address referralAddress,\n        address tokenAddress,\n        uint256 feeAmount,\n        uint256 referralFeeAmount\n    );\n\n    event ReferralDeposit(\n        address token,\n        address indexed user,\n        address indexed referrer,\n        uint256 amount,\n        uint256 balance\n    );\n\n    /**\n    * @dev Deposit Ethers with a given referrer address\n    * @param _referrer address of the referrer\n    */\n    function depositEthers(address _referrer)\n        external\n        payable\n    {\n        address user = msg.sender;\n\n        require(\n            0x0 == referrals[user],\n            \"This user already have a referrer.\"\n        );\n\n        super._depositEthers(user);\n        referrals[user] = _referrer;\n        emit ReferralDeposit(ETH, user, _referrer, msg.value, balances[ETH][user]);\n    }\n\n    /**\n    * @dev Deposit Tokens with a given referrer address\n    * @param _referrer address of the referrer\n    */\n    function depositTokens(\n        address _tokenAddress,\n        uint256 _amount,\n        address _referrer\n    )\n        external\n    {\n        address user = msg.sender;\n\n        require(\n            0x0 == referrals[user],\n            \"This user already have a referrer.\"\n        );\n\n        super._depositTokens(_tokenAddress, _amount, user);\n        referrals[user] = _referrer;\n        emit ReferralDeposit(_tokenAddress, user, _referrer, _amount, balances[_tokenAddress][user]);\n    }\n\n    /**\n    * @dev Update the referral fee rate,\n    * i.e. the rate of the fee that will be accounted to the referrer\n    * @param _referralFeeRate uint256 amount of fee going to the referrer\n    */\n    function setReferralFee(uint256 _referralFeeRate)\n        external\n        onlyOwner\n    {\n        referralFeeRate = _referralFeeRate;\n    }\n\n    /**\n    * @dev Return the feeAccount address if user doesn't have referrer\n    * @param _user address user whom referrer is being checked.\n    * @return address of user's referrer.\n    */\n    function getReferrer(address _user)\n        internal\n        view\n        returns(address referrer)\n    {\n        return referrals[_user] != address(0x0) ? referrals[_user] : feeAccount;\n    }\n}\n\ncontract UpgradableExchange is Exchange {\n\n    uint8 constant public VERSION = 0;\n\n    address public newExchangeAddress;\n\n    bool public isMigrationAllowed;\n\n    event FundsMigrated(address indexed user, address indexed exchangeAddress);\n\n    /**\n    * @dev Owner can set the address of the new version of the exchange contract.\n    * @param _newExchangeAddress address representing the new exchange contract address\n    */\n    function setNewExchangeAddress(address _newExchangeAddress)\n        external\n        onlyOwner\n    {\n        newExchangeAddress = _newExchangeAddress;\n    }\n\n    /**\n    * @dev Enables/Disables the migrations. Can be called only by the owner.\n    */\n    function allowOrRestrictMigrations()\n        external\n        onlyOwner\n    {\n        isMigrationAllowed = !isMigrationAllowed;\n    }\n\n    /**\n    * @dev Set the address of the new version of the exchange contract. Should be called by the user.\n    * @param _tokens address[] representing the token addresses which are going to be migrated.\n    */\n    function migrateFunds(address[] _tokens) external {\n\n        require(\n            false != isMigrationAllowed,\n            \"Fund migration is not allowed\"\n        );\n\n        require(\n            IUpgradableExchange(newExchangeAddress).VERSION() > VERSION,\n            \"New exchange version should be greater than the current version.\"\n        );\n\n        migrateEthers();\n\n        migrateTokens(_tokens);\n\n        emit FundsMigrated(msg.sender, newExchangeAddress);\n    }\n\n    /**\n    * @dev Helper function to migrate user's Ethers. Should be called in migrateFunds() function.\n    */\n    function migrateEthers() private {\n\n        uint256 etherAmount = balances[ETH][msg.sender];\n        if (etherAmount > 0) {\n            balances[ETH][msg.sender] = 0;\n\n            IUpgradableExchange(newExchangeAddress).importEthers.value(etherAmount)(msg.sender);\n        }\n    }\n\n    /**\n    * @dev Helper function to migrate user's tokens. Should be called in migrateFunds() function.\n    * @param _tokens address[] representing the token addresses which are going to be migrated.\n    */\n    function migrateTokens(address[] _tokens) private {\n\n        for (uint256 index = 0; index < _tokens.length; index++) {\n\n            address tokenAddress = _tokens[index];\n\n            uint256 tokenAmount = balances[tokenAddress][msg.sender];\n\n            if (0 == tokenAmount) {\n                continue;\n            }\n\n            require(\n                Token(tokenAddress).approve(newExchangeAddress, tokenAmount),\n                \"Approve failed\"\n            );\n\n            balances[tokenAddress][msg.sender] = 0;\n\n            IUpgradableExchange(newExchangeAddress).importTokens(tokenAddress, tokenAmount, msg.sender);\n        }\n    }\n}\n\ncontract ExchangeOffering is Exchange {\n\n    using CrowdsaleLib for CrowdsaleLib.Crowdsale;\n\n    mapping(address => CrowdsaleLib.Crowdsale) public crowdsales;\n\n    mapping(address => mapping(address => uint256)) public userContributionForProject;\n\n    event TokenPurchase(\n        address indexed project,\n        address indexed contributor,\n        uint256 tokens,\n        uint256 weiAmount\n    );\n\n    function registerCrowdsale(\n        address _project,\n        address _projectWallet,\n        uint256[8] _values\n    )\n        public\n        onlyOwner\n    {\n        crowdsales[_project] = CrowdsaleLib.createCrowdsale(_projectWallet, _values);\n\n        require(\n            crowdsales[_project].isValid(),\n            \"Crowdsale is not active.\"\n        );\n\n        // project contract validation\n        require(\n            getBonusFactor(_project, crowdsales[_project].minContribution) >= 0,\n            \"The project should have *getBonusFactor* function implemented. The function should return the bonus percentage depending on the start/end date and contribution amount. Should return 0 if there is no bonus.\"\n        );\n\n        // project contract validation\n        require(\n            isUserWhitelisted(_project, this),\n            \"The project should have *isUserWhitelisted* function implemented. This contract address should be whitelisted\"\n        );\n    }\n\n    function buyTokens(address _project)\n       public\n       payable\n    {\n        uint256 weiAmount = msg.value;\n\n        address contributor = msg.sender;\n\n        address crowdsaleWallet = crowdsales[_project].wallet;\n\n        require(\n            isUserWhitelisted(_project, contributor), \"User is not whitelisted\"\n        );\n\n        require(\n            validContribution(_project, contributor, weiAmount),\n            \"Contribution is not valid: Check minimum/maximum contribution amount or if crowdsale cap is reached\"\n        );\n\n        uint256 tokens = weiAmount.mul(crowdsales[_project].tokenRatio);\n\n        uint256 bonus = getBonusFactor(_project, weiAmount);\n\n        uint256 bonusAmount = tokens.mul(bonus).div(100);\n\n        uint256 totalPurchasedTokens = tokens.add(bonusAmount);\n\n        crowdsales[_project].leftAmount = crowdsales[_project].leftAmount.sub(totalPurchasedTokens);\n\n        require(Token(_project).transfer(contributor, totalPurchasedTokens), \"Transfer failed\");\n\n        crowdsales[_project].weiRaised = crowdsales[_project].weiRaised.add(weiAmount);\n\n        userContributionForProject[_project][contributor] = userContributionForProject[_project][contributor].add(weiAmount);\n\n        balances[ETH][crowdsaleWallet] = balances[ETH][crowdsaleWallet].add(weiAmount);\n\n        emit TokenPurchase(_project, contributor, totalPurchasedTokens, weiAmount);\n    }\n\n    function withdrawWhenFinished(address _project) public {\n\n        address crowdsaleWallet = crowdsales[_project].wallet;\n\n        require(\n            msg.sender == crowdsaleWallet,\n            \"Only crowdsale owner can withdraw funds that are left.\"\n        );\n\n        require(\n            !crowdsales[_project].isOpened(),\n            \"You can't withdraw funds yet. Crowdsale should end first.\"\n        );\n\n        uint256 leftAmount = crowdsales[_project].leftAmount;\n\n        crowdsales[_project].leftAmount = 0;\n\n        require(Token(_project).transfer(crowdsaleWallet, leftAmount), \"Transfer failed\");\n    }\n\n    function saleOpen(address _project)\n        public\n        view\n        returns(bool)\n    {\n        return crowdsales[_project].isOpened();\n    }\n\n    function getBonusFactor(address _project, uint256 _weiAmount)\n        public\n        view\n        returns(uint256)\n    {\n        return Token(_project).getBonusFactor(crowdsales[_project].startTime, crowdsales[_project].endTime, _weiAmount);\n    }\n\n    function isUserWhitelisted(address _project, address _user)\n        public\n        view\n        returns(bool)\n    {\n        return Token(_project).isUserWhitelisted(_user);\n    }\n\n    function validContribution(\n        address _project,\n        address _user,\n        uint256 _weiAmount\n    )\n        private\n        view\n        returns(bool)\n    {\n        if (saleOpen(_project)) {\n            // minimum contribution check\n            if (_weiAmount < crowdsales[_project].minContribution) {\n                return false;\n            }\n\n            // maximum contribution check\n            if (userContributionForProject[_project][_user].add(_weiAmount) > crowdsales[_project].maxContribution) {\n                return false;\n            }\n\n            // token sale capacity check\n            if (crowdsales[_project].capacity < crowdsales[_project].weiRaised.add(_weiAmount)) {\n                return false;\n            }\n        } else {\n            return false;\n        }\n\n        return msg.value != 0; // check for non zero contribution\n    }\n}\n\ncontract OldERC20ExchangeSupport is Exchange, ReferralExchange {\n\n    /**\n    * @dev Allows user to deposit Tokens in the exchange contract.\n    * Only the respected user can withdraw these tokens.\n    * @param _tokenAddress address representing the token contract address.\n    * @param _amount uint256 representing the token amount to be deposited.\n    */\n    function depositOldTokens(\n        address _tokenAddress,\n        uint256 _amount\n    )\n        external\n    {\n        address user = msg.sender;\n        _depositOldTokens(_tokenAddress, _amount, user);\n        emit Deposit(_tokenAddress, user, _amount, balances[_tokenAddress][user]);\n    }\n\n    /**\n    * @dev Deposit Tokens with a given referrer address\n    * @param _referrer address of the referrer\n    */\n    function depositOldTokens(\n        address _tokenAddress,\n        uint256 _amount,\n        address _referrer\n    )\n        external\n    {\n        address user = msg.sender;\n\n        require(\n            0x0 == referrals[user],\n            \"This user already have a referrer.\"\n        );\n\n        _depositOldTokens(_tokenAddress, _amount, user);\n        referrals[user] = _referrer;\n        emit ReferralDeposit(_tokenAddress, user, _referrer, _amount, balances[_tokenAddress][user]);\n    }\n\n        /**\n    * @dev Allows user to deposit Tokens for beneficiary in the exchange contract.\n    * Only the beneficiary can withdraw these tokens.\n    * @param _tokenAddress address representing the token contract address.\n    * @param _amount uint256 representing the token amount to be deposited.\n    * @param _beneficiary address representing the token amount to be deposited.\n    */\n    function depositOldTokensFor(\n        address _tokenAddress,\n        uint256 _amount,\n        address _beneficiary\n    )\n        external\n    {\n        _depositOldTokens(_tokenAddress, _amount, _beneficiary);\n        emit Deposit(_tokenAddress, _beneficiary, _amount, balances[_tokenAddress][_beneficiary]);\n    }\n\n    /**\n    * @dev Allows user to withdraw specific Token from the exchange contract.\n    * Throws if the user balance is lower than the requested amount.\n    * @param _tokenAddress address representing the token contract address.\n    * @param _amount uint256 representing the amount to be withdrawn.\n    */\n    function withdrawOldTokens(\n        address _tokenAddress,\n        uint256 _amount\n    )\n        external\n    {\n        address user = msg.sender;\n\n        require(\n            balances[_tokenAddress][user] >= _amount,\n            \"Not enough funds to withdraw.\"\n        );\n\n        balances[_tokenAddress][user] = balances[_tokenAddress][user].sub(_amount);\n\n        SafeOldERC20.transfer(_tokenAddress, user, _amount);\n\n        emit Withdraw(_tokenAddress, user, _amount, balances[_tokenAddress][user]);\n    }\n\n    /**\n    * @dev Internal version of deposit Tokens.\n    */\n    function _depositOldTokens(\n        address _tokenAddress,\n        uint256 _amount,\n        address _beneficiary\n    )\n        internal\n    {\n        balances[_tokenAddress][_beneficiary] = balances[_tokenAddress][_beneficiary].add(_amount);\n\n        SafeOldERC20.transferFrom(_tokenAddress, msg.sender, this, _amount);\n    }\n}\n\ncontract WeiDex is DiscountTokenExchange, ReferralExchange, UpgradableExchange, ExchangeOffering, OldERC20ExchangeSupport  {\n\n    mapping(bytes4 => bool) private allowedMethods;\n\n    function () public payable {\n        revert(\"Cannot send Ethers to the contract, use depositEthers\");\n    }\n\n    constructor(\n        address _feeAccount,\n        uint256 _feeRate,\n        uint256 _referralFeeRate,\n        address _discountTokenAddress,\n        uint256 _discountTokenRatio\n    )\n        public\n        Exchange(_feeAccount, _feeRate)\n        ReferralExchange(_referralFeeRate)\n        DiscountTokenExchange(_discountTokenAddress, _discountTokenRatio)\n    {\n        // empty constructor\n    }\n\n    /**\n    * @dev Allows or restricts methods from being executed in takeAllPossible and takeAllOrRevert\n    * @param _methodId bytes4 method id that will be allowed/forbidded from execution\n    * @param _allowed bool\n    */\n    function allowOrRestrictMethod(\n        bytes4 _methodId,\n        bool _allowed\n    )\n        external\n        onlyOwner\n    {\n        allowedMethods[_methodId] = _allowed;\n    }\n\n    /**\n    * @dev Execute multiple order by given method id\n    * @param _orderAddresses address[3][] representing\n    * @param _orderValues uint256[4][] representing\n    * @param _takerSellAmount uint256[] - amounts being asked from the taker, should be in tokens\n    * @param _v uint8[] parameter parsed from the signature recovery\n    * @param _r bytes32[] parameter parsed from the signature (from 0 to 32 bytes)\n    * @param _s bytes32[] parameter parsed from the signature (from 32 to 64 bytes)\n    */\n    function takeAllOrRevert(\n        address[3][] _orderAddresses,\n        uint256[3][] _orderValues,\n        uint256[] _takerSellAmount,\n        uint8[] _v,\n        bytes32[] _r,\n        bytes32[] _s,\n        bytes4 _methodId\n    )\n        external\n    {\n        require(\n            allowedMethods[_methodId],\n            \"Can't call this method\"\n        );\n\n        for (uint256 index = 0; index < _orderAddresses.length; index++) {\n            require(\n                address(this).delegatecall(\n                _methodId,\n                _orderAddresses[index],\n                _orderValues[index],\n                _takerSellAmount[index],\n                _v[index],\n                _r[index],\n                _s[index]\n                ),\n                \"Method call failed\"\n            );\n        }\n    }\n\n    /**\n    * @dev Execute multiple order by given method id\n    * @param _orderAddresses address[3][]\n    * @param _orderValues uint256[4][]\n    * @param _takerSellAmount uint256[] - amounts being asked from the taker, should be in tokens\n    * @param _v uint8[] parameter parsed from the signature recovery\n    * @param _r bytes32[] parameter parsed from the signature (from 0 to 32 bytes)\n    * @param _s bytes32[] parameter parsed from the signature (from 32 to 64 bytes)\n    */\n    function takeAllPossible(\n        address[3][] _orderAddresses,\n        uint256[3][] _orderValues,\n        uint256[] _takerSellAmount,\n        uint8[] _v,\n        bytes32[] _r,\n        bytes32[] _s,\n        bytes4 _methodId\n    )\n        external\n    {\n        require(\n            allowedMethods[_methodId],\n            \"Can't call this method\"\n        );\n\n        for (uint256 index = 0; index < _orderAddresses.length; index++) {\n            address(this).delegatecall(\n            _methodId,\n            _orderAddresses[index],\n            _orderValues[index],\n            _takerSellAmount[index],\n            _v[index],\n            _r[index],\n            _s[index]\n            );\n        }\n    }\n\n    /**\n    * @dev Execute buy order based on the order input parameters\n    * and the signature from the maker's signing\n    * @param _orderAddresses address[3] representing\n    * [0] address of the order maker\n    * [1] address of ether (0x0)\n    * [2] address of token being bought\n    * @param _orderValues uint256[4] representing\n    * [0] amount in Ethers (wei)\n    * [1] amount in tokens\n    * [2] order nonce used for hash uniqueness\n    * @param _takerSellAmount uint256 - amount being asked from the taker, should be in tokens\n    * @param _v uint8 parameter parsed from the signature recovery\n    * @param _r bytes32 parameter parsed from the signature (from 0 to 32 bytes)\n    * @param _s bytes32 parameter parsed from the signature (from 32 to 64 bytes)\n    */\n    function takeBuyOrder(\n        address[3] _orderAddresses,\n        uint256[3] _orderValues,\n        uint256 _takerSellAmount,\n        uint8 _v,\n        bytes32 _r,\n        bytes32 _s\n    )\n        external\n    {\n        require(\n            _orderAddresses[1] == ETH,\n            \"Base currency must be ether's (0x0)\"\n        );\n\n        OrderLib.Order memory order = OrderLib.createOrder(_orderAddresses, _orderValues);\n        uint256 receivedAmount = takeOrder(order, _takerSellAmount, _v, _r, _s);\n\n        require(0 < receivedAmount, \"Trade failure\");\n\n        updateVolume(receivedAmount);\n\n        if (!isVolumeReached()) {\n            takeFee(order.maker, msg.sender, order.makerBuyToken, _takerSellAmount, receivedAmount);\n        }\n    }\n\n    /**\n    * @dev Execute sell order based on the order input parameters\n    * and the signature from the maker's signing\n    * @param _orderAddresses address[3] representing\n    * [0] address of the order maker\n    * [1] address of token being sold\n    * [2] address of ether (0x0)\n    * @param _orderValues uint256[4] representing\n    * [0] amount in tokens\n    * [1] amount in Ethers (wei)\n    * [2] order nonce used for hash uniqueness\n    * @param _takerSellAmount uint256 - amount being asked from the taker, should be in ethers\n    * @param _v uint8 parameter parsed from the signature recovery\n    * @param _r bytes32 parameter parsed from the signature (from 0 to 32 bytes)\n    * @param _s bytes32 parameter parsed from the signature (from 32 to 64 bytes)\n    */\n    function takeSellOrder(\n        address[3] _orderAddresses,\n        uint256[3] _orderValues,\n        uint256 _takerSellAmount,\n        uint8 _v,\n        bytes32 _r,\n        bytes32 _s\n    )\n        public\n    {\n        require(\n            _orderAddresses[2] == ETH,\n            \"Base currency must be ether's (0x0)\"\n        );\n\n        OrderLib.Order memory order = OrderLib.createOrder(_orderAddresses, _orderValues);\n\n        uint256 receivedAmount = takeOrder(order, _takerSellAmount, _v, _r, _s);\n\n        require(0 < receivedAmount, \"Trade failure\");\n\n        updateVolume(_takerSellAmount);\n\n        if (!isVolumeReached()) {\n            takeFee(order.maker, msg.sender, order.makerSellToken, receivedAmount, _takerSellAmount);\n        }\n    }\n\n    /**\n    * @dev Takes fee for making/taking the order\n    * @param _maker address\n    * @param _taker address\n    * @param _tokenAddress address\n    * @param _tokenFulfilledAmount uint256 fulfilled amount in tokens\n    * @param _etherFulfilledAmount uint256 fulfilled amount in ethers\n    */\n    function takeFee(\n        address _maker,\n        address _taker,\n        address _tokenAddress,\n        uint256 _tokenFulfilledAmount,\n        uint256 _etherFulfilledAmount\n    )\n        private\n    {\n        uint256 _feeRate = feeRate; // gas optimization\n        uint256 feeInWdx = _etherFulfilledAmount.calculateWdxFee(discountTokenRatio, feeRate);\n\n        takeFee(_maker, ETH, _etherFulfilledAmount.div(_feeRate), feeInWdx);\n        takeFee(_taker, _tokenAddress, _tokenFulfilledAmount.div(_feeRate), feeInWdx);\n    }\n\n    /**\n    * @dev Takes fee in WDX or the given token address\n    * @param _user address taker or maker\n    * @param _tokenAddress address of the token\n    * @param _tokenFeeAmount uint256 amount in given token address\n    * @param _wdxFeeAmount uint256 amount in WDX tokens\n    */\n    function takeFee(\n        address _user,\n        address _tokenAddress,\n        uint256 _tokenFeeAmount,\n        uint256 _wdxFeeAmount\n        )\n        private\n    {\n        if(balances[discountTokenAddress][_user] >= _wdxFeeAmount) {\n            takeFee(_user, discountTokenAddress, _wdxFeeAmount);\n        } else {\n            takeFee(_user, _tokenAddress, _tokenFeeAmount);\n        }\n    }\n\n    /**\n    * @dev Takes fee in WDX or the given token address\n    * @param _user address taker or maker\n    * @param _tokenAddress address\n    * @param _fullFee uint256 fee taken from a given token address\n    */\n    function takeFee(\n        address _user,\n        address _tokenAddress,\n        uint256 _fullFee\n        )\n        private\n    {\n        address _feeAccount = feeAccount; // gas optimization\n        address referrer = getReferrer(_user);\n        uint256 referralFee = _fullFee.calculateReferralFee(referralFeeRate);\n\n        balances[_tokenAddress][_user] = balances[_tokenAddress][_user].sub(_fullFee);\n\n        if(referrer == _feeAccount) {\n            balances[_tokenAddress][_feeAccount] = balances[_tokenAddress][_feeAccount].add(_fullFee);\n        } else {\n            balances[_tokenAddress][_feeAccount] = balances[_tokenAddress][_feeAccount].add(_fullFee.sub(referralFee));\n            balances[_tokenAddress][referrer] = balances[_tokenAddress][referrer].add(referralFee);\n        }\n        emit ReferralBalanceUpdated(referrer, _user, _tokenAddress, _fullFee, referralFee);\n    }\n}",
  "abi": "[{\"constant\":false,\"inputs\":[{\"name\":\"_orderAddresses\",\"type\":\"address[3][]\"},{\"name\":\"_orderValues\",\"type\":\"uint256[3][]\"},{\"name\":\"_takerSellAmount\",\"type\":\"uint256[]\"},{\"name\":\"_v\",\"type\":\"uint8[]\"},{\"name\":\"_r\",\"type\":\"bytes32[]\"},{\"name\":\"_s\",\"type\":\"bytes32[]\"},{\"name\":\"_methodId\",\"type\":\"bytes4\"}],\"name\":\"takeAllPossible\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_tokenAddress\",\"type\":\"address\"},{\"name\":\"_amount\",\"type\":\"uint256\"}],\"name\":\"withdrawTokens\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_minimumTokenAmountForUpdate\",\"type\":\"uint256\"}],\"name\":\"setMinimumTokenAmountForUpdate\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_dailyVolumeCap\",\"type\":\"uint256\"}],\"name\":\"setDailyVolumeCap\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_methodId\",\"type\":\"bytes4\"},{\"name\":\"_allowed\",\"type\":\"bool\"}],\"name\":\"allowOrRestrictMethod\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_orderAddresses\",\"type\":\"address[3]\"},{\"name\":\"_orderValues\",\"type\":\"uint256[3]\"},{\"name\":\"_v\",\"type\":\"uint8\"},{\"name\":\"_r\",\"type\":\"bytes32\"},{\"name\":\"_s\",\"type\":\"bytes32\"}],\"name\":\"cancelOrder\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_tokenAddress\",\"type\":\"address\"},{\"name\":\"_amount\",\"type\":\"uint256\"},{\"name\":\"_referrer\",\"type\":\"address\"}],\"name\":\"depositTokens\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_orderAddresses\",\"type\":\"address[3]\"},{\"name\":\"_orderValues\",\"type\":\"uint256[3]\"},{\"name\":\"_takerSellAmount\",\"type\":\"uint256\"},{\"name\":\"_v\",\"type\":\"uint8\"},{\"name\":\"_r\",\"type\":\"bytes32\"},{\"name\":\"_s\",\"type\":\"bytes32\"}],\"name\":\"takeBuyOrder\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"isMigrationAllowed\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_orderAddresses\",\"type\":\"address[3]\"},{\"name\":\"_orderValues\",\"type\":\"uint256[3]\"},{\"name\":\"_takerSellAmount\",\"type\":\"uint256\"},{\"name\":\"_v\",\"type\":\"uint8\"},{\"name\":\"_r\",\"type\":\"bytes32\"},{\"name\":\"_s\",\"type\":\"bytes32\"}],\"name\":\"takeSellTokenOrder\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"bytes32\"}],\"name\":\"filledAmounts\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_orderAddresses\",\"type\":\"address[3]\"},{\"name\":\"_orderValues\",\"type\":\"uint256[3]\"},{\"name\":\"_takerSellAmount\",\"type\":\"uint256\"},{\"name\":\"_v\",\"type\":\"uint8\"},{\"name\":\"_r\",\"type\":\"bytes32\"},{\"name\":\"_s\",\"type\":\"bytes32\"}],\"name\":\"takeSellOrder\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_feeAccount\",\"type\":\"address\"}],\"name\":\"setFeeAccount\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_tokenAddress\",\"type\":\"address\"},{\"name\":\"_amount\",\"type\":\"uint256\"},{\"name\":\"_beneficiary\",\"type\":\"address\"}],\"name\":\"depositTokensFor\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"feeAccount\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_tokenAddress\",\"type\":\"address\"},{\"name\":\"_amount\",\"type\":\"uint256\"}],\"name\":\"depositTokens\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_discountTokenAddress\",\"type\":\"address\"},{\"name\":\"_discountTokenRatio\",\"type\":\"uint256\"},{\"name\":\"_minimumTokenAmountForUpdate\",\"type\":\"uint256\"}],\"name\":\"setDiscountToken\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_feeRate\",\"type\":\"uint256\"}],\"name\":\"setFee\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"},{\"name\":\"\",\"type\":\"address\"}],\"name\":\"userContributionForProject\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_referralFeeRate\",\"type\":\"uint256\"}],\"name\":\"setReferralFee\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"ETH\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_orderAddresses\",\"type\":\"address[3][]\"},{\"name\":\"_orderValues\",\"type\":\"uint256[3][]\"},{\"name\":\"_v\",\"type\":\"uint8[]\"},{\"name\":\"_r\",\"type\":\"bytes32[]\"},{\"name\":\"_s\",\"type\":\"bytes32[]\"}],\"name\":\"cancelMultipleOrders\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"owner\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_orderAddresses\",\"type\":\"address[3][]\"},{\"name\":\"_orderValues\",\"type\":\"uint256[3][]\"},{\"name\":\"_takerSellAmount\",\"type\":\"uint256[]\"},{\"name\":\"_v\",\"type\":\"uint8[]\"},{\"name\":\"_r\",\"type\":\"bytes32[]\"},{\"name\":\"_s\",\"type\":\"bytes32[]\"},{\"name\":\"_methodId\",\"type\":\"bytes4\"}],\"name\":\"takeAllOrRevert\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"feeRate\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"dailyVolume\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_tokenAddress\",\"type\":\"address\"},{\"name\":\"_amount\",\"type\":\"uint256\"},{\"name\":\"_referrer\",\"type\":\"address\"}],\"name\":\"depositOldTokens\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_newExchangeAddress\",\"type\":\"address\"}],\"name\":\"setNewExchangeAddress\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"}],\"name\":\"referrals\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"newExchangeAddress\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"dailyVolumeCap\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"allowOrRestrictMigrations\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"referralFeeRate\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_tokens\",\"type\":\"address[]\"}],\"name\":\"migrateFunds\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_tokenAddress\",\"type\":\"address\"},{\"name\":\"_to\",\"type\":\"address\"},{\"name\":\"_amount\",\"type\":\"uint256\"}],\"name\":\"transfer\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"},{\"name\":\"\",\"type\":\"address\"}],\"name\":\"balances\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_project\",\"type\":\"address\"},{\"name\":\"_weiAmount\",\"type\":\"uint256\"}],\"name\":\"getBonusFactor\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_project\",\"type\":\"address\"},{\"name\":\"_user\",\"type\":\"address\"}],\"name\":\"isUserWhitelisted\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_referrer\",\"type\":\"address\"}],\"name\":\"depositEthers\",\"outputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_tokenAddress\",\"type\":\"address\"},{\"name\":\"_amount\",\"type\":\"uint256\"},{\"name\":\"_beneficiary\",\"type\":\"address\"}],\"name\":\"depositOldTokensFor\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"}],\"name\":\"crowdsales\",\"outputs\":[{\"name\":\"startTime\",\"type\":\"uint256\"},{\"name\":\"endTime\",\"type\":\"uint256\"},{\"name\":\"capacity\",\"type\":\"uint256\"},{\"name\":\"leftAmount\",\"type\":\"uint256\"},{\"name\":\"tokenRatio\",\"type\":\"uint256\"},{\"name\":\"minContribution\",\"type\":\"uint256\"},{\"name\":\"maxContribution\",\"type\":\"uint256\"},{\"name\":\"weiRaised\",\"type\":\"uint256\"},{\"name\":\"wallet\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_project\",\"type\":\"address\"}],\"name\":\"withdrawWhenFinished\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_project\",\"type\":\"address\"},{\"name\":\"_projectWallet\",\"type\":\"address\"},{\"name\":\"_values\",\"type\":\"uint256[8]\"}],\"name\":\"registerCrowdsale\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_project\",\"type\":\"address\"}],\"name\":\"saleOpen\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_beneficiary\",\"type\":\"address\"}],\"name\":\"depositEthersFor\",\"outputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_tokenAddress\",\"type\":\"address\"},{\"name\":\"_amount\",\"type\":\"uint256\"}],\"name\":\"depositOldTokens\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_project\",\"type\":\"address\"}],\"name\":\"buyTokens\",\"outputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_tokenAddress\",\"type\":\"address\"},{\"name\":\"_amount\",\"type\":\"uint256\"}],\"name\":\"withdrawOldTokens\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_orderAddresses\",\"type\":\"address[3]\"},{\"name\":\"_orderValues\",\"type\":\"uint256[3]\"},{\"name\":\"_takerSellAmount\",\"type\":\"uint256\"},{\"name\":\"_v\",\"type\":\"uint8\"},{\"name\":\"_r\",\"type\":\"bytes32\"},{\"name\":\"_s\",\"type\":\"bytes32\"}],\"name\":\"takeBuyTokenOrder\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"newOwner\",\"type\":\"address\"}],\"name\":\"transferOwnership\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_amount\",\"type\":\"uint256\"}],\"name\":\"withdrawEthers\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"depositEthers\",\"outputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"discountTokenAddress\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"VERSION\",\"outputs\":[{\"name\":\"\",\"type\":\"uint8\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"name\":\"_feeAccount\",\"type\":\"address\"},{\"name\":\"_feeRate\",\"type\":\"uint256\"},{\"name\":\"_referralFeeRate\",\"type\":\"uint256\"},{\"name\":\"_discountTokenAddress\",\"type\":\"address\"},{\"name\":\"_discountTokenRatio\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"fallback\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"project\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"contributor\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"tokens\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"weiAmount\",\"type\":\"uint256\"}],\"name\":\"TokenPurchase\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"user\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"exchangeAddress\",\"type\":\"address\"}],\"name\":\"FundsMigrated\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"refererAddress\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"referralAddress\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"tokenAddress\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"feeAmount\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"referralFeeAmount\",\"type\":\"uint256\"}],\"name\":\"ReferralBalanceUpdated\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"token\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"user\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"referrer\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"amount\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"balance\",\"type\":\"uint256\"}],\"name\":\"ReferralDeposit\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"tokenAddress\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"user\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"amount\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"balance\",\"type\":\"uint256\"}],\"name\":\"Deposit\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"tokenAddress\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"user\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"amount\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"balance\",\"type\":\"uint256\"}],\"name\":\"Withdraw\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"makerBuyToken\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"makerSellToken\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"maker\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"orderHash\",\"type\":\"bytes32\"},{\"indexed\":false,\"name\":\"nonce\",\"type\":\"uint256\"}],\"name\":\"CancelOrder\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"maker\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"taker\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"makerBuyToken\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"makerSellToken\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"takerGivenAmount\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"takerReceivedAmount\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"orderHash\",\"type\":\"bytes32\"},{\"indexed\":false,\"name\":\"nonce\",\"type\":\"uint256\"}],\"name\":\"TakeOrder\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"eventId\",\"type\":\"uint8\"},{\"indexed\":false,\"name\":\"orderHash\",\"type\":\"bytes32\"}],\"name\":\"Error\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"previousOwner\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"newOwner\",\"type\":\"address\"}],\"name\":\"OwnershipTransferred\",\"type\":\"event\"}]",
  "bytecode": "6080604052600a805460a060020a60ff02191690553480156200002157600080fd5b5060405160a08062004a79833981016040908152815160208301519183015160608401516080909401516000805433600160a060020a031991821617825560048054909116600160a060020a0386161790556001859055600555683635c9adc5dea0000060065591939091828282620000a2640100000000620000d8810204565b600755600a8054600160a060020a031916600160a060020a039390931692909217909155600855600b5550620001129350505050565b6000620000f742620151806401000000006200421b620000fc82021704565b905090565b600081838115156200010a57fe5b049392505050565b61495780620001226000396000f30060806040526004361061026d5763ffffffff60e060020a6000350416624f404281146102e357806306b091f91461034e57806307f1eb0d14610372578063098210951461038a57806315a2bd76146103a2578063160fc374146103c9578063298e4f791461044057806335d7f1491461046b5780633a25823e146104955780633d40c266146104be57806340f1a34d146104e85780634ac9f881146105125780634b023cf81461058f57806362a49ae3146105b057806365e17c9d146105db57806366168bd71461060c5780636683381b1461063057806369fe0e2d146106575780636a18eb481461066f578063713494d7146106965780638322fff2146106ae57806386d8aab4146106c35780638da5cb5b146107135780639148b23714610728578063978bbdb91461079157806398c8877e146107a65780639be2385a146107bb5780639c489edb146107e65780639ca423b314610807578063a8f68a3114610828578063ac9824d71461083d578063b0d7949714610852578063bd7562ff14610867578063be3dd1311461087c578063beabacc81461089c578063c23f001f146108c6578063c4c745b6146108ed578063c7258d7f14610911578063cc64e2d514610938578063db8567591461094c578063dd1e2e0f14610977578063e3cc83cf146109e8578063e548799c14610a09578063e7c5c27f14610a61578063e8cf0aca14610a82578063e9779b7614610a96578063ec8ac4d814610aba578063ec8fb8ef14610ace578063ecb20de714610af2578063f2fde38b14610b1c578063f420670614610b3d578063f477a6b714610b55578063f617494114610b5d578063ffa1ad7414610b72575b6040805160e560020a62461bcd02815260206004820152603560248201527f43616e6e6f742073656e642045746865727320746f2074686520636f6e74726160448201527f63742c20757365206465706f7369744574686572730000000000000000000000606482015290519081900360840190fd5b3480156102ef57600080fd5b5061034c602460048035828101929082013591813580830192908201359160443580830192908201359160643580830192908201359160843580830192908201359160a435918201910135600160e060020a031960c43516610b9d565b005b34801561035a57600080fd5b5061034c600160a060020a0360043516602435610d2b565b34801561037e57600080fd5b5061034c600435610f73565b34801561039657600080fd5b5061034c600435610fdc565b3480156103ae57600080fd5b5061034c600160e060020a0319600435166024351515611045565b3480156103d557600080fd5b5060408051606081810190925261034c91369160049160649190839060039083908390808284375050604080516060818101909252949796958181019594509250600391508390839080828437509396505050823560ff1693505050602081013590604001356110d5565b34801561044c57600080fd5b5061034c600160a060020a0360043581169060243590604435166112ef565b34801561047757600080fd5b5061034c6004606460c43560ff60e43516610104356101243561141a565b3480156104a157600080fd5b506104aa611581565b604080519115158252519081900360200190f35b3480156104ca57600080fd5b5061034c6004606460c43560ff60e435166101043561012435611591565b3480156104f457600080fd5b506105006004356116be565b60408051918252519081900360200190f35b34801561051e57600080fd5b5060408051606081810190925261034c91369160049160649190839060039083908390808284375050604080516060818101909252949796958181019594509250600391508390839080828437509396505083359450505050602081013560ff1690604081013590606001356116d0565b34801561059b57600080fd5b5061034c600160a060020a03600435166117f1565b3480156105bc57600080fd5b5061034c600160a060020a036004358116906024359060443516611877565b3480156105e757600080fd5b506105f06118e7565b60408051600160a060020a039092168252519081900360200190f35b34801561061857600080fd5b5061034c600160a060020a03600435166024356118f6565b34801561063c57600080fd5b5061034c600160a060020a0360043516602435604435611902565b34801561066357600080fd5b5061034c600435611a16565b34801561067b57600080fd5b50610500600160a060020a0360043581169060243516611a7f565b3480156106a257600080fd5b5061034c600435611a9c565b3480156106ba57600080fd5b506105f0611b05565b3480156106cf57600080fd5b5061034c6024600480358281019290820135918135808301929082013591604435808301929082013591606435808301929082013591608435918201910135611b0a565b34801561071f57600080fd5b506105f0611be5565b34801561073457600080fd5b5061034c602460048035828101929082013591813580830192908201359160443580830192908201359160643580830192908201359160843580830192908201359160a435918201910135600160e060020a031960c43516611bf4565b34801561079d57600080fd5b50610500611dc4565b3480156107b257600080fd5b50610500611dca565b3480156107c757600080fd5b5061034c600160a060020a036004358116906024359060443516611dd0565b3480156107f257600080fd5b5061034c600160a060020a0360043516611e6f565b34801561081357600080fd5b506105f0600160a060020a0360043516611ef5565b34801561083457600080fd5b506105f0611f10565b34801561084957600080fd5b50610500611f1f565b34801561085e57600080fd5b5061034c611f25565b34801561087357600080fd5b50610500611fbb565b34801561088857600080fd5b5061034c6004803560248101910135611fc1565b3480156108a857600080fd5b5061034c600160a060020a03600435811690602435166044356121a9565b3480156108d257600080fd5b50610500600160a060020a03600435811690602435166122c9565b3480156108f957600080fd5b50610500600160a060020a03600435166024356122e6565b34801561091d57600080fd5b506104aa600160a060020a03600435811690602435166123a0565b61034c600160a060020a03600435166123fd565b34801561095857600080fd5b5061034c600160a060020a036004358116906024359060443516612523565b34801561098357600080fd5b50610998600160a060020a036004351661252e565b60408051998a5260208a0198909852888801969096526060880194909452608087019290925260a086015260c085015260e0840152600160a060020a031661010083015251908190036101200190f35b3480156109f457600080fd5b5061034c600160a060020a0360043516612582565b348015610a1557600080fd5b506040805161010081810190925261034c91600160a060020a0360048035821693602435909216923692610144916044906008908390839080828437509396506127c595505050505050565b348015610a6d57600080fd5b506104aa600160a060020a0360043516612a4e565b61034c600160a060020a0360043516612a6f565b348015610aa257600080fd5b5061034c600160a060020a0360043516602435612ad9565b61034c600160a060020a0360043516612ae5565b348015610ada57600080fd5b5061034c600160a060020a0360043516602435612f18565b348015610afe57600080fd5b5061034c6004606460c43560ff60e435166101043561012435612ffb565b348015610b2857600080fd5b5061034c600160a060020a0360043516613126565b348015610b4957600080fd5b5061034c600435613245565b61034c6133a6565b348015610b6957600080fd5b506105f06133b0565b348015610b7e57600080fd5b50610b87611b05565b6040805160ff9092168252519081900360200190f35b600160e060020a0319811660009081526010602052604081205460ff161515610c10576040805160e560020a62461bcd02815260206004820152601660248201527f43616e27742063616c6c2074686973206d6574686f6400000000000000000000604482015290519081900360640190fd5b5060005b8c811015610d1b573060e060020a83048f8f84818110610c3057fe5b9050606002018e8e858181101515610c4457fe5b9050606002018d8d868181101515610c5857fe5b905060200201358c8c878181101515610c6d57fe5b9050602002013560ff168b8b888181101515610c8557fe5b602002919091013590508a8a89818110610c9b57fe5b90506020020135600019166040518763ffffffff1660e060020a0281526004018087600360200280828437909101905086606080828437909101958652505060ff9092166020840152604080840191909152606083019190915251608080830194506000935090918290030181865af4505060019092019150610c149050565b5050505050505050505050505050565b600160a060020a038216600090815260026020908152604080832033808552925290912054821115610da7576040805160e560020a62461bcd02815260206004820152601d60248201527f4e6f7420656e6f7567682066756e647320746f2077697468647261772e000000604482015290519081900360640190fd5b600160a060020a03808416600090815260026020908152604080832093851683529290522054610ddd908363ffffffff6133bf16565b600160a060020a0380851660008181526002602090815260408083209487168084529482528083209590955584517fa9059cbb0000000000000000000000000000000000000000000000000000000081526004810194909452602484018790529351919363a9059cbb936044808201949293918390030190829087803b158015610e6657600080fd5b505af1158015610e7a573d6000803e3d6000fd5b505050506040513d6020811015610e9057600080fd5b50511515610f0e576040805160e560020a62461bcd02815260206004820152602260248201527f546f6b656e207472616e73666572206973206e6f74207375636365737366756c60448201527f6c2e000000000000000000000000000000000000000000000000000000000000606482015290519081900360840190fd5b600160a060020a038381166000818152600260209081526040808320948616808452948252918290205482518781529182015281517ff341246adaac6f497bc2a656f546ab9e182111d630394f0c57c710a59a2cb567929181900390910190a3505050565b600054600160a060020a03163314610fd7576040805160e560020a62461bcd028152602060048201526037602482015260008051602061490c83398151915260448201526000805160206148cc833981519152606482015290519081900360840190fd5b600955565b600054600160a060020a03163314611040576040805160e560020a62461bcd028152602060048201526037602482015260008051602061490c83398151915260448201526000805160206148cc833981519152606482015290519081900360840190fd5b600655565b600054600160a060020a031633146110a9576040805160e560020a62461bcd028152602060048201526037602482015260008051602061490c83398151915260448201526000805160206148cc833981519152606482015290519081900360840190fd5b600160e060020a0319919091166000908152601060205260409020805460ff1916911515919091179055565b6110dd614753565b60006110e987876133d1565b91506110f482613423565b604080517f19457468657265756d205369676e6564204d6573736167653a0a333200000000602080830191909152603c80830185905283518084039091018152605c9092019283905281519394503393600193918291908401908083835b602083106111715780518252601f199092019160209182019101611152565b51815160209384036101000a60001901801990921691161790526040805192909401829003822060008084528383018087529190915260ff8e1683860152606083018d9052608083018c9052935160a08084019750919550601f1981019492819003909101925090865af11580156111ed573d6000803e3d6000fd5b50505060206040510351600160a060020a0316141515611257576040805160e560020a62461bcd02815260206004820152601f60248201527f4f6e6c79206f72646572206d616b65722063616e2063616e63656c2069742e00604482015290519081900360640190fd5b6020808301516000838152600390925260409091205461127c9163ffffffff61350b16565b60008281526003602090815260409182902092909255608084015160a08501518583015183518681529485015282513394600160a060020a039384169493909216927f454e3f871d26b6d7e2e7a14972426662a13e69dad9e6526a3368f4488e952c17928290030190a450505050505050565b336000818152600c6020526040902054600160a060020a031615611383576040805160e560020a62461bcd02815260206004820152602260248201527f54686973207573657220616c726561647920686176652061207265666572726560448201527f722e000000000000000000000000000000000000000000000000000000000000606482015290519081900360840190fd5b61138e848483613518565b600160a060020a038082166000818152600c602090815260408083208054868916600160a060020a031990911681179091559489168084526002835281842085855283529281902054815193845291830188905282810191909152517f2859b84ce98bdb3ef161ba5a8434b7bef57d8c3551fa12598058d1e1ce68c7fd9181900360600190a350505050565b611422614753565b6000600160a060020a03602089013516156114ad576040805160e560020a62461bcd02815260206004820152602360248201527f426173652063757272656e6379206d757374206265206574686572277320283060448201527f7830290000000000000000000000000000000000000000000000000000000000606482015290519081900360840190fd5b6040805160608181019092526114f4918a906003908390839080828437505060408051606081810190925293508c9250600391508390839080828437506133d19350505050565b915061150382878787876136a8565b90506000811161154b576040805160e560020a62461bcd02815260206004820152600d60248201526000805160206148ac833981519152604482015290519081900360640190fd5b61155481613be2565b61155c613c22565b1515611577576115778260600151338460a001518985613c2d565b5050505050505050565b600d5460a060020a900460ff1681565b600a546020870135600160a060020a039081169116146115fb576040805160e560020a62461bcd02815260206004820152601960248201527f53686f756c642073656c6c2057656944657820546f6b656e7300000000000000604482015290519081900360640190fd5b611652611649876003806020026040519081016040528092919082600360200280828437505060408051606081810190925293508b9250600391508390839080828437506133d19350505050565b858585856136a8565b600010611697576040805160e560020a62461bcd02815260206004820152600d60248201526000805160206148ac833981519152604482015290519081900360640190fd5b6116a084613be2565b6116b660208601358660005b6020020135613c7b565b505050505050565b60036020526000908152604090205481565b6116d8614753565b6040870151600090600160a060020a031615611764576040805160e560020a62461bcd02815260206004820152602360248201527f426173652063757272656e6379206d757374206265206574686572277320283060448201527f7830290000000000000000000000000000000000000000000000000000000000606482015290519081900360840190fd5b61176e88886133d1565b915061177d82878787876136a8565b9050600081116117c5576040805160e560020a62461bcd02815260206004820152600d60248201526000805160206148ac833981519152604482015290519081900360640190fd5b6117ce86613be2565b6117d6613c22565b1515611577576115778260600151338460800151848a613c2d565b600054600160a060020a03163314611855576040805160e560020a62461bcd028152602060048201526037602482015260008051602061490c83398151915260448201526000805160206148cc833981519152606482015290519081900360840190fd5b60048054600160a060020a031916600160a060020a0392909216919091179055565b611882838383613518565b600160a060020a038381166000818152600260209081526040808320948616808452948252918290205482518781529182015281517fdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7929181900390910190a3505050565b600454600160a060020a031681565b33611882838383613518565b600054600160a060020a03163314611966576040805160e560020a62461bcd028152602060048201526037602482015260008051602061490c83398151915260448201526000805160206148cc833981519152606482015290519081900360840190fd5b600a5460a060020a900460ff16156119c8576040805160e560020a62461bcd02815260206004820152601f60248201527f45786368616e676520697320616c726561647920696e697469616c697a656400604482015290519081900360640190fd5b600a805460089390935560099190915560a060020a600160a060020a0319909216600160a060020a03939093169290921774ff00000000000000000000000000000000000000001916179055565b600054600160a060020a03163314611a7a576040805160e560020a62461bcd028152602060048201526037602482015260008051602061490c83398151915260448201526000805160206148cc833981519152606482015290519081900360840190fd5b600155565b600f60209081526000928352604080842090915290825290205481565b600054600160a060020a03163314611b00576040805160e560020a62461bcd028152602060048201526037602482015260008051602061490c83398151915260448201526000805160206148cc833981519152606482015290519081900360840190fd5b600b55565b600081565b60005b89811015611bd857611bd08b8b83818110611b2457fe5b9050606002016003806020026040519081016040528092919082600360200280828437508e93508d925086915050818110611b5b57fe5b9050606002016003806020026040519081016040528092919082600360200280828437508d93508c925087915050818110611b9257fe5b9050602002013560ff168888868181101515611baa57fe5b60200291909101359050878787818110611bc057fe5b90506020020135600019166110d5565b600101611b0d565b5050505050505050505050565b600054600160a060020a031681565b600160e060020a0319811660009081526010602052604081205460ff161515611c67576040805160e560020a62461bcd02815260206004820152601660248201527f43616e27742063616c6c2074686973206d6574686f6400000000000000000000604482015290519081900360640190fd5b5060005b8c811015610d1b573060e060020a83048f8f84818110611c8757fe5b9050606002018e8e858181101515611c9b57fe5b9050606002018d8d868181101515611caf57fe5b905060200201358c8c878181101515611cc457fe5b9050602002013560ff168b8b888181101515611cdc57fe5b602002919091013590508a8a89818110611cf257fe5b90506020020135600019166040518763ffffffff1660e060020a0281526004018087600360200280828437909101905086606080828437909101958652505060ff9092166020840152604080840191909152606083019190915251608080830194506000935090918290030181865af4925050501515611dbc576040805160e560020a62461bcd02815260206004820152601260248201527f4d6574686f642063616c6c206661696c65640000000000000000000000000000604482015290519081900360640190fd5b600101611c6b565b60015481565b60055481565b336000818152600c6020526040902054600160a060020a031615611e64576040805160e560020a62461bcd02815260206004820152602260248201527f54686973207573657220616c726561647920686176652061207265666572726560448201527f722e000000000000000000000000000000000000000000000000000000000000606482015290519081900360840190fd5b61138e848483613c9c565b600054600160a060020a03163314611ed3576040805160e560020a62461bcd028152602060048201526037602482015260008051602061490c83398151915260448201526000805160206148cc833981519152606482015290519081900360840190fd5b600d8054600160a060020a031916600160a060020a0392909216919091179055565b600c60205260009081526040902054600160a060020a031681565b600d54600160a060020a031681565b60065481565b600054600160a060020a03163314611f89576040805160e560020a62461bcd028152602060048201526037602482015260008051602061490c83398151915260448201526000805160206148cc833981519152606482015290519081900360840190fd5b600d805474ff000000000000000000000000000000000000000019811660a060020a9182900460ff1615909102179055565b600b5481565b600d5460a060020a900460ff161515612024576040805160e560020a62461bcd02815260206004820152601d60248201527f46756e64206d6967726174696f6e206973206e6f7420616c6c6f776564000000604482015290519081900360640190fd5b600d54604080517fffa1ad740000000000000000000000000000000000000000000000000000000081529051600092600160a060020a03169163ffa1ad7491600480830192602092919082900301818787803b15801561208357600080fd5b505af1158015612097573d6000803e3d6000fd5b505050506040513d60208110156120ad57600080fd5b505160ff161161212d576040805160e560020a62461bcd02815260206004820152602481018290527f4e65772065786368616e67652076657273696f6e2073686f756c64206265206760448201527f726561746572207468616e207468652063757272656e742076657273696f6e2e606482015290519081900360840190fd5b612135613d04565b61216b82828080602002602001604051908101604052809392919081815260200183836020028082843750613dbe945050505050565b600d54604051600160a060020a039091169033907f0cd41587e1fdc62ecf8d0627f78a2e52dfb0ac9116b3c84027ce99ba7c2a198a90600090a35050565b600160a060020a038316600090815260026020908152604080832033808552925290912054821115612225576040805160e560020a62461bcd02815260206004820152601d60248201527f4e6f7420656e6f7567682066756e647320746f207472616e736665722e000000604482015290519081900360640190fd5b600160a060020a0380851660009081526002602090815260408083209385168352929052205461225b908363ffffffff6133bf16565b600160a060020a03858116600090815260026020908152604080832086851684529091528082209390935590851681522054612297908361350b565b600160a060020a0394851660009081526002602090815260408083209690971682529490945293909220929092555050565b600260209081526000928352604080842090915290825290205481565b600160a060020a0382166000818152600e60209081526040808320805460019091015482517f060d15f90000000000000000000000000000000000000000000000000000000081526004810192909252602482015260448101869052905192939263060d15f99260648084019391929182900301818787803b15801561236b57600080fd5b505af115801561237f573d6000803e3d6000fd5b505050506040513d602081101561239557600080fd5b505190505b92915050565b600082600160a060020a031663fb237eb2836040518263ffffffff1660e060020a0281526004018082600160a060020a0316600160a060020a03168152602001915050602060405180830381600087803b15801561236b57600080fd5b336000818152600c6020526040902054600160a060020a031615612491576040805160e560020a62461bcd02815260206004820152602260248201527f54686973207573657220616c726561647920686176652061207265666572726560448201527f722e000000000000000000000000000000000000000000000000000000000000606482015290519081900360840190fd5b61249a81613fc2565b600160a060020a038181166000818152600c602090815260408083208054600160a060020a03191695881695861790556000805160206148ec8339815191528252808320548151938452349284019290925282810191909152517f2859b84ce98bdb3ef161ba5a8434b7bef57d8c3551fa12598058d1e1ce68c7fd916060908290030190a35050565b611882838383613c9c565b600e60205260009081526040902080546001820154600283015460038401546004850154600586015460068701546007880154600890980154969795969495939492939192909190600160a060020a031689565b600160a060020a038082166000908152600e602052604081206008015490911690338214612620576040805160e560020a62461bcd02815260206004820152603660248201527f4f6e6c792063726f776473616c65206f776e65722063616e207769746864726160448201527f772066756e6473207468617420617265206c6566742e00000000000000000000606482015290519081900360840190fd5b600160a060020a0383166000908152600e6020526040902061264190614022565b156126bc576040805160e560020a62461bcd02815260206004820152603960248201527f596f752063616e27742077697468647261772066756e6473207965742e20437260448201527f6f776473616c652073686f756c6420656e642066697273742e00000000000000606482015290519081900360840190fd5b50600160a060020a038083166000818152600e6020908152604080832060030180549084905581517fa9059cbb0000000000000000000000000000000000000000000000000000000081529587166004870152602486018190529051909463a9059cbb9360448083019493928390030190829087803b15801561273e57600080fd5b505af1158015612752573d6000803e3d6000fd5b505050506040513d602081101561276857600080fd5b505115156127c0576040805160e560020a62461bcd02815260206004820152600f60248201527f5472616e73666572206661696c65640000000000000000000000000000000000604482015290519081900360640190fd5b505050565b600054600160a060020a03163314612829576040805160e560020a62461bcd028152602060048201526037602482015260008051602061490c83398151915260448201526000805160206148cc833981519152606482015290519081900360840190fd5b612833828261403c565b600160a060020a038481166000908152600e602090815260409182902084518155908401516001820155908301516002820155606083015160038201556080830151600482015560a0830151600582015560c0830151600682015560e0830151600782015561010090920151600883018054600160a060020a031916919092161790556128bf906140b2565b1515612915576040805160e560020a62461bcd02815260206004820152601860248201527f43726f776473616c65206973206e6f74206163746976652e0000000000000000604482015290519081900360640190fd5b600160a060020a0383166000908152600e602052604081206005015461293c9085906122e6565b101561297c5760405160e560020a62461bcd0281526004018080602001828103825260cd8152602001806147df60cd913960e00191505060405180910390fd5b61298683306123a0565b15156127c0576040805160e560020a62461bcd02815260206004820152606d60248201527f5468652070726f6a6563742073686f756c642068617665202a6973557365725760448201527f686974656c69737465642a2066756e6374696f6e20696d706c656d656e74656460648201527f2e205468697320636f6e747261637420616464726573732073686f756c64206260848201527f652077686974656c69737465640000000000000000000000000000000000000060a482015290519081900360c40190fd5b600160a060020a0381166000908152600e6020526040812061239a90614022565b612a7881613fc2565b600160a060020a03811660008181526000805160206148ec833981519152602090815260408083205481513481529283015280517fdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d79281900390910190a350565b33611882838383613c9c565b600160a060020a038082166000908152600e602052604081206008015434923392911690808080612b1688876123a0565b1515612b6c576040805160e560020a62461bcd02815260206004820152601760248201527f55736572206973206e6f742077686974656c6973746564000000000000000000604482015290519081900360640190fd5b612b778887896140f7565b1515612c3f576040805160e560020a62461bcd02815260206004820152606360248201527f436f6e747269627574696f6e206973206e6f742076616c69643a20436865636b60448201527f206d696e696d756d2f6d6178696d756d20636f6e747269627574696f6e20616d60648201527f6f756e74206f722069662063726f776473616c6520636170206973207265616360848201527f686564000000000000000000000000000000000000000000000000000000000060a482015290519081900360c40190fd5b600160a060020a0388166000908152600e6020526040902060040154612c6c90889063ffffffff6141f216565b9350612c7888886122e6565b9250612c9b6064612c8f868663ffffffff6141f216565b9063ffffffff61421b16565b9150612cad848363ffffffff61350b16565b600160a060020a0389166000908152600e6020526040902060030154909150612cdc908263ffffffff6133bf16565b600160a060020a03808a166000818152600e602090815260408083206003019590955584517fa9059cbb000000000000000000000000000000000000000000000000000000008152938b166004850152602484018690529351919363a9059cbb936044808201949293918390030190829087803b158015612d5c57600080fd5b505af1158015612d70573d6000803e3d6000fd5b505050506040513d6020811015612d8657600080fd5b50511515612dde576040805160e560020a62461bcd02815260206004820152600f60248201527f5472616e73666572206661696c65640000000000000000000000000000000000604482015290519081900360640190fd5b600160a060020a0388166000908152600e6020526040902060070154612e0a908863ffffffff61350b16565b600160a060020a03808a166000908152600e6020908152604080832060070194909455600f8152838220928a168252919091522054612e4f908863ffffffff61350b16565b600160a060020a03808a166000908152600f602090815260408083208b8516845282528083209490945591881681526000805160206148ec8339815191529091522054612ea2908863ffffffff61350b16565b600160a060020a0386811660009081526000805160206148ec83398151915260209081526040918290209390935580518481529283018a9052805189831693928c16927f623b3804fa71d67900d064613da8f94b9617215ee90799290593e1745087ad1892908290030190a35050505050505050565b600160a060020a038216600090815260026020908152604080832033808552925290912054821115612f94576040805160e560020a62461bcd02815260206004820152601d60248201527f4e6f7420656e6f7567682066756e647320746f2077697468647261772e000000604482015290519081900360640190fd5b600160a060020a03808416600090815260026020908152604080832093851683529290522054612fca908363ffffffff6133bf16565b600160a060020a03808516600090815260026020908152604080832093861683529290522055610f0e838284614230565b600a546000906040880135600160a060020a03908116911614613068576040805160e560020a62461bcd02815260206004820152601860248201527f53686f756c64206275792057656944657820546f6b656e730000000000000000604482015290519081900360640190fd5b6130bf6130b6886003806020026040519081016040528092919082600360200280828437505060408051606081810190925293508c9250600391508390839080828437506133d19350505050565b868686866136a8565b905060008111613107576040805160e560020a62461bcd02815260206004820152600d60248201526000805160206148ac833981519152604482015290519081900360640190fd5b61311081613be2565b61311d86358760016116ac565b50505050505050565b600054600160a060020a0316331461318a576040805160e560020a62461bcd028152602060048201526037602482015260008051602061490c83398151915260448201526000805160206148cc833981519152606482015290519081900360840190fd5b600160a060020a03811615156131ea576040805160e560020a62461bcd02815260206004820152600f60248201527f496e76616c696420616464726573730000000000000000000000000000000000604482015290519081900360640190fd5b60008054604051600160a060020a03808516939216917f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e091a360008054600160a060020a031916600160a060020a0392909216919091179055565b3360008181526000805160206148ec83398151915260205260409020548211156132b9576040805160e560020a62461bcd02815260206004820152601d60248201527f4e6f7420656e6f7567682066756e647320746f2077697468647261772e000000604482015290519081900360640190fd5b600160a060020a03811660009081526000805160206148ec83398151915260205260409020546132ef908363ffffffff6133bf16565b600160a060020a03821660008181526000805160206148ec8339815191526020526040808220939093559151909184156108fc02918591818181858888f19350505050158015613343573d6000803e3d6000fd5b50600160a060020a03811660008181526000805160206148ec833981519152602090815260408083205481518781529283015280517ff341246adaac6f497bc2a656f546ab9e182111d630394f0c57c710a59a2cb5679281900390910190a35050565b33612a7881613fc2565b600a54600160a060020a031681565b6000828211156133cb57fe5b50900390565b6133d9614753565b506040805160c081018252825181526020808401518183015292820151818301528351600160a060020a03908116606083015292840151831660808201529201511660a082015290565b60608101516080820151825160a084015160208086015160408088015181516c01000000000000000000000000600160a060020a03998a168102828701529789168802603482015260488101969096529690931685026068850152607c840152609c830194909452309290920260bc820152815160b081830301815260d09091019182905280516000939192918291908401908083835b602083106134d95780518252601f1990920191602091820191016134ba565b5181516020939093036101000a6000190180199091169216919091179052604051920182900390912095945050505050565b8181018281101561239a57fe5b600160a060020a0380841660009081526002602090815260408083209385168352929052205461354e908363ffffffff61350b16565b600160a060020a03808516600081815260026020908152604080832094871683529381528382209490945582517f23b872dd00000000000000000000000000000000000000000000000000000000815233600482015230602482015260448101879052925191936323b872dd936064808201949293918390030190829087803b1580156135da57600080fd5b505af11580156135ee573d6000803e3d6000fd5b505050506040513d602081101561360457600080fd5b505115156127c0576040805160e560020a62461bcd02815260206004820152604960248201527f546f6b656e207472616e73666572206973206e6f74207375636365737366756c60448201527f6c20286d6179626520796f7520686176656e2774207573656420617070726f7660648201527f652066697273743f290000000000000000000000000000000000000000000000608482015290519081900360a40190fd5b60008060006136b688613423565b91508760600151600160a060020a031660018360405160200180807f19457468657265756d205369676e6564204d6573736167653a0a333200000000815250601c0182600019166000191681526020019150506040516020818303038152906040526040518082805190602001908083835b602083106137475780518252601f199092019160209182019101613728565b51815160209384036101000a60001901801990921691161790526040805192909401829003822060008084528383018087529190915260ff8f1683860152606083018e9052608083018d9052935160a08084019750919550601f1981019492819003909101925090865af11580156137c3573d6000803e3d6000fd5b50505060206040510351600160a060020a031614151561382d576040805160e560020a62461bcd02815260206004820152601760248201527f4f72646572206d616b657220697320696e76616c69642e000000000000000000604482015290519081900360640190fd5b60a0880151600160a060020a031660009081526002602090815260408083203384529091529020548711156138a4577fe6104340582083fe7674a149f8da127b9d3d7f74a88ccd7610562eb5b61b919360015b6040805160ff9092168252602082018590528051918290030190a160009250613bd7565b602088015188516138c09190612c8f908a63ffffffff6141f216565b6080890151600160a060020a03908116600090815260026020908152604080832060608e015190941683529290522054909150811115613922577fe6104340582083fe7674a149f8da127b9d3d7f74a88ccd7610562eb5b61b91936000613880565b60208089015160008481526003909252604090912054613948908963ffffffff61350b16565b1115613976577fe6104340582083fe7674a149f8da127b9d3d7f74a88ccd7610562eb5b61b91936002613880565b600082815260036020526040902054613995908863ffffffff61350b16565b60008381526003602090815260408083209390935560a08b0151600160a060020a0316825260028152828220338352905220546139d8908863ffffffff6133bf16565b60a089018051600160a060020a039081166000908152600260208181526040808420338552825280842096909655935183168252835283812060608d0151909216815291522054613a2f908863ffffffff61350b16565b60a0890151600160a060020a03908116600090815260026020818152604080842060608f01518616855282528084209590955560808d0151909316825282528281203382529091522054613a89908263ffffffff61350b16565b608089018051600160a060020a039081166000908152600260208181526040808420338552825280842096909655935183168252835283812060608d0151909216815291522054613ae0908263ffffffff6133bf16565b600260008a60800151600160a060020a0316600160a060020a0316815260200190815260200160002060008a60600151600160a060020a0316600160a060020a03168152602001908152602001600020819055508760800151600160a060020a03168860a00151600160a060020a03168960600151600160a060020a03167f7b2fd6a4107f9286b35491723230f0752c38716aacf97d686f19385a9d9ac7a1338b86888f604001516040518086600160a060020a0316600160a060020a0316815260200185815260200184815260200183600019166000191681526020018281526020019550505050505060405180910390a48092505b505095945050505050565b600754613bed614309565b1115613c08576005819055613c00614309565b600755613c1f565b600554613c1b908263ffffffff61350b16565b6005555b50565b600654600554101590565b600154600854600090613c489084908463ffffffff61432316565b9050613c66876000613c60868663ffffffff61421b16565b8461435b565b61311d8686613c60878663ffffffff61421b16565b6009548110613c9857613c94828263ffffffff6143b216565b6008555b5050565b600160a060020a03808416600090815260026020908152604080832093851683529290522054613cd2908363ffffffff61350b16565b600160a060020a038085166000908152600260209081526040808320938616835292905220556127c0833330856143cf565b3360009081526000805160206148ec833981519152602052604081205490811115613c1f573360008181526000805160206148ec8339815191526020526040808220829055600d5481517fae41480b00000000000000000000000000000000000000000000000000000000815260048101949094529051600160a060020a039091169263ae41480b92859260248084019382900301818588803b158015613daa57600080fd5b505af11580156116b6573d6000803e3d6000fd5b600080805b8351831015613fbc578383815181101515613dda57fe5b6020908102909101810151600160a060020a038116600090815260028352604080822033835290935291909120549092509050801515613e1957613fb1565b600d54604080517f095ea7b3000000000000000000000000000000000000000000000000000000008152600160a060020a0392831660048201526024810184905290519184169163095ea7b3916044808201926020929091908290030181600087803b158015613e8857600080fd5b505af1158015613e9c573d6000803e3d6000fd5b505050506040513d6020811015613eb257600080fd5b50511515613f0a576040805160e560020a62461bcd02815260206004820152600e60248201527f417070726f7665206661696c6564000000000000000000000000000000000000604482015290519081900360640190fd5b600160a060020a038083166000818152600260209081526040808320338085529252808320839055600d5481517f83960e3c0000000000000000000000000000000000000000000000000000000081526004810195909552602485018790526044850192909252519316926383960e3c92606480820193929182900301818387803b158015613f9857600080fd5b505af1158015613fac573d6000803e3d6000fd5b505050505b600190920191613dc3565b50505050565b600160a060020a03811660009081526000805160206148ec8339815191526020526040902054613ff8903463ffffffff61350b16565b600160a060020a039190911660009081526000805160206148ec8339815191526020526040902055565b8054600090421080159061239a5750506001015442111590565b614044614788565b50604080516101208101825282518152602080840151908201528282015191810191909152606080830151908201526080808301519082015260a0808301519082015260c0808301519082015260e09182015191810191909152600160a060020a0390911661010082015290565b6000428260000154101580156140cd57508154600183015410155b80156140dd575060008260040154115b801561239a57505060080154600160a060020a0316151590565b600061410284612a4e565b156141de57600160a060020a0384166000908152600e6020526040902060050154821015614132575060006141eb565b600160a060020a038085166000908152600e6020908152604080832060060154600f8352818420948816845293909152902054614175908463ffffffff61350b16565b1115614183575060006141eb565b600160a060020a0384166000908152600e60205260409020600701546141af908363ffffffff61350b16565b600160a060020a0385166000908152600e602052604090206002015410156141d9575060006141eb565b6141e6565b5060006141eb565b503415155b9392505050565b60008215156142035750600061239a565b5081810281838281151561421357fe5b041461239a57fe5b6000818381151561422857fe5b049392505050565b82600160a060020a031663a9059cbb83836040518363ffffffff1660e060020a0281526004018083600160a060020a0316600160a060020a0316815260200182815260200192505050600060405180830381600087803b15801561429357600080fd5b505af11580156142a7573d6000803e3d6000fd5b505050506142b36144b8565b15156127c0576040805160e560020a62461bcd02815260206004820152600f60248201527f5472616e73666572206661696c65640000000000000000000000000000000000604482015290519081900360640190fd5b600061431e426201518063ffffffff61421b16565b905090565b600061435361434361433d86670de0b6b3a76400006141f2565b8561421b565b61434e8460026141f2565b61421b565b949350505050565b600a54600160a060020a0390811660009081526002602090815260408083209388168352929052205481116143a757600a546143a2908590600160a060020a0316836144ec565b613fbc565b613fbc8484846144ec565b60006141eb6143c984670de0b6b3a76400006141f2565b8361421b565b604080517f23b872dd000000000000000000000000000000000000000000000000000000008152600160a060020a0385811660048301528481166024830152604482018490529151918616916323b872dd9160648082019260009290919082900301818387803b15801561444257600080fd5b505af1158015614456573d6000803e3d6000fd5b505050506144626144b8565b1515613fbc576040805160e560020a62461bcd02815260206004820152601460248201527f5472616e736665722046726f6d206661696c6564000000000000000000000000604482015290519081900360640190fd5b6000803d80156144cf57602081146144d8576144e4565b600191506144e4565b60206000803e60005191505b501515919050565b600454600160a060020a0316600080614504866146f4565b915061451b600b548561474790919063ffffffff16565b600160a060020a038087166000908152600260209081526040808320938b1683529290522054909150614554908563ffffffff6133bf16565b600160a060020a0380871660009081526002602090815260408083208b8516845290915290209190915582811690841614156145eb57600160a060020a038086166000908152600260209081526040808320938716835292905220546145c0908563ffffffff61350b16565b600160a060020a03808716600090815260026020908152604080832093881683529290522055614693565b6146306145fe858363ffffffff6133bf16565b600160a060020a038088166000908152600260209081526040808320938916835292905220549063ffffffff61350b16565b600160a060020a0386811660009081526002602090815260408083208885168452909152808220939093559084168152205461466c908261350b565b600160a060020a038087166000908152600260209081526040808320938716835292905220555b60408051600160a060020a0380851682528089166020830152871681830152606081018690526080810183905290517f607596039a399fab9c51534a8b31c1c8d8679d266168a193d64211d9c4aacc5c9181900360a00190a1505050505050565b600160a060020a038181166000908152600c6020526040812054909116151561472857600454600160a060020a031661239a565b50600160a060020a039081166000908152600c60205260409020541690565b60006141eb838361421b565b6040805160c081018252600080825260208201819052918101829052606081018290526080810182905260a081019190915290565b6101206040519081016040528060008152602001600081526020016000815260200160008152602001600081526020016000815260200160008152602001600081526020016000600160a060020a03168152509056005468652070726f6a6563742073686f756c642068617665202a676574426f6e7573466163746f722a2066756e6374696f6e20696d706c656d656e7465642e205468652066756e6374696f6e2073686f756c642072657475726e2074686520626f6e75732070657263656e7461676520646570656e64696e67206f6e207468652073746172742f656e64206461746520616e6420636f6e747269627574696f6e20616d6f756e742e2053686f756c642072657475726e2030206966207468657265206973206e6f20626f6e75732e5472616465206661696c7572650000000000000000000000000000000000000063616e20657865637574652074686973206d6574686f64000000000000000000ac33ff75c19e70fe83507db0d683fd3465c996598dc972688b7ace676c89077b4f6e6c7920746865206f776e6572206f66207468617420636f6e747261637420a165627a7a72305820a2214fbc358cecd0a04650a7cd0356e0d3a1b5977b4f27f5488617e123b79c5f00290000000000000000000000004c7fecf4d0be2ac527119fca1b31a4811cccece3000000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000003e8000000000000000000000000000000000000000000000000000000000000dead00000000000000000000000000000000000000000000000000071afd498d0000",
  "constructorArguments": "0000000000000000000000004c7fecf4d0be2ac527119fca1b31a4811cccece3000000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000003e8000000000000000000000000000000000000000000000000000000000000dead00000000000000000000000000000000000000000000000000071afd498d0000"
}