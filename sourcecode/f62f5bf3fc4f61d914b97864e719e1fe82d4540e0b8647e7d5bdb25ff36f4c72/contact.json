{
  "address": "0xa9e3440d5c64e99c77410ec4b15746b835add59e",
  "chain": "ETH",
  "chainID": 1,
  "verifier": "etherscan.io",
  "commonName": "",
  "contractName": "CryptoZoo",
  "compilerVersion": "v0.4.21+commit.dfe3193c",
  "optimization": true,
  "runs": "200",
  "evmVersion": "default",
  "sourceCode": "/**\n *Submitted for verification at Etherscan.io on 2018-05-04\n*/\n\npragma solidity ^0.4.21;\n\ncontract Ownable {\n    address public owner;\n\n    event OwnershipTransferred(address previousOwner, address newOwner);\n\n    function Ownable() public {\n        owner = msg.sender;\n    }\n\n    modifier onlyOwner() {\n        require(msg.sender == owner);\n        _;\n    }\n\n    function transferOwnership(address newOwner) public onlyOwner {\n        require(newOwner != address(0));\n        emit OwnershipTransferred(owner, newOwner);\n        owner = newOwner;\n    }\n}\n\ncontract StorageBase is Ownable {\n\n    function withdrawBalance() external onlyOwner returns (bool) {\n        // The owner has a method to withdraw balance from multiple contracts together,\n        // use send here to make sure even if one withdrawBalance fails the others will still work\n        bool res = msg.sender.send(address(this).balance);\n        return res;\n    }\n}\n\n// owner of ActivityStorage should be ActivityCore contract address\ncontract ActivityStorage is StorageBase {\n\n    struct Activity {\n        // accept bid or not\n        bool isPause;\n        // limit max num of monster buyable per address\n        uint16 buyLimit;\n        // price (in wei)\n        uint128 packPrice;\n        // startDate (in seconds)\n        uint64 startDate;\n        // endDate (in seconds)\n        uint64 endDate;\n        // packId => address of bid winner\n        mapping(uint16 => address) soldPackToAddress;\n        // address => number of success bid\n        mapping(address => uint16) addressBoughtCount;\n    }\n\n    // limit max activityId to 65536, big enough\n    mapping(uint16 => Activity) public activities;\n\n    function createActivity(\n        uint16 _activityId,\n        uint16 _buyLimit,\n        uint128 _packPrice,\n        uint64 _startDate,\n        uint64 _endDate\n    ) \n        external\n        onlyOwner\n    {\n        // activity should not exist and can only be initialized once\n        require(activities[_activityId].buyLimit == 0);\n\n        activities[_activityId] = Activity({\n            isPause: false,\n            buyLimit: _buyLimit,\n            packPrice: _packPrice,\n            startDate: _startDate,\n            endDate: _endDate\n        });\n    }\n\n    function sellPackToAddress(\n        uint16 _activityId, \n        uint16 _packId, \n        address buyer\n    ) \n        external \n        onlyOwner\n    {\n        Activity storage activity = activities[_activityId];\n        activity.soldPackToAddress[_packId] = buyer;\n        activity.addressBoughtCount[buyer]++;\n    }\n\n    function pauseActivity(uint16 _activityId) external onlyOwner {\n        activities[_activityId].isPause = true;\n    }\n\n    function unpauseActivity(uint16 _activityId) external onlyOwner {\n        activities[_activityId].isPause = false;\n    }\n\n    function deleteActivity(uint16 _activityId) external onlyOwner {\n        delete activities[_activityId];\n    }\n\n    function getAddressBoughtCount(uint16 _activityId, address buyer) external view returns (uint16) {\n        return activities[_activityId].addressBoughtCount[buyer];\n    }\n\n    function getBuyerAddress(uint16 _activityId, uint16 packId) external view returns (address) {\n        return activities[_activityId].soldPackToAddress[packId];\n    }\n}\n\ncontract Pausable is Ownable {\n    event Pause();\n    event Unpause();\n\n    bool public paused = false;\n\n    modifier whenNotPaused() {\n        require(!paused);\n        _;\n    }\n\n    modifier whenPaused {\n        require(paused);\n        _;\n    }\n\n    function pause() public onlyOwner whenNotPaused {\n        paused = true;\n        emit Pause();\n    }\n\n    function unpause() public onlyOwner whenPaused {\n        paused = false;\n        emit Unpause();\n    }\n}\n\ncontract HasNoContracts is Pausable {\n\n    function reclaimContract(address _contractAddr) external onlyOwner whenPaused {\n        Ownable contractInst = Ownable(_contractAddr);\n        contractInst.transferOwnership(owner);\n    }\n}\n\ncontract ERC721 {\n    // Required methods\n    function totalSupply() public view returns (uint256 total);\n    function balanceOf(address _owner) public view returns (uint256 balance);\n    function ownerOf(uint256 _tokenId) external view returns (address owner);\n    function approve(address _to, uint256 _tokenId) external;\n    function transfer(address _to, uint256 _tokenId) external;\n    function transferFrom(address _from, address _to, uint256 _tokenId) external;\n\n    // Events\n    event Transfer(address from, address to, uint256 tokenId);\n    event Approval(address owner, address approved, uint256 tokenId);\n\n    // Optional\n    // function name() public view returns (string name);\n    // function symbol() public view returns (string symbol);\n    // function tokensOfOwner(address _owner) external view returns (uint256[] tokenIds);\n    // function tokenMetadata(uint256 _tokenId, string _preferredTransport) public view returns (string infoUrl);\n\n    // ERC-165 Compatibility (https://github.com/ethereum/EIPs/issues/165)\n    function supportsInterface(bytes4 _interfaceID) external view returns (bool);\n}\n\ncontract LogicBase is HasNoContracts {\n\n    /// The ERC-165 interface signature for ERC-721.\n    ///  Ref: https://github.com/ethereum/EIPs/issues/165\n    ///  Ref: https://github.com/ethereum/EIPs/issues/721\n    bytes4 constant InterfaceSignature_NFC = bytes4(0x9f40b779);\n\n    // Reference to contract tracking NFT ownership\n    ERC721 public nonFungibleContract;\n\n    // Reference to storage contract\n    StorageBase public storageContract;\n\n    function LogicBase(address _nftAddress, address _storageAddress) public {\n        // paused by default\n        paused = true;\n\n        setNFTAddress(_nftAddress);\n\n        require(_storageAddress != address(0));\n        storageContract = StorageBase(_storageAddress);\n    }\n\n    // Very dangerous action, only when new contract has been proved working\n    // Requires storageContract already transferOwnership to the new contract\n    // This method is only used to transfer the balance to owner\n    function destroy() external onlyOwner whenPaused {\n        address storageOwner = storageContract.owner();\n        // owner of storageContract must not be the current contract otherwise the storageContract will forever not accessible\n        require(storageOwner != address(this));\n        // Transfers the current balance to the owner and terminates the contract\n        selfdestruct(owner);\n    }\n\n    // Very dangerous action, only when new contract has been proved working\n    // Requires storageContract already transferOwnership to the new contract\n    // This method is only used to transfer the balance to the new contract\n    function destroyAndSendToStorageOwner() external onlyOwner whenPaused {\n        address storageOwner = storageContract.owner();\n        // owner of storageContract must not be the current contract otherwise the storageContract will forever not accessible\n        require(storageOwner != address(this));\n        // Transfers the current balance to the new owner of the storage contract and terminates the contract\n        selfdestruct(storageOwner);\n    }\n\n    // override to make sure everything is initialized before the unpause\n    function unpause() public onlyOwner whenPaused {\n        // can not unpause when the logic contract is not initialzed\n        require(nonFungibleContract != address(0));\n        require(storageContract != address(0));\n        // can not unpause when ownership of storage contract is not the current contract\n        require(storageContract.owner() == address(this));\n\n        super.unpause();\n    }\n\n    function setNFTAddress(address _nftAddress) public onlyOwner {\n        require(_nftAddress != address(0));\n        ERC721 candidateContract = ERC721(_nftAddress);\n        require(candidateContract.supportsInterface(InterfaceSignature_NFC));\n        nonFungibleContract = candidateContract;\n    }\n\n    // Withdraw balance to the Core Contract\n    function withdrawBalance() external returns (bool) {\n        address nftAddress = address(nonFungibleContract);\n        // either Owner or Core Contract can trigger the withdraw\n        require(msg.sender == owner || msg.sender == nftAddress);\n        // The owner has a method to withdraw balance from multiple contracts together,\n        // use send here to make sure even if one withdrawBalance fails the others will still work\n        bool res = nftAddress.send(address(this).balance);\n        return res;\n    }\n\n    function withdrawBalanceFromStorageContract() external returns (bool) {\n        address nftAddress = address(nonFungibleContract);\n        // either Owner or Core Contract can trigger the withdraw\n        require(msg.sender == owner || msg.sender == nftAddress);\n        // The owner has a method to withdraw balance from multiple contracts together,\n        // use send here to make sure even if one withdrawBalance fails the others will still work\n        bool res = storageContract.withdrawBalance();\n        return res;\n    }\n}\n\ncontract ActivityCore is LogicBase {\n\n    bool public isActivityCore = true;\n\n    ActivityStorage activityStorage;\n\n    event ActivityCreated(uint16 activityId);\n    event ActivityBidSuccess(uint16 activityId, uint16 packId, address winner);\n\n    function ActivityCore(address _nftAddress, address _storageAddress) \n        LogicBase(_nftAddress, _storageAddress) public {\n            \n        activityStorage = ActivityStorage(_storageAddress);\n    }\n\n    function createActivity(\n        uint16 _activityId,\n        uint16 _buyLimit,\n        uint128 _packPrice,\n        uint64 _startDate,\n        uint64 _endDate\n    ) \n        external\n        onlyOwner\n        whenNotPaused\n    {\n        activityStorage.createActivity(_activityId, _buyLimit, _packPrice, _startDate, _endDate);\n\n        emit ActivityCreated(_activityId);\n    }\n\n    // Very dangerous action and should be only used for testing\n    // Must pause the contract first \n    function deleteActivity(\n        uint16 _activityId\n    )\n        external \n        onlyOwner\n        whenPaused\n    {\n        activityStorage.deleteActivity(_activityId);\n    }\n\n    function getActivity(\n        uint16 _activityId\n    ) \n        external \n        view  \n        returns (\n            bool isPause,\n            uint16 buyLimit,\n            uint128 packPrice,\n            uint64 startDate,\n            uint64 endDate\n        )\n    {\n        return activityStorage.activities(_activityId);\n    }\n    \n    function bid(uint16 _activityId, uint16 _packId)\n        external\n        payable\n        whenNotPaused\n    {\n        bool isPause;\n        uint16 buyLimit;\n        uint128 packPrice;\n        uint64 startDate;\n        uint64 endDate;\n        (isPause, buyLimit, packPrice, startDate, endDate) = activityStorage.activities(_activityId);\n        // not allow to bid when activity is paused\n        require(!isPause);\n        // not allow to bid when activity is not initialized (buyLimit == 0)\n        require(buyLimit > 0);\n        // should send enough ether\n        require(msg.value >= packPrice);\n        // verify startDate & endDate\n        require(now >= startDate && now <= endDate);\n        // this pack is not sold out\n        require(activityStorage.getBuyerAddress(_activityId, _packId) == address(0));\n        // buyer not exceed buyLimit\n        require(activityStorage.getAddressBoughtCount(_activityId, msg.sender) < buyLimit);\n        // record in blockchain\n        activityStorage.sellPackToAddress(_activityId, _packId, msg.sender);\n        // emit the success event\n        emit ActivityBidSuccess(_activityId, _packId, msg.sender);\n    }\n}\n\ncontract CryptoStorage is StorageBase {\n\n    struct Monster {\n        uint32 matronId;\n        uint32 sireId;\n        uint32 siringWithId;\n        uint16 cooldownIndex;\n        uint16 generation;\n        uint64 cooldownEndBlock;\n        uint64 birthTime;\n        uint16 monsterId;\n        uint32 monsterNum;\n        bytes properties;\n    }\n\n    // ERC721 tokens\n    Monster[] internal monsters;\n\n    // total number of monster created from system instead of breeding\n    uint256 public promoCreatedCount;\n\n    // total number of monster created by system sale address\n    uint256 public systemCreatedCount;\n\n    // number of monsters in pregnant\n    uint256 public pregnantMonsters;\n    \n    // monsterId => total number\n    mapping (uint256 => uint32) public monsterCurrentNumber;\n    \n    // tokenId => owner address\n    mapping (uint256 => address) public monsterIndexToOwner;\n\n    // owner address => balance of tokens\n    mapping (address => uint256) public ownershipTokenCount;\n\n    // tokenId => approved address\n    mapping (uint256 => address) public monsterIndexToApproved;\n\n    function CryptoStorage() public {\n        // placeholder to make the first available monster to have a tokenId starts from 1\n        createMonster(0, 0, 0, 0, 0, \"\");\n    }\n\n    function createMonster(\n        uint256 _matronId,\n        uint256 _sireId,\n        uint256 _generation,\n        uint256 _birthTime,\n        uint256 _monsterId,\n        bytes _properties\n    ) \n        public \n        onlyOwner\n        returns (uint256)\n    {\n        require(_matronId == uint256(uint32(_matronId)));\n        require(_sireId == uint256(uint32(_sireId)));\n        require(_generation == uint256(uint16(_generation)));\n        require(_birthTime == uint256(uint64(_birthTime)));\n        require(_monsterId == uint256(uint16(_monsterId)));\n\n        monsterCurrentNumber[_monsterId]++;\n\n        Monster memory monster = Monster({\n            matronId: uint32(_matronId),\n            sireId: uint32(_sireId),\n            siringWithId: 0,\n            cooldownIndex: 0,\n            generation: uint16(_generation),\n            cooldownEndBlock: 0,\n            birthTime: uint64(_birthTime),\n            monsterId: uint16(_monsterId),\n            monsterNum: monsterCurrentNumber[_monsterId],\n            properties: _properties\n        });\n        uint256 tokenId = monsters.push(monster) - 1;\n\n        // overflow check\n        require(tokenId == uint256(uint32(tokenId)));\n\n        return tokenId;\n    }\n\n    function getMonster(uint256 _tokenId)\n        external\n        view\n        returns (\n            bool isGestating,\n            bool isReady,\n            uint16 cooldownIndex,\n            uint64 nextActionAt,\n            uint32 siringWithId,\n            uint32 matronId,\n            uint32 sireId,\n            uint64 cooldownEndBlock,\n            uint16 generation,\n            uint64 birthTime,\n            uint32 monsterNum,\n            uint16 monsterId,\n            bytes properties\n        ) \n    {\n        Monster storage monster = monsters[_tokenId];\n\n        isGestating = (monster.siringWithId != 0);\n        isReady = (monster.cooldownEndBlock <= block.number);\n        cooldownIndex = monster.cooldownIndex;\n        nextActionAt = monster.cooldownEndBlock;\n        siringWithId = monster.siringWithId;\n        matronId = monster.matronId;\n        sireId = monster.sireId;\n        cooldownEndBlock = monster.cooldownEndBlock;\n        generation = monster.generation;\n        birthTime = monster.birthTime;\n        monsterNum = monster.monsterNum;\n        monsterId = monster.monsterId;\n        properties = monster.properties;\n    }\n\n    function getMonsterCount() external view returns (uint256) {\n        return monsters.length - 1;\n    }\n\n    function getMatronId(uint256 _tokenId) external view returns (uint32) {\n        return monsters[_tokenId].matronId;\n    }\n\n    function getSireId(uint256 _tokenId) external view returns (uint32) {\n        return monsters[_tokenId].sireId;\n    }\n\n    function getSiringWithId(uint256 _tokenId) external view returns (uint32) {\n        return monsters[_tokenId].siringWithId;\n    }\n    \n    function setSiringWithId(uint256 _tokenId, uint32 _siringWithId) external onlyOwner {\n        monsters[_tokenId].siringWithId = _siringWithId;\n    }\n\n    function deleteSiringWithId(uint256 _tokenId) external onlyOwner {\n        delete monsters[_tokenId].siringWithId;\n    }\n\n    function getCooldownIndex(uint256 _tokenId) external view returns (uint16) {\n        return monsters[_tokenId].cooldownIndex;\n    }\n\n    function setCooldownIndex(uint256 _tokenId) external onlyOwner {\n        monsters[_tokenId].cooldownIndex += 1;\n    }\n\n    function getGeneration(uint256 _tokenId) external view returns (uint16) {\n        return monsters[_tokenId].generation;\n    }\n\n    function getCooldownEndBlock(uint256 _tokenId) external view returns (uint64) {\n        return monsters[_tokenId].cooldownEndBlock;\n    }\n\n    function setCooldownEndBlock(uint256 _tokenId, uint64 _cooldownEndBlock) external onlyOwner {\n        monsters[_tokenId].cooldownEndBlock = _cooldownEndBlock;\n    }\n\n    function getBirthTime(uint256 _tokenId) external view returns (uint64) {\n        return monsters[_tokenId].birthTime;\n    }\n\n    function getMonsterId(uint256 _tokenId) external view returns (uint16) {\n        return monsters[_tokenId].monsterId;\n    }\n\n    function getMonsterNum(uint256 _tokenId) external view returns (uint32) {\n        return monsters[_tokenId].monsterNum;\n    }\n\n    function getProperties(uint256 _tokenId) external view returns (bytes) {\n        return monsters[_tokenId].properties;\n    }\n\n    function updateProperties(uint256 _tokenId, bytes _properties) external onlyOwner {\n        monsters[_tokenId].properties = _properties;\n    }\n    \n    function setMonsterIndexToOwner(uint256 _tokenId, address _owner) external onlyOwner {\n        monsterIndexToOwner[_tokenId] = _owner;\n    }\n\n    function increaseOwnershipTokenCount(address _owner) external onlyOwner {\n        ownershipTokenCount[_owner]++;\n    }\n\n    function decreaseOwnershipTokenCount(address _owner) external onlyOwner {\n        ownershipTokenCount[_owner]--;\n    }\n\n    function setMonsterIndexToApproved(uint256 _tokenId, address _approved) external onlyOwner {\n        monsterIndexToApproved[_tokenId] = _approved;\n    }\n    \n    function deleteMonsterIndexToApproved(uint256 _tokenId) external onlyOwner {\n        delete monsterIndexToApproved[_tokenId];\n    }\n\n    function increasePromoCreatedCount() external onlyOwner {\n        promoCreatedCount++;\n    }\n\n    function increaseSystemCreatedCount() external onlyOwner {\n        systemCreatedCount++;\n    }\n\n    function increasePregnantCounter() external onlyOwner {\n        pregnantMonsters++;\n    }\n\n    function decreasePregnantCounter() external onlyOwner {\n        pregnantMonsters--;\n    }\n}\n\ncontract ClockAuctionStorage is StorageBase {\n\n    // Represents an auction on an NFT\n    struct Auction {\n        // Current owner of NFT\n        address seller;\n        // Price (in wei) at beginning of auction\n        uint128 startingPrice;\n        // Price (in wei) at end of auction\n        uint128 endingPrice;\n        // Duration (in seconds) of auction\n        uint64 duration;\n        // Time when auction started\n        // NOTE: 0 if this auction has been concluded\n        uint64 startedAt;\n    }\n\n    // Map from token ID to their corresponding auction.\n    mapping (uint256 => Auction) tokenIdToAuction;\n\n    function addAuction(\n        uint256 _tokenId,\n        address _seller,\n        uint128 _startingPrice,\n        uint128 _endingPrice,\n        uint64 _duration,\n        uint64 _startedAt\n    )\n        external\n        onlyOwner\n    {\n        tokenIdToAuction[_tokenId] = Auction(\n            _seller,\n            _startingPrice,\n            _endingPrice,\n            _duration,\n            _startedAt\n        );\n    }\n\n    function removeAuction(uint256 _tokenId) public onlyOwner {\n        delete tokenIdToAuction[_tokenId];\n    }\n\n    function getAuction(uint256 _tokenId)\n        external\n        view\n        returns (\n            address seller,\n            uint128 startingPrice,\n            uint128 endingPrice,\n            uint64 duration,\n            uint64 startedAt\n        )\n    {\n        Auction storage auction = tokenIdToAuction[_tokenId];\n        return (\n            auction.seller,\n            auction.startingPrice,\n            auction.endingPrice,\n            auction.duration,\n            auction.startedAt\n        );\n    }\n\n    function isOnAuction(uint256 _tokenId) external view returns (bool) {\n        return (tokenIdToAuction[_tokenId].startedAt > 0);\n    }\n\n    function getSeller(uint256 _tokenId) external view returns (address) {\n        return tokenIdToAuction[_tokenId].seller;\n    }\n\n    function transfer(ERC721 _nonFungibleContract, address _receiver, uint256 _tokenId) external onlyOwner {\n        // it will throw if transfer fails\n        _nonFungibleContract.transfer(_receiver, _tokenId);\n    }\n}\n\ncontract SaleClockAuctionStorage is ClockAuctionStorage {\n    bool public isSaleClockAuctionStorage = true;\n\n    // total accumulate sold count\n    uint256 public totalSoldCount;\n\n    // last 3 sale price\n    uint256[3] public lastSoldPrices;\n\n    // current on sale auction count from system\n    uint256 public systemOnSaleCount;\n\n    // map of on sale token ids from system\n    mapping (uint256 => bool) systemOnSaleTokens;\n\n    function removeAuction(uint256 _tokenId) public onlyOwner {\n        // first remove auction from state variable\n        super.removeAuction(_tokenId);\n\n        // update system on sale record\n        if (systemOnSaleTokens[_tokenId]) {\n            delete systemOnSaleTokens[_tokenId];\n            \n            if (systemOnSaleCount > 0) {\n                systemOnSaleCount--;\n            }\n        }\n    }\n\n    function recordSystemOnSaleToken(uint256 _tokenId) external onlyOwner {\n        if (!systemOnSaleTokens[_tokenId]) {\n            systemOnSaleTokens[_tokenId] = true;\n            systemOnSaleCount++;\n        }\n    }\n\n    function recordSoldPrice(uint256 _price) external onlyOwner {\n        lastSoldPrices[totalSoldCount % 3] = _price;\n        totalSoldCount++;\n    }\n\n    function averageSoldPrice() external view returns (uint256) {\n        if (totalSoldCount == 0) return 0;\n        \n        uint256 sum = 0;\n        uint256 len = (totalSoldCount < 3 ? totalSoldCount : 3);\n        for (uint256 i = 0; i < len; i++) {\n            sum += lastSoldPrices[i];\n        }\n        return sum / len;\n    }\n}\n\ncontract ClockAuction is LogicBase {\n    \n    // Reference to contract tracking auction state variables\n    ClockAuctionStorage public clockAuctionStorage;\n\n    // Cut owner takes on each auction, measured in basis points (1/100 of a percent).\n    // Values 0-10,000 map to 0%-100%\n    uint256 public ownerCut;\n\n    // Minimum cut value on each auction (in WEI)\n    uint256 public minCutValue;\n\n    event AuctionCreated(uint256 tokenId, uint256 startingPrice, uint256 endingPrice, uint256 duration);\n    event AuctionSuccessful(uint256 tokenId, uint256 totalPrice, address winner, address seller, uint256 sellerProceeds);\n    event AuctionCancelled(uint256 tokenId);\n\n    function ClockAuction(address _nftAddress, address _storageAddress, uint256 _cut, uint256 _minCutValue) \n        LogicBase(_nftAddress, _storageAddress) public\n    {\n        setOwnerCut(_cut);\n        setMinCutValue(_minCutValue);\n\n        clockAuctionStorage = ClockAuctionStorage(_storageAddress);\n    }\n\n    function setOwnerCut(uint256 _cut) public onlyOwner {\n        require(_cut <= 10000);\n        ownerCut = _cut;\n    }\n\n    function setMinCutValue(uint256 _minCutValue) public onlyOwner {\n        minCutValue = _minCutValue;\n    }\n\n    function getMinPrice() public view returns (uint256) {\n        // return ownerCut > 0 ? (minCutValue / ownerCut * 10000) : 0;\n        // use minCutValue directly, when the price == minCutValue seller will get no profit\n        return minCutValue;\n    }\n\n    // Only auction from none system user need to verify the price\n    // System auction can set any price\n    function isValidPrice(uint256 _startingPrice, uint256 _endingPrice) public view returns (bool) {\n        return (_startingPrice < _endingPrice ? _startingPrice : _endingPrice) >= getMinPrice();\n    }\n\n    function createAuction(\n        uint256 _tokenId,\n        uint256 _startingPrice,\n        uint256 _endingPrice,\n        uint256 _duration,\n        address _seller\n    )\n        public\n        whenNotPaused\n    {\n        require(_startingPrice == uint256(uint128(_startingPrice)));\n        require(_endingPrice == uint256(uint128(_endingPrice)));\n        require(_duration == uint256(uint64(_duration)));\n\n        require(msg.sender == address(nonFungibleContract));\n        \n        // assigning ownership to this clockAuctionStorage when in auction\n        // it will throw if transfer fails\n        nonFungibleContract.transferFrom(_seller, address(clockAuctionStorage), _tokenId);\n\n        // Require that all auctions have a duration of at least one minute.\n        require(_duration >= 1 minutes);\n\n        clockAuctionStorage.addAuction(\n            _tokenId,\n            _seller,\n            uint128(_startingPrice),\n            uint128(_endingPrice),\n            uint64(_duration),\n            uint64(now)\n        );\n\n        emit AuctionCreated(_tokenId, _startingPrice, _endingPrice, _duration);\n    }\n\n    function cancelAuction(uint256 _tokenId) external {\n        require(clockAuctionStorage.isOnAuction(_tokenId));\n        address seller = clockAuctionStorage.getSeller(_tokenId);\n        require(msg.sender == seller);\n        _cancelAuction(_tokenId, seller);\n    }\n\n    function cancelAuctionWhenPaused(uint256 _tokenId) external whenPaused onlyOwner {\n        require(clockAuctionStorage.isOnAuction(_tokenId));\n        address seller = clockAuctionStorage.getSeller(_tokenId);\n        _cancelAuction(_tokenId, seller);\n    }\n\n    function getAuction(uint256 _tokenId)\n        public\n        view\n        returns\n    (\n        address seller,\n        uint256 startingPrice,\n        uint256 endingPrice,\n        uint256 duration,\n        uint256 startedAt\n    ) {\n        require(clockAuctionStorage.isOnAuction(_tokenId));\n        return clockAuctionStorage.getAuction(_tokenId);\n    }\n\n    function getCurrentPrice(uint256 _tokenId)\n        external\n        view\n        returns (uint256)\n    {\n        require(clockAuctionStorage.isOnAuction(_tokenId));\n        return _currentPrice(_tokenId);\n    }\n\n    function _cancelAuction(uint256 _tokenId, address _seller) internal {\n        clockAuctionStorage.removeAuction(_tokenId);\n        clockAuctionStorage.transfer(nonFungibleContract, _seller, _tokenId);\n        emit AuctionCancelled(_tokenId);\n    }\n\n    function _bid(uint256 _tokenId, uint256 _bidAmount, address bidder) internal returns (uint256) {\n\n        require(clockAuctionStorage.isOnAuction(_tokenId));\n\n        // Check that the bid is greater than or equal to the current price\n        uint256 price = _currentPrice(_tokenId);\n        require(_bidAmount >= price);\n\n        address seller = clockAuctionStorage.getSeller(_tokenId);\n        uint256 sellerProceeds = 0;\n\n        // Remove the auction before sending the fees to the sender so we can't have a reentrancy attack\n        clockAuctionStorage.removeAuction(_tokenId);\n\n        // Transfer proceeds to seller (if there are any!)\n        if (price > 0) {\n            // Calculate the auctioneer's cut, so this subtraction can't go negative\n            uint256 auctioneerCut = _computeCut(price);\n            sellerProceeds = price - auctioneerCut;\n\n            // transfer the sellerProceeds\n            seller.transfer(sellerProceeds);\n        }\n\n        // Calculate any excess funds included with the bid\n        // transfer it back to bidder.\n        // this cannot underflow.\n        uint256 bidExcess = _bidAmount - price;\n        bidder.transfer(bidExcess);\n\n        emit AuctionSuccessful(_tokenId, price, bidder, seller, sellerProceeds);\n\n        return price;\n    }\n\n    function _currentPrice(uint256 _tokenId) internal view returns (uint256) {\n\n        uint256 secondsPassed = 0;\n\n        address seller;\n        uint128 startingPrice;\n        uint128 endingPrice;\n        uint64 duration;\n        uint64 startedAt;\n        (seller, startingPrice, endingPrice, duration, startedAt) = clockAuctionStorage.getAuction(_tokenId);\n\n        if (now > startedAt) {\n            secondsPassed = now - startedAt;\n        }\n\n        return _computeCurrentPrice(\n            startingPrice,\n            endingPrice,\n            duration,\n            secondsPassed\n        );\n    }\n\n    function _computeCurrentPrice(\n        uint256 _startingPrice,\n        uint256 _endingPrice,\n        uint256 _duration,\n        uint256 _secondsPassed\n    )\n        internal\n        pure\n        returns (uint256)\n    {\n        if (_secondsPassed >= _duration) {\n            return _endingPrice;\n        } else {\n            // this delta can be negative.\n            int256 totalPriceChange = int256(_endingPrice) - int256(_startingPrice);\n\n            // This multiplication can't overflow, _secondsPassed will easily fit within\n            // 64-bits, and totalPriceChange will easily fit within 128-bits, their product\n            // will always fit within 256-bits.\n            int256 currentPriceChange = totalPriceChange * int256(_secondsPassed) / int256(_duration);\n\n            // this result will always end up positive.\n            int256 currentPrice = int256(_startingPrice) + currentPriceChange;\n\n            return uint256(currentPrice);\n        }\n    }\n\n    function _computeCut(uint256 _price) internal view returns (uint256) {\n        uint256 cutValue = _price * ownerCut / 10000;\n        if (_price < minCutValue) return cutValue;\n        if (cutValue > minCutValue) return cutValue;\n        return minCutValue;\n    }\n}\n\ncontract SaleClockAuction is ClockAuction {\n\n    bool public isSaleClockAuction = true;\n\n    address public systemSaleAddress;\n    uint256 public systemStartingPriceMin = 20 finney;\n    uint256 public systemEndingPrice = 0;\n    uint256 public systemAuctionDuration = 1 days;\n\n    function SaleClockAuction(address _nftAddr, address _storageAddress, address _systemSaleAddress, uint256 _cut, uint256 _minCutValue) \n        ClockAuction(_nftAddr, _storageAddress, _cut, _minCutValue) public\n    {\n        require(SaleClockAuctionStorage(_storageAddress).isSaleClockAuctionStorage());\n        \n        setSystemSaleAddress(_systemSaleAddress);\n    }\n  \n    function bid(uint256 _tokenId) external payable {\n        uint256 price = _bid(_tokenId, msg.value, msg.sender);\n        \n        clockAuctionStorage.transfer(nonFungibleContract, msg.sender, _tokenId);\n        \n        SaleClockAuctionStorage(clockAuctionStorage).recordSoldPrice(price);\n    }\n\n    function createSystemAuction(uint256 _tokenId) external {\n        require(msg.sender == address(nonFungibleContract));\n\n        createAuction(\n            _tokenId,\n            computeNextSystemSalePrice(),\n            systemEndingPrice,\n            systemAuctionDuration,\n            systemSaleAddress\n        );\n\n        SaleClockAuctionStorage(clockAuctionStorage).recordSystemOnSaleToken(_tokenId);\n    }\n\n    function setSystemSaleAddress(address _systemSaleAddress) public onlyOwner {\n        require(_systemSaleAddress != address(0));\n        systemSaleAddress = _systemSaleAddress;\n    }\n\n    function setSystemStartingPriceMin(uint256 _startingPrice) external onlyOwner {\n        require(_startingPrice == uint256(uint128(_startingPrice)));\n        systemStartingPriceMin = _startingPrice;\n    }\n\n    function setSystemEndingPrice(uint256 _endingPrice) external onlyOwner {\n        require(_endingPrice == uint256(uint128(_endingPrice)));\n        systemEndingPrice = _endingPrice;\n    }\n\n    function setSystemAuctionDuration(uint256 _duration) external onlyOwner {\n        require(_duration == uint256(uint64(_duration)));\n        systemAuctionDuration = _duration;\n    }\n\n    function totalSoldCount() external view returns (uint256) {\n        return SaleClockAuctionStorage(clockAuctionStorage).totalSoldCount();\n    }\n\n    function systemOnSaleCount() external view returns (uint256) {\n        return SaleClockAuctionStorage(clockAuctionStorage).systemOnSaleCount();\n    }\n\n    function averageSoldPrice() external view returns (uint256) {\n        return SaleClockAuctionStorage(clockAuctionStorage).averageSoldPrice();\n    }\n\n    function computeNextSystemSalePrice() public view returns (uint256) {\n        uint256 avePrice = SaleClockAuctionStorage(clockAuctionStorage).averageSoldPrice();\n\n        require(avePrice == uint256(uint128(avePrice)));\n\n        uint256 nextPrice = avePrice + (avePrice / 2);\n\n        if (nextPrice < systemStartingPriceMin) {\n            nextPrice = systemStartingPriceMin;\n        }\n\n        return nextPrice;\n    }\n}\n\ncontract SiringClockAuctionStorage is ClockAuctionStorage {\n    bool public isSiringClockAuctionStorage = true;\n}\n\ncontract SiringClockAuction is ClockAuction {\n\n    bool public isSiringClockAuction = true;\n\n    function SiringClockAuction(address _nftAddr, address _storageAddress, uint256 _cut, uint256 _minCutValue) \n        ClockAuction(_nftAddr, _storageAddress, _cut, _minCutValue) public\n    {\n        require(SiringClockAuctionStorage(_storageAddress).isSiringClockAuctionStorage());\n    }\n\n    function bid(uint256 _tokenId, address bidder) external payable {\n        // can only be called by CryptoZoo\n        require(msg.sender == address(nonFungibleContract));\n        // get seller before the _bid for the auction will be removed once the bid success\n        address seller = clockAuctionStorage.getSeller(_tokenId);\n        // _bid checks that token ID is valid and will throw if bid fails\n        _bid(_tokenId, msg.value, bidder);\n        // transfer the monster back to the seller, the winner will get the child\n        clockAuctionStorage.transfer(nonFungibleContract, seller, _tokenId);\n    }\n}\n\ncontract ZooAccessControl is HasNoContracts {\n\n    address public ceoAddress;\n    address public cfoAddress;\n    address public cooAddress;\n\n    modifier onlyCEO() {\n        require(msg.sender == ceoAddress);\n        _;\n    }\n\n    modifier onlyCFO() {\n        require(msg.sender == cfoAddress);\n        _;\n    }\n\n    modifier onlyCOO() {\n        require(msg.sender == cooAddress);\n        _;\n    }\n\n    modifier onlyCLevel() {\n        require(\n            msg.sender == cooAddress ||\n            msg.sender == ceoAddress ||\n            msg.sender == cfoAddress\n        );\n        _;\n    }\n\n    function setCEO(address _newCEO) public onlyCEO {\n        require(_newCEO != address(0));\n        ceoAddress = _newCEO;\n    }\n\n    function setCFO(address _newCFO) public onlyCEO {\n        require(_newCFO != address(0));\n        cfoAddress = _newCFO;\n    }\n    \n    function setCOO(address _newCOO) public onlyCEO {\n        require(_newCOO != address(0));\n        cooAddress = _newCOO;\n    }\n}\n\ncontract Zoo721 is ZooAccessControl, ERC721 {\n\n    // ERC721 Required\n    string public constant name = \"Giftomon\";\n    // ERC721 Required\n    string public constant symbol = \"GTOM\";\n\n    bytes4 constant InterfaceSignature_ERC165 =\n        bytes4(keccak256(\"supportsInterface(bytes4)\"));\n\n    bytes4 constant InterfaceSignature_ERC721 =\n        bytes4(keccak256('name()')) ^\n        bytes4(keccak256('symbol()')) ^\n        bytes4(keccak256('totalSupply()')) ^\n        bytes4(keccak256('balanceOf(address)')) ^\n        bytes4(keccak256('ownerOf(uint256)')) ^\n        bytes4(keccak256('approve(address,uint256)')) ^\n        bytes4(keccak256('transfer(address,uint256)')) ^\n        bytes4(keccak256('transferFrom(address,address,uint256)')) ^\n        bytes4(keccak256('tokensOfOwner(address)'));\n\n    CryptoStorage public cryptoStorage;\n\n    function Zoo721(address _storageAddress) public {\n        require(_storageAddress != address(0));\n        cryptoStorage = CryptoStorage(_storageAddress);\n    }\n\n    // ERC165 Required\n    function supportsInterface(bytes4 _interfaceID) external view returns (bool) {\n        return ((_interfaceID == InterfaceSignature_ERC165) || (_interfaceID == InterfaceSignature_ERC721));\n    }\n\n    // ERC721 Required\n    function totalSupply() public view returns (uint) {\n        return cryptoStorage.getMonsterCount();\n    }\n    \n    // ERC721 Required\n    function balanceOf(address _owner) public view returns (uint256 count) {\n        return cryptoStorage.ownershipTokenCount(_owner);\n    }\n\n    // ERC721 Required\n    function ownerOf(uint256 _tokenId) external view returns (address owner) {\n        owner = cryptoStorage.monsterIndexToOwner(_tokenId);\n        require(owner != address(0));\n    }\n\n    // ERC721 Required\n    function approve(address _to, uint256 _tokenId) external whenNotPaused {\n        require(_owns(msg.sender, _tokenId));\n        _approve(_tokenId, _to);\n        emit Approval(msg.sender, _to, _tokenId);\n    }\n\n    // ERC721 Required\n    function transfer(address _to, uint256 _tokenId) external whenNotPaused {\n        // Safety check to prevent against an unexpected 0x0 default.\n        require(_to != address(0));\n        // Not allow to transfer to the contract itself except for system sale monsters\n        require(_to != address(this));\n        // You can only send your own cat.\n        require(_owns(msg.sender, _tokenId));\n\n        // Reassign ownership, clear pending approvals, emit Transfer event.\n        _transfer(msg.sender, _to, _tokenId);\n    }\n\n    // ERC721 Required\n    function transferFrom(address _from, address _to, uint256 _tokenId) external whenNotPaused {\n        // Safety check to prevent against an unexpected 0x0 default.\n        require(_to != address(0));\n        require(_to != address(this));\n        // Check for approval and valid ownership\n        require(_approvedFor(msg.sender, _tokenId));\n        require(_owns(_from, _tokenId));\n        // Reassign ownership (also clears pending approvals and emits Transfer event).\n        _transfer(_from, _to, _tokenId);\n    }\n\n    // ERC721 Optional\n    function tokensOfOwner(address _owner) external view returns(uint256[] ownerTokens) {\n        uint256 tokenCount = balanceOf(_owner);\n\n        if (tokenCount == 0) {\n            return new uint256[](0);\n        } else {\n            uint256[] memory result = new uint256[](tokenCount);\n            uint256 totalTokens = totalSupply();\n            uint256 resultIndex = 0;\n\n            uint256 tokenId;\n\n            for (tokenId = 1; tokenId <= totalTokens; tokenId++) {\n                if (cryptoStorage.monsterIndexToOwner(tokenId) == _owner) {\n                    result[resultIndex] = tokenId;\n                    resultIndex++;\n                }\n            }\n\n            return result;\n        }\n    }\n\n    function _transfer(address _from, address _to, uint256 _tokenId) internal {\n        // increase number of token owned by _to\n        cryptoStorage.increaseOwnershipTokenCount(_to);\n\n        // transfer ownership\n        cryptoStorage.setMonsterIndexToOwner(_tokenId, _to);\n\n        // new monster born does not have previous owner\n        if (_from != address(0)) {\n            // decrease number of token owned by _from\n            cryptoStorage.decreaseOwnershipTokenCount(_from);\n            // clear any previously approved ownership exchange\n            cryptoStorage.deleteMonsterIndexToApproved(_tokenId);\n        }\n        \n        emit Transfer(_from, _to, _tokenId);\n    }\n\n    function _owns(address _claimant, uint256 _tokenId) internal view returns (bool) {\n        return cryptoStorage.monsterIndexToOwner(_tokenId) == _claimant;\n    }\n\n    function _approve(uint256 _tokenId, address _approved) internal {\n        cryptoStorage.setMonsterIndexToApproved(_tokenId, _approved);\n    }\n\n    function _approvedFor(address _claimant, uint256 _tokenId) internal view returns (bool) {\n        return cryptoStorage.monsterIndexToApproved(_tokenId) == _claimant;\n    }\n}\n\ncontract CryptoZoo is Zoo721 {\n\n    uint256 public constant SYSTEM_CREATION_LIMIT = 10000;\n\n    // new monster storage fee for the coo\n    uint256 public autoBirthFee = 2 finney;\n\n    // an approximation of currently how many seconds are in between blocks.\n    uint256 public secondsPerBlock = 15;\n\n    // hatch duration in second by hatch times (start from 0)\n    // default to 1 minute if not set and minimum to 1 minute \n    // must be an integral multiple of 1 minute\n    uint32[] public hatchDurationByTimes = [uint32(1 minutes)];\n\n    // hatch duration multiple value by generation (start from 0)\n    // multiple = value / 60, 60 is the base value\n    // default to 60 if not set and minimum to 60\n    // must be an integral multiple of secondsPerBlock\n    uint32[] public hatchDurationMultiByGeneration = [uint32(60)];\n\n    // sale auctions\n    SaleClockAuction public saleAuction;\n    \n    // siring auctions\n    SiringClockAuction public siringAuction;\n\n    // activity core\n    ActivityCore public activityCore;\n\n    // events\n    event Pregnant(address owner, uint256 matronId, uint256 sireId, uint256 matronCooldownEndBlock, uint256 sireCooldownEndBlock, uint256 breedCost);\n    event Birth(address owner, uint256 tokenId, uint256 matronId, uint256 sireId);\n\n    // Core Contract of Giftomon\n    function CryptoZoo(address _storageAddress, address _cooAddress, address _cfoAddress) Zoo721(_storageAddress) public {\n        // paused by default\n        paused = true;\n        // ceo defaults the the contract creator\n        ceoAddress = msg.sender;\n\n        setCOO(_cooAddress);\n        setCFO(_cfoAddress);\n    }\n\n    function() external payable {\n        require(\n            msg.sender == address(saleAuction) ||\n            msg.sender == address(siringAuction) ||\n            msg.sender == address(activityCore) || \n            msg.sender == cooAddress\n        );\n    }\n\n    // override to allow any CLevel to pause the contract\n    function pause() public onlyCLevel whenNotPaused {\n        super.pause();\n    }\n\n    // override to make sure everything is initialized before the unpause\n    function unpause() public onlyCEO whenPaused {\n        // can not unpause when CLevel addresses is not initialized\n        require(ceoAddress != address(0));\n        require(cooAddress != address(0));\n        require(cfoAddress != address(0));\n        // can not unpause when the logic contract is not initialzed\n        require(saleAuction != address(0));\n        require(siringAuction != address(0));\n        require(activityCore != address(0));\n        require(cryptoStorage != address(0));\n        // can not unpause when ownership of storage contract is not the current contract\n        require(cryptoStorage.owner() == address(this));\n\n        super.unpause();\n    }\n\n    // Very dangerous action, only when new contract has been proved working\n    // Requires cryptoStorage already transferOwnership to the new contract\n    // This method is only used to transfer the balance (authBirthFee used for giveBirth) to ceo\n    function destroy() external onlyCEO whenPaused {\n        address storageOwner = cryptoStorage.owner();\n        // owner of cryptoStorage must not be the current contract otherwise the cryptoStorage will forever in accessable\n        require(storageOwner != address(this));\n        // Transfers the current balance to the ceo and terminates the contract\n        selfdestruct(ceoAddress);\n    }\n\n    // Very dangerous action, only when new contract has been proved working\n    // Requires cryptoStorage already transferOwnership to the new contract\n    // This method is only used to transfer the balance (authBirthFee used for giveBirth) to the new contract\n    function destroyAndSendToStorageOwner() external onlyCEO whenPaused {\n        address storageOwner = cryptoStorage.owner();\n        // owner of cryptoStorage must not be the current contract otherwise the cryptoStorage will forever in accessable\n        require(storageOwner != address(this));\n        // Transfers the current balance to the new owner of the storage contract and terminates the contract\n        selfdestruct(storageOwner);\n    }\n\n    function setSaleAuctionAddress(address _address) external onlyCEO {\n        SaleClockAuction candidateContract = SaleClockAuction(_address);\n        require(candidateContract.isSaleClockAuction());\n        saleAuction = candidateContract;\n    }\n\n    function setSiringAuctionAddress(address _address) external onlyCEO {\n        SiringClockAuction candidateContract = SiringClockAuction(_address);\n        require(candidateContract.isSiringClockAuction());\n        siringAuction = candidateContract;\n    }\n\n    function setActivityCoreAddress(address _address) external onlyCEO {\n        ActivityCore candidateContract = ActivityCore(_address);\n        require(candidateContract.isActivityCore());\n        activityCore = candidateContract;\n    }\n\n    function withdrawBalance() external onlyCLevel {\n        uint256 balance = address(this).balance;\n        // Subtract all the currently pregnant kittens we have, plus 1 of margin.\n        uint256 subtractFees = (cryptoStorage.pregnantMonsters() + 1) * autoBirthFee;\n\n        if (balance > subtractFees) {\n            cfoAddress.transfer(balance - subtractFees);\n        }\n    }\n\n    function withdrawBalancesToNFC() external onlyCLevel {\n        saleAuction.withdrawBalance();\n        siringAuction.withdrawBalance();\n        activityCore.withdrawBalance();\n        cryptoStorage.withdrawBalance();\n    }\n\n    function withdrawBalancesToLogic() external onlyCLevel {\n        saleAuction.withdrawBalanceFromStorageContract();\n        siringAuction.withdrawBalanceFromStorageContract();\n        activityCore.withdrawBalanceFromStorageContract();\n    }\n\n    function setAutoBirthFee(uint256 val) external onlyCOO {\n        autoBirthFee = val;\n    }\n\n    function setAllHatchConfigs(\n        uint32[] _durationByTimes,\n        uint256 _secs,\n        uint32[] _multiByGeneration\n    )\n        external \n        onlyCLevel \n    {\n        setHatchDurationByTimes(_durationByTimes);\n        setSecondsPerBlock(_secs);\n        setHatchDurationMultiByGeneration(_multiByGeneration);\n    }\n\n    function setSecondsPerBlock(uint256 _secs) public onlyCLevel {\n        require(_secs < hatchDurationByTimes[0]);\n        secondsPerBlock = _secs;\n    }\n\n    // we must do a carefully check when set hatch duration configuration, since wrong value may break the whole cooldown logic\n    function setHatchDurationByTimes(uint32[] _durationByTimes) public onlyCLevel {\n        uint256 len = _durationByTimes.length;\n        // hatch duration should not be empty\n        require(len > 0);\n        // check overflow\n        require(len == uint256(uint16(len)));\n        \n        delete hatchDurationByTimes;\n        \n        uint32 value;\n        for (uint256 idx = 0; idx < len; idx++) {\n            value = _durationByTimes[idx];\n            \n            // duration must be larger than 1 minute, and must be an integral multiple of 1 minute\n            require(value >= 1 minutes && value % 1 minutes == 0);\n            \n            hatchDurationByTimes.push(value);\n        }\n    }\n    \n    function getHatchDurationByTimes() external view returns (uint32[]) {\n        return hatchDurationByTimes;\n    }\n\n    // we must do a carefully check when set hatch duration multi configuration, since wrong value may break the whole cooldown logic\n    function setHatchDurationMultiByGeneration(uint32[] _multiByGeneration) public onlyCLevel {\n        uint256 len = _multiByGeneration.length;\n        // multi configuration should not be empty\n        require(len > 0);\n        // check overflow\n        require(len == uint256(uint16(len)));\n        \n        delete hatchDurationMultiByGeneration;\n        \n        uint32 value;\n        for (uint256 idx = 0; idx < len; idx++) {\n            value = _multiByGeneration[idx];\n            \n            // multiple must be larger than 60, and must be an integral multiple of secondsPerBlock\n            require(value >= 60 && value % secondsPerBlock == 0);\n            \n            hatchDurationMultiByGeneration.push(value);\n        }\n    }\n\n    function getHatchDurationMultiByGeneration() external view returns (uint32[]) {\n        return hatchDurationMultiByGeneration;\n    }\n\n    function createPromoMonster(\n        uint32 _monsterId, \n        bytes _properties, \n        address _owner\n    )\n        public \n        onlyCOO \n        whenNotPaused \n    {\n        require(_owner != address(0));\n\n        _createMonster(\n            0, \n            0, \n            0, \n            uint64(now), \n            _monsterId, \n            _properties, \n            _owner\n        );\n\n        cryptoStorage.increasePromoCreatedCount();\n    }\n\n    function createPromoMonsterWithTokenId(\n        uint32 _monsterId, \n        bytes _properties, \n        address _owner, \n        uint256 _tokenId\n    ) \n        external \n        onlyCOO \n        whenNotPaused \n    {\n        require(_tokenId > 0 && cryptoStorage.getMonsterCount() + 1 == _tokenId);\n        \n        createPromoMonster(_monsterId, _properties, _owner);\n    }\n\n    function createSystemSaleAuction(\n        uint32 _monsterId, \n        bytes _properties, \n        uint16 _generation\n    )\n        external \n        onlyCOO\n        whenNotPaused\n    {\n        require(cryptoStorage.systemCreatedCount() < SYSTEM_CREATION_LIMIT);\n\n        uint256 tokenId = _createMonster(\n            0, \n            0, \n            _generation, \n            uint64(now), \n            _monsterId, \n            _properties, \n            saleAuction.systemSaleAddress()\n        );\n\n        _approve(tokenId, saleAuction);\n\n        saleAuction.createSystemAuction(tokenId);\n\n        cryptoStorage.increaseSystemCreatedCount();\n    }\n\n    function createSaleAuction(\n        uint256 _tokenId,\n        uint256 _startingPrice,\n        uint256 _endingPrice,\n        uint256 _duration\n    )\n        external\n        whenNotPaused\n    {\n        require(_tokenId > 0);\n        require(_owns(msg.sender, _tokenId));\n        // the monster must not pregnant othewise the birth child may owned by the the sale auction or the buyer\n        require(!isPregnant(_tokenId));\n        require(saleAuction.isValidPrice(_startingPrice, _endingPrice));\n        _approve(_tokenId, saleAuction);\n        // Sale auction throws if inputs are invalid and approve status will be reverted\n        saleAuction.createAuction(\n            _tokenId,\n            _startingPrice,\n            _endingPrice,\n            _duration,\n            msg.sender\n        );\n    }\n\n    function createSiringAuction(\n        uint256 _tokenId,\n        uint256 _startingPrice,\n        uint256 _endingPrice,\n        uint256 _duration\n    )\n        external\n        whenNotPaused\n    {\n        require(_tokenId > 0);\n        require(_owns(msg.sender, _tokenId));\n        require(isReadyToBreed(_tokenId));\n        require(siringAuction.isValidPrice(_startingPrice, _endingPrice));\n        _approve(_tokenId, siringAuction);\n        // Siring auction throws if inputs are invalid and approve status will be reverted\n        siringAuction.createAuction(\n            _tokenId,\n            _startingPrice,\n            _endingPrice,\n            _duration,\n            msg.sender\n        );\n    }\n\n    // breed with the monster siring on market\n    function bidOnSiringAuction(\n        uint256 _sireId,\n        uint256 _matronId\n    )\n        external\n        payable\n        whenNotPaused\n    {\n        require(_matronId > 0);\n        require(_owns(msg.sender, _matronId));\n        require(isReadyToBreed(_matronId));\n        require(isValidMatingPair(_matronId, _sireId));\n\n        // Define the current price of the auction.\n        uint256 currentPrice = siringAuction.getCurrentPrice(_sireId);\n        uint256 breedCost = currentPrice + autoBirthFee;\n        require(msg.value >= breedCost);\n\n        // Siring auction will throw if the bid fails.\n        siringAuction.bid.value(msg.value - autoBirthFee)(_sireId, msg.sender);\n        _breedWith(_matronId, _sireId, breedCost);\n    }\n\n    // breed with the monster of one's own\n    function breedWithAuto(uint256 _matronId, uint256 _sireId)\n        external\n        payable\n        whenNotPaused\n    {\n        // Checks for payment.\n        require(msg.value >= autoBirthFee);\n\n        // Caller must own the matron and sire\n        require(_owns(msg.sender, _matronId));\n        require(_owns(msg.sender, _sireId));\n\n        // any monster in auction will be owned by the auction contract address,\n        // so the monster must not in auction if it's owned by the msg.sender\n\n        // Make sure matron isn't pregnant, or in the middle of a siring cooldown\n        require(isReadyToBreed(_matronId));\n\n        // Make sure sire isn't pregnant, or in the middle of a siring cooldown\n        require(isReadyToBreed(_sireId));\n\n        // Test that these cats are a valid mating pair.\n        require(isValidMatingPair(_matronId, _sireId));\n\n        // All checks passed, monster gets pregnant!\n        _breedWith(_matronId, _sireId, autoBirthFee);\n    }\n\n    function giveBirth(uint256 _matronId, uint256 _monsterId, uint256 _birthTime, bytes _properties)\n        external\n        whenNotPaused\n        onlyCOO\n        returns (uint256)\n    {\n        // the matron is a valid monster\n        require(cryptoStorage.getBirthTime(_matronId) != 0);\n\n        uint256 sireId = cryptoStorage.getSiringWithId(_matronId);\n        // the matron is pregnant if and only if this field is set\n        require(sireId != 0);\n\n        // no need to check cooldown of matron or sire \n        // since giveBirth can only be called by COO\n\n        // determine higher generation of the parents\n        uint16 parentGen = cryptoStorage.getGeneration(_matronId);\n        uint16 sireGen = cryptoStorage.getGeneration(sireId);\n        if (sireGen > parentGen) parentGen = sireGen;\n\n        address owner = cryptoStorage.monsterIndexToOwner(_matronId);\n        uint256 tokenId = _createMonster(\n            _matronId, \n            sireId,\n            parentGen + 1, \n            _birthTime, \n            _monsterId, \n            _properties, \n            owner\n        );\n\n        // clear pregnant related info\n        cryptoStorage.deleteSiringWithId(_matronId);\n\n        // decrease pregnant counter.\n        cryptoStorage.decreasePregnantCounter();\n\n        // send the blockchain storage fee to the coo\n        msg.sender.transfer(autoBirthFee);\n\n        return tokenId;\n    }\n\n    function computeCooldownSeconds(uint16 _hatchTimes, uint16 _generation) public view returns (uint32) {\n        require(hatchDurationByTimes.length > 0);\n        require(hatchDurationMultiByGeneration.length > 0);\n\n        uint16 hatchTimesMax = uint16(hatchDurationByTimes.length - 1);\n        uint16 hatchTimes = (_hatchTimes > hatchTimesMax ? hatchTimesMax : _hatchTimes);\n        \n        uint16 generationMax = uint16(hatchDurationMultiByGeneration.length - 1);\n        uint16 generation = (_generation > generationMax ? generationMax : _generation);\n\n        return hatchDurationByTimes[hatchTimes] * hatchDurationMultiByGeneration[generation] / 60;\n    }\n\n    function isReadyToBreed(uint256 _tokenId) public view returns (bool) {\n        // not pregnant and not in cooldown\n        return (cryptoStorage.getSiringWithId(_tokenId) == 0) && (cryptoStorage.getCooldownEndBlock(_tokenId) <= uint64(block.number));\n    }\n\n    function isPregnant(uint256 _tokenId) public view returns (bool) {\n        // A monster is pregnant if and only if this field is set\n        return cryptoStorage.getSiringWithId(_tokenId) != 0;\n    }\n\n    function isValidMatingPair(uint256 _matronId, uint256 _sireId) public view returns (bool) {\n        // can't breed with itself!\n        if (_matronId == _sireId) {\n            return false;\n        }\n        uint32 matron_of_matron = cryptoStorage.getMatronId(_matronId);\n        uint32 sire_of_matron = cryptoStorage.getSireId(_matronId);\n        uint32 matron_of_sire = cryptoStorage.getMatronId(_sireId);\n        uint32 sire_of_sire = cryptoStorage.getSireId(_sireId);\n        // can't breed with their parents.\n        if (matron_of_matron == _sireId || sire_of_matron == _sireId) return false;\n        if (matron_of_sire == _matronId || sire_of_sire == _matronId) return false;\n        // if either cat is gen zero, they can breed without siblings check\n        if (matron_of_sire == 0 || matron_of_matron == 0) return true;\n        // can't breed with full or half siblings.\n        if (matron_of_sire == matron_of_matron || matron_of_sire == sire_of_matron) return false;\n        if (sire_of_sire == matron_of_matron || sire_of_sire == sire_of_matron) return false;    \n        return true;\n    }\n\n    function _createMonster(\n        uint256 _matronId,\n        uint256 _sireId,\n        uint256 _generation,\n        uint256 _birthTime,\n        uint256 _monsterId,\n        bytes _properties,\n        address _owner\n    )\n        internal\n        returns (uint256)\n    {\n        uint256 tokenId = cryptoStorage.createMonster(\n            _matronId,\n            _sireId,\n            _generation,\n            _birthTime,\n            _monsterId,\n            _properties\n        );\n\n        _transfer(0, _owner, tokenId);\n        \n        emit Birth(_owner, tokenId, _matronId, _sireId);\n\n        return tokenId;\n    }\n\n    function _breedWith(uint256 _matronId, uint256 _sireId, uint256 _breedCost) internal {\n        // Mark the matron as pregnant, keeping track of who the sire is.\n        cryptoStorage.setSiringWithId(_matronId, uint32(_sireId));\n\n        // Trigger the cooldown for both parents.\n        uint64 sireCooldownEndBlock = _triggerCooldown(_sireId);\n        uint64 matronCooldownEndBlock = _triggerCooldown(_matronId);\n\n        // increase pregnant counter.\n        cryptoStorage.increasePregnantCounter();\n        \n        // give birth time depends on the shorter cooldown of the two parents\n        emit Pregnant(\n            cryptoStorage.monsterIndexToOwner(_matronId),\n            _matronId,\n            _sireId,\n            matronCooldownEndBlock,\n            sireCooldownEndBlock,\n            _breedCost\n        );\n    }\n\n    // Compute an estimation of the cooldown time in blocks (based on current cooldownIndex).\n    function _triggerCooldown(uint256 _tokenId) internal returns (uint64) {\n        uint32 cooldownSeconds = computeCooldownSeconds(cryptoStorage.getCooldownIndex(_tokenId), cryptoStorage.getGeneration(_tokenId));\n        uint64 cooldownEndBlock = uint64((cooldownSeconds / secondsPerBlock) + block.number);\n        cryptoStorage.setCooldownEndBlock(_tokenId, cooldownEndBlock);\n        // increate hatch times by 1\n        cryptoStorage.setCooldownIndex(_tokenId);\n        return cooldownEndBlock;\n    }\n}",
  "bytecode": "606060409081526000805460a060020a60ff021916905566071afd498d0000600555600f60065560209051908101604052603c81526200004490600790600162000203565b506020604051908101604052603c81526200006490600890600162000203565b5034156200007157600080fd5b60405160608062003f5983398101604052808051919060200180519190602001805160008054600160a060020a03191633600160a060020a039081169190911790915590925084915081161515620000c857600080fd5b60048054600160a060020a03928316600160a060020a0319918216179091556000805460a060020a60ff021916740100000000000000000000000000000000000000001790556001805433909316929091169190911790556200013982640100000000620012566200015b82021704565b620001528164010000000062001e30620001af82021704565b505050620002e0565b60015433600160a060020a039081169116146200017757600080fd5b600160a060020a03811615156200018d57600080fd5b60038054600160a060020a031916600160a060020a0392909216919091179055565b60015433600160a060020a03908116911614620001cb57600080fd5b600160a060020a0381161515620001e157600080fd5b60028054600160a060020a031916600160a060020a0392909216919091179055565b82805482825590600052602060002090600701600890048101928215620002a75791602002820160005b838211156200027357835183826101000a81548163ffffffff021916908363ffffffff16021790555092602001926004016020816003010492830192600103026200022d565b8015620002a55782816101000a81549063ffffffff021916905560040160208160030104928301926001030262000273565b505b50620002b5929150620002b9565b5090565b620002dd91905b80821115620002b557805463ffffffff19168155600101620002c0565b90565b613c6980620002f06000396000f30060606040526004361061029a5763ffffffff60e060020a60003504166301ffc9a78114610304578063048986ae146103505780630519ce791461037f57806306fdde03146103925780630800a05f1461041c578063095ea7b31461042f5780630a0f81681461045157806314001f4c1461046457806318160ddd146104835780631862c10b146104a85780631940a936146104bb57806321717ebf146104d157806323b872dd146104e457806327d7874c1461050c5780632aed7f3f1461052b5780632ba73c151461054a5780632da4dddd14610569578063357fe12a146105985780633d7d3f5a146105cf5780633f4ba83a146105ee57806349ec7c3f146106015780634ad8c9381461062b5780634b85fd551461064a5780634c8f3562146106605780634e0a3379146106995780635663896e146106b85780635c975abb146106ce5780635fd8c710146106e15780636352211e146106f45780636fbde40d1461070a57806370a082311461072957806372db0dd314610748578063748889141461075e57806376c2c296146107ad5780637a7d4937146107c05780637b9a3a40146107d357806383197ef0146107f257806384125e0b146108055780638456cb59146108185780638462151c1461082b5780638da5cb5b1461089d57806394636cee146108b057806395d89b41146109175780639ae6303d1461092a578063a52989551461093d578063a9059cbb1461096b578063b047fb501461098d578063b0c35c05146109a0578063b5794222146109b3578063bb245283146109c6578063c547e14d146109d9578063cd7fb38c14610a28578063d3e6f49f14610a41578063e6cbe35114610a57578063ed11542014610a6a578063ed60ade614610a80578063f2fde38b14610a8e578063f7d8c88314610aad575b60095433600160a060020a03908116911614806102c55750600a5433600160a060020a039081169116145b806102de5750600b5433600160a060020a039081169116145b806102f7575060035433600160a060020a039081169116145b151561030257600080fd5b005b341561030f57600080fd5b61033c7fffffffff0000000000000000000000000000000000000000000000000000000060043516610abb565b604051901515815260200160405180910390f35b341561035b57600080fd5b610363610d10565b604051600160a060020a03909116815260200160405180910390f35b341561038a57600080fd5b610363610d1f565b341561039d57600080fd5b6103a5610d2e565b60405160208082528190810183818151815260200191508051906020019080838360005b838110156103e15780820151838201526020016103c9565b50505050905090810190601f16801561040e5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561042757600080fd5b610363610d65565b341561043a57600080fd5b610302600160a060020a0360043516602435610d74565b341561045c57600080fd5b610363610dfe565b341561046f57600080fd5b610302600160a060020a0360043516610e0d565b341561048e57600080fd5b610496610eaf565b60405190815260200160405180910390f35b34156104b357600080fd5b610302610f0d565b34156104c657600080fd5b61033c600435611060565b34156104dc57600080fd5b6103636110cf565b34156104ef57600080fd5b610302600160a060020a03600435811690602435166044356110de565b341561051757600080fd5b610302600160a060020a0360043516611165565b341561053657600080fd5b610302600160a060020a03600435166111b7565b341561055557600080fd5b610302600160a060020a0360043516611256565b341561057457600080fd5b6103026004803563ffffffff16906024803590810191013560443561ffff166112a8565b34156105a357600080fd5b6103026004803563ffffffff169060248035908101910135604435600160a060020a03166064356114b6565b34156105da57600080fd5b610302600435602435604435606435611596565b34156105f957600080fd5b6103026116ee565b341561060c57600080fd5b610496600480359060248035916044359160643590810191013561183b565b341561063657600080fd5b610302600435602435604435606435611bcd565b341561065557600080fd5b610302600435611d10565b341561066b57600080fd5b61068061ffff60043581169060243516611d30565b60405163ffffffff909116815260200160405180910390f35b34156106a457600080fd5b610302600160a060020a0360043516611e30565b34156106c357600080fd5b610302600435611e82565b34156106d957600080fd5b61033c611f14565b34156106ec57600080fd5b610302611f24565b34156106ff57600080fd5b61036360043561201f565b341561071557600080fd5b610302600160a060020a0360043516612097565b341561073457600080fd5b610496600160a060020a0360043516612139565b341561075357600080fd5b6106806004356121a8565b341561076957600080fd5b61030260046024813581810190830135806020818102016040519081016040528093929190818152602001838360200280828437509496506121e095505050505050565b34156107b857600080fd5b61049661230e565b34156107cb57600080fd5b610496612314565b34156107de57600080fd5b610302600160a060020a036004351661231a565b34156107fd57600080fd5b6103026123bc565b341561081057600080fd5b610302612479565b341561082357600080fd5b610302612609565b341561083657600080fd5b61084a600160a060020a0360043516612677565b60405160208082528190810183818151815260200191508051906020019060200280838360005b83811015610889578082015183820152602001610871565b505050509050019250505060405180910390f35b34156108a857600080fd5b6103636127a8565b34156108bb57600080fd5b6103026004803563ffffffff169060446024803590810190830135806020601f8201819004810201604051908101604052818152929190602084018383808284375094965050509235600160a060020a031692506127b7915050565b341561092257600080fd5b6103a5612874565b341561093557600080fd5b61084a6128ab565b341561094857600080fd5b610302602460048035828101929082013591813591604435908101910135612935565b341561097657600080fd5b610302600160a060020a03600435166024356129f9565b341561099857600080fd5b610363612a66565b34156109ab57600080fd5b610496612a75565b34156109be57600080fd5b610302612a7b565b34156109d157600080fd5b61084a612b36565b34156109e457600080fd5b6103026004602481358181019083013580602081810201604051908101604052809392919081815260200183836020028082843750949650612b9995505050505050565b3415610a3357600080fd5b61033c600435602435612cbf565b3415610a4c57600080fd5b61033c600435612f44565b3415610a6257600080fd5b610363613032565b3415610a7557600080fd5b610680600435613041565b61030260043560243561304f565b3415610a9957600080fd5b610302600160a060020a03600435166131a5565b610302600435602435613249565b60006040517f737570706f727473496e7465726661636528627974657334290000000000000081526019016040518091039020600160e060020a03191682600160e060020a0319161480610d0857506040517f746f6b656e734f664f776e657228616464726573732900000000000000000000815260160160405180910390206040517f7472616e7366657246726f6d28616464726573732c616464726573732c75696e81527f7432353629000000000000000000000000000000000000000000000000000000602082015260250160405180910390206040517f7472616e7366657228616464726573732c75696e743235362900000000000000815260190160405180910390206040517f617070726f766528616464726573732c75696e74323536290000000000000000815260180160405180910390206040517f6f776e65724f662875696e743235362900000000000000000000000000000000815260100160405180910390206040517f62616c616e63654f662861646472657373290000000000000000000000000000815260120160405180910390206040517f746f74616c537570706c792829000000000000000000000000000000000000008152600d0160405180910390206040517f73796d626f6c2829000000000000000000000000000000000000000000000000815260080160405180910390206040517f6e616d6528290000000000000000000000000000000000000000000000000000815260060160405180910390201818181818181818600160e060020a03191682600160e060020a031916145b90505b919050565b600b54600160a060020a031681565b600254600160a060020a031681565b60408051908101604052600881527f476966746f6d6f6e000000000000000000000000000000000000000000000000602082015281565b600454600160a060020a031681565b60005460a060020a900460ff1615610d8b57600080fd5b610d9533826132e3565b1515610da057600080fd5b610daa818361335b565b7f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925338383604051600160a060020a039384168152919092166020820152604080820192909252606001905180910390a15050565b600154600160a060020a031681565b60015460009033600160a060020a03908116911614610e2b57600080fd5b5080600160a060020a0381166376190f8f6040518163ffffffff1660e060020a028152600401602060405180830381600087803b1515610e6a57600080fd5b5af11515610e7757600080fd5b505050604051805190501515610e8c57600080fd5b600a8054600160a060020a031916600160a060020a039290921691909117905550565b600454600090600160a060020a0316639bb5d4506040518163ffffffff1660e060020a028152600401602060405180830381600087803b1515610ef157600080fd5b5af11515610efe57600080fd5b50505060405180519150505b90565b60035433600160a060020a0390811691161480610f38575060015433600160a060020a039081169116145b80610f51575060025433600160a060020a039081169116145b1515610f5c57600080fd5b600954600160a060020a031663ba6763ce6040518163ffffffff1660e060020a028152600401602060405180830381600087803b1515610f9b57600080fd5b5af11515610fa857600080fd5b50505060405180515050600a54600160a060020a031663ba6763ce6040518163ffffffff1660e060020a028152600401602060405180830381600087803b1515610ff157600080fd5b5af11515610ffe57600080fd5b50505060405180515050600b54600160a060020a031663ba6763ce6040518163ffffffff1660e060020a028152600401602060405180830381600087803b151561104757600080fd5b5af1151561105457600080fd5b50505060405180515050565b600454600090600160a060020a0316637b12e0748360405160e060020a63ffffffff84160281526004810191909152602401602060405180830381600087803b15156110ab57600080fd5b5af115156110b857600080fd5b505050604051805163ffffffff1615159392505050565b600a54600160a060020a031681565b60005460a060020a900460ff16156110f557600080fd5b600160a060020a038216151561110a57600080fd5b30600160a060020a031682600160a060020a03161415151561112b57600080fd5b61113533826133b2565b151561114057600080fd5b61114a83826132e3565b151561115557600080fd5b611160838383613401565b505050565b60015433600160a060020a0390811691161461118057600080fd5b600160a060020a038116151561119557600080fd5b60018054600160a060020a031916600160a060020a0392909216919091179055565b6000805433600160a060020a039081169116146111d357600080fd5b60005460a060020a900460ff1615156111eb57600080fd5b506000548190600160a060020a038083169163f2fde38b911660405160e060020a63ffffffff8416028152600160a060020a039091166004820152602401600060405180830381600087803b151561124257600080fd5b5af1151561124f57600080fd5b5050505050565b60015433600160a060020a0390811691161461127157600080fd5b600160a060020a038116151561128657600080fd5b60038054600160a060020a031916600160a060020a0392909216919091179055565b60035460009033600160a060020a039081169116146112c657600080fd5b60005460a060020a900460ff16156112dd57600080fd5b60045461271090600160a060020a031663acf1b06a6040518163ffffffff1660e060020a028152600401602060405180830381600087803b151561132057600080fd5b5af1151561132d57600080fd5b5050506040518051905010151561134357600080fd5b6113ed6000808461ffff164267ffffffffffffffff168963ffffffff1689898080601f01602080910402602001604051908101604052818152929190602084018383808284375050600954600160a060020a03169350637fb0a44592506040915050518163ffffffff1660e060020a028152600401602060405180830381600087803b15156113d157600080fd5b5af115156113de57600080fd5b505050604051805190506135e7565b600954909150611407908290600160a060020a031661335b565b600954600160a060020a0316636baa0f8e8260405160e060020a63ffffffff84160281526004810191909152602401600060405180830381600087803b151561144f57600080fd5b5af1151561145c57600080fd5b5050600454600160a060020a031690506356f1d2dc6040518163ffffffff1660e060020a028152600401600060405180830381600087803b151561149f57600080fd5b5af115156114ac57600080fd5b5050505050505050565b60035433600160a060020a039081169116146114d157600080fd5b60005460a060020a900460ff16156114e857600080fd5b60008111801561155057506004548190600160a060020a0316639bb5d4506040518163ffffffff1660e060020a028152600401602060405180830381600087803b151561153457600080fd5b5af1151561154157600080fd5b50505060405180519050600101145b151561155b57600080fd5b61124f8585858080601f0160208091040260200160405190810160405281815292919060208401838380828437508994506127b79350505050565b60005460a060020a900460ff16156115ad57600080fd5b600084116115ba57600080fd5b6115c433856132e3565b15156115cf57600080fd5b6115d884611060565b156115e257600080fd5b600954600160a060020a031663a43d76e9848460405160e060020a63ffffffff851602815260048101929092526024820152604401602060405180830381600087803b151561163057600080fd5b5af1151561163d57600080fd5b50505060405180519050151561165257600080fd5b600954611669908590600160a060020a031661335b565b600954600160a060020a03166327ebe40a858585853360405160e060020a63ffffffff88160281526004810195909552602485019390935260448401919091526064830152600160a060020a0316608482015260a401600060405180830381600087803b15156116d857600080fd5b5af115156116e557600080fd5b50505050505050565b60015433600160a060020a0390811691161461170957600080fd5b60005460a060020a900460ff16151561172157600080fd5b600154600160a060020a0316151561173857600080fd5b600354600160a060020a0316151561174f57600080fd5b600254600160a060020a0316151561176657600080fd5b600954600160a060020a0316151561177d57600080fd5b600a54600160a060020a0316151561179457600080fd5b600b54600160a060020a031615156117ab57600080fd5b600454600160a060020a031615156117c257600080fd5b600454600160a060020a033081169116638da5cb5b6040518163ffffffff1660e060020a028152600401602060405180830381600087803b151561180557600080fd5b5af1151561181257600080fd5b50505060405180519050600160a060020a031614151561183157600080fd5b611839613752565b565b600080600080600080600060149054906101000a900460ff1615151561186057600080fd5b60035433600160a060020a0390811691161461187b57600080fd5b600454600160a060020a0316634f5af7398c60405160e060020a63ffffffff84160281526004810191909152602401602060405180830381600087803b15156118c357600080fd5b5af115156118d057600080fd5b505050604051805167ffffffffffffffff16151590506118ef57600080fd5b600454600160a060020a0316637b12e0748c60405160e060020a63ffffffff84160281526004810191909152602401602060405180830381600087803b151561193757600080fd5b5af1151561194457600080fd5b505050604051805163ffffffff1695505084151561196157600080fd5b600454600160a060020a03166356e3df978c60405160e060020a63ffffffff84160281526004810191909152602401602060405180830381600087803b15156119a957600080fd5b5af115156119b657600080fd5b5050506040518051600454909550600160a060020a031690506356e3df978660405160e060020a63ffffffff84160281526004810191909152602401602060405180830381600087803b1515611a0b57600080fd5b5af11515611a1857600080fd5b5050506040518051905092508361ffff168361ffff161115611a38578293505b600454600160a060020a031663ad4b558c8c60405160e060020a63ffffffff84160281526004810191909152602401602060405180830381600087803b1515611a8057600080fd5b5af11515611a8d57600080fd5b505050604051805190509150611adf8b868660010161ffff168c8e8d8d8080601f0160208091040260200160405190810160405281815292919060208401838380828437508d94506135e79350505050565b600454909150600160a060020a031663ab7891f58c60405160e060020a63ffffffff84160281526004810191909152602401600060405180830381600087803b1515611b2a57600080fd5b5af11515611b3757600080fd5b5050600454600160a060020a0316905063503c449f6040518163ffffffff1660e060020a028152600401600060405180830381600087803b1515611b7a57600080fd5b5af11515611b8757600080fd5b50505033600160a060020a03166108fc6005549081150290604051600060405180830381858888f193505050501515611bbf57600080fd5b9a9950505050505050505050565b60005460a060020a900460ff1615611be457600080fd5b60008411611bf157600080fd5b611bfb33856132e3565b1515611c0657600080fd5b611c0f84612f44565b1515611c1a57600080fd5b600a54600160a060020a031663a43d76e9848460405160e060020a63ffffffff851602815260048101929092526024820152604401602060405180830381600087803b1515611c6857600080fd5b5af11515611c7557600080fd5b505050604051805190501515611c8a57600080fd5b600a54611ca1908590600160a060020a031661335b565b600a54600160a060020a03166327ebe40a858585853360405160e060020a63ffffffff88160281526004810195909552602485019390935260448401919091526064830152600160a060020a0316608482015260a401600060405180830381600087803b15156116d857600080fd5b60035433600160a060020a03908116911614611d2b57600080fd5b600555565b600080600080600080600780549050111515611d4b57600080fd5b60085460009011611d5b57600080fd5b60075460001901935061ffff80851690881611611d785786611d7a565b835b60085490935060001901915061ffff80831690871611611d9a5785611d9c565b815b9050603c60088261ffff16815481101515611db357fe5b90600052602060002090600891828204019190066004029054906101000a900463ffffffff1660078561ffff16815481101515611dec57fe5b90600052602060002090600891828204019190066004029054906101000a900463ffffffff160263ffffffff16811515611e2257fe5b0494505b5050505092915050565b60015433600160a060020a03908116911614611e4b57600080fd5b600160a060020a0381161515611e6057600080fd5b60028054600160a060020a031916600160a060020a0392909216919091179055565b60035433600160a060020a0390811691161480611ead575060015433600160a060020a039081169116145b80611ec6575060025433600160a060020a039081169116145b1515611ed157600080fd5b600780546000908110611ee057fe5b6000918252602090912060088204015460079091166004026101000a900463ffffffff168110611f0f57600080fd5b600655565b60005460a060020a900460ff1681565b600354600090819033600160a060020a0390811691161480611f54575060015433600160a060020a039081169116145b80611f6d575060025433600160a060020a039081169116145b1515611f7857600080fd5b600554600454600160a060020a033081163194501663c7e3ff4b6040518163ffffffff1660e060020a028152600401602060405180830381600087803b1515611fc057600080fd5b5af11515611fcd57600080fd5b505050604051805190506001010290508082111561201b57600254600160a060020a031681830380156108fc0290604051600060405180830381858888f19350505050151561201b57600080fd5b5050565b600454600090600160a060020a031663ad4b558c8360405160e060020a63ffffffff84160281526004810191909152602401602060405180830381600087803b151561206a57600080fd5b5af1151561207757600080fd5b5050506040518051915050600160a060020a0381161515610d0b57600080fd5b60015460009033600160a060020a039081169116146120b557600080fd5b5080600160a060020a0381166385b861886040518163ffffffff1660e060020a028152600401602060405180830381600087803b15156120f457600080fd5b5af1151561210157600080fd5b50505060405180519050151561211657600080fd5b60098054600160a060020a031916600160a060020a039290921691909117905550565b600454600090600160a060020a031663cec21acb8360405160e060020a63ffffffff8416028152600160a060020a039091166004820152602401602060405180830381600087803b151561218c57600080fd5b5af1151561219957600080fd5b50505060405180519392505050565b60078054829081106121b657fe5b9060005260206000209060089182820401919006600402915054906101000a900463ffffffff1681565b6003546000908190819033600160a060020a0390811691161480612212575060015433600160a060020a039081169116145b8061222b575060025433600160a060020a039081169116145b151561223657600080fd5b835192506000831161224757600080fd5b61ffff8316831461225757600080fd5b61226360086000613bb1565b5060005b828110156123085783818151811061227b57fe5b906020019060200201519150603c8263ffffffff16101580156122af57506006548263ffffffff168115156122ac57fe5b06155b15156122ba57600080fd5b60088054600181016122cc8382613bd9565b50600091825260209091206008820401805460079092166004026101000a63ffffffff8181021990931692851602919091179055600101612267565b50505050565b61271081565b60065481565b60015460009033600160a060020a0390811691161461233857600080fd5b5080600160a060020a0381166391e503146040518163ffffffff1660e060020a028152600401602060405180830381600087803b151561237757600080fd5b5af1151561238457600080fd5b50505060405180519050151561239957600080fd5b600b8054600160a060020a031916600160a060020a039290921691909117905550565b60015460009033600160a060020a039081169116146123da57600080fd5b60005460a060020a900460ff1615156123f257600080fd5b600454600160a060020a0316638da5cb5b6040518163ffffffff1660e060020a028152600401602060405180830381600087803b151561243157600080fd5b5af1151561243e57600080fd5b50505060405180519050905030600160a060020a031681600160a060020a03161415151561246b57600080fd5b600154600160a060020a0316ff5b60035433600160a060020a03908116911614806124a4575060015433600160a060020a039081169116145b806124bd575060025433600160a060020a039081169116145b15156124c857600080fd5b600954600160a060020a0316635fd8c7106040518163ffffffff1660e060020a028152600401602060405180830381600087803b151561250757600080fd5b5af1151561251457600080fd5b50505060405180515050600a54600160a060020a0316635fd8c7106040518163ffffffff1660e060020a028152600401602060405180830381600087803b151561255d57600080fd5b5af1151561256a57600080fd5b50505060405180515050600b54600160a060020a0316635fd8c7106040518163ffffffff1660e060020a028152600401602060405180830381600087803b15156125b357600080fd5b5af115156125c057600080fd5b50505060405180515050600454600160a060020a0316635fd8c7106040518163ffffffff1660e060020a028152600401602060405180830381600087803b151561104757600080fd5b60035433600160a060020a0390811691161480612634575060015433600160a060020a039081169116145b8061264d575060025433600160a060020a039081169116145b151561265857600080fd5b60005460a060020a900460ff161561266f57600080fd5b6118396137d1565b61267f613c0d565b6000612689613c0d565b600080600061269787612139565b94508415156126c75760006040518059106126af5750595b9080825280602002602001820160405250955061279e565b846040518059106126d55750595b908082528060200260200182016040525093506126f0610eaf565b925060009150600190505b82811161279a57600454600160a060020a03808916911663ad4b558c8360405160e060020a63ffffffff84160281526004810191909152602401602060405180830381600087803b151561274e57600080fd5b5af1151561275b57600080fd5b50505060405180519050600160a060020a03161415612792578084838151811061278157fe5b602090810290910101526001909101905b6001016126fb565b8395505b5050505050919050565b600054600160a060020a031681565b60035433600160a060020a039081169116146127d257600080fd5b60005460a060020a900460ff16156127e957600080fd5b600160a060020a03811615156127fe57600080fd5b61281f60008060004267ffffffffffffffff168763ffffffff1687876135e7565b50600454600160a060020a03166340ceb4516040518163ffffffff1660e060020a028152600401600060405180830381600087803b151561285f57600080fd5b5af1151561286c57600080fd5b505050505050565b60408051908101604052600481527f47544f4d00000000000000000000000000000000000000000000000000000000602082015281565b6128b3613c0d565b600780548060200260200160405190810160405280929190818152602001828054801561292b57602002820191906000526020600020906000905b82829054906101000a900463ffffffff1663ffffffff16815260200190600401906020826003010492830192600103820291508084116128ee5790505b5050505050905090565b60035433600160a060020a0390811691161480612960575060015433600160a060020a039081169116145b80612979575060025433600160a060020a039081169116145b151561298457600080fd5b6129ba85858080602002602001604051908101604052809392919081815260200183836020028082843750612b99945050505050565b6129c383611e82565b61124f828280806020026020016040519081016040528093929190818152602001838360200280828437506121e0945050505050565b60005460a060020a900460ff1615612a1057600080fd5b600160a060020a0382161515612a2557600080fd5b30600160a060020a031682600160a060020a031614151515612a4657600080fd5b612a5033826132e3565b1515612a5b57600080fd5b61201b338383613401565b600354600160a060020a031681565b60055481565b60015460009033600160a060020a03908116911614612a9957600080fd5b60005460a060020a900460ff161515612ab157600080fd5b600454600160a060020a0316638da5cb5b6040518163ffffffff1660e060020a028152600401602060405180830381600087803b1515612af057600080fd5b5af11515612afd57600080fd5b50505060405180519050905030600160a060020a031681600160a060020a031614151515612b2a57600080fd5b80600160a060020a0316ff5b612b3e613c0d565b600880548060200260200160405190810160405280929190818152602001828054801561292b576000918252602091829020805463ffffffff1684529082028301929091600491018084116128ee5790505050505050905090565b6003546000908190819033600160a060020a0390811691161480612bcb575060015433600160a060020a039081169116145b80612be4575060025433600160a060020a039081169116145b1515612bef57600080fd5b8351925060008311612c0057600080fd5b61ffff83168314612c1057600080fd5b612c1c60076000613bb1565b5060005b8281101561230857838181518110612c3457fe5b906020019060200201519150603c8263ffffffff1610158015612c665750603c63ffffffff83160663ffffffff166000145b1515612c7157600080fd5b6007805460018101612c838382613bd9565b50600091825260209091206008820401805460079092166004026101000a63ffffffff8181021990931692851602919091179055600101612c20565b600080600080600085871415612cd85760009450611e26565b600454600160a060020a031663bf2126378860405160e060020a63ffffffff84160281526004810191909152602401602060405180830381600087803b1515612d2057600080fd5b5af11515612d2d57600080fd5b5050506040518051600454909550600160a060020a0316905063a05578188860405160e060020a63ffffffff84160281526004810191909152602401602060405180830381600087803b1515612d8257600080fd5b5af11515612d8f57600080fd5b5050506040518051600454909450600160a060020a0316905063bf2126378760405160e060020a63ffffffff84160281526004810191909152602401602060405180830381600087803b1515612de457600080fd5b5af11515612df157600080fd5b5050506040518051600454909350600160a060020a0316905063a05578188760405160e060020a63ffffffff84160281526004810191909152602401602060405180830381600087803b1515612e4657600080fd5b5af11515612e5357600080fd5b505050604051805191505063ffffffff8416861480612e775750858363ffffffff16145b15612e855760009450611e26565b868263ffffffff161480612e9e5750868163ffffffff16145b15612eac5760009450611e26565b63ffffffff82161580612ec3575063ffffffff8416155b15612ed15760019450611e26565b8363ffffffff168263ffffffff161480612ef657508263ffffffff168263ffffffff16145b15612f045760009450611e26565b8363ffffffff168163ffffffff161480612f2957508263ffffffff168163ffffffff16145b15612f375760009450611e26565b5060019695505050505050565b600454600090600160a060020a0316637b12e0748360405160e060020a63ffffffff84160281526004810191909152602401602060405180830381600087803b1515612f8f57600080fd5b5af11515612f9c57600080fd5b505050604051805163ffffffff161590508015610d08575060045467ffffffffffffffff431690600160a060020a031663a5cbe71c8460405160e060020a63ffffffff84160281526004810191909152602401602060405180830381600087803b151561300857600080fd5b5af1151561301557600080fd5b5050506040518051905067ffffffffffffffff1611159050919050565b600954600160a060020a031681565b60088054829081106121b657fe5b60008054819060a060020a900460ff161561306957600080fd5b6000831161307657600080fd5b61308033846132e3565b151561308b57600080fd5b61309483612f44565b151561309f57600080fd5b6130a98385612cbf565b15156130b457600080fd5b600a54600160a060020a031663c55d0f568560405160e060020a63ffffffff84160281526004810191909152602401602060405180830381600087803b15156130fc57600080fd5b5af1151561310957600080fd5b50505060405180516005549093508301915050348190101561312a57600080fd5b600a54600554600160a060020a0390911690639f04996d903403863360405160e060020a63ffffffff86160281526004810192909252600160a060020a031660248201526044016000604051808303818588803b151561318957600080fd5b5af1151561319657600080fd5b50505050612308838583613855565b60005433600160a060020a039081169116146131c057600080fd5b600160a060020a03811615156131d557600080fd5b6000547f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e090600160a060020a031682604051600160a060020a039283168152911660208201526040908101905180910390a160008054600160a060020a031916600160a060020a0392909216919091179055565b60005460a060020a900460ff161561326057600080fd5b60055434101561326f57600080fd5b61327933836132e3565b151561328457600080fd5b61328e33826132e3565b151561329957600080fd5b6132a282612f44565b15156132ad57600080fd5b6132b681612f44565b15156132c157600080fd5b6132cb8282612cbf565b15156132d657600080fd5b61201b8282600554613855565b600454600090600160a060020a03808516911663ad4b558c8460405160e060020a63ffffffff84160281526004810191909152602401602060405180830381600087803b151561333257600080fd5b5af1151561333f57600080fd5b50505060405180519050600160a060020a031614905092915050565b600454600160a060020a03166332708966838360405160e060020a63ffffffff85160281526004810192909252600160a060020a03166024820152604401600060405180830381600087803b151561124257600080fd5b600454600090600160a060020a038085169116637d55aeea8460405160e060020a63ffffffff84160281526004810191909152602401602060405180830381600087803b151561333257600080fd5b600454600160a060020a0316636bfaa9038360405160e060020a63ffffffff8416028152600160a060020a039091166004820152602401600060405180830381600087803b151561345157600080fd5b5af1151561345e57600080fd5b5050600454600160a060020a031690506340a401d0828460405160e060020a63ffffffff85160281526004810192909252600160a060020a03166024820152604401600060405180830381600087803b15156134b957600080fd5b5af115156134c657600080fd5b505050600160a060020a0383161561359257600454600160a060020a0316631be6ce578460405160e060020a63ffffffff8416028152600160a060020a039091166004820152602401600060405180830381600087803b151561352857600080fd5b5af1151561353557600080fd5b5050600454600160a060020a0316905063a51ba5428260405160e060020a63ffffffff84160281526004810191909152602401600060405180830381600087803b151561358157600080fd5b5af1151561358e57600080fd5b5050505b7fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef838383604051600160a060020a039384168152919092166020820152604080820192909252606001905180910390a1505050565b6004546000908190600160a060020a0316638e6ddab18a8a8a8a8a8a6040518763ffffffff1660e060020a0281526004018087815260200186815260200185815260200184815260200183815260200180602001828103825283818151815260200191508051906020019080838360005b83811015613670578082015183820152602001613658565b50505050905090810190601f16801561369d5780820380516001836020036101000a031916815260200191505b50975050505050505050602060405180830381600087803b15156136c057600080fd5b5af115156136cd57600080fd5b5050506040518051905090506136e560008483613401565b7fbade1ef9a1460ef6a988ba5d64ac136f3198dfb02107b88a8aa3b851a7e4644b83828b8b6040518085600160a060020a0316600160a060020a0316815260200184815260200183815260200182815260200194505050505060405180910390a198975050505050505050565b60005433600160a060020a0390811691161461376d57600080fd5b60005460a060020a900460ff16151561378557600080fd5b6000805474ff0000000000000000000000000000000000000000191690557f7805862f689e2f13df9f062ff482ad3ad112aca9e0847911ed832e158c525b3360405160405180910390a1565b60005433600160a060020a039081169116146137ec57600080fd5b60005460a060020a900460ff161561380357600080fd5b6000805474ff0000000000000000000000000000000000000000191660a060020a1790557f6985a02210a168e66602d3235cb6db0e70f92b3ba4d376a33c0f3d9434bff62560405160405180910390a1565b6004546000908190600160a060020a031663fc906720868660405163ffffffff84811660e060020a028252600482019390935291166024820152604401600060405180830381600087803b15156138ab57600080fd5b5af115156138b857600080fd5b5050506138c4846139fa565b91506138cf856139fa565b600454909150600160a060020a031663cc57e4f86040518163ffffffff1660e060020a028152600401600060405180830381600087803b151561391157600080fd5b5af1151561391e57600080fd5b50506004547f3387f58f1cd9cb07744c5aeebf3bec262e46581cb5d5874d0e78c26502d493699150600160a060020a031663ad4b558c8760405160e060020a63ffffffff84160281526004810191909152602401602060405180830381600087803b151561398b57600080fd5b5af1151561399857600080fd5b505050604051805190508686848688604051600160a060020a039096168652602086019490945260408086019390935267ffffffffffffffff918216606086015216608084015260a083019190915260c0909101905180910390a15050505050565b60045460009081908190613ac990600160a060020a031663d6c8f93c8660405160e060020a63ffffffff84160281526004810191909152602401602060405180830381600087803b1515613a4d57600080fd5b5af11515613a5a57600080fd5b5050506040518051600454909150600160a060020a03166356e3df978760405160e060020a63ffffffff84160281526004810191909152602401602060405180830381600087803b1515613aad57600080fd5b5af11515613aba57600080fd5b50505060405180519050611d30565b9150436006548363ffffffff16811515613adf57fe5b600454919004919091019150600160a060020a0316632a804835858360405160e060020a63ffffffff8516028152600481019290925267ffffffffffffffff166024820152604401600060405180830381600087803b1515613b4057600080fd5b5af11515613b4d57600080fd5b5050600454600160a060020a03169050631f6d20868560405160e060020a63ffffffff84160281526004810191909152602401600060405180830381600087803b1515613b9957600080fd5b5af11515613ba657600080fd5b509195945050505050565b508054600082556007016008900490600052602060002090810190613bd69190613c1f565b50565b8154818355818115116111605760070160089004816007016008900483600052602060002091820191016111609190613c1f565b60206040519081016040526000815290565b610f0a91905b80821115613c395760008155600101613c25565b50905600a165627a7a7230582089a05b996e772c210bdce8d50368e03ce45be6b9218e98e59a204d16cf90542b00290000000000000000000000005e2d66856a2fc7eaf843d65721e2ea20c4e8b2330000000000000000000000000761efe3e147af93b9f5c238913baf3bf241e71b000000000000000000000000d451de0f02c4e8553babda572e4582b0c5461081",
  "constructorArguments": "0000000000000000000000005e2d66856a2fc7eaf843d65721e2ea20c4e8b2330000000000000000000000000761efe3e147af93b9f5c238913baf3bf241e71b000000000000000000000000d451de0f02c4e8553babda572e4582b0c5461081"
}