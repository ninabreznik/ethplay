{
  "address": "0xae64963f1e6aa5ab9e186c9e35947e52bb434ff3",
  "chain": "ETH",
  "chainID": 1,
  "verifier": "etherscan.io",
  "commonName": "",
  "contractName": "NescrowExchangeService",
  "compilerVersion": "v0.4.25+commit.59dbf8f1",
  "optimization": true,
  "runs": "200",
  "evmVersion": "default",
  "sourceCode": "/**\n *Submitted for verification at Etherscan.io on 2018-12-07\n*/\n\npragma solidity ^0.4.25;\n\ncontract Token {\n    function transfer(address _to, uint256 _value) public returns (bool success);\n    function approve(address _spender, uint256 _value) public returns (bool success);\n    function transferFrom(address _from, address _to, uint256 _value) public returns (bool success);\n}\n\ncontract NescrowExchangeService {\n\n    address owner = msg.sender;\n\n    uint256 public feeRateLimit = 200;//100/200 = 0.5% max fee\n    uint256 public takerFeeRate = 0;\n    uint256 public makerFeeRate = 0;\n    address public feeAddress;\n\n    mapping (address => bool) public admins;\n    mapping (bytes32 => uint256) public orderFills;\n    mapping (bytes32 => bool) public withdrawn;\n    mapping (bytes32 => bool) public transfers;\n    mapping (address => mapping (address => uint256)) public balances;\n    mapping (address => uint256) public tradesLocked;\n    mapping (address => uint256) public disableFees;\n    mapping (address => uint256) public tokenDecimals;\n    mapping (address => bool) public tokenRegistered;\n\n    struct EIP712Domain {\n        string  name;\n        string  version;\n        uint256 chainId;\n        address verifyingContract;\n    }\n\n    event Deposit(address token, address user, uint256 amount, uint256 balance);\n    event Withdraw(address token, address user, uint256 amount, uint256 balance);\n    event TradesLock(address user);\n    event TradesUnlock(address user);\n\n    modifier onlyOwner {\n        assert(msg.sender == owner);\n        _;\n    }\n\n    modifier onlyAdmin {\n        require(msg.sender == owner || admins[msg.sender]);\n        _;\n    }\n\n    bytes32 constant EIP712DOMAIN_TYPEHASH = keccak256(\"EIP712Domain(string name,string version,uint256 chainId,address verifyingContract)\");\n    bytes32 constant ORDER_TYPEHASH = keccak256(\"Order(address sell,address buy,uint256 sellAmount,uint256 buyAmount,uint256 withdrawOnTrade,uint256 sellSide,uint256 expires,uint256 nonce)\");\n    bytes32 constant ORDER_WITH_TIPS_TYPEHASH = keccak256(\"OrderWithTips(address sell,address buy,uint256 sellAmount,uint256 buyAmount,uint256 withdrawOnTrade,uint256 sellSide,uint256 expires,uint256 nonce,uint256 makerTips,uint256 takerTips)\");\n    bytes32 constant WITHDRAWAL_TYPEHASH = keccak256(\"Withdrawal(address withdrawToken,uint256 amount,uint256 nonce)\");\n    bytes32 constant TIPS_TYPEHASH = keccak256(\"Tips(address tipsToken,uint256 amount,uint256 nonce)\");\n    bytes32 constant TRANSFER_TYPEHASH = keccak256(\"Transfer(address transferToken,address to,uint256 amount,uint256 nonce)\");\n    bytes32 DOMAIN_SEPARATOR;\n\n    function domainHash(EIP712Domain eip712Domain) internal pure returns (bytes32) {\n        return keccak256(abi.encode(\n                EIP712DOMAIN_TYPEHASH,\n                keccak256(bytes(eip712Domain.name)),\n                keccak256(bytes(eip712Domain.version)),\n                eip712Domain.chainId,\n                eip712Domain.verifyingContract\n            ));\n    }\n\n    constructor() public {\n        DOMAIN_SEPARATOR = domainHash(EIP712Domain({\n            name: \"Nescrow Exchange\",\n            version: '1',\n            chainId: 1,\n            verifyingContract: this\n        }));\n\n        tokenRegistered[0x0] = true;\n        tokenDecimals[0x0] = 18;\n    }\n\n    function setOwner(address newOwner) external onlyOwner {\n        owner = newOwner;\n    }\n\n    function getOwner() public view returns (address out) {\n        return owner;\n    }\n\n    function setAdmin(address admin, bool isAdmin) external onlyOwner {\n        admins[admin] = isAdmin;\n    }\n\n    function deposit() external payable {\n        uint amount = safeDiv(msg.value, 10**10);//wei to 8 decimals\n        require(amount > 0);\n        increaseBalance(msg.sender, address(0), amount);\n    }\n\n    function depositToken(address token, uint256 amount) external {\n        require(amount > 0);\n        require(safeTransferFrom(token, msg.sender, this, toTokenAmount(token, amount)));\n        increaseBalance(msg.sender, token, amount);\n    }\n\n    function depositTokenByAdmin(address user, address token, uint256 amount)\n        external onlyAdmin {\n        require(amount > 0);\n        require(safeTransferFrom(token, user, this, toTokenAmount(token, amount)));\n        increaseBalance(user, token, amount);\n    }\n\n    function sendTips() external payable {\n        uint amount = safeDiv(msg.value, 10**10);//wei to 8 decimals\n        require(amount > 0);\n        increaseBalance(feeAddress, address(0), amount);\n    }\n\n    function transferTips(address token, uint256 amount, address fromUser, uint nonce, uint8 v, bytes32 r, bytes32 s)\n        external onlyAdmin {\n\n        require(amount > 0);\n\n        bytes32 hash = keccak256(abi.encode(TIPS_TYPEHASH, token, amount, nonce));\n        require(ecrecover(keccak256(abi.encodePacked(\"\\x19\\x01\", DOMAIN_SEPARATOR, hash)), v, r, s) == fromUser);\n\n        require(!transfers[hash]);\n        transfers[hash] = true;\n\n        require(reduceBalance(fromUser, token, amount));\n        increaseBalance(feeAddress, token, amount);\n    }\n\n    function transfer(address token, uint256 amount, address fromUser, address toUser, uint nonce, uint8 v, bytes32 r, bytes32 s)\n        external onlyAdmin {\n\n        require(amount > 0);\n\n        bytes32 hash = keccak256(abi.encode(TRANSFER_TYPEHASH, token, toUser, amount, nonce));\n        require(ecrecover(keccak256(abi.encodePacked(\"\\x19\\x01\", DOMAIN_SEPARATOR, hash)), v, r, s) == fromUser);\n        transfers[hash] = true;\n\n        require(reduceBalance(fromUser, token, amount));\n        increaseBalance(toUser, token, amount);\n    }\n\n    function withdrawByAdmin(address token, uint256 amount, address user, uint nonce, uint8 v, bytes32 r, bytes32 s)\n        external onlyAdmin {\n\n        require(amount > 0);\n        bytes32 hash = keccak256(abi.encode(WITHDRAWAL_TYPEHASH, token, amount, nonce));\n        require(ecrecover(keccak256(abi.encodePacked(\"\\x19\\x01\", DOMAIN_SEPARATOR, hash)), v, r, s) == user);\n\n        require(!withdrawn[hash]);\n        withdrawn[hash] = true;\n\n        require(reduceBalance(user, token, amount));\n        require(sendToUser(user, token, amount));\n    }\n\n    function withdraw(address token, uint256 amount) external {\n\n        require(amount > 0);\n        require(tradesLocked[msg.sender] > block.number);\n        require(reduceBalance(msg.sender, token, amount));\n\n        require(sendToUser(msg.sender, token, amount));\n        emit Withdraw(token, msg.sender, amount, balances[token][msg.sender]);\n    }\n\n    function reduceBalance(address user, address token, uint256 amount) private returns(bool) {\n        if (balances[token][user] < amount) return false;\n        balances[token][user] = safeSub(balances[token][user], amount);\n        return true;\n    }\n\n    function increaseBalanceOrWithdraw(address user, address token, uint256 amount, uint256 _withdraw) private returns(bool) {\n        if (_withdraw == 1) {\n            return sendToUser(user, token, amount);\n        } else {\n            return increaseBalance(user, token, amount);\n        }\n    }\n\n    function increaseBalance(address user, address token, uint256 amount) private returns(bool) {\n        balances[token][user] = safeAdd(balances[token][user], amount);\n        return true;\n    }\n\n    function sendToUser(address user, address token, uint256 amount) private returns(bool) {\n        if (token == address(0)) {\n            return user.send(toTokenAmount(address(0), amount));\n        } else {\n            return safeTransfer(token, user, toTokenAmount(token, amount));\n        }\n    }\n\n    function toTokenAmount(address token, uint256 amount) private view returns (uint256) {\n\n        require(tokenRegistered[token]);\n        uint256 decimals = token == address(0)\n            ? 18\n            : tokenDecimals[token];\n\n        if (decimals == 8) {\n            return amount;\n        }\n\n        if (decimals > 8) {\n            return safeMul(amount, 10**(decimals - 8));\n        } else {\n            return safeDiv(amount, 10**(8 - decimals));\n        }\n    }\n\n    function setTakerFeeRate(uint256 feeRate) external onlyAdmin {\n        require(feeRate == 0 || feeRate >= feeRateLimit);\n        takerFeeRate = feeRate;\n    }\n\n    function setMakerFeeRate(uint256 feeRate) external onlyAdmin {\n        require(feeRate == 0 || feeRate >= feeRateLimit);\n        makerFeeRate = feeRate;\n    }\n\n    function setFeeAddress(address _feeAddress) external onlyAdmin {\n        require(_feeAddress != address(0));\n        feeAddress = _feeAddress;\n    }\n\n    function disableFeesForUser(address user, uint256 timestamp) external onlyAdmin {\n        require(timestamp > block.timestamp);\n        disableFees[user] = timestamp;\n    }\n\n    function registerToken(address token, uint256 decimals) external onlyAdmin {\n        require(!tokenRegistered[token]);\n        tokenRegistered[token] = true;\n        tokenDecimals[token] = decimals;\n    }\n\n    function tradesLock(address user) external {\n        require(user == msg.sender);\n        tradesLocked[user] = block.number + 20000;\n        emit TradesLock(user);\n    }\n\n    function tradesUnlock(address user) external {\n        require(user == msg.sender);\n        tradesLocked[user] = 0;\n        emit TradesUnlock(user);\n    }\n\n    function isUserMakerFeeEnabled(address user) private view returns(bool) {\n        return makerFeeRate > 0 && disableFees[user] < block.timestamp;\n    }\n\n    function isUserTakerFeeEnabled(address user) private view returns(bool) {\n        return takerFeeRate > 0 && disableFees[user] < block.timestamp;\n    }\n\n    function calculatePrice(uint256 offerAmount, uint256 wantAmount, uint256 sellSide) private pure returns(uint256) {\n        return sellSide == 0\n            ? safeDiv(safeMul(10**8, offerAmount), wantAmount)\n            : safeDiv(safeMul(10**8, wantAmount), offerAmount);\n    }\n\n    function trade(\n        uint256[10] amounts,\n        address[4] addresses,\n        uint256[5] values,\n        bytes32[4] rs\n    ) external onlyAdmin {\n        /**\n            amounts: 0-offerAmount, 1-wantAmount, 2-orderExpires, 3-orderNonce, 4-offerAmount2, 5-wantAmount2, 6-orderExpires2, 7-orderNonce2, 8-offerAmountToFill, 9-wantAmountToFill\n            addresses: 0-maker, 1-taker, 2-offerToken, 3-wantToken\n            values: 2-withdrawMaker, 3-withdrawTaker, 4-sellSide\n        */\n        require(tradesLocked[addresses[0]] < block.number);\n        require(block.timestamp <= amounts[2]);\n        bytes32 orderHash = keccak256(abi.encode(ORDER_TYPEHASH, addresses[2], addresses[3], amounts[0], amounts[1], values[2], values[4], amounts[2], amounts[3]));\n        require(ecrecover(keccak256(abi.encodePacked(\"\\x19\\x01\", DOMAIN_SEPARATOR, orderHash)), uint8(values[0]), rs[0], rs[1]) == addresses[0]);\n        orderFills[orderHash] = safeAdd(orderFills[orderHash], amounts[8]);\n        require(orderFills[orderHash] <= amounts[0]);\n\n        require(tradesLocked[addresses[1]] < block.number);\n        require(block.timestamp <= amounts[6]);\n        bytes32 orderHash2 = keccak256(abi.encode(ORDER_TYPEHASH, addresses[3], addresses[2], amounts[4], amounts[5], values[3], values[4] == 0 ? 1 : 0, amounts[6], amounts[7]));\n        require(ecrecover(keccak256(abi.encodePacked(\"\\x19\\x01\", DOMAIN_SEPARATOR, orderHash2)), uint8(values[1]), rs[2], rs[3]) == addresses[1]);\n\n        uint256 makerPrice = calculatePrice(amounts[0], amounts[1], values[4]);\n        uint256 takerPrice = calculatePrice(amounts[4], amounts[5], values[4] == 0 ? 1 : 0);\n        require(values[4] == 0 && makerPrice >= takerPrice\n            || values[4] == 1 && makerPrice <= takerPrice);\n        require(makerPrice == calculatePrice(amounts[8], amounts[9], values[4]));\n\n        orderFills[orderHash2] = safeAdd(orderFills[orderHash2], amounts[9]);\n        require(orderFills[orderHash2] <= amounts[4]);\n\n        require(reduceBalance(addresses[0], addresses[2], amounts[8]));\n        require(reduceBalance(addresses[1], addresses[3], amounts[9]));\n\n        if (isUserMakerFeeEnabled(addresses[0])) {\n            require(increaseBalanceOrWithdraw(addresses[0], addresses[3], safeSub(amounts[9], safeDiv(amounts[9], makerFeeRate)), values[2]));\n            increaseBalance(feeAddress, addresses[3], safeDiv(amounts[9], makerFeeRate));\n        } else {\n            require(increaseBalanceOrWithdraw(addresses[0], addresses[3], amounts[9], values[2]));\n        }\n\n        if (isUserTakerFeeEnabled(addresses[1])) {\n            require(increaseBalanceOrWithdraw(addresses[1], addresses[2], safeSub(amounts[8], safeDiv(amounts[8], takerFeeRate)), values[3]));\n            increaseBalance(feeAddress, addresses[2], safeDiv(amounts[8], takerFeeRate));\n        } else {\n            require(increaseBalanceOrWithdraw(addresses[1], addresses[2], amounts[8], values[3]));\n        }\n    }\n\n    function tradeWithTips(\n        uint256[10] amounts,\n        address[4] addresses,\n        uint256[9] values,\n        bytes32[4] rs\n    ) external onlyAdmin {\n        /**\n            amounts: 0-offerAmount, 1-wantAmount, 2-orderExpires, 3-orderNonce, 4-offerAmount2, 5-wantAmount2, 6-orderExpires2, 7-orderNonce2, 8-offerAmountToFill, 9-wantAmountToFill\n            addresses: 0-maker, 1-taker, 2-offerToken, 3-wantToken\n            values: 2-withdrawMaker, 3-withdrawTaker, 4-sellSide, 5-orderMakerTips, 6-orderTakerTips, 7-orderMakerTips2, 8-orderTakerTips2\n        */\n        require(tradesLocked[addresses[0]] < block.number);\n        require(block.timestamp <= amounts[2]);\n        bytes32 orderHash = values[5] > 0 || values[6] > 0\n            ? keccak256(abi.encode(ORDER_WITH_TIPS_TYPEHASH, addresses[2], addresses[3], amounts[0], amounts[1], values[2], values[4], amounts[2], amounts[3], values[5], values[6]))\n            : keccak256(abi.encode(ORDER_TYPEHASH, addresses[2], addresses[3], amounts[0], amounts[1], values[2], values[4], amounts[2], amounts[3]));\n        require(ecrecover(keccak256(abi.encodePacked(\"\\x19\\x01\", DOMAIN_SEPARATOR, orderHash)), uint8(values[0]), rs[0], rs[1]) == addresses[0]);\n        orderFills[orderHash] = safeAdd(orderFills[orderHash], amounts[8]);\n        require(orderFills[orderHash] <= amounts[0]);\n\n        require(tradesLocked[addresses[1]] < block.number);\n        require(block.timestamp <= amounts[6]);\n        bytes32 orderHash2 = values[7] > 0 || values[8] > 0\n            ? keccak256(abi.encode(ORDER_WITH_TIPS_TYPEHASH, addresses[3], addresses[2], amounts[4], amounts[5], values[3], values[4] == 0 ? 1 : 0, amounts[6], amounts[7], values[7], values[8]))\n            : keccak256(abi.encode(ORDER_TYPEHASH, addresses[3], addresses[2], amounts[4], amounts[5], values[3], values[4] == 0 ? 1 : 0, amounts[6], amounts[7]));\n        require(ecrecover(keccak256(abi.encodePacked(\"\\x19\\x01\", DOMAIN_SEPARATOR, orderHash2)), uint8(values[1]), rs[2], rs[3]) == addresses[1]);\n\n        uint256 makerPrice = calculatePrice(amounts[0], amounts[1], values[4]);\n        uint256 takerPrice = calculatePrice(amounts[4], amounts[5], values[4] == 0 ? 1 : 0);\n        require(values[4] == 0 && makerPrice >= takerPrice\n            || values[4] == 1 && makerPrice <= takerPrice);\n        require(makerPrice == calculatePrice(amounts[8], amounts[9], values[4]));\n\n        orderFills[orderHash2] = safeAdd(orderFills[orderHash2], amounts[9]);\n        require(orderFills[orderHash2] <= amounts[4]);\n\n        require(reduceBalance(addresses[0], addresses[2], amounts[8]));\n        require(reduceBalance(addresses[1], addresses[3], amounts[9]));\n\n        if (values[5] > 0 && !isUserMakerFeeEnabled(addresses[0])) {\n            increaseBalanceOrWithdraw(addresses[0], addresses[3], safeSub(amounts[9], safeDiv(amounts[9], values[5])), values[2]);\n            increaseBalance(feeAddress, addresses[3], safeDiv(amounts[9], values[5]));\n        } else if (values[5] == 0 && isUserMakerFeeEnabled(addresses[0])) {\n            increaseBalanceOrWithdraw(addresses[0], addresses[3], safeSub(amounts[9], safeDiv(amounts[9], makerFeeRate)), values[2]);\n            increaseBalance(feeAddress, addresses[3], safeDiv(amounts[9], makerFeeRate));\n        } else if (values[5] > 0 && isUserMakerFeeEnabled(addresses[0])) {\n            increaseBalanceOrWithdraw(addresses[0], addresses[3], safeSub(amounts[9], safeAdd(safeDiv(amounts[9], values[5]), safeDiv(amounts[9], makerFeeRate))), values[2]);\n            increaseBalance(feeAddress, addresses[3], safeAdd(safeDiv(amounts[9], values[5]), safeDiv(amounts[9], makerFeeRate)));\n        } else {\n            increaseBalanceOrWithdraw(addresses[0], addresses[3], amounts[9], values[2]);\n        }\n\n        if (values[8] > 0 && !isUserTakerFeeEnabled(addresses[1])) {\n            increaseBalanceOrWithdraw(addresses[1], addresses[2], safeSub(amounts[8], safeDiv(amounts[8], values[8])), values[3]);\n            increaseBalance(feeAddress, addresses[2], safeDiv(amounts[8], values[8]));\n        } else if (values[8] == 0 && isUserTakerFeeEnabled(addresses[1])) {\n            increaseBalanceOrWithdraw(addresses[1], addresses[2], safeSub(amounts[8], safeDiv(amounts[8], takerFeeRate)), values[3]);\n            increaseBalance(feeAddress, addresses[2], safeDiv(amounts[8], takerFeeRate));\n        } else if (values[8] > 0 && isUserTakerFeeEnabled(addresses[1])) {\n            increaseBalanceOrWithdraw(addresses[1], addresses[2], safeSub(amounts[8], safeAdd(safeDiv(amounts[8], values[8]), safeDiv(amounts[8], takerFeeRate))), values[3]);\n            increaseBalance(feeAddress, addresses[2], safeAdd(safeDiv(amounts[8], values[8]), safeDiv(amounts[8], takerFeeRate)));\n        } else {\n            increaseBalanceOrWithdraw(addresses[1], addresses[2], amounts[8], values[3]);\n        }\n    }\n\n    function() public payable {\n        revert();\n    }\n\n    function safeMul(uint a, uint b) internal pure returns (uint) {\n        uint c = a * b;\n        assert(a == 0 || c / a == b);\n        return c;\n    }\n\n    function safeSub(uint a, uint b) internal pure returns (uint) {\n        assert(b <= a);\n        return a - b;\n    }\n\n    function safeAdd(uint a, uint b) internal pure returns (uint) {\n        uint c = a + b;\n        assert(c>=a && c>=b);\n        return c;\n    }\n\n    function safeDiv(uint a, uint b) internal pure returns (uint) {\n        assert(b > 0);\n        uint c = a / b;\n        assert(a == b * c + a % b);\n        return c;\n    }\n\n    function safeTransfer(\n        address token,\n        address to,\n        uint256 value)\n    private\n    returns (bool success)\n    {\n        // A transfer is successful when 'call' is successful and depending on the token:\n        // - No value is returned: we assume a revert when the transfer failed (i.e. 'call' returns false)\n        // - A single boolean is returned: this boolean needs to be true (non-zero)\n\n        // bytes4(keccak256(\"transfer(address,uint256)\")) = 0xa9059cbb\n        success = token.call(0xa9059cbb, to, value);\n        return checkReturnValue(success);\n    }\n\n    function safeTransferFrom(\n        address token,\n        address from,\n        address to,\n        uint256 value)\n    private\n    returns (bool success)\n    {\n        // A transferFrom is successful when 'call' is successful and depending on the token:\n        // - No value is returned: we assume a revert when the transfer failed (i.e. 'call' returns false)\n        // - A single boolean is returned: this boolean needs to be true (non-zero)\n\n//         bytes4(keccak256(\"transferFrom(address,address,uint256)\")) = 0x23b872dd\n        success = token.call(0x23b872dd, from, to, value);\n        return checkReturnValue(success);\n    }\n\n    function checkReturnValue(\n        bool success\n    )\n    private\n    pure\n    returns (bool)\n    {\n        // A transfer/transferFrom is successful when 'call' is successful and depending on the token:\n        // - No value is returned: we assume a revert when the transfer failed (i.e. 'call' returns false)\n        // - A single boolean is returned: this boolean needs to be true (non-zero)\n        if (success) {\n            assembly {\n                switch returndatasize()\n                // Non-standard ERC20: nothing is returned so if 'call' was successful we assume the transfer succeeded\n                case 0 {\n                    success := 1\n                }\n                // Standard ERC20: a single boolean value is returned which needs to be true\n                case 32 {\n                    returndatacopy(0, 0, 32)\n                    success := mload(0)\n                }\n                // None of the above: not successful\n                default {\n                    success := 0\n                }\n            }\n        }\n        return success;\n    }\n}",
  "bytecode": "608060405260008054600160a060020a0319163317815560c860015560028190556003553480156200003057600080fd5b506040805160c0810182526010608082019081527f4e657363726f772045786368616e67650000000000000000000000000000000060a083015281528151808301835260018082527f310000000000000000000000000000000000000000000000000000000000000060208381019190915283019190915291810191909152306060820152620000c9906401000000006200012b810204565b600e55600080527f81955a0a11e65eac625c29e8882660bae4e165a75d72780094acae8ece9a29ee805460ff19166001179055600c60205260127f13649b2456f1b42fef0f0040b3aaeabcd21a76a0f3f5defd4f583839455116e85562000318565b600060405180807f454950373132446f6d61696e28737472696e67206e616d652c737472696e672081526020017f76657273696f6e2c75696e7432353620636861696e49642c616464726573732081526020017f766572696679696e67436f6e74726163742900000000000000000000000000008152506052019050604051809103902082600001516040518082805190602001908083835b60208310620001e55780518252601f199092019160209182019101620001c4565b51815160209384036101000a6000190180199092169116179052604051919093018190038120888401518051919650945090928392508401908083835b60208310620002435780518252601f19909201916020918201910162000222565b51815160209384036101000a6000190180199092169116179052604080519290940182900382208a8501516060808d01518585019b909b5284870199909952978301526080820196909652600160a060020a0390961660a0808801919091528251808803909101815260c0909601918290525084519093849350850191508083835b60208310620002e65780518252601f199092019160209182019101620002c5565b5181516020939093036101000a6000190180199091169216919091179052604051920182900390912095945050505050565b612e1680620003286000396000f3006080604052600436106101a05763ffffffff7c0100000000000000000000000000000000000000000000000000000000600035041663020de87681146101a557806302ca5994146101bf57806308283ee2146101e357806313af40351461020a5780632d9d5ab71461022b578063338b5dea1461026557806333daaa5e146102895780633823d66c146102a15780633c64f04b146102cd57806341275358146102e5578063429b62e5146103165780634b0bddd214610337578063529ef9071461035d5780635458f0a01461037d57806360775951146103925780637428f89e146103b3578063810c0af8146103c857806384168c01146103f25780638705fcd414610413578063893d20e8146104345780638ee573ac14610449578063a2e1ce621461046a578063b1cb15ca1461048b578063bb1a733c146104ac578063c23f001f146104cc578063d0e30db0146104f3578063d3de5834146104fb578063dbf8d2fa1461051f578063e0d669d814610527578063f3fef3a314610548578063f7213db61461056c578063fcfe6af114610584578063fe4ee216146105c4575b600080fd5b3480156101b157600080fd5b506101bd6004356105fe565b005b3480156101cb57600080fd5b506101bd600160a060020a0360043516602435610650565b3480156101ef57600080fd5b506101f86106da565b60408051918252519081900360200190f35b34801561021657600080fd5b506101bd600160a060020a03600435166106e0565b34801561023757600080fd5b506101bd600160a060020a03600435811690602435906044351660643560ff6084351660a43560c435610723565b34801561027157600080fd5b506101bd600160a060020a03600435166024356109c0565b34801561029557600080fd5b506101bd6004356109fd565b3480156102ad57600080fd5b506102b9600435610a4f565b604080519115158252519081900360200190f35b3480156102d957600080fd5b506102b9600435610a64565b3480156102f157600080fd5b506102fa610a79565b60408051600160a060020a039092168252519081900360200190f35b34801561032257600080fd5b506102b9600160a060020a0360043516610a88565b34801561034357600080fd5b506101bd600160a060020a03600435166024351515610a9d565b34801561036957600080fd5b506101bd60046101446101c4610264610adc565b34801561038957600080fd5b506101f86113a0565b34801561039e57600080fd5b506101f8600160a060020a03600435166113a6565b3480156103bf57600080fd5b506101f86113b8565b3480156103d457600080fd5b506101bd600160a060020a03600435811690602435166044356113be565b3480156103fe57600080fd5b506101bd600160a060020a036004351661142a565b34801561041f57600080fd5b506101bd600160a060020a0360043516611492565b34801561044057600080fd5b506102fa611509565b34801561045557600080fd5b506101f8600160a060020a0360043516611518565b34801561047657600080fd5b506102b9600160a060020a036004351661152a565b34801561049757600080fd5b506101f8600160a060020a036004351661153f565b3480156104b857600080fd5b506101bd60046101446101c46102e4611551565b3480156104d857600080fd5b506101f8600160a060020a0360043581169060243516612117565b6101bd612134565b34801561050757600080fd5b506101bd600160a060020a0360043516602435612164565b6101bd6121bf565b34801561053357600080fd5b506101bd600160a060020a03600435166121f7565b34801561055457600080fd5b506101bd600160a060020a0360043516602435612263565b34801561057857600080fd5b506101f8600435612324565b34801561059057600080fd5b506101bd600160a060020a03600435811690602435906044358116906064351660843560ff60a4351660c43560e435612336565b3480156105d057600080fd5b506101bd600160a060020a03600435811690602435906044351660643560ff6084351660a43560c4356125db565b600054600160a060020a031633148061062657503360009081526005602052604090205460ff165b151561063157600080fd5b80158061064057506001548110155b151561064b57600080fd5b600255565b600054600160a060020a031633148061067857503360009081526005602052604090205460ff165b151561068357600080fd5b600160a060020a0382166000908152600d602052604090205460ff16156106a957600080fd5b600160a060020a039091166000908152600d60209081526040808320805460ff19166001179055600c909152902055565b60015481565b600054600160a060020a031633146106f457fe5b6000805473ffffffffffffffffffffffffffffffffffffffff1916600160a060020a0392909216919091179055565b60008054600160a060020a031633148061074c57503360009081526005602052604090205460ff165b151561075757600080fd5b6000871161076457600080fd5b604080517f5769746864726177616c2861646472657373207769746864726177546f6b656e81527f2c75696e7432353620616d6f756e742c75696e74323536206e6f6e6365290000602080830191909152825191829003603e01822082820152600160a060020a038b1682840152606082018a905260808083018990528351808403909101815260a090920192839052815191929182918401908083835b602083106108215780518252601f199092019160209182019101610802565b51815160209384036101000a600019018019909216911617905260408051929094018290038220600e5460f060020a611901028484015260228401526042808401829052855180850390910181526062909301948590528251909750600160a060020a038d16965060019550919392508291908401908083835b602083106108ba5780518252601f19909201916020918201910161089b565b51815160209384036101000a60001901801990921691161790526040805192909401829003822060008084528383018087529190915260ff8d1683860152606083018c9052608083018b9052935160a08084019750919550601f1981019492819003909101925090865af1158015610936573d6000803e3d6000fd5b50505060206040510351600160a060020a031614151561095557600080fd5b60008181526007602052604090205460ff161561097157600080fd5b6000818152600760205260409020805460ff1916600117905561099586898961286f565b15156109a057600080fd5b6109ab868989612907565b15156109b657600080fd5b5050505050505050565b600081116109cd57600080fd5b6109e28233306109dd868661296a565b612a0d565b15156109ed57600080fd5b6109f8338383612a8e565b505050565b600054600160a060020a0316331480610a2557503360009081526005602052604090205460ff165b1515610a3057600080fd5b801580610a3f57506001548110155b1515610a4a57600080fd5b600355565b60076020526000908152604090205460ff1681565b60086020526000908152604090205460ff1681565b600454600160a060020a031681565b60056020526000908152604090205460ff1681565b600054600160a060020a03163314610ab157fe5b600160a060020a03919091166000908152600560205260409020805460ff1916911515919091179055565b60008054819081908190600160a060020a0316331480610b0b57503360009081526005602052604090205460ff165b1515610b1657600080fd5b600160a060020a038735166000908152600a60205260409020544311610b3b57600080fd5b6040880135421115610b4c57600080fd5b60405180608b612ca982396040805191829003608b0182206020808401919091528a820135600160a060020a03908116848401526060808d0135909116818501528c356080808601919091528d83013560a08601528b84013560c08601528b013560e08501528c8301356101008501528c01356101208085019190915282518085039091018152610140909301918290528251929350909182918401908083835b60208310610c0c5780518252601f199092019160209182019101610bed565b5181516020939093036101000a60001901801990911692169190911790526040519201829003909120965089925060009150610c459050565b600e546040805160f060020a61190102602080830191909152602282019390935260428082018a90528251808303909101815260629091019182905280519383029490940135600160a060020a03169360019390928291908401908083835b60208310610cc35780518252601f199092019160209182019101610ca4565b51815160209384036101000a6000190180199092169116179052604080519490920184900384206000808652858301808552919091528e3560ff16858401528d3560608601528d8201356080860152915160a08086019750919550601f19810194819003909101925090865af1158015610d41573d6000803e3d6000fd5b50505060206040510351600160a060020a0316141515610d6057600080fd5b600084815260066020526040902054610d81908960085b6020020135612abc565b600085815260066020526040902081905588351015610d9f57600080fd5b602087810135600160a060020a03166000908152600a90915260409020544311610dc857600080fd5b60c0880135421115610dd957600080fd5b60405180608b612ca982396040805191829003608b0190912091506060890135600160a060020a03908116918a0135168a6004602002013560a08c013560608b013560808c013515610e2c576000610e2f565b60015b8e600660200201358f60076040805160208181019c909c52600160a060020a039a8b1681830152989099166060890152608088019690965260a087019490945260c086019290925260ff1660e08501526101008401529084020135610120808301919091528251808303909101815261014090910191829052805190928291908401908083835b60208310610ed55780518252601f199092019160209182019101610eb6565b5181516020939093036101000a60001901801990911692169190911790526040519201829003909120955089925060019150610f0e9050565b600e546040805160f060020a61190102602080830191909152602282019390935260428082018990528251808303909101815260629091019182905280519383029490940135600160a060020a03169360019390928291908401908083835b60208310610f8c5780518252601f199092019160209182019101610f6d565b51815160209384036101000a6000190180199092169116179052604080519490920184900384206000808652858301808552919091528e82013560ff16858401528d8301356060808701919091528e01356080860152915160a08086019750919550601f19810194819003909101925090865af1158015611011573d6000803e3d6000fd5b50505060206040510351600160a060020a031614151561103057600080fd5b61104c88358960015b60200201358860045b6020020135612ad9565b915061107b608089013560a08a01358860045b602002013515611070576000611073565b60015b60ff16612ad9565b9050608086013515801561108f5750808210155b806110a95750600160808701351480156110a95750808211155b15156110b457600080fd5b6110c5610100890135896009611039565b82146110d057600080fd5b6000838152600660205260409020546110eb90896009610d77565b60008481526006602052604090208190556080890135101561110c57600080fd5b6111578760005b6020020135600160a060020a031688600260048110151561113057fe5b6020020135600160a060020a03168a6008600a8110151561114d57fe5b602002013561286f565b151561116257600080fd5b6111a38760015b6020020135600160a060020a031688600360048110151561118657fe5b6020020135600160a060020a03168a6009600a8110151561114d57fe5b15156111ae57600080fd5b6111c88760005b6020020135600160a060020a0316612b14565b1561126057611216600160a060020a03883581169060608a0135166112088b60095b60200201356112038d60095b6020020135600354612b44565b612b78565b8960025b6020020135612b8a565b151561122157600080fd5b60045461125a90600160a060020a03168860035b6020020135600160a060020a03166112558b6009600a811015156111f657fe5b612a8e565b506112a7565b61129c600160a060020a038835168860035b6020020135600160a060020a03168a6009600a8110151561128f57fe5b602002013589600261120c565b15156112a757600080fd5b6112c18760015b6020020135600160a060020a0316612bb2565b156113615761131c600160a060020a036020890135168860025b6020020135600160a060020a03166113148b6008600a811015156112fb57fe5b60200201356112038d60085b6020020135600254612b44565b89600361120c565b151561132757600080fd5b60045461135b90600160a060020a03168860025b6020020135600160a060020a03166112558b6008600a8110151561130757fe5b506109b6565b6109ab600160a060020a036020890135168860025b6020020135600160a060020a03168a6008600a8110151561139357fe5b602002013589600361120c565b60025481565b600b6020526000908152604090205481565b60035481565b600054600160a060020a03163314806113e657503360009081526005602052604090205460ff165b15156113f157600080fd5b600081116113fe57600080fd5b61140e8284306109dd868661296a565b151561141957600080fd5b611424838383612a8e565b50505050565b600160a060020a038116331461143f57600080fd5b600160a060020a0381166000818152600a6020908152604080832092909255815192835290517f74a13841820d13a9c7be42f0cb24857476222aed887fc6ef0455c4f54e04633f9281900390910190a150565b600054600160a060020a03163314806114ba57503360009081526005602052604090205460ff165b15156114c557600080fd5b600160a060020a03811615156114da57600080fd5b6004805473ffffffffffffffffffffffffffffffffffffffff1916600160a060020a0392909216919091179055565b600054600160a060020a031690565b600c6020526000908152604090205481565b600d6020526000908152604090205460ff1681565b600a6020526000908152604090205481565b60008054819081908190600160a060020a031633148061158057503360009081526005602052604090205460ff165b151561158b57600080fd5b600160a060020a038735166000908152600a602052604090205443116115b057600080fd5b60408801354211156115c157600080fd5b600060a087013511806115d85750600060c0870135115b6116ce5760405180608b612ca982396040805191829003608b0182206020808401919091528a820135600160a060020a03908116848401526060808d0135909116818501528c356080808601919091528d83013560a08601528b84013560c08601528b013560e08501528c8301356101008501528c01356101208085019190915282518085039091018152610140909301918290528251929350909182918401908083835b6020831061169c5780518252601f19909201916020918201910161167d565b6001836020036101000a03801982511681845116808217855250505050505090500191505060405180910390206117d9565b6040518060b7612d348239604080519182900360b70182206020808401919091528a820135600160a060020a03908116848401526060808d0135909116818501528c356080808601919091528d83013560a0808701919091528c85013560c080880191909152918d013560e08701528e850135610100870152918e0135610120860152908b01356101408501528a01356101608085019190915282518085039091018152610180909301918290528251929350909182918401908083835b602083106117ab5780518252601f19909201916020918201910161178c565b6001836020036101000a03801982511681845116808217855250505050505090500191505060405180910390205b600e546040805160f060020a6119010260208083019190915260228201939093526042808201859052825180830390910181526062909101918290528051939750600160a060020a038b3516936001939192918291908401908083835b602083106118555780518252601f199092019160209182019101611836565b51815160209384036101000a6000190180199092169116179052604080519490920184900384206000808652858301808552919091528e3560ff16858401528d3560608601528d8201356080860152915160a08086019750919550601f19810194819003909101925090865af11580156118d3573d6000803e3d6000fd5b50505060206040510351600160a060020a03161415156118f257600080fd5b60008481526006602052604090205461190d90896008610d77565b60008581526006602052604090208190558835101561192b57600080fd5b602087810135600160a060020a03166000908152600a9091526040902054431161195457600080fd5b60c088013542111561196557600080fd5b600060e0870135118061197d57506000610100870135115b611aaf5760405180608b612ca982396040805191829003608b0190912091506060890135600160a060020a03908116918a0135168a6004602002013560a08c013560608b013560808c0135156119d45760006119d7565b60015b8e600660200201358f60076040805160208181019c909c52600160a060020a039a8b1681830152989099166060890152608088019690965260a087019490945260c086019290925260ff1660e08501526101008401529084020135610120808301919091528251808303909101815261014090910191829052805190928291908401908083835b60208310611a7d5780518252601f199092019160209182019101611a5e565b6001836020036101000a0380198251168184511680821785525050505050509050019150506040518091039020611bf7565b6040518060b7612d348239604080519182900360b70190912091506060890135600160a060020a03908116918a0135168a6004602002013560a08c013560608b013560808c013515611b02576000611b05565b60015b8e600660200201358f600760200201358e600760200201358f60086040805160208181019e909e52600160a060020a039c8d16818301529a909b1660608b015260808a019890985260a089019690965260c088019490945260ff90921660e08701526101008601526101208501526101408401529084020135610160808301919091528251808303909101815261018090910191829052805190928291908401908083835b60208310611bc95780518252601f199092019160209182019101611baa565b6001836020036101000a03801982511681845116808217855250505050505090500191505060405180910390205b600e546040805160f060020a6119010260208083019190915260228201939093526042808201859052825180830390910181526062909101918290528051939650600160a060020a03838c013516936001939192918291908401908083835b60208310611c755780518252601f199092019160209182019101611c56565b51815160209384036101000a6000190180199092169116179052604080519490920184900384206000808652858301808552919091528e82013560ff16858401528d8301356060808701919091528e01356080860152915160a08086019750919550601f19810194819003909101925090865af1158015611cfa573d6000803e3d6000fd5b50505060206040510351600160a060020a0316141515611d1957600080fd5b611d2f88358960015b6020020135886004611042565b9150611d46608089013560a08a013588600461105f565b90506080860135158015611d5a5750808210155b80611d74575060016080870135148015611d745750808211155b1515611d7f57600080fd5b611d90610100890135896009611d22565b8214611d9b57600080fd5b600083815260066020526040902054611db690896009610d77565b600084815260066020526040902081905560808901351015611dd757600080fd5b611de2876000611113565b1515611ded57600080fd5b611df8876001611169565b1515611e0357600080fd5b600060a0870135118015611e1f5750611e1d8760006111b5565b155b15611e8e57611e5d600160a060020a03883581169060608a013516611e556101208c0135611203818c60055b6020020135612b44565b89600261120c565b50600454611e8890600160a060020a039081169060608a0135166112556101208c01358a6005611e4b565b50611f93565b60a0860135158015611ea65750611ea68760006111b5565b15611ee557611ecc600160a060020a03883581169060608a013516611e558b60096111ea565b50600454611e8890600160a060020a0316886003611235565b600060a0870135118015611eff5750611eff8760006111b5565b15611f7b57611f42600160a060020a03883581169060608a013516611e556101208c0135611203611f32828d6005611e4b565b611f3d8f60096111f6565b612abc565b50600454611e8890600160a060020a039081169060608a013516611255611f706101208d01358b6005611e4b565b611f3d8d60096111f6565b611f91600160a060020a03883516886003611272565b505b6000610100870135118015611fb05750611fae8760016112ae565b155b1561200e57611fe3600160a060020a03602089013581169060408a0135166113146101008c0135611203818c6008611e4b565b5060045461135b90600160a060020a039081169060408a0135166112556101008c01358a6008611e4b565b61010086013515801561202757506120278760016112ae565b1561205e57612045600160a060020a036020890135168860026112db565b5060045461135b90600160a060020a031688600261133b565b600061010087013511801561207957506120798760016112ae565b156120f3576120ba600160a060020a03602089013581169060408a0135166113146101008c01356112036120af828d6008611e4b565b611f3d8f6008611307565b5060045461135b90600160a060020a039081169060408a0135166112556120e86101008d01358b6008611e4b565b611f3d8d6008611307565b61210c600160a060020a03602089013516886002611376565b505050505050505050565b600960209081526000928352604080842090915290825290205481565b6000612145346402540be400612b44565b90506000811161215457600080fd5b61216033600083612a8e565b5050565b600054600160a060020a031633148061218c57503360009081526005602052604090205460ff165b151561219757600080fd5b4281116121a357600080fd5b600160a060020a039091166000908152600b6020526040902055565b60006121d0346402540be400612b44565b9050600081116121df57600080fd5b60045461216090600160a060020a0316600083612a8e565b600160a060020a038116331461220c57600080fd5b600160a060020a0381166000818152600a6020908152604091829020614e2043019055815192835290517fc7ab4b6e06c18951360c4651bc514ecc3c041aae323b673d0c4421ed8a4017979281900390910190a150565b6000811161227057600080fd5b336000908152600a6020526040902054431061228b57600080fd5b61229633838361286f565b15156122a157600080fd5b6122ac338383612907565b15156122b757600080fd5b600160a060020a03821660008181526009602090815260408083203380855290835292819020548151948552918401929092528282018490526060830152517ff341246adaac6f497bc2a656f546ab9e182111d630394f0c57c710a59a2cb5679181900360800190a15050565b60066020526000908152604090205481565b60008054600160a060020a031633148061235f57503360009081526005602052604090205460ff165b151561236a57600080fd5b6000881161237757600080fd5b604080517f5472616e736665722861646472657373207472616e73666572546f6b656e2c6181527f64647265737320746f2c75696e7432353620616d6f756e742c75696e743235366020808301919091527f206e6f6e6365290000000000000000000000000000000000000000000000000082840152825191829003604701822082820152600160a060020a03808d168385015289166060830152608082018b905260a08083018990528351808403909101815260c090920192839052815191929182918401908083835b602083106124615780518252601f199092019160209182019101612442565b51815160209384036101000a600019018019909216911617905260408051929094018290038220600e5460f060020a611901028484015260228401526042808401829052855180850390910181526062909301948590528251909750600160a060020a038e16965060019550919392508291908401908083835b602083106124fa5780518252601f1990920191602091820191016124db565b51815160209384036101000a60001901801990921691161790526040805192909401829003822060008084528383018087529190915260ff8d1683860152606083018c9052608083018b9052935160a08084019750919550601f1981019492819003909101925090865af1158015612576573d6000803e3d6000fd5b50505060206040510351600160a060020a031614151561259557600080fd5b6000818152600860205260409020805460ff191660011790556125b9878a8a61286f565b15156125c457600080fd5b6125cf868a8a612a8e565b50505050505050505050565b60008054600160a060020a031633148061260457503360009081526005602052604090205460ff165b151561260f57600080fd5b6000871161261c57600080fd5b604080517f5469707328616464726573732074697073546f6b656e2c75696e74323536206181527f6d6f756e742c75696e74323536206e6f6e636529000000000000000000000000602080830191909152825191829003603401822082820152600160a060020a038b1682840152606082018a905260808083018990528351808403909101815260a090920192839052815191929182918401908083835b602083106126d95780518252601f1990920191602091820191016126ba565b51815160209384036101000a600019018019909216911617905260408051929094018290038220600e5460f060020a611901028484015260228401526042808401829052855180850390910181526062909301948590528251909750600160a060020a038d16965060019550919392508291908401908083835b602083106127725780518252601f199092019160209182019101612753565b51815160209384036101000a60001901801990921691161790526040805192909401829003822060008084528383018087529190915260ff8d1683860152606083018c9052608083018b9052935160a08084019750919550601f1981019492819003909101925090865af11580156127ee573d6000803e3d6000fd5b50505060206040510351600160a060020a031614151561280d57600080fd5b60008181526008602052604090205460ff161561282957600080fd5b6000818152600860205260409020805460ff1916600117905561284d86898961286f565b151561285857600080fd5b60045461210c90600160a060020a03168989612a8e565b600160a060020a0380831660009081526009602090815260408083209387168352929052908120548211156128a657506000612900565b600160a060020a038084166000908152600960209081526040808320938816835292905220546128d69083612b78565b600160a060020a038085166000908152600960209081526040808320938916835292905220555060015b9392505050565b6000600160a060020a038316151561294f5783600160a060020a03166108fc61293160008561296a565b6040518115909202916000818181858888f193505050509050612900565b612963838561295e868661296a565b612bde565b9050612900565b600160a060020a0382166000908152600d6020526040812054819060ff16151561299357600080fd5b600160a060020a038416156129c057600160a060020a0384166000908152600c60205260409020546129c3565b60125b905080600814156129d657829150612a06565b60088111156129f6576129ef8360088303600a0a612c4c565b9150612a06565b6129ef8382600803600a0a612b44565b5092915050565b604080517f23b872dd000000000000000000000000000000000000000000000000000000008152600160a060020a03858116600483015284811660248301526044820184905291516000928716916323b872dd9160648083019286929190829003018183875af1925050509050612a8381612c6d565b90505b949350505050565b600160a060020a0380831660009081526009602090815260408083209387168352929052908120546128d690835b6000828201838110801590612ad15750828110155b151561290057fe5b60008115612afd57612af8612af26305f5e10085612c4c565b85612b44565b612a86565b612a86612b0e6305f5e10086612c4c565b84612b44565b600080600354118015612b3e5750600160a060020a0382166000908152600b602052604090205442115b92915050565b600080808311612b5057fe5b8284811515612b5b57fe5b0490508284811515612b6957fe5b06818402018414151561290057fe5b600082821115612b8457fe5b50900390565b60008160011415612ba757612ba0858585612907565b9050612a86565b612ba0858585612a8e565b600080600254118015612b3e575050600160a060020a03166000908152600b6020526040902054421190565b604080517fa9059cbb000000000000000000000000000000000000000000000000000000008152600160a060020a03848116600483015260248201849052915160009286169163a9059cbb9160448083019286929190829003018183875af1925050509050612a8681612c6d565b6000828202831580612ad15750828482811515612c6557fe5b041461290057fe5b60008115612ca4573d8015612c8d5760208114612c965760009250612ca2565b60019250612ca2565b60206000803e60005192505b505b509056004f7264657228616464726573732073656c6c2c61646472657373206275792c75696e743235362073656c6c416d6f756e742c75696e7432353620627579416d6f756e742c75696e743235362077697468647261774f6e54726164652c75696e743235362073656c6c536964652c75696e7432353620657870697265732c75696e74323536206e6f6e6365294f72646572576974685469707328616464726573732073656c6c2c61646472657373206275792c75696e743235362073656c6c416d6f756e742c75696e7432353620627579416d6f756e742c75696e743235362077697468647261774f6e54726164652c75696e743235362073656c6c536964652c75696e7432353620657870697265732c75696e74323536206e6f6e63652c75696e74323536206d616b6572546970732c75696e743235362074616b65725469707329a165627a7a72305820a942ee97f1dc9bd0324acf53c26221e1b7cf08ed9e16944213fde58e8506cfb40029"
}