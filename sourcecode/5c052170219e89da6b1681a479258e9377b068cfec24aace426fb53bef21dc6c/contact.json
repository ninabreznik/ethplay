{
  "address": "0xe97b5fd7056d38c85c5f6924461f7055588a53d9",
  "chain": "ETH",
  "chainID": 1,
  "verifier": "etherscan.io",
  "commonName": "",
  "contractName": "Clans",
  "compilerVersion": "v0.4.25+commit.59dbf8f1",
  "optimization": true,
  "runs": "200",
  "evmVersion": "default",
  "sourceCode": "/**\n *Submitted for verification at Etherscan.io on 2019-05-05\n*/\n\npragma solidity ^0.4.25;\n\n/**\n * \n * World War Goo - Competitive Idle Game\n * \n * https://ethergoo.io\n * \n */\n \n \ninterface ERC721 {\n    function totalSupply() external view returns (uint256 tokens);\n    function balanceOf(address owner) external view returns (uint256 balance);\n    function ownerOf(uint256 tokenId) external view returns (address owner);\n    function exists(uint256 tokenId) external view returns (bool tokenExists);\n    function approve(address to, uint256 tokenId) external;\n    function getApproved(uint256 tokenId) external view returns (address approvee);\n\n    function transferFrom(address from, address to, uint256 tokenId) external;\n    function tokensOf(address owner) external view returns (uint256[] tokens);\n    //function tokenByIndex(uint256 index) external view returns (uint256 token);\n\n    // Events\n    event Transfer(address from, address to, uint256 tokenId);\n    event Approval(address owner, address approved, uint256 tokenId);\n}\n\ninterface ApproveAndCallFallBack {\n    function receiveApproval(address from, uint256 tokens, address token, bytes data) external;\n}\n\n\ncontract Clans is ERC721, ApproveAndCallFallBack {\n    using SafeMath for uint256;\n\n    GooToken constant goo = GooToken(0xdf0960778c6e6597f197ed9a25f12f5d971da86c);\n    Army constant army = Army(0x98278eb74b388efd4d6fc81dd3f95b642ce53f2b);\n    WWGClanCoupons constant clanCoupons = WWGClanCoupons(0xe9fe4e530ebae235877289bd978f207ae0c8bb25); // For minting clans to initial owners (prelaunch buyers)\n\n    string public constant name = \"Goo Clan\";\n    string public constant symbol = \"GOOCLAN\";\n    uint224 numClans;\n    address owner; // Minor management\n\n    // ERC721 stuff\n    mapping (uint256 => address) public tokenOwner;\n    mapping (uint256 => address) public tokenApprovals;\n    mapping (address => uint256[]) public ownedTokens;\n    mapping(uint256 => uint256) public ownedTokensIndex;\n\n    mapping(address => UserClan) public userClan;\n    mapping(uint256 => uint224) public clanFee;\n    mapping(uint256 => uint224) public leaderFee;\n    mapping(uint256 => uint256) public clanMembers;\n    mapping(uint256 => mapping(uint256 => uint224)) public clanUpgradesOwned;\n    mapping(uint256 => uint256) public clanGoo;\n    mapping(uint256 => address) public clanToken; // i.e. BNB\n    mapping(uint256 => uint256) public baseTokenDenomination; // base value for token gains i.e. 0.000001 BNB\n    mapping(uint256 => uint256) public clanTotalArmyPower;\n\n    mapping(uint256 => uint224) public referalFee; // If invited to a clan how much % of player's divs go to referer\n    mapping(address => mapping(uint256 => address)) public clanReferer; // Address of who invited player to each clan\n\n    mapping(uint256 => Upgrade) public upgradeList;\n    mapping(address => bool) operator;\n\n    struct UserClan {\n        uint224 clanId;\n        uint32 clanJoinTime;\n    }\n\n    struct Upgrade {\n        uint256 upgradeId;\n        uint224 gooCost;\n        uint224 upgradeGain;\n        uint256 upgradeClass;\n        uint256 prerequisiteUpgrade;\n    }\n\n    // Events\n    event JoinedClan(uint256 clanId, address player, address referer);\n    event LeftClan(uint256 clanId, address player);\n\n    constructor() public {\n        owner = msg.sender;\n    }\n\n    function setOperator(address gameContract, bool isOperator) external {\n        require(msg.sender == owner);\n        operator[gameContract] = isOperator;\n    }\n\n    function totalSupply() external view returns (uint256) {\n        return numClans;\n    }\n\n    function balanceOf(address player) public view returns (uint256) {\n        return ownedTokens[player].length;\n    }\n\n    function ownerOf(uint256 clanId) external view returns (address) {\n        return tokenOwner[clanId];\n    }\n\n    function exists(uint256 clanId) public view returns (bool) {\n        return tokenOwner[clanId] != address(0);\n    }\n\n    function approve(address to, uint256 clanId) external {\n        require(tokenOwner[clanId] == msg.sender);\n        tokenApprovals[clanId] = to;\n        emit Approval(msg.sender, to, clanId);\n    }\n\n    function getApproved(uint256 clanId) external view returns (address) {\n        return tokenApprovals[clanId];\n    }\n\n    function tokensOf(address player) external view returns (uint256[] tokens) {\n         return ownedTokens[player];\n    }\n\n    function transferFrom(address from, address to, uint256 tokenId) public {\n        require(tokenApprovals[tokenId] == msg.sender || tokenOwner[tokenId] == msg.sender);\n\n        joinClanPlayer(to, uint224(tokenId), 0); // uint224 won't overflow due to tokenOwner check in removeTokenFrom()\n        removeTokenFrom(from, tokenId);\n        addTokenTo(to, tokenId);\n\n        delete tokenApprovals[tokenId]; // Clear approval\n        emit Transfer(from, to, tokenId);\n    }\n\n    function safeTransferFrom(address from, address to, uint256 tokenId) public {\n        safeTransferFrom(from, to, tokenId, \"\");\n    }\n\n    function safeTransferFrom(address from, address to, uint256 tokenId, bytes memory data) public {\n        transferFrom(from, to, tokenId);\n        checkERC721Recieved(from, to, tokenId, data);\n    }\n\n    function checkERC721Recieved(address from, address to, uint256 tokenId, bytes memory data) internal {\n        uint256 size;\n        assembly { size := extcodesize(to) }\n        if (size > 0) { // Recipient is contract so must confirm recipt\n            bytes4 successfullyRecieved = ERC721Receiver(to).onERC721Received(msg.sender, from, tokenId, data);\n            require(successfullyRecieved == bytes4(keccak256(\"onERC721Received(address,address,uint256,bytes)\")));\n        }\n    }\n\n    function removeTokenFrom(address from, uint256 tokenId) internal {\n        require(tokenOwner[tokenId] == from);\n        tokenOwner[tokenId] = address(0);\n\n        uint256 tokenIndex = ownedTokensIndex[tokenId];\n        uint256 lastTokenIndex = ownedTokens[from].length.sub(1);\n        uint256 lastToken = ownedTokens[from][lastTokenIndex];\n\n        ownedTokens[from][tokenIndex] = lastToken;\n        ownedTokens[from][lastTokenIndex] = 0;\n\n        ownedTokens[from].length--;\n        ownedTokensIndex[tokenId] = 0;\n        ownedTokensIndex[lastToken] = tokenIndex;\n    }\n\n    function addTokenTo(address to, uint256 tokenId) internal {\n        require(ownedTokens[to].length == 0); // Can't own multiple clans\n        tokenOwner[tokenId] = to;\n        ownedTokensIndex[tokenId] = ownedTokens[to].length;\n        ownedTokens[to].push(tokenId);\n    }\n\n    function updateClanFees(uint224 newClanFee, uint224 newLeaderFee, uint224 newReferalFee, uint256 clanId) external {\n        require(msg.sender == tokenOwner[clanId]);\n        require(newClanFee <= 25); // 25% max fee\n        require(newReferalFee <= 10); // 10% max refs\n        require(newLeaderFee <= newClanFee); // Clan gets fair cut\n        clanFee[clanId] = newClanFee;\n        leaderFee[clanId] = newLeaderFee;\n        referalFee[clanId] = newReferalFee;\n    }\n\n    function getPlayerFees(address player) external view returns (uint224 clansFee, uint224 leadersFee, address leader, uint224 referalsFee, address referer) {\n        uint256 usersClan = userClan[player].clanId;\n        clansFee = clanFee[usersClan];\n        leadersFee = leaderFee[usersClan];\n        leader = tokenOwner[usersClan];\n        referalsFee = referalFee[usersClan];\n        referer = clanReferer[player][usersClan];\n    }\n\n    function getPlayersClanUpgrade(address player, uint256 upgradeClass) external view returns (uint224 upgradeGain) {\n        upgradeGain = upgradeList[clanUpgradesOwned[userClan[player].clanId][upgradeClass]].upgradeGain;\n    }\n\n    function getClanUpgrade(uint256 clanId, uint256 upgradeClass) external view returns (uint224 upgradeGain) {\n        upgradeGain = upgradeList[clanUpgradesOwned[clanId][upgradeClass]].upgradeGain;\n    }\n\n    // Convienence function\n    function getClanDetailsForAttack(address player, address target) external view returns (uint256 clanId, uint256 targetClanId, uint224 playerLootingBonus) {\n        clanId = userClan[player].clanId;\n        targetClanId = userClan[target].clanId;\n        playerLootingBonus = upgradeList[clanUpgradesOwned[clanId][3]].upgradeGain; // class 3 = looting bonus\n    }\n\n    function joinClan(uint224 clanId, address referer) external {\n        require(exists(clanId));\n        joinClanPlayer(msg.sender, clanId, referer);\n    }\n\n    // Allows smarter invites/referals in future\n    function joinClanFromInvite(address player, uint224 clanId, address referer) external {\n        require(operator[msg.sender]);\n        joinClanPlayer(player, clanId, referer);\n    }\n\n    function joinClanPlayer(address player, uint224 clanId, address referer) internal {\n        require(ownedTokens[player].length == 0); // Owners can't join\n\n        (uint80 attack, uint80 defense,) = army.getArmyPower(player);\n\n        // Leave old clan\n        UserClan memory existingClan = userClan[player];\n        if (existingClan.clanId > 0) {\n            clanMembers[existingClan.clanId]--;\n            clanTotalArmyPower[existingClan.clanId] -= (attack + defense);\n            emit LeftClan(existingClan.clanId, player);\n        }\n\n        if (referer != address(0) && referer != player) {\n            require(userClan[referer].clanId == clanId);\n            clanReferer[player][clanId] = referer;\n        }\n\n        existingClan.clanId = clanId;\n        existingClan.clanJoinTime = uint32(now);\n\n        clanMembers[clanId]++;\n        clanTotalArmyPower[clanId] += (attack + defense);\n        userClan[player] = existingClan;\n        emit JoinedClan(clanId, player, referer);\n    }\n\n    function leaveClan() external {\n        require(ownedTokens[msg.sender].length == 0); // Owners can't leave\n\n        UserClan memory usersClan = userClan[msg.sender];\n        require(usersClan.clanId > 0);\n\n        (uint80 attack, uint80 defense,) = army.getArmyPower(msg.sender);\n        clanTotalArmyPower[usersClan.clanId] -= (attack + defense);\n\n        clanMembers[usersClan.clanId]--;\n        delete userClan[msg.sender];\n        emit LeftClan(usersClan.clanId, msg.sender);\n\n        // Cannot leave if player has unclaimed divs (edge case for clan fee abuse)\n        require(attack + defense == 0 || army.lastWarFundClaim(msg.sender) == army.getSnapshotDay());\n        require(usersClan.clanJoinTime + 24 hours < now);\n    }\n\n    function mintClan(address recipient, uint224 referalPercent, address clanTokenAddress, uint256 baseTokenReward) external {\n        require(operator[msg.sender]);\n        require(ERC20(clanTokenAddress).totalSupply() > 0);\n\n        numClans++;\n        uint224 clanId = numClans; // Starts from clanId 1\n\n        // Add recipient to clan\n        joinClanPlayer(recipient, clanId, 0);\n\n        require(tokenOwner[clanId] == address(0));\n        addTokenTo(recipient, clanId);\n        emit Transfer(address(0), recipient, clanId);\n\n        // Store clan token\n        clanToken[clanId] = clanTokenAddress;\n        baseTokenDenomination[clanId] = baseTokenReward;\n        referalFee[clanId] = referalPercent;\n\n        // Burn clan coupons from owner (prelaunch event)\n        if (clanCoupons.totalSupply() > 0) {\n            clanCoupons.burnCoupon(recipient, clanId);\n        }\n    }\n\n    function addUpgrade(uint256 id, uint224 gooCost, uint224 upgradeGain, uint256 upgradeClass, uint256 prereq) external {\n        require(operator[msg.sender]);\n        upgradeList[id] = Upgrade(id, gooCost, upgradeGain, upgradeClass, prereq);\n    }\n\n    // Incase an existing token becomes invalid (i.e. migrates away)\n    function updateClanToken(uint256 clanId, address newClanToken, bool shouldRetrieveOldTokens) external {\n        require(msg.sender == owner);\n        require(ERC20(newClanToken).totalSupply() > 0);\n\n        if (shouldRetrieveOldTokens) {\n            ERC20(clanToken[clanId]).transferFrom(this, owner, ERC20(clanToken[clanId]).balanceOf(this));\n        }\n\n        clanToken[clanId] = newClanToken;\n    }\n\n    // Incase need to tweak/balance attacking rewards (i.e. token moons so not viable to restock at current level)\n    function updateClanTokenGain(uint256 clanId, uint256 baseTokenReward) external {\n        require(msg.sender == owner);\n        baseTokenDenomination[clanId] = baseTokenReward;\n    }\n\n\n    // Clan member goo deposits\n    function receiveApproval(address player, uint256 amount, address, bytes) external {\n        uint256 clanId = userClan[player].clanId;\n        require(exists(clanId));\n        require(msg.sender == address(goo));\n\n        ERC20(msg.sender).transferFrom(player, address(0), amount);\n        clanGoo[clanId] += amount;\n    }\n\n    function buyUpgrade(uint224 upgradeId) external {\n        uint256 clanId = userClan[msg.sender].clanId;\n        require(msg.sender == tokenOwner[clanId]);\n\n        Upgrade memory upgrade = upgradeList[upgradeId];\n        require (upgrade.upgradeId > 0); // Valid upgrade\n\n        uint256 upgradeClass = upgrade.upgradeClass;\n        uint256 latestOwned = clanUpgradesOwned[clanId][upgradeClass];\n        require(latestOwned < upgradeId); // Haven't already purchased\n        require(latestOwned >= upgrade.prerequisiteUpgrade); // Own prequisite\n\n        // Clan discount\n        uint224 upgradeDiscount = clanUpgradesOwned[clanId][0]; // class 0 = upgrade discount\n        uint224 reducedUpgradeCost = upgrade.gooCost - ((upgrade.gooCost * upgradeDiscount) / 100);\n\n        clanGoo[clanId] = clanGoo[clanId].sub(reducedUpgradeCost);\n        army.depositSpentGoo(reducedUpgradeCost); // Transfer to goo bankroll\n\n        clanUpgradesOwned[clanId][upgradeClass] = upgradeId;\n    }\n\n    // Goo from divs etc.\n    function depositGoo(uint256 amount, uint256 clanId) external {\n        require(operator[msg.sender]);\n        require(exists(clanId));\n        clanGoo[clanId] += amount;\n    }\n\n\n    function increaseClanPower(address player, uint256 amount) external {\n        require(operator[msg.sender]);\n\n        uint256 clanId = userClan[player].clanId;\n        if (clanId > 0) {\n            clanTotalArmyPower[clanId] += amount;\n        }\n    }\n\n    function decreaseClanPower(address player, uint256 amount) external {\n        require(operator[msg.sender]);\n\n        uint256 clanId = userClan[player].clanId;\n        if (clanId > 0) {\n            clanTotalArmyPower[clanId] -= amount;\n        }\n    }\n\n\n    function stealGoo(address attacker, uint256 playerClanId, uint256 enemyClanId, uint80 lootingPower) external returns(uint256) {\n        require(operator[msg.sender]);\n\n        uint224 enemyGoo = uint224(clanGoo[enemyClanId]);\n        uint224 enemyGooStolen = (lootingPower > enemyGoo) ? enemyGoo : lootingPower;\n\n        clanGoo[enemyClanId] = clanGoo[enemyClanId].sub(enemyGooStolen);\n\n        uint224 clansShare = (enemyGooStolen * clanFee[playerClanId]) / 100;\n        uint224 referersFee = referalFee[playerClanId];\n        address referer = clanReferer[attacker][playerClanId];\n\n        if (clansShare > 0 || (referersFee > 0 && referer != address(0))) {\n            uint224 leaderShare = (enemyGooStolen * leaderFee[playerClanId]) / 100;\n\n            uint224 refsShare;\n            if (referer != address(0)) {\n                refsShare = (enemyGooStolen * referersFee) / 100;\n                goo.mintGoo(refsShare, referer);\n            }\n\n            clanGoo[playerClanId] += clansShare;\n            goo.mintGoo(leaderShare, tokenOwner[playerClanId]);\n            goo.mintGoo(enemyGooStolen - (clansShare + leaderShare + refsShare), attacker);\n        } else {\n            goo.mintGoo(enemyGooStolen, attacker);\n        }\n        return enemyGooStolen;\n    }\n\n\n    function rewardTokens(address attacker, uint256 playerClanId, uint80 lootingPower) external returns(uint256) {\n        require(operator[msg.sender]);\n\n        uint256 amount = baseTokenDenomination[playerClanId] * lootingPower;\n        ERC20(clanToken[playerClanId]).transfer(attacker, amount);\n        return amount;\n\n    }\n\n    // Daily clan dividends\n    function mintGoo(address player, uint256 amount) external {\n        require(operator[msg.sender]);\n        clanGoo[userClan[player].clanId] += amount;\n    }\n\n}\n\ncontract ERC20 {\n    function transferFrom(address from, address to, uint tokens) external returns (bool success);\n    function transfer(address to, uint tokens) external returns (bool success);\n    function totalSupply() external constant returns (uint);\n    function balanceOf(address tokenOwner) external constant returns (uint balance);\n}\n\ncontract GooToken {\n    function mintGoo(uint224 amount, address player) external;\n    function updatePlayersGooFromPurchase(address player, uint224 purchaseCost) external;\n}\n\ncontract Army {\n    mapping(address => uint256) public lastWarFundClaim; // Days (snapshot number)\n    function depositSpentGoo(uint224 amount) external;\n    function getArmyPower(address player) external view returns (uint80, uint80, uint80);\n    function getSnapshotDay() external view returns (uint256 snapshot);\n}\n\ncontract WWGClanCoupons {\n    function totalSupply() external view returns (uint256);\n    function burnCoupon(address clanOwner, uint256 tokenId) external;\n}\n\ncontract ERC721Receiver {\n    function onERC721Received(address operator, address from, uint256 tokenId, bytes data) external returns(bytes4);\n}\n\n\n\n\n\n\n\n\n\nlibrary SafeMath {\n\n  /**\n  * @dev Multiplies two numbers, throws on overflow.\n  */\n  function mul(uint256 a, uint256 b) internal pure returns (uint256) {\n    if (a == 0) {\n      return 0;\n    }\n    uint256 c = a * b;\n    assert(c / a == b);\n    return c;\n  }\n\n  /**\n  * @dev Integer division of two numbers, truncating the quotient.\n  */\n  function div(uint256 a, uint256 b) internal pure returns (uint256) {\n    // assert(b > 0); // Solidity automatically throws when dividing by 0\n    uint256 c = a / b;\n    // assert(a == b * c + a % b); // There is no case in which this doesn't hold\n    return c;\n  }\n\n  /**\n  * @dev Substracts two numbers, throws on overflow (i.e. if subtrahend is greater than minuend).\n  */\n  function sub(uint256 a, uint256 b) internal pure returns (uint256) {\n    assert(b <= a);\n    return a - b;\n  }\n\n  /**\n  * @dev Adds two numbers, throws on overflow.\n  */\n  function add(uint256 a, uint256 b) internal pure returns (uint256) {\n    uint256 c = a + b;\n    assert(c >= a);\n    return c;\n  }\n}",
  "bytecode": "608060405234801561001057600080fd5b5060018054600160a060020a03191633179055612c6d806100326000396000f3006080604052600436106102375763ffffffff60e060020a60003504166306fdde03811461023c578063081812fc146102c657806309582e9b146102fa578063095ea7b31461031d5780630c3f3acb14610341578063118382ff14610378578063126ef280146103dd57806318160ddd1461042c5780631c2d6998146104535780631caaa4871461046b57806323b872dd14610483578063240f07c4146104ad57806325d32f5a146104c5578063315e857e146104dd57806342842e0e1461050d5780634defaa78146105375780634f558e791461055b5780635286cd0c14610587578063558a7297146105b45780635a3f2672146105da5780635abe455c1461064b5780635d74979e1461067457806360e8c11f1461068f5780636352211e146106a7578063646a59b3146106bf5780636551da18146106e357806370a082311461071757806370b11a351461073857806374e243671461075c57806376563560146107745780638ee99da41461078c5780638f4ffcb1146107c35780639181fa18146107fb57806395d89b411461082b5780639d32733c14610840578063a6c604421461088e578063a8be8329146108c1578063aae1aa37146108e5578063acdeb5b9146108fa578063afd15b0614610912578063b88d4fde1461095b578063b94afc50146109ca578063cd677daa146109e5578063d566c2b3146109fd578063da4fa0d814610a15578063dea7dd9814610a39578063e149f03614610a54578063e3d39e6614610a78578063f3986fef14610a90575b600080fd5b34801561024857600080fd5b50610251610ac6565b6040805160208082528351818301528351919283929083019185019080838360005b8381101561028b578181015183820152602001610273565b50505050905090810190601f1680156102b85780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b3480156102d257600080fd5b506102de600435610afd565b60408051600160a060020a039092168252519081900360200190f35b34801561030657600080fd5b5061031b600160e060020a0360043516610b18565b005b34801561032957600080fd5b5061031b600160a060020a0360043516602435610d48565b34801561034d57600080fd5b5061035c600435602435610dd9565b60408051600160e060020a039092168252519081900360200190f35b34801561038457600080fd5b50610399600160a060020a0360043516610e10565b60408051600160e060020a0396871681529486166020860152600160a060020a03938416858201529190941660608401529216608082015290519081900360a00190f35b3480156103e957600080fd5b506103f5600435610e83565b60408051958652600160e060020a039485166020870152929093168483015260608401526080830191909152519081900360a00190f35b34801561043857600080fd5b50610441610ebe565b60408051918252519081900360200190f35b34801561045f57600080fd5b506102de600435610ece565b34801561047757600080fd5b506102de600435610ee9565b34801561048f57600080fd5b5061031b600160a060020a0360043581169060243516604435610f04565b3480156104b957600080fd5b5061035c600435610fd9565b3480156104d157600080fd5b50610441600435610ff4565b3480156104e957600080fd5b5061031b600160e060020a0360043581169060243581169060443516606435611006565b34801561051957600080fd5b5061031b600160a060020a03600435811690602435166044356110c8565b34801561054357600080fd5b5061031b600160a060020a03600435166024356110e9565b34801561056757600080fd5b5061057360043561114b565b604080519115158252519081900360200190f35b34801561059357600080fd5b5061031b600160e060020a0360043516600160a060020a0360243516611168565b3480156105c057600080fd5b5061031b600160a060020a03600435166024351515611194565b3480156105e657600080fd5b506105fb600160a060020a03600435166111d6565b60408051602080825283518183015283519192839290830191858101910280838360005b8381101561063757818101518382015260200161061f565b505050509050019250505060405180910390f35b34801561065757600080fd5b5061031b600435600160a060020a03602435166044351515611242565b34801561068057600080fd5b5061031b600435602435611432565b34801561069b57600080fd5b5061044160043561147b565b3480156106b357600080fd5b506102de60043561148d565b3480156106cb57600080fd5b5061031b600160a060020a03600435166024356114a8565b3480156106ef57600080fd5b5061031b600160a060020a03600435811690600160e060020a0360243516906044351661150a565b34801561072357600080fd5b50610441600160a060020a0360043516611533565b34801561074457600080fd5b5061031b600160a060020a036004351660243561154e565b34801561076857600080fd5b506104416004356115a4565b34801561078057600080fd5b5061035c6004356115b6565b34801561079857600080fd5b5061031b600160a060020a03600435811690600160e060020a036024351690604435166064356115d1565b3480156107cf57600080fd5b5061031b60048035600160a060020a0390811691602480359260443516916064359182019101356118bc565b34801561080757600080fd5b5061031b600435600160e060020a03602435811690604435166064356084356119cd565b34801561083757600080fd5b50610251611a72565b34801561084c57600080fd5b50610867600160a060020a0360043581169060243516611aa9565b604080519384526020840192909252600160e060020a031682820152519081900360600190f35b34801561089a57600080fd5b50610441600160a060020a036004351660243569ffffffffffffffffffff60443516611b0b565b3480156108cd57600080fd5b5061035c600160a060020a0360043516602435611bf7565b3480156108f157600080fd5b5061031b611c45565b34801561090657600080fd5b506102de600435611f38565b34801561091e57600080fd5b50610933600160a060020a0360043516611f53565b60408051600160e060020a03909316835263ffffffff90911660208301528051918290030190f35b34801561096757600080fd5b50604080516020601f60643560048181013592830184900484028501840190955281845261031b94600160a060020a038135811695602480359092169560443595369560849401918190840183828082843750949750611f7d9650505050505050565b3480156109d657600080fd5b5061035c600435602435611f9a565b3480156109f157600080fd5b5061035c600435611fc0565b348015610a0957600080fd5b50610441600435611fdb565b348015610a2157600080fd5b506102de600160a060020a0360043516602435611fed565b348015610a4557600080fd5b5061031b600435602435612013565b348015610a6057600080fd5b50610441600160a060020a036004351660243561203c565b348015610a8457600080fd5b5061044160043561206c565b348015610a9c57600080fd5b50610441600160a060020a036004351660243560443569ffffffffffffffffffff6064351661207e565b60408051808201909152600881527f476f6f20436c616e000000000000000000000000000000000000000000000000602082015281565b600090815260036020526040902054600160a060020a031690565b6000610b22612bab565b33600081815260066020908152604080832054600160e060020a031680845260029092528220549094509091829182918291600160a060020a031614610b6757600080fd5b600160e060020a038088166000908152601160209081526040808320815160a081018352815480825260018301548716948201949094526002820154909516918501919091526003810154606085015260040154608084015291965010610bcd57600080fd5b60608501516000878152600a60209081526040808320848452909152902054909450600160e060020a03908116935087168310610c0957600080fd5b6080850151831015610c1a57600080fd5b50506000848152600a6020908152604080832083805282528083205486830151888552600b909352922054600160e060020a0392831692606484840282160490920391610c6f9190831663ffffffff6124f416565b6000878152600b60205260408082209290925581517f1149ef5a000000000000000000000000000000000000000000000000000000008152600160e060020a038416600482015291517398278eb74b388efd4d6fc81dd3f95b642ce53f2b92631149ef5a92602480830193919282900301818387803b158015610cf157600080fd5b505af1158015610d05573d6000803e3d6000fd5b50505060009687525050600a6020908152604080872094875293905250509091208054600160e060020a031916600160e060020a03939093169290921790915550565b600081815260026020526040902054600160a060020a03163314610d6b57600080fd5b6000818152600360209081526040918290208054600160a060020a038616600160a060020a0319909116811790915582513381529182015280820183905290517f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b9259181900360600190a15050565b6000918252600a6020908152604080842092845291815281832054600160e060020a03908116845260119091529120600201541690565b600160a060020a03908116600081815260066020908152604080832054600160e060020a03908116808552600784528285205460088552838620546002865284872054600f8752858820549888526010875285882093885292909552929094205491811696928116959384169416921690565b601160205260009081526040902080546001820154600283015460038401546004909401549293600160e060020a0392831693929091169185565b600054600160e060020a03165b90565b600c60205260009081526040902054600160a060020a031681565b600260205260009081526040902054600160a060020a031681565b600081815260036020526040902054600160a060020a0316331480610f3f5750600081815260026020526040902054600160a060020a031633145b1515610f4a57600080fd5b610f5682826000612506565b610f60838261282f565b610f6a8282612998565b6000818152600360209081526040918290208054600160a060020a03191690558151600160a060020a03868116825285169181019190915280820183905290517fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef9181900360600190a1505050565b600f60205260009081526040902054600160e060020a031681565b60096020526000908152604090205481565b600081815260026020526040902054600160a060020a0316331461102957600080fd5b6019600160e060020a038516111561104057600080fd5b600a600160e060020a038316111561105757600080fd5b600160e060020a03808516908416111561107057600080fd5b60009081526007602090815260408083208054600160e060020a03978816600160e060020a03199182161790915560088352818420805496881696821696909617909555600f90915290208054919093169116179055565b6110e48383836020604051908101604052806000815250611f7d565b505050565b3360009081526012602052604081205460ff16151561110757600080fd5b50600160a060020a038216600090815260066020526040812054600160e060020a0316908111156110e4576000818152600e60205260409020805483019055505050565b600090815260026020526040902054600160a060020a0316151590565b61117a82600160e060020a031661114b565b151561118557600080fd5b611190338383612506565b5050565b600154600160a060020a031633146111ab57600080fd5b600160a060020a03919091166000908152601260205260409020805460ff1916911515919091179055565b600160a060020a03811660009081526004602090815260409182902080548351818402810184019094528084526060939283018282801561123657602002820191906000526020600020905b815481526020019060010190808311611222575b50505050509050919050565b600154600160a060020a0316331461125957600080fd5b600082600160a060020a03166318160ddd6040518163ffffffff1660e060020a028152600401602060405180830381600087803b15801561129957600080fd5b505af11580156112ad573d6000803e3d6000fd5b505050506040513d60208110156112c357600080fd5b5051116112cf57600080fd5b8015611403576000838152600c602090815260408083205460015482517f70a0823100000000000000000000000000000000000000000000000000000000815230600482018190529351600160a060020a03938416966323b872dd96949093169387936370a082319360248082019492918390030190829087803b15801561135657600080fd5b505af115801561136a573d6000803e3d6000fd5b505050506040513d602081101561138057600080fd5b50516040805160e060020a63ffffffff8716028152600160a060020a0394851660048201529290931660248301526044820152905160648083019260209291908290030181600087803b1580156113d657600080fd5b505af11580156113ea573d6000803e3d6000fd5b505050506040513d602081101561140057600080fd5b50505b506000918252600c60205260409091208054600160a060020a031916600160a060020a03909216919091179055565b3360009081526012602052604090205460ff16151561145057600080fd5b6114598161114b565b151561146457600080fd5b6000908152600b6020526040902080549091019055565b600b6020526000908152604090205481565b600090815260026020526040902054600160a060020a031690565b3360009081526012602052604081205460ff1615156114c657600080fd5b50600160a060020a038216600090815260066020526040812054600160e060020a0316908111156110e4576000908152600e60205260409020805491909103905550565b3360009081526012602052604090205460ff16151561152857600080fd5b6110e4838383612506565b600160a060020a031660009081526004602052604090205490565b3360009081526012602052604090205460ff16151561156c57600080fd5b600160a060020a03909116600090815260066020908152604080832054600160e060020a03168352600b909152902080549091019055565b60056020526000908152604090205481565b600860205260009081526040902054600160e060020a031681565b3360009081526012602052604081205460ff1615156115ef57600080fd5b600083600160a060020a03166318160ddd6040518163ffffffff1660e060020a028152600401602060405180830381600087803b15801561162f57600080fd5b505af1158015611643573d6000803e3d6000fd5b505050506040513d602081101561165957600080fd5b50511161166557600080fd5b5060008054600160e060020a031981166001600160e060020a039283160182161780835516906116989086908390612506565b600160e060020a038116600090815260026020526040902054600160a060020a0316156116c457600080fd5b6116d78582600160e060020a0316612998565b6040805160008152600160a060020a0387166020820152600160e060020a0383168183015290517fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef9181900360600190a1600160e060020a038181166000908152600c602090815260408083208054600160a060020a031916600160a060020a038916179055600d8252808320869055600f82528083208054600160e060020a0319169489169490941790935582517f18160ddd0000000000000000000000000000000000000000000000000000000081529251919273e9fe4e530ebae235877289bd978f207ae0c8bb25926318160ddd9260048084019391929182900301818787803b1580156117e757600080fd5b505af11580156117fb573d6000803e3d6000fd5b505050506040513d602081101561181157600080fd5b505111156118b557604080517fa2d488e0000000000000000000000000000000000000000000000000000000008152600160a060020a0387166004820152600160e060020a0383166024820152905173e9fe4e530ebae235877289bd978f207ae0c8bb259163a2d488e091604480830192600092919082900301818387803b15801561189c57600080fd5b505af11580156118b0573d6000803e3d6000fd5b505050505b5050505050565b600160a060020a038516600090815260066020526040902054600160e060020a03166118e78161114b565b15156118f257600080fd5b3373df0960778c6e6597f197ed9a25f12f5d971da86c1461191257600080fd5b604080517f23b872dd000000000000000000000000000000000000000000000000000000008152600160a060020a038816600482015260006024820181905260448201889052915133926323b872dd92606480820193602093909283900390910190829087803b15801561198557600080fd5b505af1158015611999573d6000803e3d6000fd5b505050506040513d60208110156119af57600080fd5b50506000908152600b60205260409020805490940190935550505050565b3360009081526012602052604090205460ff1615156119eb57600080fd5b6040805160a081018252868152600160e060020a039586166020808301918252958716828401908152606083019586526080830194855260009889526011909652919096209551865551600186018054918616600160e060020a03199283161790559251600286018054919095169316929092179092559051600383015551600490910155565b60408051808201909152600781527f474f4f434c414e00000000000000000000000000000000000000000000000000602082015281565b600160a060020a0391821660009081526006602090815260408083205493909416825283822054600160e060020a03938416808452600a8352858420600385528352858420548516845260119092529390912060020154909392821692911690565b33600090815260126020526040812054819060ff161515611b2b57600080fd5b506000838152600d6020908152604080832054600c83528184205482517fa9059cbb000000000000000000000000000000000000000000000000000000008152600160a060020a038a8116600483015269ffffffffffffffffffff89169093026024820181905293519395929091169363a9059cbb9360448084019492939192918390030190829087803b158015611bc257600080fd5b505af1158015611bd6573d6000803e3d6000fd5b505050506040513d6020811015611bec57600080fd5b509095945050505050565b600160a060020a03909116600090815260066020908152604080832054600160e060020a039081168452600a8352818420948452938252808320548416835260119091529020600201541690565b611c4d612bed565b33600090815260046020526040812054819015611c6957600080fd5b336000908152600660209081526040808320815180830190925254600160e060020a03811680835260e060020a90910463ffffffff1692820192909252945011611cb257600080fd5b604080517fdd53c72800000000000000000000000000000000000000000000000000000000815233600482015290517398278eb74b388efd4d6fc81dd3f95b642ce53f2b9163dd53c7289160248083019260609291908290030181600087803b158015611d1e57600080fd5b505af1158015611d32573d6000803e3d6000fd5b505050506040513d6060811015611d4857600080fd5b5080516020918201518551600160e060020a039081166000908152600e85526040808220805469ffffffffffffffffffff868801169003905588518316825260098652808220805460001901905533808352600687528183209290925588518151931683529482015283519295509093507f35362be75c0f39fcf83e91bc863c0c52834c4c53b0a0f528661cfcd76007e6a292908290030190a169ffffffffffffffffffff828201161580611f1057507398278eb74b388efd4d6fc81dd3f95b642ce53f2b600160a060020a031663158993fd6040518163ffffffff1660e060020a028152600401602060405180830381600087803b158015611e4a57600080fd5b505af1158015611e5e573d6000803e3d6000fd5b505050506040513d6020811015611e7457600080fd5b5051604080517fe0ef84b900000000000000000000000000000000000000000000000000000000815233600482015290517398278eb74b388efd4d6fc81dd3f95b642ce53f2b9163e0ef84b99160248083019260209291908290030181600087803b158015611ee257600080fd5b505af1158015611ef6573d6000803e3d6000fd5b505050506040513d6020811015611f0c57600080fd5b5051145b1515611f1b57600080fd5b428360200151620151800163ffffffff161015156110e457600080fd5b600360205260009081526040902054600160a060020a031681565b600660205260009081526040902054600160e060020a0381169060e060020a900463ffffffff1682565b611f88848484610f04565b611f9484848484612a16565b50505050565b600a602090815260009283526040808420909152908252902054600160e060020a031681565b600760205260009081526040902054600160e060020a031681565b600d6020526000908152604090205481565b6010602090815260009283526040808420909152908252902054600160a060020a031681565b600154600160a060020a0316331461202a57600080fd5b6000918252600d602052604090912055565b60046020528160005260406000208181548110151561205757fe5b90600052602060002001600091509150505481565b600e6020526000908152604090205481565b33600090815260126020526040812054819081908190819081908190819060ff1615156120aa57600080fd5b60008a8152600b60205260409020549650600160e060020a03871669ffffffffffffffffffff8a16116120e9578869ffffffffffffffffffff166120eb565b865b60008b8152600b602052604090205490965061211690600160e060020a03881663ffffffff6124f416565b60008b8152600b60209081526040808320939093558d8252600790522054606490600160e060020a03908116880216049450600f60008c815260200190815260200160002060009054906101000a9004600160e060020a03169350601060008d600160a060020a0316600160a060020a0316815260200190815260200160002060008c815260200190815260200160002060009054906101000a9004600160a060020a03169250600085600160e060020a031611806121f15750600084600160e060020a03161180156121f15750600160a060020a03831615155b1561243e5760008b815260086020526040902054606490600160e060020a03908116880216049150600160a060020a038316156122d9576064600160e060020a0387860216604080517f4f03f17c00000000000000000000000000000000000000000000000000000000815292909104600160e060020a0381166004840152600160a060020a0386166024840152905190925073df0960778c6e6597f197ed9a25f12f5d971da86c91634f03f17c91604480830192600092919082900301818387803b1580156122c057600080fd5b505af11580156122d4573d6000803e3d6000fd5b505050505b60008b8152600b602090815260408083208054600160e060020a038a811690910190915560029092528083205481517f4f03f17c0000000000000000000000000000000000000000000000000000000081529286166004840152600160a060020a031660248301525173df0960778c6e6597f197ed9a25f12f5d971da86c92634f03f17c926044808201939182900301818387803b15801561237a57600080fd5b505af115801561238e573d6000803e3d6000fd5b5050505073df0960778c6e6597f197ed9a25f12f5d971da86c600160a060020a0316634f03f17c828488010188038e6040518363ffffffff1660e060020a0281526004018083600160e060020a0316600160e060020a0316815260200182600160a060020a0316600160a060020a0316815260200192505050600060405180830381600087803b15801561242157600080fd5b505af1158015612435573d6000803e3d6000fd5b505050506124da565b604080517f4f03f17c000000000000000000000000000000000000000000000000000000008152600160e060020a0388166004820152600160a060020a038e166024820152905173df0960778c6e6597f197ed9a25f12f5d971da86c91634f03f17c91604480830192600092919082900301818387803b1580156124c157600080fd5b505af11580156124d5573d6000803e3d6000fd5b505050505b5050600160e060020a039093169998505050505050505050565b60008282111561250057fe5b50900390565b600080612511612bed565b600160a060020a0386166000908152600460205260409020541561253457600080fd5b604080517fdd53c728000000000000000000000000000000000000000000000000000000008152600160a060020a038816600482015290517398278eb74b388efd4d6fc81dd3f95b642ce53f2b9163dd53c7289160248083019260609291908290030181600087803b1580156125a957600080fd5b505af11580156125bd573d6000803e3d6000fd5b505050506040513d60608110156125d357600080fd5b508051602091820151600160a060020a0389166000908152600684526040808220815180830190925254600160e060020a03811680835260e060020a90910463ffffffff169582019590955292965090945090925010156126ba578051600160e060020a0390811660009081526009602090815260408083208054600019019055845184168352600e825291829020805469ffffffffffffffffffff88880116900390558351825193168352600160a060020a0389169083015280517f35362be75c0f39fcf83e91bc863c0c52834c4c53b0a0f528661cfcd76007e6a29281900390910190a15b600160a060020a038416158015906126e4575085600160a060020a031684600160a060020a031614155b1561275c57600160a060020a038416600090815260066020526040902054600160e060020a0386811691161461271957600080fd5b600160a060020a038681166000908152601060209081526040808320600160e060020a038a16845290915290208054600160a060020a0319169186169190911790555b600160e060020a0380861680835263ffffffff4281166020808601918252600084815260098252604080822080546001019055600e8352808220805469ffffffffffffffffffff8c8c0116019055600160a060020a03808e16808452600685529282902089518154965190971660e060020a02968916600160e060020a0319909616959095179097169490941790925582519384528301529186168183015290517f254ec6da34e9a6d5a2299d82a8e64bc04bd8af79fae42c3ecedfa03f7466b92f9181900360600190a1505050505050565b60008181526002602052604081205481908190600160a060020a0386811691161461285957600080fd5b60008481526002602090815260408083208054600160a060020a03191690556005825280832054600160a060020a03891684526004909252909120549093506128a990600163ffffffff6124f416565b600160a060020a0386166000908152600460205260409020805491935090839081106128d157fe5b90600052602060002001549050806004600087600160a060020a0316600160a060020a031681526020019081526020016000208481548110151561291157fe5b6000918252602080832090910192909255600160a060020a038716815260049091526040812080548490811061294357fe5b6000918252602080832090910192909255600160a060020a038716815260049091526040902080549061297a906000198301612c04565b50600093845260056020526040808520859055908452909220555050565b600160a060020a038216600090815260046020526040902054156129bb57600080fd5b60008181526002602090815260408083208054600160a060020a03909616600160a060020a03199096168617905593825260048082528483208054858552600584529584208690559082526001850181558252902090910155565b823b600080821115612ba3576040517f150b7a020000000000000000000000000000000000000000000000000000000081523360048201818152600160a060020a03898116602485015260448401889052608060648501908152875160848601528751918a169463150b7a0294938c938b938b93909160a490910190602085019080838360005b83811015612ab5578181015183820152602001612a9d565b50505050905090810190601f168015612ae25780820380516001836020036101000a031916815260200191505b5095505050505050602060405180830381600087803b158015612b0457600080fd5b505af1158015612b18573d6000803e3d6000fd5b505050506040513d6020811015612b2e57600080fd5b5051604080517f6f6e455243373231526563656976656428616464726573732c6164647265737381527f2c75696e743235362c62797465732900000000000000000000000000000000006020820152905190819003602f019020909150600160e060020a0319808316911614612ba357600080fd5b505050505050565b60a060405190810160405280600081526020016000600160e060020a031681526020016000600160e060020a0316815260200160008152602001600081525090565b604080518082019091526000808252602082015290565b8154818355818111156110e4576000838152602090206110e4918101908301610ecb91905b80821115612c3d5760008155600101612c29565b50905600a165627a7a723058204189b5152fda78273a7212a5120282adf68c15cc949c6605eddc5182257c70e00029"
}